{"version":3,"sources":["webpack://@jupyterlab/application-top/./node_modules/microplugin/src/microplugin.js","webpack://@jupyterlab/application-top/./node_modules/selectize/dist/js/selectize.js","webpack://@jupyterlab/application-top/./node_modules/sifter/sifter.js"],"names":["root","factory","this","MicroPlugin","mixin","Interface","plugins","prototype","initializePlugins","i","n","key","self","queue","names","settings","requested","loaded","utils","isArray","length","push","name","options","hasOwnProperty","require","shift","loadPlugin","plugin","Error","fn","apply","define","Array","vArg","Object","toString","call","$","Sifter","highlight","$element","pattern","regex","RegExp","node","skip","nodeType","pos","data","search","match","spannode","document","createElement","className","middlebit","splitText","endbit","middleclone","cloneNode","appendChild","parentNode","replaceChild","childNodes","test","tagName","each","removeHighlight","find","firstChild","nodeName","parent","normalize","end","MicroEvent","on","event","fct","_events","off","arguments","splice","indexOf","trigger","slice","destObject","props","IS_MAC","navigator","userAgent","KEY_A","KEY_COMMA","KEY_RETURN","KEY_ESC","KEY_LEFT","KEY_UP","KEY_P","KEY_RIGHT","KEY_DOWN","KEY_N","KEY_BACKSPACE","KEY_DELETE","KEY_SHIFT","KEY_CMD","KEY_CTRL","KEY_TAB","TAG_SELECT","TAG_INPUT","SUPPORTS_VALIDITY_API","window","validity","isset","object","hash_key","value","escape_html","str","replace","escape_replace","hook","before","method","original","after","result","once","called","debounce","delay","timeout","args","clearTimeout","setTimeout","debounce_events","types","type","event_args","watchChildEvent","$parent","selector","e","child","target","currentTarget","getSelection","input","start","selectionStart","selectionEnd","selection","focus","sel","createRange","selLen","text","moveStart","transferStyles","$from","$to","properties","styles","css","measureString","Selectize","$testInput","position","top","left","width","padding","whiteSpace","appendTo","autoGrow","$input","currentWidth","update","keyCode","printable","placeholder","character","metaKey","altKey","force","val","toLowerCase","substring","shiftKey","String","fromCharCode","toUpperCase","attr","triggerHandler","domToString","d","tmp","innerHTML","logError","message","component","console","error","explanation","group","groupEnd","dir","selectize","computedStyle","getComputedStyle","getPropertyValue","currentStyle","direction","parents","extend","order","tabIndex","tagType","rtl","eventNS","count","highlightedValue","isBlurring","isOpen","isDisabled","isRequired","is","isInvalid","isLocked","isFocused","isInputHidden","isSetup","isShiftDown","isCmdDown","isCtrlDown","ignoreFocus","ignoreBlur","ignoreHover","hasOptions","currentResults","lastValue","caretPos","loading","loadedSearches","$activeOption","$activeItems","optgroups","userOptions","items","renderCache","onSearchChange","loadThrottle","sifter","diacritics","registerOption","registerOptionGroup","mode","maxItems","hideSelected","setupCallbacks","setupTemplates","setup","$window","$document","$wrapper","$control","$control_input","$dropdown","$dropdown_content","$dropdown_parent","inputMode","timeout_blur","timeout_focus","classes","classes_plugins","inputId","addClass","wrapperClass","inputClass","dropdownParent","dropdownClass","hide","dropdownContentClass","copyClassesToDropdown","style","join","splitOn","delimiter","delimiterEscaped","stopImmediatePropagation","onOptionHover","onOptionSelect","onItemSelect","mousedown","onMouseDown","click","onClick","stopPropagation","keydown","onKeyDown","keyup","onKeyUp","keypress","onKeyPress","resize","positionDropdown","blur","onBlur","onFocus","paste","onPaste","has","revertSettings","$children","children","detach","tabindex","setValue","preventDefault","refreshState","updateOriginalInput","refreshItems","updatePlaceholder","disable","onChange","preload","field_label","labelField","field_optgroup","optgroupLabelField","templates","html","escape","render","callbacks","defaultPrevented","isDefaultPrevented","$target","close","open","setActiveItem","isFull","pastedText","splitInput","trim","split","createItem","which","create","isInput","selectAll","ctrlKey","$next","getAdjacentOption","setActiveOption","$prev","advanceSelection","selectOnTab","deleteSelection","refreshOptions","load","callback","wasFocused","showInput","openOnFocus","dest","activeElement","deactivate","setTextboxValue","setCaret","createOnBlur","$option","hasClass","closeAfterSelect","lastQuery","addItem","getOption","loadingClass","results","Math","max","addOption","removeClass","changed","getValue","silent","events","clear","addItems","$item","eventName","idx","begin","item","swap","$last","hideInput","scroll","animate","height_menu","height_item","y","scroll_top","scroll_bottom","height","outerHeight","scrollTop","offset","stop","scrollDuration","opacity","getScoreFunction","query","getSearchOptions","sort","sortField","field","fields","searchField","conjunction","searchConjunction","nesting","score","calculateScore","id","triggerDropdown","j","k","groups","groups_order","option","option_html","optgroup","html_children","has_create_option","$active","$active_before","$create","active_before","maxOptions","min","optgroupField","createDocumentFragment","lockOptgroupOrder","a","b","a_order","$order","b_order","dom","tokens","canCreate","prepend","addPrecedence","valueField","optgroupValueField","addOptionGroup","removeOptionGroup","clearOptionGroups","updateOption","$item_new","value_new","index_item","cache_items","cache_options","order_old","getItem","replaceWith","removeOption","removeItem","clearOptions","getElementWithValue","$options","index","eq","$els","getAttribute","values","buffer","isPending","control","insertBefore","active","value_next","wasFull","insertAtCaret","remove","persist","caret","lock","unlock","output","refreshValidityState","refreshClasses","invalid","prop","toggleClass","isEmptyObject","opts","label","removeAttr","visibility","display","getBoundingClientRect","$el","el","option_select","$option_select","$tail","onDelete","pop","tail","valueLength","cursorAtEdge","advanceCaret","$adj","$child","append","enable","destroy","show","removeData","undefined","body","templateName","cache","regex_tag","disabledField","clearCache","filter","createFilter","defaults","allowEmptyOption","dataAttr","settings_user","attr_data","field_value","field_disabled","field_optgroup_label","field_optgroup_value","init_textbox","settings_element","data_raw","JSON","parse","init_select","optionsMap","readData","arr","addGroup","$optgroup","instance","tag_name","support","sortable","forcePlaceholderSize","disabled","ui","helper","overflow","title","headerClass","titleRowClass","labelClass","closeClass","$dropdown_header","equalizeWidth","equalizeHeight","closest","prev","next","getScrollbarWidth","div","doc","offsetWidth","clientWidth","removeChild","equalizeSizes","height_max","width_last","width_parent","$optgroups","innerWidth","round","singleClose","thisRef","html_container","html_element","context","selectizer","render_item","multiClose","tokenize","letter","words","escape_regex","DIACRITICS","string","iterator","is_array","forEach","token_count","prepareSearch","scoreValue","token","scoreObject","field_count","getattr","sum","getSortFunction","fields_count","multiplier","multipliers","get_field","implicit_score","sort_empty","unshift","cmp","a_value","b_value","option_fields","option_sort","option_sort_empty","total","fn_sort","fn_score","limit","asciifold","obj","chunk","foreignletters","lookup","charAt","regexp","foreignletter"],"mappings":"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","file":"5703.cda205ba89151b892c7d.js?v=cda205ba89151b892c7d","sourcesContent":["/**\n * microplugin.js\n * Copyright (c) 2013 Brian Reavis & contributors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this\n * file except in compliance with the License. You may obtain a copy of the License at:\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software distributed under\n * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF\n * ANY KIND, either express or implied. See the License for the specific language\n * governing permissions and limitations under the License.\n *\n * @author Brian Reavis <brian@thirdroute.com>\n */\n\n(function(root, factory) {\n\tif (typeof define === 'function' && define.amd) {\n\t\tdefine(factory);\n\t} else if (typeof exports === 'object') {\n\t\tmodule.exports = factory();\n\t} else {\n\t\troot.MicroPlugin = factory();\n\t}\n}(this, function() {\n\tvar MicroPlugin = {};\n\n\tMicroPlugin.mixin = function(Interface) {\n\t\tInterface.plugins = {};\n\n\t\t/**\n\t\t * Initializes the listed plugins (with options).\n\t\t * Acceptable formats:\n\t\t *\n\t\t * List (without options):\n\t\t *   ['a', 'b', 'c']\n\t\t *\n\t\t * List (with options):\n\t\t *   [{'name': 'a', options: {}}, {'name': 'b', options: {}}]\n\t\t *\n\t\t * Hash (with options):\n\t\t *   {'a': { ... }, 'b': { ... }, 'c': { ... }}\n\t\t *\n\t\t * @param {mixed} plugins\n\t\t */\n\t\tInterface.prototype.initializePlugins = function(plugins) {\n\t\t\tvar i, n, key;\n\t\t\tvar self  = this;\n\t\t\tvar queue = [];\n\n\t\t\tself.plugins = {\n\t\t\t\tnames     : [],\n\t\t\t\tsettings  : {},\n\t\t\t\trequested : {},\n\t\t\t\tloaded    : {}\n\t\t\t};\n\n\t\t\tif (utils.isArray(plugins)) {\n\t\t\t\tfor (i = 0, n = plugins.length; i < n; i++) {\n\t\t\t\t\tif (typeof plugins[i] === 'string') {\n\t\t\t\t\t\tqueue.push(plugins[i]);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tself.plugins.settings[plugins[i].name] = plugins[i].options;\n\t\t\t\t\t\tqueue.push(plugins[i].name);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else if (plugins) {\n\t\t\t\tfor (key in plugins) {\n\t\t\t\t\tif (plugins.hasOwnProperty(key)) {\n\t\t\t\t\t\tself.plugins.settings[key] = plugins[key];\n\t\t\t\t\t\tqueue.push(key);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\twhile (queue.length) {\n\t\t\t\tself.require(queue.shift());\n\t\t\t}\n\t\t};\n\n\t\tInterface.prototype.loadPlugin = function(name) {\n\t\t\tvar self    = this;\n\t\t\tvar plugins = self.plugins;\n\t\t\tvar plugin  = Interface.plugins[name];\n\n\t\t\tif (!Interface.plugins.hasOwnProperty(name)) {\n\t\t\t\tthrow new Error('Unable to find \"' +  name + '\" plugin');\n\t\t\t}\n\n\t\t\tplugins.requested[name] = true;\n\t\t\tplugins.loaded[name] = plugin.fn.apply(self, [self.plugins.settings[name] || {}]);\n\t\t\tplugins.names.push(name);\n\t\t};\n\n\t\t/**\n\t\t * Initializes a plugin.\n\t\t *\n\t\t * @param {string} name\n\t\t */\n\t\tInterface.prototype.require = function(name) {\n\t\t\tvar self = this;\n\t\t\tvar plugins = self.plugins;\n\n\t\t\tif (!self.plugins.loaded.hasOwnProperty(name)) {\n\t\t\t\tif (plugins.requested[name]) {\n\t\t\t\t\tthrow new Error('Plugin has circular dependency (\"' + name + '\")');\n\t\t\t\t}\n\t\t\t\tself.loadPlugin(name);\n\t\t\t}\n\n\t\t\treturn plugins.loaded[name];\n\t\t};\n\n\t\t/**\n\t\t * Registers a plugin.\n\t\t *\n\t\t * @param {string} name\n\t\t * @param {function} fn\n\t\t */\n\t\tInterface.define = function(name, fn) {\n\t\t\tInterface.plugins[name] = {\n\t\t\t\t'name' : name,\n\t\t\t\t'fn'   : fn\n\t\t\t};\n\t\t};\n\t};\n\n\tvar utils = {\n\t\tisArray: Array.isArray || function(vArg) {\n\t\t\treturn Object.prototype.toString.call(vArg) === '[object Array]';\n\t\t}\n\t};\n\n\treturn MicroPlugin;\n}));","/**\n * selectize.js (v0.12.6)\n * Copyright (c) 20132015 Brian Reavis & contributors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this\n * file except in compliance with the License. You may obtain a copy of the License at:\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software distributed under\n * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF\n * ANY KIND, either express or implied. See the License for the specific language\n * governing permissions and limitations under the License.\n *\n * @author Brian Reavis <brian@thirdroute.com>\n */\n\n/*jshint curly:false */\n/*jshint browser:true */\n\n(function(root, factory) {\n\tif (typeof define === 'function' && define.amd) {\n\t\tdefine(['jquery','sifter','microplugin'], factory);\n\t} else if (typeof exports === 'object') {\n\t\tmodule.exports = factory(require('jquery'), require('sifter'), require('microplugin'));\n\t} else {\n\t\troot.Selectize = factory(root.jQuery, root.Sifter, root.MicroPlugin);\n\t}\n}(this, function($, Sifter, MicroPlugin) {\n\t'use strict';\n\n\tvar highlight = function($element, pattern) {\n\t\tif (typeof pattern === 'string' && !pattern.length) return;\n\t\tvar regex = (typeof pattern === 'string') ? new RegExp(pattern, 'i') : pattern;\n\t\n\t\tvar highlight = function(node) {\n\t\t\tvar skip = 0;\n\t\t\t// Wrap matching part of text node with highlighting <span>, e.g.\n\t\t\t// Soccer  ->  <span class=\"highlight\">Soc</span>cer  for regex = /soc/i\n\t\t\tif (node.nodeType === 3) {\n\t\t\t\tvar pos = node.data.search(regex);\n\t\t\t\tif (pos >= 0 && node.data.length > 0) {\n\t\t\t\t\tvar match = node.data.match(regex);\n\t\t\t\t\tvar spannode = document.createElement('span');\n\t\t\t\t\tspannode.className = 'highlight';\n\t\t\t\t\tvar middlebit = node.splitText(pos);\n\t\t\t\t\tvar endbit = middlebit.splitText(match[0].length);\n\t\t\t\t\tvar middleclone = middlebit.cloneNode(true);\n\t\t\t\t\tspannode.appendChild(middleclone);\n\t\t\t\t\tmiddlebit.parentNode.replaceChild(spannode, middlebit);\n\t\t\t\t\tskip = 1;\n\t\t\t\t}\n\t\t\t} \n\t\t\t// Recurse element node, looking for child text nodes to highlight, unless element \n\t\t\t// is childless, <script>, <style>, or already highlighted: <span class=\"hightlight\">\n\t\t\telse if (node.nodeType === 1 && node.childNodes && !/(script|style)/i.test(node.tagName) && ( node.className !== 'highlight' || node.tagName !== 'SPAN' )) {\n\t\t\t\tfor (var i = 0; i < node.childNodes.length; ++i) {\n\t\t\t\t\ti += highlight(node.childNodes[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn skip;\n\t\t};\n\t\n\t\treturn $element.each(function() {\n\t\t\thighlight(this);\n\t\t});\n\t};\n\t\n\t/**\n\t * removeHighlight fn copied from highlight v5 and\n\t * edited to remove with() and pass js strict mode\n\t */\n\t$.fn.removeHighlight = function() {\n\t\treturn this.find(\"span.highlight\").each(function() {\n\t\t\tthis.parentNode.firstChild.nodeName;\n\t\t\tvar parent = this.parentNode;\n\t\t\tparent.replaceChild(this.firstChild, this);\n\t\t\tparent.normalize();\n\t\t}).end();\n\t};\n\t\n\t\n\tvar MicroEvent = function() {};\n\tMicroEvent.prototype = {\n\t\ton: function(event, fct){\n\t\t\tthis._events = this._events || {};\n\t\t\tthis._events[event] = this._events[event] || [];\n\t\t\tthis._events[event].push(fct);\n\t\t},\n\t\toff: function(event, fct){\n\t\t\tvar n = arguments.length;\n\t\t\tif (n === 0) return delete this._events;\n\t\t\tif (n === 1) return delete this._events[event];\n\t\n\t\t\tthis._events = this._events || {};\n\t\t\tif (event in this._events === false) return;\n\t\t\tthis._events[event].splice(this._events[event].indexOf(fct), 1);\n\t\t},\n\t\ttrigger: function(event /* , args... */){\n\t\t\tthis._events = this._events || {};\n\t\t\tif (event in this._events === false) return;\n\t\t\tfor (var i = 0; i < this._events[event].length; i++){\n\t\t\t\tthis._events[event][i].apply(this, Array.prototype.slice.call(arguments, 1));\n\t\t\t}\n\t\t}\n\t};\n\t\n\t/**\n\t * Mixin will delegate all MicroEvent.js function in the destination object.\n\t *\n\t * - MicroEvent.mixin(Foobar) will make Foobar able to use MicroEvent\n\t *\n\t * @param {object} the object which will support MicroEvent\n\t */\n\tMicroEvent.mixin = function(destObject){\n\t\tvar props = ['on', 'off', 'trigger'];\n\t\tfor (var i = 0; i < props.length; i++){\n\t\t\tdestObject.prototype[props[i]] = MicroEvent.prototype[props[i]];\n\t\t}\n\t};\n\t\n\tvar IS_MAC        = /Mac/.test(navigator.userAgent);\n\t\n\tvar KEY_A         = 65;\n\tvar KEY_COMMA     = 188;\n\tvar KEY_RETURN    = 13;\n\tvar KEY_ESC       = 27;\n\tvar KEY_LEFT      = 37;\n\tvar KEY_UP        = 38;\n\tvar KEY_P         = 80;\n\tvar KEY_RIGHT     = 39;\n\tvar KEY_DOWN      = 40;\n\tvar KEY_N         = 78;\n\tvar KEY_BACKSPACE = 8;\n\tvar KEY_DELETE    = 46;\n\tvar KEY_SHIFT     = 16;\n\tvar KEY_CMD       = IS_MAC ? 91 : 17;\n\tvar KEY_CTRL      = IS_MAC ? 18 : 17;\n\tvar KEY_TAB       = 9;\n\t\n\tvar TAG_SELECT    = 1;\n\tvar TAG_INPUT     = 2;\n\t\n\t// for now, android support in general is too spotty to support validity\n\tvar SUPPORTS_VALIDITY_API = !/android/i.test(window.navigator.userAgent) && !!document.createElement('input').validity;\n\t\n\t\n\tvar isset = function(object) {\n\t\treturn typeof object !== 'undefined';\n\t};\n\t\n\t/**\n\t * Converts a scalar to its best string representation\n\t * for hash keys and HTML attribute values.\n\t *\n\t * Transformations:\n\t *   'str'     -> 'str'\n\t *   null      -> ''\n\t *   undefined -> ''\n\t *   true      -> '1'\n\t *   false     -> '0'\n\t *   0         -> '0'\n\t *   1         -> '1'\n\t *\n\t * @param {string} value\n\t * @returns {string|null}\n\t */\n\tvar hash_key = function(value) {\n\t\tif (typeof value === 'undefined' || value === null) return null;\n\t\tif (typeof value === 'boolean') return value ? '1' : '0';\n\t\treturn value + '';\n\t};\n\t\n\t/**\n\t * Escapes a string for use within HTML.\n\t *\n\t * @param {string} str\n\t * @returns {string}\n\t */\n\tvar escape_html = function(str) {\n\t\treturn (str + '')\n\t\t\t.replace(/&/g, '&amp;')\n\t\t\t.replace(/</g, '&lt;')\n\t\t\t.replace(/>/g, '&gt;')\n\t\t\t.replace(/\"/g, '&quot;');\n\t};\n\t\n\t/**\n\t * Escapes \"$\" characters in replacement strings.\n\t *\n\t * @param {string} str\n\t * @returns {string}\n\t */\n\tvar escape_replace = function(str) {\n\t\treturn (str + '').replace(/\\$/g, '$$$$');\n\t};\n\t\n\tvar hook = {};\n\t\n\t/**\n\t * Wraps `method` on `self` so that `fn`\n\t * is invoked before the original method.\n\t *\n\t * @param {object} self\n\t * @param {string} method\n\t * @param {function} fn\n\t */\n\thook.before = function(self, method, fn) {\n\t\tvar original = self[method];\n\t\tself[method] = function() {\n\t\t\tfn.apply(self, arguments);\n\t\t\treturn original.apply(self, arguments);\n\t\t};\n\t};\n\t\n\t/**\n\t * Wraps `method` on `self` so that `fn`\n\t * is invoked after the original method.\n\t *\n\t * @param {object} self\n\t * @param {string} method\n\t * @param {function} fn\n\t */\n\thook.after = function(self, method, fn) {\n\t\tvar original = self[method];\n\t\tself[method] = function() {\n\t\t\tvar result = original.apply(self, arguments);\n\t\t\tfn.apply(self, arguments);\n\t\t\treturn result;\n\t\t};\n\t};\n\t\n\t/**\n\t * Wraps `fn` so that it can only be invoked once.\n\t *\n\t * @param {function} fn\n\t * @returns {function}\n\t */\n\tvar once = function(fn) {\n\t\tvar called = false;\n\t\treturn function() {\n\t\t\tif (called) return;\n\t\t\tcalled = true;\n\t\t\tfn.apply(this, arguments);\n\t\t};\n\t};\n\t\n\t/**\n\t * Wraps `fn` so that it can only be called once\n\t * every `delay` milliseconds (invoked on the falling edge).\n\t *\n\t * @param {function} fn\n\t * @param {int} delay\n\t * @returns {function}\n\t */\n\tvar debounce = function(fn, delay) {\n\t\tvar timeout;\n\t\treturn function() {\n\t\t\tvar self = this;\n\t\t\tvar args = arguments;\n\t\t\twindow.clearTimeout(timeout);\n\t\t\ttimeout = window.setTimeout(function() {\n\t\t\t\tfn.apply(self, args);\n\t\t\t}, delay);\n\t\t};\n\t};\n\t\n\t/**\n\t * Debounce all fired events types listed in `types`\n\t * while executing the provided `fn`.\n\t *\n\t * @param {object} self\n\t * @param {array} types\n\t * @param {function} fn\n\t */\n\tvar debounce_events = function(self, types, fn) {\n\t\tvar type;\n\t\tvar trigger = self.trigger;\n\t\tvar event_args = {};\n\t\n\t\t// override trigger method\n\t\tself.trigger = function() {\n\t\t\tvar type = arguments[0];\n\t\t\tif (types.indexOf(type) !== -1) {\n\t\t\t\tevent_args[type] = arguments;\n\t\t\t} else {\n\t\t\t\treturn trigger.apply(self, arguments);\n\t\t\t}\n\t\t};\n\t\n\t\t// invoke provided function\n\t\tfn.apply(self, []);\n\t\tself.trigger = trigger;\n\t\n\t\t// trigger queued events\n\t\tfor (type in event_args) {\n\t\t\tif (event_args.hasOwnProperty(type)) {\n\t\t\t\ttrigger.apply(self, event_args[type]);\n\t\t\t}\n\t\t}\n\t};\n\t\n\t/**\n\t * A workaround for http://bugs.jquery.com/ticket/6696\n\t *\n\t * @param {object} $parent - Parent element to listen on.\n\t * @param {string} event - Event name.\n\t * @param {string} selector - Descendant selector to filter by.\n\t * @param {function} fn - Event handler.\n\t */\n\tvar watchChildEvent = function($parent, event, selector, fn) {\n\t\t$parent.on(event, selector, function(e) {\n\t\t\tvar child = e.target;\n\t\t\twhile (child && child.parentNode !== $parent[0]) {\n\t\t\t\tchild = child.parentNode;\n\t\t\t}\n\t\t\te.currentTarget = child;\n\t\t\treturn fn.apply(this, [e]);\n\t\t});\n\t};\n\t\n\t/**\n\t * Determines the current selection within a text input control.\n\t * Returns an object containing:\n\t *   - start\n\t *   - length\n\t *\n\t * @param {object} input\n\t * @returns {object}\n\t */\n\tvar getSelection = function(input) {\n\t\tvar result = {};\n\t\tif ('selectionStart' in input) {\n\t\t\tresult.start = input.selectionStart;\n\t\t\tresult.length = input.selectionEnd - result.start;\n\t\t} else if (document.selection) {\n\t\t\tinput.focus();\n\t\t\tvar sel = document.selection.createRange();\n\t\t\tvar selLen = document.selection.createRange().text.length;\n\t\t\tsel.moveStart('character', -input.value.length);\n\t\t\tresult.start = sel.text.length - selLen;\n\t\t\tresult.length = selLen;\n\t\t}\n\t\treturn result;\n\t};\n\t\n\t/**\n\t * Copies CSS properties from one element to another.\n\t *\n\t * @param {object} $from\n\t * @param {object} $to\n\t * @param {array} properties\n\t */\n\tvar transferStyles = function($from, $to, properties) {\n\t\tvar i, n, styles = {};\n\t\tif (properties) {\n\t\t\tfor (i = 0, n = properties.length; i < n; i++) {\n\t\t\t\tstyles[properties[i]] = $from.css(properties[i]);\n\t\t\t}\n\t\t} else {\n\t\t\tstyles = $from.css();\n\t\t}\n\t\t$to.css(styles);\n\t};\n\t\n\t/**\n\t * Measures the width of a string within a\n\t * parent element (in pixels).\n\t *\n\t * @param {string} str\n\t * @param {object} $parent\n\t * @returns {int}\n\t */\n\tvar measureString = function(str, $parent) {\n\t\tif (!str) {\n\t\t\treturn 0;\n\t\t}\n\t\n\t\tif (!Selectize.$testInput) {\n\t\t\tSelectize.$testInput = $('<span />').css({\n\t\t\t\tposition: 'absolute',\n\t\t\t\ttop: -99999,\n\t\t\t\tleft: -99999,\n\t\t\t\twidth: 'auto',\n\t\t\t\tpadding: 0,\n\t\t\t\twhiteSpace: 'pre'\n\t\t\t}).appendTo('body');\n\t\t}\n\t\n\t\tSelectize.$testInput.text(str);\n\t\n\t\ttransferStyles($parent, Selectize.$testInput, [\n\t\t\t'letterSpacing',\n\t\t\t'fontSize',\n\t\t\t'fontFamily',\n\t\t\t'fontWeight',\n\t\t\t'textTransform'\n\t\t]);\n\t\n\t\treturn Selectize.$testInput.width();\n\t};\n\t\n\t/**\n\t * Sets up an input to grow horizontally as the user\n\t * types. If the value is changed manually, you can\n\t * trigger the \"update\" handler to resize:\n\t *\n\t * $input.trigger('update');\n\t *\n\t * @param {object} $input\n\t */\n\tvar autoGrow = function($input) {\n\t\tvar currentWidth = null;\n\t\n\t\tvar update = function(e, options) {\n\t\t\tvar value, keyCode, printable, placeholder, width;\n\t\t\tvar shift, character, selection;\n\t\t\te = e || window.event || {};\n\t\t\toptions = options || {};\n\t\n\t\t\tif (e.metaKey || e.altKey) return;\n\t\t\tif (!options.force && $input.data('grow') === false) return;\n\t\n\t\t\tvalue = $input.val();\n\t\t\tif (e.type && e.type.toLowerCase() === 'keydown') {\n\t\t\t\tkeyCode = e.keyCode;\n\t\t\t\tprintable = (\n\t\t\t\t\t(keyCode >= 48 && keyCode <= 57)  || // 0-9\n\t\t\t\t\t(keyCode >= 65 && keyCode <= 90)   || // a-z\n\t\t\t\t\t(keyCode >= 96 && keyCode <= 111)  || // numpad 0-9, numeric operators\n\t\t\t\t\t(keyCode >= 186 && keyCode <= 222) || // semicolon, equal, comma, dash, etc.\n\t\t\t\t\tkeyCode === 32 // space\n\t\t\t\t);\n\t\n\t\t\t\tif (keyCode === KEY_DELETE || keyCode === KEY_BACKSPACE) {\n\t\t\t\t\tselection = getSelection($input[0]);\n\t\t\t\t\tif (selection.length) {\n\t\t\t\t\t\tvalue = value.substring(0, selection.start) + value.substring(selection.start + selection.length);\n\t\t\t\t\t} else if (keyCode === KEY_BACKSPACE && selection.start) {\n\t\t\t\t\t\tvalue = value.substring(0, selection.start - 1) + value.substring(selection.start + 1);\n\t\t\t\t\t} else if (keyCode === KEY_DELETE && typeof selection.start !== 'undefined') {\n\t\t\t\t\t\tvalue = value.substring(0, selection.start) + value.substring(selection.start + 1);\n\t\t\t\t\t}\n\t\t\t\t} else if (printable) {\n\t\t\t\t\tshift = e.shiftKey;\n\t\t\t\t\tcharacter = String.fromCharCode(e.keyCode);\n\t\t\t\t\tif (shift) character = character.toUpperCase();\n\t\t\t\t\telse character = character.toLowerCase();\n\t\t\t\t\tvalue += character;\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\tplaceholder = $input.attr('placeholder');\n\t\t\tif (!value && placeholder) {\n\t\t\t\tvalue = placeholder;\n\t\t\t}\n\t\n\t\t\twidth = measureString(value, $input) + 4;\n\t\t\tif (width !== currentWidth) {\n\t\t\t\tcurrentWidth = width;\n\t\t\t\t$input.width(width);\n\t\t\t\t$input.triggerHandler('resize');\n\t\t\t}\n\t\t};\n\t\n\t\t$input.on('keydown keyup update blur', update);\n\t\tupdate();\n\t};\n\t\n\tvar domToString = function(d) {\n\t\tvar tmp = document.createElement('div');\n\t\n\t\ttmp.appendChild(d.cloneNode(true));\n\t\n\t\treturn tmp.innerHTML;\n\t};\n\t\n\tvar logError = function(message, options){\n\t\tif(!options) options = {};\n\t\tvar component = \"Selectize\";\n\t\n\t\tconsole.error(component + \": \" + message)\n\t\n\t\tif(options.explanation){\n\t\t\t// console.group is undefined in <IE11\n\t\t\tif(console.group) console.group();\n\t\t\tconsole.error(options.explanation);\n\t\t\tif(console.group) console.groupEnd();\n\t\t}\n\t}\n\t\n\t\n\tvar Selectize = function($input, settings) {\n\t\tvar key, i, n, dir, input, self = this;\n\t\tinput = $input[0];\n\t\tinput.selectize = self;\n\t\n\t\t// detect rtl environment\n\t\tvar computedStyle = window.getComputedStyle && window.getComputedStyle(input, null);\n\t\tdir = computedStyle ? computedStyle.getPropertyValue('direction') : input.currentStyle && input.currentStyle.direction;\n\t\tdir = dir || $input.parents('[dir]:first').attr('dir') || '';\n\t\n\t\t// setup default state\n\t\t$.extend(self, {\n\t\t\torder            : 0,\n\t\t\tsettings         : settings,\n\t\t\t$input           : $input,\n\t\t\ttabIndex         : $input.attr('tabindex') || '',\n\t\t\ttagType          : input.tagName.toLowerCase() === 'select' ? TAG_SELECT : TAG_INPUT,\n\t\t\trtl              : /rtl/i.test(dir),\n\t\n\t\t\teventNS          : '.selectize' + (++Selectize.count),\n\t\t\thighlightedValue : null,\n\t\t\tisBlurring       : false,\n\t\t\tisOpen           : false,\n\t\t\tisDisabled       : false,\n\t\t\tisRequired       : $input.is('[required]'),\n\t\t\tisInvalid        : false,\n\t\t\tisLocked         : false,\n\t\t\tisFocused        : false,\n\t\t\tisInputHidden    : false,\n\t\t\tisSetup          : false,\n\t\t\tisShiftDown      : false,\n\t\t\tisCmdDown        : false,\n\t\t\tisCtrlDown       : false,\n\t\t\tignoreFocus      : false,\n\t\t\tignoreBlur       : false,\n\t\t\tignoreHover      : false,\n\t\t\thasOptions       : false,\n\t\t\tcurrentResults   : null,\n\t\t\tlastValue        : '',\n\t\t\tcaretPos         : 0,\n\t\t\tloading          : 0,\n\t\t\tloadedSearches   : {},\n\t\n\t\t\t$activeOption    : null,\n\t\t\t$activeItems     : [],\n\t\n\t\t\toptgroups        : {},\n\t\t\toptions          : {},\n\t\t\tuserOptions      : {},\n\t\t\titems            : [],\n\t\t\trenderCache      : {},\n\t\t\tonSearchChange   : settings.loadThrottle === null ? self.onSearchChange : debounce(self.onSearchChange, settings.loadThrottle)\n\t\t});\n\t\n\t\t// search system\n\t\tself.sifter = new Sifter(this.options, {diacritics: settings.diacritics});\n\t\n\t\t// build options table\n\t\tif (self.settings.options) {\n\t\t\tfor (i = 0, n = self.settings.options.length; i < n; i++) {\n\t\t\t\tself.registerOption(self.settings.options[i]);\n\t\t\t}\n\t\t\tdelete self.settings.options;\n\t\t}\n\t\n\t\t// build optgroup table\n\t\tif (self.settings.optgroups) {\n\t\t\tfor (i = 0, n = self.settings.optgroups.length; i < n; i++) {\n\t\t\t\tself.registerOptionGroup(self.settings.optgroups[i]);\n\t\t\t}\n\t\t\tdelete self.settings.optgroups;\n\t\t}\n\t\n\t\t// option-dependent defaults\n\t\tself.settings.mode = self.settings.mode || (self.settings.maxItems === 1 ? 'single' : 'multi');\n\t\tif (typeof self.settings.hideSelected !== 'boolean') {\n\t\t\tself.settings.hideSelected = self.settings.mode === 'multi';\n\t\t}\n\t\n\t\tself.initializePlugins(self.settings.plugins);\n\t\tself.setupCallbacks();\n\t\tself.setupTemplates();\n\t\tself.setup();\n\t};\n\t\n\t// mixins\n\t// - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\n\t\n\tMicroEvent.mixin(Selectize);\n\t\n\tif(typeof MicroPlugin !== \"undefined\"){\n\t\tMicroPlugin.mixin(Selectize);\n\t}else{\n\t\tlogError(\"Dependency MicroPlugin is missing\",\n\t\t\t{explanation:\n\t\t\t\t\"Make sure you either: (1) are using the \\\"standalone\\\" \"+\n\t\t\t\t\"version of Selectize, or (2) require MicroPlugin before you \"+\n\t\t\t\t\"load Selectize.\"}\n\t\t);\n\t}\n\t\n\t\n\t// methods\n\t// - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\n\t\n\t$.extend(Selectize.prototype, {\n\t\n\t\t/**\n\t\t * Creates all elements and sets up event bindings.\n\t\t */\n\t\tsetup: function() {\n\t\t\tvar self      = this;\n\t\t\tvar settings  = self.settings;\n\t\t\tvar eventNS   = self.eventNS;\n\t\t\tvar $window   = $(window);\n\t\t\tvar $document = $(document);\n\t\t\tvar $input    = self.$input;\n\t\n\t\t\tvar $wrapper;\n\t\t\tvar $control;\n\t\t\tvar $control_input;\n\t\t\tvar $dropdown;\n\t\t\tvar $dropdown_content;\n\t\t\tvar $dropdown_parent;\n\t\t\tvar inputMode;\n\t\t\tvar timeout_blur;\n\t\t\tvar timeout_focus;\n\t\t\tvar classes;\n\t\t\tvar classes_plugins;\n\t\t\tvar inputId;\n\t\n\t\t\tinputMode         = self.settings.mode;\n\t\t\tclasses           = $input.attr('class') || '';\n\t\n\t\t\t$wrapper          = $('<div>').addClass(settings.wrapperClass).addClass(classes).addClass(inputMode);\n\t\t\t$control          = $('<div>').addClass(settings.inputClass).addClass('items').appendTo($wrapper);\n\t\t\t$control_input    = $('<input type=\"text\" autocomplete=\"off\" />').appendTo($control).attr('tabindex', $input.is(':disabled') ? '-1' : self.tabIndex);\n\t\t\t$dropdown_parent  = $(settings.dropdownParent || $wrapper);\n\t\t\t$dropdown         = $('<div>').addClass(settings.dropdownClass).addClass(inputMode).hide().appendTo($dropdown_parent);\n\t\t\t$dropdown_content = $('<div>').addClass(settings.dropdownContentClass).appendTo($dropdown);\n\t\n\t\t\tif(inputId = $input.attr('id')) {\n\t\t\t\t$control_input.attr('id', inputId + '-selectized');\n\t\t\t\t$(\"label[for='\"+inputId+\"']\").attr('for', inputId + '-selectized');\n\t\t\t}\n\t\n\t\t\tif(self.settings.copyClassesToDropdown) {\n\t\t\t\t$dropdown.addClass(classes);\n\t\t\t}\n\t\n\t\t\t$wrapper.css({\n\t\t\t\twidth: $input[0].style.width\n\t\t\t});\n\t\n\t\t\tif (self.plugins.names.length) {\n\t\t\t\tclasses_plugins = 'plugin-' + self.plugins.names.join(' plugin-');\n\t\t\t\t$wrapper.addClass(classes_plugins);\n\t\t\t\t$dropdown.addClass(classes_plugins);\n\t\t\t}\n\t\n\t\t\tif ((settings.maxItems === null || settings.maxItems > 1) && self.tagType === TAG_SELECT) {\n\t\t\t\t$input.attr('multiple', 'multiple');\n\t\t\t}\n\t\n\t\t\tif (self.settings.placeholder) {\n\t\t\t\t$control_input.attr('placeholder', settings.placeholder);\n\t\t\t}\n\t\n\t\t\t// if splitOn was not passed in, construct it from the delimiter to allow pasting universally\n\t\t\tif (!self.settings.splitOn && self.settings.delimiter) {\n\t\t\t\tvar delimiterEscaped = self.settings.delimiter.replace(/[-\\/\\\\^$*+?.()|[\\]{}]/g, '\\\\$&');\n\t\t\t\tself.settings.splitOn = new RegExp('\\\\s*' + delimiterEscaped + '+\\\\s*');\n\t\t\t}\n\t\n\t\t\tif ($input.attr('autocorrect')) {\n\t\t\t\t$control_input.attr('autocorrect', $input.attr('autocorrect'));\n\t\t\t}\n\t\n\t\t\tif ($input.attr('autocapitalize')) {\n\t\t\t\t$control_input.attr('autocapitalize', $input.attr('autocapitalize'));\n\t\t\t}\n\t\t\t$control_input[0].type = $input[0].type;\n\t\n\t\t\tself.$wrapper          = $wrapper;\n\t\t\tself.$control          = $control;\n\t\t\tself.$control_input    = $control_input;\n\t\t\tself.$dropdown         = $dropdown;\n\t\t\tself.$dropdown_content = $dropdown_content;\n\t\n\t\t\t$dropdown.on('mouseenter mousedown click', '[data-disabled]>[data-selectable]', function(e) { e.stopImmediatePropagation(); });\n\t\t\t$dropdown.on('mouseenter', '[data-selectable]', function() { return self.onOptionHover.apply(self, arguments); });\n\t\t\t$dropdown.on('mousedown click', '[data-selectable]', function() { return self.onOptionSelect.apply(self, arguments); });\n\t\t\twatchChildEvent($control, 'mousedown', '*:not(input)', function() { return self.onItemSelect.apply(self, arguments); });\n\t\t\tautoGrow($control_input);\n\t\n\t\t\t$control.on({\n\t\t\t\tmousedown : function() { return self.onMouseDown.apply(self, arguments); },\n\t\t\t\tclick     : function() { return self.onClick.apply(self, arguments); }\n\t\t\t});\n\t\n\t\t\t$control_input.on({\n\t\t\t\tmousedown : function(e) { e.stopPropagation(); },\n\t\t\t\tkeydown   : function() { return self.onKeyDown.apply(self, arguments); },\n\t\t\t\tkeyup     : function() { return self.onKeyUp.apply(self, arguments); },\n\t\t\t\tkeypress  : function() { return self.onKeyPress.apply(self, arguments); },\n\t\t\t\tresize    : function() { self.positionDropdown.apply(self, []); },\n\t\t\t\tblur      : function() { return self.onBlur.apply(self, arguments); },\n\t\t\t\tfocus     : function() { self.ignoreBlur = false; return self.onFocus.apply(self, arguments); },\n\t\t\t\tpaste     : function() { return self.onPaste.apply(self, arguments); }\n\t\t\t});\n\t\n\t\t\t$document.on('keydown' + eventNS, function(e) {\n\t\t\t\tself.isCmdDown = e[IS_MAC ? 'metaKey' : 'ctrlKey'];\n\t\t\t\tself.isCtrlDown = e[IS_MAC ? 'altKey' : 'ctrlKey'];\n\t\t\t\tself.isShiftDown = e.shiftKey;\n\t\t\t});\n\t\n\t\t\t$document.on('keyup' + eventNS, function(e) {\n\t\t\t\tif (e.keyCode === KEY_CTRL) self.isCtrlDown = false;\n\t\t\t\tif (e.keyCode === KEY_SHIFT) self.isShiftDown = false;\n\t\t\t\tif (e.keyCode === KEY_CMD) self.isCmdDown = false;\n\t\t\t});\n\t\n\t\t\t$document.on('mousedown' + eventNS, function(e) {\n\t\t\t\tif (self.isFocused) {\n\t\t\t\t\t// prevent events on the dropdown scrollbar from causing the control to blur\n\t\t\t\t\tif (e.target === self.$dropdown[0] || e.target.parentNode === self.$dropdown[0]) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\t// blur on click outside\n\t\t\t\t\tif (!self.$control.has(e.target).length && e.target !== self.$control[0]) {\n\t\t\t\t\t\tself.blur(e.target);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\n\t\t\t$window.on(['scroll' + eventNS, 'resize' + eventNS].join(' '), function() {\n\t\t\t\tif (self.isOpen) {\n\t\t\t\t\tself.positionDropdown.apply(self, arguments);\n\t\t\t\t}\n\t\t\t});\n\t\t\t$window.on('mousemove' + eventNS, function() {\n\t\t\t\tself.ignoreHover = false;\n\t\t\t});\n\t\n\t\t\t// store original children and tab index so that they can be\n\t\t\t// restored when the destroy() method is called.\n\t\t\tthis.revertSettings = {\n\t\t\t\t$children : $input.children().detach(),\n\t\t\t\ttabindex  : $input.attr('tabindex')\n\t\t\t};\n\t\n\t\t\t$input.attr('tabindex', -1).hide().after(self.$wrapper);\n\t\n\t\t\tif ($.isArray(settings.items)) {\n\t\t\t\tself.setValue(settings.items);\n\t\t\t\tdelete settings.items;\n\t\t\t}\n\t\n\t\t\t// feature detect for the validation API\n\t\t\tif (SUPPORTS_VALIDITY_API) {\n\t\t\t\t$input.on('invalid' + eventNS, function(e) {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tself.isInvalid = true;\n\t\t\t\t\tself.refreshState();\n\t\t\t\t});\n\t\t\t}\n\t\n\t\t\tself.updateOriginalInput();\n\t\t\tself.refreshItems();\n\t\t\tself.refreshState();\n\t\t\tself.updatePlaceholder();\n\t\t\tself.isSetup = true;\n\t\n\t\t\tif ($input.is(':disabled')) {\n\t\t\t\tself.disable();\n\t\t\t}\n\t\n\t\t\tself.on('change', this.onChange);\n\t\n\t\t\t$input.data('selectize', self);\n\t\t\t$input.addClass('selectized');\n\t\t\tself.trigger('initialize');\n\t\n\t\t\t// preload options\n\t\t\tif (settings.preload === true) {\n\t\t\t\tself.onSearchChange('');\n\t\t\t}\n\t\n\t\t},\n\t\n\t\t/**\n\t\t * Sets up default rendering functions.\n\t\t */\n\t\tsetupTemplates: function() {\n\t\t\tvar self = this;\n\t\t\tvar field_label = self.settings.labelField;\n\t\t\tvar field_optgroup = self.settings.optgroupLabelField;\n\t\n\t\t\tvar templates = {\n\t\t\t\t'optgroup': function(data) {\n\t\t\t\t\treturn '<div class=\"optgroup\">' + data.html + '</div>';\n\t\t\t\t},\n\t\t\t\t'optgroup_header': function(data, escape) {\n\t\t\t\t\treturn '<div class=\"optgroup-header\">' + escape(data[field_optgroup]) + '</div>';\n\t\t\t\t},\n\t\t\t\t'option': function(data, escape) {\n\t\t\t\t\treturn '<div class=\"option\">' + escape(data[field_label]) + '</div>';\n\t\t\t\t},\n\t\t\t\t'item': function(data, escape) {\n\t\t\t\t\treturn '<div class=\"item\">' + escape(data[field_label]) + '</div>';\n\t\t\t\t},\n\t\t\t\t'option_create': function(data, escape) {\n\t\t\t\t\treturn '<div class=\"create\">Add <strong>' + escape(data.input) + '</strong>&hellip;</div>';\n\t\t\t\t}\n\t\t\t};\n\t\n\t\t\tself.settings.render = $.extend({}, templates, self.settings.render);\n\t\t},\n\t\n\t\t/**\n\t\t * Maps fired events to callbacks provided\n\t\t * in the settings used when creating the control.\n\t\t */\n\t\tsetupCallbacks: function() {\n\t\t\tvar key, fn, callbacks = {\n\t\t\t\t'initialize'      : 'onInitialize',\n\t\t\t\t'change'          : 'onChange',\n\t\t\t\t'item_add'        : 'onItemAdd',\n\t\t\t\t'item_remove'     : 'onItemRemove',\n\t\t\t\t'clear'           : 'onClear',\n\t\t\t\t'option_add'      : 'onOptionAdd',\n\t\t\t\t'option_remove'   : 'onOptionRemove',\n\t\t\t\t'option_clear'    : 'onOptionClear',\n\t\t\t\t'optgroup_add'    : 'onOptionGroupAdd',\n\t\t\t\t'optgroup_remove' : 'onOptionGroupRemove',\n\t\t\t\t'optgroup_clear'  : 'onOptionGroupClear',\n\t\t\t\t'dropdown_open'   : 'onDropdownOpen',\n\t\t\t\t'dropdown_close'  : 'onDropdownClose',\n\t\t\t\t'type'            : 'onType',\n\t\t\t\t'load'            : 'onLoad',\n\t\t\t\t'focus'           : 'onFocus',\n\t\t\t\t'blur'            : 'onBlur'\n\t\t\t};\n\t\n\t\t\tfor (key in callbacks) {\n\t\t\t\tif (callbacks.hasOwnProperty(key)) {\n\t\t\t\t\tfn = this.settings[callbacks[key]];\n\t\t\t\t\tif (fn) this.on(key, fn);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\n\t\t/**\n\t\t * Triggered when the main control element\n\t\t * has a click event.\n\t\t *\n\t\t * @param {object} e\n\t\t * @return {boolean}\n\t\t */\n\t\tonClick: function(e) {\n\t\t\tvar self = this;\n\t\n\t\t\t// necessary for mobile webkit devices (manual focus triggering\n\t\t\t// is ignored unless invoked within a click event)\n\t    // also necessary to reopen a dropdown that has been closed by\n\t    // closeAfterSelect\n\t\t\tif (!self.isFocused || !self.isOpen) {\n\t\t\t\tself.focus();\n\t\t\t\te.preventDefault();\n\t\t\t}\n\t\t},\n\t\n\t\t/**\n\t\t * Triggered when the main control element\n\t\t * has a mouse down event.\n\t\t *\n\t\t * @param {object} e\n\t\t * @return {boolean}\n\t\t */\n\t\tonMouseDown: function(e) {\n\t\t\tvar self = this;\n\t\t\tvar defaultPrevented = e.isDefaultPrevented();\n\t\t\tvar $target = $(e.target);\n\t\n\t\t\tif (self.isFocused) {\n\t\t\t\t// retain focus by preventing native handling. if the\n\t\t\t\t// event target is the input it should not be modified.\n\t\t\t\t// otherwise, text selection within the input won't work.\n\t\t\t\tif (e.target !== self.$control_input[0]) {\n\t\t\t\t\tif (self.settings.mode === 'single') {\n\t\t\t\t\t\t// toggle dropdown\n\t\t\t\t\t\tself.isOpen ? self.close() : self.open();\n\t\t\t\t\t} else if (!defaultPrevented) {\n\t\t\t\t\t\tself.setActiveItem(null);\n\t\t\t\t\t}\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// give control focus\n\t\t\t\tif (!defaultPrevented) {\n\t\t\t\t\twindow.setTimeout(function() {\n\t\t\t\t\t\tself.focus();\n\t\t\t\t\t}, 0);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\n\t\t/**\n\t\t * Triggered when the value of the control has been changed.\n\t\t * This should propagate the event to the original DOM\n\t\t * input / select element.\n\t\t */\n\t\tonChange: function() {\n\t\t\tthis.$input.trigger('change');\n\t\t},\n\t\n\t\t/**\n\t\t * Triggered on <input> paste.\n\t\t *\n\t\t * @param {object} e\n\t\t * @returns {boolean}\n\t\t */\n\t\tonPaste: function(e) {\n\t\t\tvar self = this;\n\t\n\t\t\tif (self.isFull() || self.isInputHidden || self.isLocked) {\n\t\t\t\te.preventDefault();\n\t\t\t\treturn;\n\t\t\t}\n\t\n\t\t\t// If a regex or string is included, this will split the pasted\n\t\t\t// input and create Items for each separate value\n\t\t\tif (self.settings.splitOn) {\n\t\n\t\t\t\t// Wait for pasted text to be recognized in value\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\tvar pastedText = self.$control_input.val();\n\t\t\t\t\tif(!pastedText.match(self.settings.splitOn)){ return }\n\t\n\t\t\t\t\tvar splitInput = $.trim(pastedText).split(self.settings.splitOn);\n\t\t\t\t\tfor (var i = 0, n = splitInput.length; i < n; i++) {\n\t\t\t\t\t\tself.createItem(splitInput[i]);\n\t\t\t\t\t}\n\t\t\t\t}, 0);\n\t\t\t}\n\t\t},\n\t\n\t\t/**\n\t\t * Triggered on <input> keypress.\n\t\t *\n\t\t * @param {object} e\n\t\t * @returns {boolean}\n\t\t */\n\t\tonKeyPress: function(e) {\n\t\t\tif (this.isLocked) return e && e.preventDefault();\n\t\t\tvar character = String.fromCharCode(e.keyCode || e.which);\n\t\t\tif (this.settings.create && this.settings.mode === 'multi' && character === this.settings.delimiter) {\n\t\t\t\tthis.createItem();\n\t\t\t\te.preventDefault();\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\t\n\t\t/**\n\t\t * Triggered on <input> keydown.\n\t\t *\n\t\t * @param {object} e\n\t\t * @returns {boolean}\n\t\t */\n\t\tonKeyDown: function(e) {\n\t\t\tvar isInput = e.target === this.$control_input[0];\n\t\t\tvar self = this;\n\t\n\t\t\tif (self.isLocked) {\n\t\t\t\tif (e.keyCode !== KEY_TAB) {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}\n\t\n\t\t\tswitch (e.keyCode) {\n\t\t\t\tcase KEY_A:\n\t\t\t\t\tif (self.isCmdDown) {\n\t\t\t\t\t\tself.selectAll();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase KEY_ESC:\n\t\t\t\t\tif (self.isOpen) {\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\tself.close();\n\t\t\t\t\t}\n\t\t\t\t\treturn;\n\t\t\t\tcase KEY_N:\n\t\t\t\t\tif (!e.ctrlKey || e.altKey) break;\n\t\t\t\tcase KEY_DOWN:\n\t\t\t\t\tif (!self.isOpen && self.hasOptions) {\n\t\t\t\t\t\tself.open();\n\t\t\t\t\t} else if (self.$activeOption) {\n\t\t\t\t\t\tself.ignoreHover = true;\n\t\t\t\t\t\tvar $next = self.getAdjacentOption(self.$activeOption, 1);\n\t\t\t\t\t\tif ($next.length) self.setActiveOption($next, true, true);\n\t\t\t\t\t}\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\treturn;\n\t\t\t\tcase KEY_P:\n\t\t\t\t\tif (!e.ctrlKey || e.altKey) break;\n\t\t\t\tcase KEY_UP:\n\t\t\t\t\tif (self.$activeOption) {\n\t\t\t\t\t\tself.ignoreHover = true;\n\t\t\t\t\t\tvar $prev = self.getAdjacentOption(self.$activeOption, -1);\n\t\t\t\t\t\tif ($prev.length) self.setActiveOption($prev, true, true);\n\t\t\t\t\t}\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\treturn;\n\t\t\t\tcase KEY_RETURN:\n\t\t\t\t\tif (self.isOpen && self.$activeOption) {\n\t\t\t\t\t\tself.onOptionSelect({currentTarget: self.$activeOption});\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t}\n\t\t\t\t\treturn;\n\t\t\t\tcase KEY_LEFT:\n\t\t\t\t\tself.advanceSelection(-1, e);\n\t\t\t\t\treturn;\n\t\t\t\tcase KEY_RIGHT:\n\t\t\t\t\tself.advanceSelection(1, e);\n\t\t\t\t\treturn;\n\t\t\t\tcase KEY_TAB:\n\t\t\t\t\tif (self.settings.selectOnTab && self.isOpen && self.$activeOption) {\n\t\t\t\t\t\tself.onOptionSelect({currentTarget: self.$activeOption});\n\t\n\t\t\t\t\t\t// Default behaviour is to jump to the next field, we only want this\n\t\t\t\t\t\t// if the current field doesn't accept any more entries\n\t\t\t\t\t\tif (!self.isFull()) {\n\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (self.settings.create && self.createItem()) {\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t}\n\t\t\t\t\treturn;\n\t\t\t\tcase KEY_BACKSPACE:\n\t\t\t\tcase KEY_DELETE:\n\t\t\t\t\tself.deleteSelection(e);\n\t\t\t\t\treturn;\n\t\t\t}\n\t\n\t\t\tif ((self.isFull() || self.isInputHidden) && !(IS_MAC ? e.metaKey : e.ctrlKey)) {\n\t\t\t\te.preventDefault();\n\t\t\t\treturn;\n\t\t\t}\n\t\t},\n\t\n\t\t/**\n\t\t * Triggered on <input> keyup.\n\t\t *\n\t\t * @param {object} e\n\t\t * @returns {boolean}\n\t\t */\n\t\tonKeyUp: function(e) {\n\t\t\tvar self = this;\n\t\n\t\t\tif (self.isLocked) return e && e.preventDefault();\n\t\t\tvar value = self.$control_input.val() || '';\n\t\t\tif (self.lastValue !== value) {\n\t\t\t\tself.lastValue = value;\n\t\t\t\tself.onSearchChange(value);\n\t\t\t\tself.refreshOptions();\n\t\t\t\tself.trigger('type', value);\n\t\t\t}\n\t\t},\n\t\n\t\t/**\n\t\t * Invokes the user-provide option provider / loader.\n\t\t *\n\t\t * Note: this function is debounced in the Selectize\n\t\t * constructor (by `settings.loadThrottle` milliseconds)\n\t\t *\n\t\t * @param {string} value\n\t\t */\n\t\tonSearchChange: function(value) {\n\t\t\tvar self = this;\n\t\t\tvar fn = self.settings.load;\n\t\t\tif (!fn) return;\n\t\t\tif (self.loadedSearches.hasOwnProperty(value)) return;\n\t\t\tself.loadedSearches[value] = true;\n\t\t\tself.load(function(callback) {\n\t\t\t\tfn.apply(self, [value, callback]);\n\t\t\t});\n\t\t},\n\t\n\t\t/**\n\t\t * Triggered on <input> focus.\n\t\t *\n\t\t * @param {object} e (optional)\n\t\t * @returns {boolean}\n\t\t */\n\t\tonFocus: function(e) {\n\t\t\tvar self = this;\n\t\t\tvar wasFocused = self.isFocused;\n\t\n\t\t\tif (self.isDisabled) {\n\t\t\t\tself.blur();\n\t\t\t\te && e.preventDefault();\n\t\t\t\treturn false;\n\t\t\t}\n\t\n\t\t\tif (self.ignoreFocus) return;\n\t\t\tself.isFocused = true;\n\t\t\tif (self.settings.preload === 'focus') self.onSearchChange('');\n\t\n\t\t\tif (!wasFocused) self.trigger('focus');\n\t\n\t\t\tif (!self.$activeItems.length) {\n\t\t\t\tself.showInput();\n\t\t\t\tself.setActiveItem(null);\n\t\t\t\tself.refreshOptions(!!self.settings.openOnFocus);\n\t\t\t}\n\t\n\t\t\tself.refreshState();\n\t\t},\n\t\n\t\t/**\n\t\t * Triggered on <input> blur.\n\t\t *\n\t\t * @param {object} e\n\t\t * @param {Element} dest\n\t\t */\n\t\tonBlur: function(e, dest) {\n\t\t\tvar self = this;\n\t\t\tif (!self.isFocused) return;\n\t\t\tself.isFocused = false;\n\t\n\t\t\tif (self.ignoreFocus) {\n\t\t\t\treturn;\n\t\t\t} else if (!self.ignoreBlur && document.activeElement === self.$dropdown_content[0]) {\n\t\t\t\t// necessary to prevent IE closing the dropdown when the scrollbar is clicked\n\t\t\t\tself.ignoreBlur = true;\n\t\t\t\tself.onFocus(e);\n\t\t\t\treturn;\n\t\t\t}\n\t\n\t\t\tvar deactivate = function() {\n\t\t\t\tself.close();\n\t\t\t\tself.setTextboxValue('');\n\t\t\t\tself.setActiveItem(null);\n\t\t\t\tself.setActiveOption(null);\n\t\t\t\tself.setCaret(self.items.length);\n\t\t\t\tself.refreshState();\n\t\n\t\t\t\t// IE11 bug: element still marked as active\n\t\t\t\tdest && dest.focus && dest.focus();\n\t\n\t\t\t\tself.isBlurring = false;\n\t\t\t\tself.ignoreFocus = false;\n\t\t\t\tself.trigger('blur');\n\t\t\t};\n\t\n\t\t\tself.isBlurring = true;\n\t\t\tself.ignoreFocus = true;\n\t\t\tif (self.settings.create && self.settings.createOnBlur) {\n\t\t\t\tself.createItem(null, false, deactivate);\n\t\t\t} else {\n\t\t\t\tdeactivate();\n\t\t\t}\n\t\t},\n\t\n\t\t/**\n\t\t * Triggered when the user rolls over\n\t\t * an option in the autocomplete dropdown menu.\n\t\t *\n\t\t * @param {object} e\n\t\t * @returns {boolean}\n\t\t */\n\t\tonOptionHover: function(e) {\n\t\t\tif (this.ignoreHover) return;\n\t\t\tthis.setActiveOption(e.currentTarget, false);\n\t\t},\n\t\n\t\t/**\n\t\t * Triggered when the user clicks on an option\n\t\t * in the autocomplete dropdown menu.\n\t\t *\n\t\t * @param {object} e\n\t\t * @returns {boolean}\n\t\t */\n\t\tonOptionSelect: function(e) {\n\t\t\tvar value, $target, $option, self = this;\n\t\n\t\t\tif (e.preventDefault) {\n\t\t\t\te.preventDefault();\n\t\t\t\te.stopPropagation();\n\t\t\t}\n\t\n\t\t\t$target = $(e.currentTarget);\n\t\t\tif ($target.hasClass('create')) {\n\t\t\t\tself.createItem(null, function() {\n\t\t\t\t\tif (self.settings.closeAfterSelect) {\n\t\t\t\t\t\tself.close();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tvalue = $target.attr('data-value');\n\t\t\t\tif (typeof value !== 'undefined') {\n\t\t\t\t\tself.lastQuery = null;\n\t\t\t\t\tself.setTextboxValue('');\n\t\t\t\t\tself.addItem(value);\n\t\t\t\t\tif (self.settings.closeAfterSelect) {\n\t\t\t\t\t\tself.close();\n\t\t\t\t\t} else if (!self.settings.hideSelected && e.type && /mouse/.test(e.type)) {\n\t\t\t\t\t\tself.setActiveOption(self.getOption(value));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\n\t\t/**\n\t\t * Triggered when the user clicks on an item\n\t\t * that has been selected.\n\t\t *\n\t\t * @param {object} e\n\t\t * @returns {boolean}\n\t\t */\n\t\tonItemSelect: function(e) {\n\t\t\tvar self = this;\n\t\n\t\t\tif (self.isLocked) return;\n\t\t\tif (self.settings.mode === 'multi') {\n\t\t\t\te.preventDefault();\n\t\t\t\tself.setActiveItem(e.currentTarget, e);\n\t\t\t}\n\t\t},\n\t\n\t\t/**\n\t\t * Invokes the provided method that provides\n\t\t * results to a callback---which are then added\n\t\t * as options to the control.\n\t\t *\n\t\t * @param {function} fn\n\t\t */\n\t\tload: function(fn) {\n\t\t\tvar self = this;\n\t\t\tvar $wrapper = self.$wrapper.addClass(self.settings.loadingClass);\n\t\n\t\t\tself.loading++;\n\t\t\tfn.apply(self, [function(results) {\n\t\t\t\tself.loading = Math.max(self.loading - 1, 0);\n\t\t\t\tif (results && results.length) {\n\t\t\t\t\tself.addOption(results);\n\t\t\t\t\tself.refreshOptions(self.isFocused && !self.isInputHidden);\n\t\t\t\t}\n\t\t\t\tif (!self.loading) {\n\t\t\t\t\t$wrapper.removeClass(self.settings.loadingClass);\n\t\t\t\t}\n\t\t\t\tself.trigger('load', results);\n\t\t\t}]);\n\t\t},\n\t\n\t\t/**\n\t\t * Sets the input field of the control to the specified value.\n\t\t *\n\t\t * @param {string} value\n\t\t */\n\t\tsetTextboxValue: function(value) {\n\t\t\tvar $input = this.$control_input;\n\t\t\tvar changed = $input.val() !== value;\n\t\t\tif (changed) {\n\t\t\t\t$input.val(value).triggerHandler('update');\n\t\t\t\tthis.lastValue = value;\n\t\t\t}\n\t\t},\n\t\n\t\t/**\n\t\t * Returns the value of the control. If multiple items\n\t\t * can be selected (e.g. <select multiple>), this returns\n\t\t * an array. If only one item can be selected, this\n\t\t * returns a string.\n\t\t *\n\t\t * @returns {mixed}\n\t\t */\n\t\tgetValue: function() {\n\t\t\tif (this.tagType === TAG_SELECT && this.$input.attr('multiple')) {\n\t\t\t\treturn this.items;\n\t\t\t} else {\n\t\t\t\treturn this.items.join(this.settings.delimiter);\n\t\t\t}\n\t\t},\n\t\n\t\t/**\n\t\t * Resets the selected items to the given value.\n\t\t *\n\t\t * @param {mixed} value\n\t\t */\n\t\tsetValue: function(value, silent) {\n\t\t\tvar events = silent ? [] : ['change'];\n\t\n\t\t\tdebounce_events(this, events, function() {\n\t\t\t\tthis.clear(silent);\n\t\t\t\tthis.addItems(value, silent);\n\t\t\t});\n\t\t},\n\t\n\t\t/**\n\t\t * Sets the selected item.\n\t\t *\n\t\t * @param {object} $item\n\t\t * @param {object} e (optional)\n\t\t */\n\t\tsetActiveItem: function($item, e) {\n\t\t\tvar self = this;\n\t\t\tvar eventName;\n\t\t\tvar i, idx, begin, end, item, swap;\n\t\t\tvar $last;\n\t\n\t\t\tif (self.settings.mode === 'single') return;\n\t\t\t$item = $($item);\n\t\n\t\t\t// clear the active selection\n\t\t\tif (!$item.length) {\n\t\t\t\t$(self.$activeItems).removeClass('active');\n\t\t\t\tself.$activeItems = [];\n\t\t\t\tif (self.isFocused) {\n\t\t\t\t\tself.showInput();\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}\n\t\n\t\t\t// modify selection\n\t\t\teventName = e && e.type.toLowerCase();\n\t\n\t\t\tif (eventName === 'mousedown' && self.isShiftDown && self.$activeItems.length) {\n\t\t\t\t$last = self.$control.children('.active:last');\n\t\t\t\tbegin = Array.prototype.indexOf.apply(self.$control[0].childNodes, [$last[0]]);\n\t\t\t\tend   = Array.prototype.indexOf.apply(self.$control[0].childNodes, [$item[0]]);\n\t\t\t\tif (begin > end) {\n\t\t\t\t\tswap  = begin;\n\t\t\t\t\tbegin = end;\n\t\t\t\t\tend   = swap;\n\t\t\t\t}\n\t\t\t\tfor (i = begin; i <= end; i++) {\n\t\t\t\t\titem = self.$control[0].childNodes[i];\n\t\t\t\t\tif (self.$activeItems.indexOf(item) === -1) {\n\t\t\t\t\t\t$(item).addClass('active');\n\t\t\t\t\t\tself.$activeItems.push(item);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\te.preventDefault();\n\t\t\t} else if ((eventName === 'mousedown' && self.isCtrlDown) || (eventName === 'keydown' && this.isShiftDown)) {\n\t\t\t\tif ($item.hasClass('active')) {\n\t\t\t\t\tidx = self.$activeItems.indexOf($item[0]);\n\t\t\t\t\tself.$activeItems.splice(idx, 1);\n\t\t\t\t\t$item.removeClass('active');\n\t\t\t\t} else {\n\t\t\t\t\tself.$activeItems.push($item.addClass('active')[0]);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t$(self.$activeItems).removeClass('active');\n\t\t\t\tself.$activeItems = [$item.addClass('active')[0]];\n\t\t\t}\n\t\n\t\t\t// ensure control has focus\n\t\t\tself.hideInput();\n\t\t\tif (!this.isFocused) {\n\t\t\t\tself.focus();\n\t\t\t}\n\t\t},\n\t\n\t\t/**\n\t\t * Sets the selected item in the dropdown menu\n\t\t * of available options.\n\t\t *\n\t\t * @param {object} $object\n\t\t * @param {boolean} scroll\n\t\t * @param {boolean} animate\n\t\t */\n\t\tsetActiveOption: function($option, scroll, animate) {\n\t\t\tvar height_menu, height_item, y;\n\t\t\tvar scroll_top, scroll_bottom;\n\t\t\tvar self = this;\n\t\n\t\t\tif (self.$activeOption) self.$activeOption.removeClass('active');\n\t\t\tself.$activeOption = null;\n\t\n\t\t\t$option = $($option);\n\t\t\tif (!$option.length) return;\n\t\n\t\t\tself.$activeOption = $option.addClass('active');\n\t\n\t\t\tif (scroll || !isset(scroll)) {\n\t\n\t\t\t\theight_menu   = self.$dropdown_content.height();\n\t\t\t\theight_item   = self.$activeOption.outerHeight(true);\n\t\t\t\tscroll        = self.$dropdown_content.scrollTop() || 0;\n\t\t\t\ty             = self.$activeOption.offset().top - self.$dropdown_content.offset().top + scroll;\n\t\t\t\tscroll_top    = y;\n\t\t\t\tscroll_bottom = y - height_menu + height_item;\n\t\n\t\t\t\tif (y + height_item > height_menu + scroll) {\n\t\t\t\t\tself.$dropdown_content.stop().animate({scrollTop: scroll_bottom}, animate ? self.settings.scrollDuration : 0);\n\t\t\t\t} else if (y < scroll) {\n\t\t\t\t\tself.$dropdown_content.stop().animate({scrollTop: scroll_top}, animate ? self.settings.scrollDuration : 0);\n\t\t\t\t}\n\t\n\t\t\t}\n\t\t},\n\t\n\t\t/**\n\t\t * Selects all items (CTRL + A).\n\t\t */\n\t\tselectAll: function() {\n\t\t\tvar self = this;\n\t\t\tif (self.settings.mode === 'single') return;\n\t\n\t\t\tself.$activeItems = Array.prototype.slice.apply(self.$control.children(':not(input)').addClass('active'));\n\t\t\tif (self.$activeItems.length) {\n\t\t\t\tself.hideInput();\n\t\t\t\tself.close();\n\t\t\t}\n\t\t\tself.focus();\n\t\t},\n\t\n\t\t/**\n\t\t * Hides the input element out of view, while\n\t\t * retaining its focus.\n\t\t */\n\t\thideInput: function() {\n\t\t\tvar self = this;\n\t\n\t\t\tself.setTextboxValue('');\n\t\t\tself.$control_input.css({opacity: 0, position: 'absolute', left: self.rtl ? 10000 : -10000});\n\t\t\tself.isInputHidden = true;\n\t\t},\n\t\n\t\t/**\n\t\t * Restores input visibility.\n\t\t */\n\t\tshowInput: function() {\n\t\t\tthis.$control_input.css({opacity: 1, position: 'relative', left: 0});\n\t\t\tthis.isInputHidden = false;\n\t\t},\n\t\n\t\t/**\n\t\t * Gives the control focus.\n\t\t */\n\t\tfocus: function() {\n\t\t\tvar self = this;\n\t\t\tif (self.isDisabled) return;\n\t\n\t\t\tself.ignoreFocus = true;\n\t\t\tself.$control_input[0].focus();\n\t\t\twindow.setTimeout(function() {\n\t\t\t\tself.ignoreFocus = false;\n\t\t\t\tself.onFocus();\n\t\t\t}, 0);\n\t\t},\n\t\n\t\t/**\n\t\t * Forces the control out of focus.\n\t\t *\n\t\t * @param {Element} dest\n\t\t */\n\t\tblur: function(dest) {\n\t\t\tthis.$control_input[0].blur();\n\t\t\tthis.onBlur(null, dest);\n\t\t},\n\t\n\t\t/**\n\t\t * Returns a function that scores an object\n\t\t * to show how good of a match it is to the\n\t\t * provided query.\n\t\t *\n\t\t * @param {string} query\n\t\t * @param {object} options\n\t\t * @return {function}\n\t\t */\n\t\tgetScoreFunction: function(query) {\n\t\t\treturn this.sifter.getScoreFunction(query, this.getSearchOptions());\n\t\t},\n\t\n\t\t/**\n\t\t * Returns search options for sifter (the system\n\t\t * for scoring and sorting results).\n\t\t *\n\t\t * @see https://github.com/brianreavis/sifter.js\n\t\t * @return {object}\n\t\t */\n\t\tgetSearchOptions: function() {\n\t\t\tvar settings = this.settings;\n\t\t\tvar sort = settings.sortField;\n\t\t\tif (typeof sort === 'string') {\n\t\t\t\tsort = [{field: sort}];\n\t\t\t}\n\t\n\t\t\treturn {\n\t\t\t\tfields      : settings.searchField,\n\t\t\t\tconjunction : settings.searchConjunction,\n\t\t\t\tsort        : sort,\n\t\t\t\tnesting     : settings.nesting\n\t\t\t};\n\t\t},\n\t\n\t\t/**\n\t\t * Searches through available options and returns\n\t\t * a sorted array of matches.\n\t\t *\n\t\t * Returns an object containing:\n\t\t *\n\t\t *   - query {string}\n\t\t *   - tokens {array}\n\t\t *   - total {int}\n\t\t *   - items {array}\n\t\t *\n\t\t * @param {string} query\n\t\t * @returns {object}\n\t\t */\n\t\tsearch: function(query) {\n\t\t\tvar i, value, score, result, calculateScore;\n\t\t\tvar self     = this;\n\t\t\tvar settings = self.settings;\n\t\t\tvar options  = this.getSearchOptions();\n\t\n\t\t\t// validate user-provided result scoring function\n\t\t\tif (settings.score) {\n\t\t\t\tcalculateScore = self.settings.score.apply(this, [query]);\n\t\t\t\tif (typeof calculateScore !== 'function') {\n\t\t\t\t\tthrow new Error('Selectize \"score\" setting must be a function that returns a function');\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\t// perform search\n\t\t\tif (query !== self.lastQuery) {\n\t\t\t\tself.lastQuery = query;\n\t\t\t\tresult = self.sifter.search(query, $.extend(options, {score: calculateScore}));\n\t\t\t\tself.currentResults = result;\n\t\t\t} else {\n\t\t\t\tresult = $.extend(true, {}, self.currentResults);\n\t\t\t}\n\t\n\t\t\t// filter out selected items\n\t\t\tif (settings.hideSelected) {\n\t\t\t\tfor (i = result.items.length - 1; i >= 0; i--) {\n\t\t\t\t\tif (self.items.indexOf(hash_key(result.items[i].id)) !== -1) {\n\t\t\t\t\t\tresult.items.splice(i, 1);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\treturn result;\n\t\t},\n\t\n\t\t/**\n\t\t * Refreshes the list of available options shown\n\t\t * in the autocomplete dropdown menu.\n\t\t *\n\t\t * @param {boolean} triggerDropdown\n\t\t */\n\t\trefreshOptions: function(triggerDropdown) {\n\t\t\tvar i, j, k, n, groups, groups_order, option, option_html, optgroup, optgroups, html, html_children, has_create_option;\n\t\t\tvar $active, $active_before, $create;\n\t\n\t\t\tif (typeof triggerDropdown === 'undefined') {\n\t\t\t\ttriggerDropdown = true;\n\t\t\t}\n\t\n\t\t\tvar self              = this;\n\t\t\tvar query             = $.trim(self.$control_input.val());\n\t\t\tvar results           = self.search(query);\n\t\t\tvar $dropdown_content = self.$dropdown_content;\n\t\t\tvar active_before     = self.$activeOption && hash_key(self.$activeOption.attr('data-value'));\n\t\n\t\t\t// build markup\n\t\t\tn = results.items.length;\n\t\t\tif (typeof self.settings.maxOptions === 'number') {\n\t\t\t\tn = Math.min(n, self.settings.maxOptions);\n\t\t\t}\n\t\n\t\t\t// render and group available options individually\n\t\t\tgroups = {};\n\t\t\tgroups_order = [];\n\t\n\t\t\tfor (i = 0; i < n; i++) {\n\t\t\t\toption      = self.options[results.items[i].id];\n\t\t\t\toption_html = self.render('option', option);\n\t\t\t\toptgroup    = option[self.settings.optgroupField] || '';\n\t\t\t\toptgroups   = $.isArray(optgroup) ? optgroup : [optgroup];\n\t\n\t\t\t\tfor (j = 0, k = optgroups && optgroups.length; j < k; j++) {\n\t\t\t\t\toptgroup = optgroups[j];\n\t\t\t\t\tif (!self.optgroups.hasOwnProperty(optgroup)) {\n\t\t\t\t\t\toptgroup = '';\n\t\t\t\t\t}\n\t\t\t\t\tif (!groups.hasOwnProperty(optgroup)) {\n\t\t\t\t\t\tgroups[optgroup] = document.createDocumentFragment();\n\t\t\t\t\t\tgroups_order.push(optgroup);\n\t\t\t\t\t}\n\t\t\t\t\tgroups[optgroup].appendChild(option_html);\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\t// sort optgroups\n\t\t\tif (this.settings.lockOptgroupOrder) {\n\t\t\t\tgroups_order.sort(function(a, b) {\n\t\t\t\t\tvar a_order = self.optgroups[a].$order || 0;\n\t\t\t\t\tvar b_order = self.optgroups[b].$order || 0;\n\t\t\t\t\treturn a_order - b_order;\n\t\t\t\t});\n\t\t\t}\n\t\n\t\t\t// render optgroup headers & join groups\n\t\t\thtml = document.createDocumentFragment();\n\t\t\tfor (i = 0, n = groups_order.length; i < n; i++) {\n\t\t\t\toptgroup = groups_order[i];\n\t\t\t\tif (self.optgroups.hasOwnProperty(optgroup) && groups[optgroup].childNodes.length) {\n\t\t\t\t\t// render the optgroup header and options within it,\n\t\t\t\t\t// then pass it to the wrapper template\n\t\t\t\t\thtml_children = document.createDocumentFragment();\n\t\t\t\t\thtml_children.appendChild(self.render('optgroup_header', self.optgroups[optgroup]));\n\t\t\t\t\thtml_children.appendChild(groups[optgroup]);\n\t\n\t\t\t\t\thtml.appendChild(self.render('optgroup', $.extend({}, self.optgroups[optgroup], {\n\t\t\t\t\t\thtml: domToString(html_children),\n\t\t\t\t\t\tdom:  html_children\n\t\t\t\t\t})));\n\t\t\t\t} else {\n\t\t\t\t\thtml.appendChild(groups[optgroup]);\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\t$dropdown_content.html(html);\n\t\n\t\t\t// highlight matching terms inline\n\t\t\tif (self.settings.highlight) {\n\t\t\t\t$dropdown_content.removeHighlight();\n\t\t\t\tif (results.query.length && results.tokens.length) {\n\t\t\t\t\tfor (i = 0, n = results.tokens.length; i < n; i++) {\n\t\t\t\t\t\thighlight($dropdown_content, results.tokens[i].regex);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\t// add \"selected\" class to selected options\n\t\t\tif (!self.settings.hideSelected) {\n\t\t\t\tfor (i = 0, n = self.items.length; i < n; i++) {\n\t\t\t\t\tself.getOption(self.items[i]).addClass('selected');\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\t// add create option\n\t\t\thas_create_option = self.canCreate(query);\n\t\t\tif (has_create_option) {\n\t\t\t\t$dropdown_content.prepend(self.render('option_create', {input: query}));\n\t\t\t\t$create = $($dropdown_content[0].childNodes[0]);\n\t\t\t}\n\t\n\t\t\t// activate\n\t\t\tself.hasOptions = results.items.length > 0 || has_create_option;\n\t\t\tif (self.hasOptions) {\n\t\t\t\tif (results.items.length > 0) {\n\t\t\t\t\t$active_before = active_before && self.getOption(active_before);\n\t\t\t\t\tif ($active_before && $active_before.length) {\n\t\t\t\t\t\t$active = $active_before;\n\t\t\t\t\t} else if (self.settings.mode === 'single' && self.items.length) {\n\t\t\t\t\t\t$active = self.getOption(self.items[0]);\n\t\t\t\t\t}\n\t\t\t\t\tif (!$active || !$active.length) {\n\t\t\t\t\t\tif ($create && !self.settings.addPrecedence) {\n\t\t\t\t\t\t\t$active = self.getAdjacentOption($create, 1);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t$active = $dropdown_content.find('[data-selectable]:first');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t$active = $create;\n\t\t\t\t}\n\t\t\t\tself.setActiveOption($active);\n\t\t\t\tif (triggerDropdown && !self.isOpen) { self.open(); }\n\t\t\t} else {\n\t\t\t\tself.setActiveOption(null);\n\t\t\t\tif (triggerDropdown && self.isOpen) { self.close(); }\n\t\t\t}\n\t\t},\n\t\n\t\t/**\n\t\t * Adds an available option. If it already exists,\n\t\t * nothing will happen. Note: this does not refresh\n\t\t * the options list dropdown (use `refreshOptions`\n\t\t * for that).\n\t\t *\n\t\t * Usage:\n\t\t *\n\t\t *   this.addOption(data)\n\t\t *\n\t\t * @param {object|array} data\n\t\t */\n\t\taddOption: function(data) {\n\t\t\tvar i, n, value, self = this;\n\t\n\t\t\tif ($.isArray(data)) {\n\t\t\t\tfor (i = 0, n = data.length; i < n; i++) {\n\t\t\t\t\tself.addOption(data[i]);\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}\n\t\n\t\t\tif (value = self.registerOption(data)) {\n\t\t\t\tself.userOptions[value] = true;\n\t\t\t\tself.lastQuery = null;\n\t\t\t\tself.trigger('option_add', value, data);\n\t\t\t}\n\t\t},\n\t\n\t\t/**\n\t\t * Registers an option to the pool of options.\n\t\t *\n\t\t * @param {object} data\n\t\t * @return {boolean|string}\n\t\t */\n\t\tregisterOption: function(data) {\n\t\t\tvar key = hash_key(data[this.settings.valueField]);\n\t\t\tif (typeof key === 'undefined' || key === null || this.options.hasOwnProperty(key)) return false;\n\t\t\tdata.$order = data.$order || ++this.order;\n\t\t\tthis.options[key] = data;\n\t\t\treturn key;\n\t\t},\n\t\n\t\t/**\n\t\t * Registers an option group to the pool of option groups.\n\t\t *\n\t\t * @param {object} data\n\t\t * @return {boolean|string}\n\t\t */\n\t\tregisterOptionGroup: function(data) {\n\t\t\tvar key = hash_key(data[this.settings.optgroupValueField]);\n\t\t\tif (!key) return false;\n\t\n\t\t\tdata.$order = data.$order || ++this.order;\n\t\t\tthis.optgroups[key] = data;\n\t\t\treturn key;\n\t\t},\n\t\n\t\t/**\n\t\t * Registers a new optgroup for options\n\t\t * to be bucketed into.\n\t\t *\n\t\t * @param {string} id\n\t\t * @param {object} data\n\t\t */\n\t\taddOptionGroup: function(id, data) {\n\t\t\tdata[this.settings.optgroupValueField] = id;\n\t\t\tif (id = this.registerOptionGroup(data)) {\n\t\t\t\tthis.trigger('optgroup_add', id, data);\n\t\t\t}\n\t\t},\n\t\n\t\t/**\n\t\t * Removes an existing option group.\n\t\t *\n\t\t * @param {string} id\n\t\t */\n\t\tremoveOptionGroup: function(id) {\n\t\t\tif (this.optgroups.hasOwnProperty(id)) {\n\t\t\t\tdelete this.optgroups[id];\n\t\t\t\tthis.renderCache = {};\n\t\t\t\tthis.trigger('optgroup_remove', id);\n\t\t\t}\n\t\t},\n\t\n\t\t/**\n\t\t * Clears all existing option groups.\n\t\t */\n\t\tclearOptionGroups: function() {\n\t\t\tthis.optgroups = {};\n\t\t\tthis.renderCache = {};\n\t\t\tthis.trigger('optgroup_clear');\n\t\t},\n\t\n\t\t/**\n\t\t * Updates an option available for selection. If\n\t\t * it is visible in the selected items or options\n\t\t * dropdown, it will be re-rendered automatically.\n\t\t *\n\t\t * @param {string} value\n\t\t * @param {object} data\n\t\t */\n\t\tupdateOption: function(value, data) {\n\t\t\tvar self = this;\n\t\t\tvar $item, $item_new;\n\t\t\tvar value_new, index_item, cache_items, cache_options, order_old;\n\t\n\t\t\tvalue     = hash_key(value);\n\t\t\tvalue_new = hash_key(data[self.settings.valueField]);\n\t\n\t\t\t// sanity checks\n\t\t\tif (value === null) return;\n\t\t\tif (!self.options.hasOwnProperty(value)) return;\n\t\t\tif (typeof value_new !== 'string') throw new Error('Value must be set in option data');\n\t\n\t\t\torder_old = self.options[value].$order;\n\t\n\t\t\t// update references\n\t\t\tif (value_new !== value) {\n\t\t\t\tdelete self.options[value];\n\t\t\t\tindex_item = self.items.indexOf(value);\n\t\t\t\tif (index_item !== -1) {\n\t\t\t\t\tself.items.splice(index_item, 1, value_new);\n\t\t\t\t}\n\t\t\t}\n\t\t\tdata.$order = data.$order || order_old;\n\t\t\tself.options[value_new] = data;\n\t\n\t\t\t// invalidate render cache\n\t\t\tcache_items = self.renderCache['item'];\n\t\t\tcache_options = self.renderCache['option'];\n\t\n\t\t\tif (cache_items) {\n\t\t\t\tdelete cache_items[value];\n\t\t\t\tdelete cache_items[value_new];\n\t\t\t}\n\t\t\tif (cache_options) {\n\t\t\t\tdelete cache_options[value];\n\t\t\t\tdelete cache_options[value_new];\n\t\t\t}\n\t\n\t\t\t// update the item if it's selected\n\t\t\tif (self.items.indexOf(value_new) !== -1) {\n\t\t\t\t$item = self.getItem(value);\n\t\t\t\t$item_new = $(self.render('item', data));\n\t\t\t\tif ($item.hasClass('active')) $item_new.addClass('active');\n\t\t\t\t$item.replaceWith($item_new);\n\t\t\t}\n\t\n\t\t\t// invalidate last query because we might have updated the sortField\n\t\t\tself.lastQuery = null;\n\t\n\t\t\t// update dropdown contents\n\t\t\tif (self.isOpen) {\n\t\t\t\tself.refreshOptions(false);\n\t\t\t}\n\t\t},\n\t\n\t\t/**\n\t\t * Removes a single option.\n\t\t *\n\t\t * @param {string} value\n\t\t * @param {boolean} silent\n\t\t */\n\t\tremoveOption: function(value, silent) {\n\t\t\tvar self = this;\n\t\t\tvalue = hash_key(value);\n\t\n\t\t\tvar cache_items = self.renderCache['item'];\n\t\t\tvar cache_options = self.renderCache['option'];\n\t\t\tif (cache_items) delete cache_items[value];\n\t\t\tif (cache_options) delete cache_options[value];\n\t\n\t\t\tdelete self.userOptions[value];\n\t\t\tdelete self.options[value];\n\t\t\tself.lastQuery = null;\n\t\t\tself.trigger('option_remove', value);\n\t\t\tself.removeItem(value, silent);\n\t\t},\n\t\n\t\t/**\n\t\t * Clears all options.\n\t\t */\n\t\tclearOptions: function() {\n\t\t\tvar self = this;\n\t\n\t\t\tself.loadedSearches = {};\n\t\t\tself.userOptions = {};\n\t\t\tself.renderCache = {};\n\t\t\tvar options = self.options;\n\t\t\t$.each(self.options, function(key, value) {\n\t\t\t\tif(self.items.indexOf(key) == -1) {\n\t\t\t\t\tdelete options[key];\n\t\t\t\t}\n\t\t\t});\n\t\t\tself.options = self.sifter.items = options;\n\t\t\tself.lastQuery = null;\n\t\t\tself.trigger('option_clear');\n\t\t},\n\t\n\t\t/**\n\t\t * Returns the jQuery element of the option\n\t\t * matching the given value.\n\t\t *\n\t\t * @param {string} value\n\t\t * @returns {object}\n\t\t */\n\t\tgetOption: function(value) {\n\t\t\treturn this.getElementWithValue(value, this.$dropdown_content.find('[data-selectable]'));\n\t\t},\n\t\n\t\t/**\n\t\t * Returns the jQuery element of the next or\n\t\t * previous selectable option.\n\t\t *\n\t\t * @param {object} $option\n\t\t * @param {int} direction  can be 1 for next or -1 for previous\n\t\t * @return {object}\n\t\t */\n\t\tgetAdjacentOption: function($option, direction) {\n\t\t\tvar $options = this.$dropdown.find('[data-selectable]');\n\t\t\tvar index    = $options.index($option) + direction;\n\t\n\t\t\treturn index >= 0 && index < $options.length ? $options.eq(index) : $();\n\t\t},\n\t\n\t\t/**\n\t\t * Finds the first element with a \"data-value\" attribute\n\t\t * that matches the given value.\n\t\t *\n\t\t * @param {mixed} value\n\t\t * @param {object} $els\n\t\t * @return {object}\n\t\t */\n\t\tgetElementWithValue: function(value, $els) {\n\t\t\tvalue = hash_key(value);\n\t\n\t\t\tif (typeof value !== 'undefined' && value !== null) {\n\t\t\t\tfor (var i = 0, n = $els.length; i < n; i++) {\n\t\t\t\t\tif ($els[i].getAttribute('data-value') === value) {\n\t\t\t\t\t\treturn $($els[i]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\treturn $();\n\t\t},\n\t\n\t\t/**\n\t\t * Returns the jQuery element of the item\n\t\t * matching the given value.\n\t\t *\n\t\t * @param {string} value\n\t\t * @returns {object}\n\t\t */\n\t\tgetItem: function(value) {\n\t\t\treturn this.getElementWithValue(value, this.$control.children());\n\t\t},\n\t\n\t\t/**\n\t\t * \"Selects\" multiple items at once. Adds them to the list\n\t\t * at the current caret position.\n\t\t *\n\t\t * @param {string} value\n\t\t * @param {boolean} silent\n\t\t */\n\t\taddItems: function(values, silent) {\n\t\t\tthis.buffer = document.createDocumentFragment();\n\t\n\t\t\tvar childNodes = this.$control[0].childNodes;\n\t\t\tfor (var i = 0; i < childNodes.length; i++) {\n\t\t\t\tthis.buffer.appendChild(childNodes[i]);\n\t\t\t}\n\t\n\t\t\tvar items = $.isArray(values) ? values : [values];\n\t\t\tfor (var i = 0, n = items.length; i < n; i++) {\n\t\t\t\tthis.isPending = (i < n - 1);\n\t\t\t\tthis.addItem(items[i], silent);\n\t\t\t}\n\t\n\t\t\tvar control = this.$control[0];\n\t\t\tcontrol.insertBefore(this.buffer, control.firstChild);\n\t\n\t\t\tthis.buffer = null;\n\t\t},\n\t\n\t\t/**\n\t\t * \"Selects\" an item. Adds it to the list\n\t\t * at the current caret position.\n\t\t *\n\t\t * @param {string} value\n\t\t * @param {boolean} silent\n\t\t */\n\t\taddItem: function(value, silent) {\n\t\t\tvar events = silent ? [] : ['change'];\n\t\n\t\t\tdebounce_events(this, events, function() {\n\t\t\t\tvar $item, $option, $options;\n\t\t\t\tvar self = this;\n\t\t\t\tvar inputMode = self.settings.mode;\n\t\t\t\tvar i, active, value_next, wasFull;\n\t\t\t\tvalue = hash_key(value);\n\t\n\t\t\t\tif (self.items.indexOf(value) !== -1) {\n\t\t\t\t\tif (inputMode === 'single') self.close();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\n\t\t\t\tif (!self.options.hasOwnProperty(value)) return;\n\t\t\t\tif (inputMode === 'single') self.clear(silent);\n\t\t\t\tif (inputMode === 'multi' && self.isFull()) return;\n\t\n\t\t\t\t$item = $(self.render('item', self.options[value]));\n\t\t\t\twasFull = self.isFull();\n\t\t\t\tself.items.splice(self.caretPos, 0, value);\n\t\t\t\tself.insertAtCaret($item);\n\t\t\t\tif (!self.isPending || (!wasFull && self.isFull())) {\n\t\t\t\t\tself.refreshState();\n\t\t\t\t}\n\t\n\t\t\t\tif (self.isSetup) {\n\t\t\t\t\t$options = self.$dropdown_content.find('[data-selectable]');\n\t\n\t\t\t\t\t// update menu / remove the option (if this is not one item being added as part of series)\n\t\t\t\t\tif (!self.isPending) {\n\t\t\t\t\t\t$option = self.getOption(value);\n\t\t\t\t\t\tvalue_next = self.getAdjacentOption($option, 1).attr('data-value');\n\t\t\t\t\t\tself.refreshOptions(self.isFocused && inputMode !== 'single');\n\t\t\t\t\t\tif (value_next) {\n\t\t\t\t\t\t\tself.setActiveOption(self.getOption(value_next));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\n\t\t\t\t\t// hide the menu if the maximum number of items have been selected or no options are left\n\t\t\t\t\tif (!$options.length || self.isFull()) {\n\t\t\t\t\t\tself.close();\n\t\t\t\t\t} else if (!self.isPending) {\n\t\t\t\t\t\tself.positionDropdown();\n\t\t\t\t\t}\n\t\n\t\t\t\t\tself.updatePlaceholder();\n\t\t\t\t\tself.trigger('item_add', value, $item);\n\t\n\t\t\t\t\tif (!self.isPending) {\n\t\t\t\t\t\tself.updateOriginalInput({silent: silent});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\n\t\t/**\n\t\t * Removes the selected item matching\n\t\t * the provided value.\n\t\t *\n\t\t * @param {string} value\n\t\t */\n\t\tremoveItem: function(value, silent) {\n\t\t\tvar self = this;\n\t\t\tvar $item, i, idx;\n\t\n\t\t\t$item = (value instanceof $) ? value : self.getItem(value);\n\t\t\tvalue = hash_key($item.attr('data-value'));\n\t\t\ti = self.items.indexOf(value);\n\t\n\t\t\tif (i !== -1) {\n\t\t\t\t$item.remove();\n\t\t\t\tif ($item.hasClass('active')) {\n\t\t\t\t\tidx = self.$activeItems.indexOf($item[0]);\n\t\t\t\t\tself.$activeItems.splice(idx, 1);\n\t\t\t\t}\n\t\n\t\t\t\tself.items.splice(i, 1);\n\t\t\t\tself.lastQuery = null;\n\t\t\t\tif (!self.settings.persist && self.userOptions.hasOwnProperty(value)) {\n\t\t\t\t\tself.removeOption(value, silent);\n\t\t\t\t}\n\t\n\t\t\t\tif (i < self.caretPos) {\n\t\t\t\t\tself.setCaret(self.caretPos - 1);\n\t\t\t\t}\n\t\n\t\t\t\tself.refreshState();\n\t\t\t\tself.updatePlaceholder();\n\t\t\t\tself.updateOriginalInput({silent: silent});\n\t\t\t\tself.positionDropdown();\n\t\t\t\tself.trigger('item_remove', value, $item);\n\t\t\t}\n\t\t},\n\t\n\t\t/**\n\t\t * Invokes the `create` method provided in the\n\t\t * selectize options that should provide the data\n\t\t * for the new item, given the user input.\n\t\t *\n\t\t * Once this completes, it will be added\n\t\t * to the item list.\n\t\t *\n\t\t * @param {string} value\n\t\t * @param {boolean} [triggerDropdown]\n\t\t * @param {function} [callback]\n\t\t * @return {boolean}\n\t\t */\n\t\tcreateItem: function(input, triggerDropdown) {\n\t\t\tvar self  = this;\n\t\t\tvar caret = self.caretPos;\n\t\t\tinput = input || $.trim(self.$control_input.val() || '');\n\t\n\t\t\tvar callback = arguments[arguments.length - 1];\n\t\t\tif (typeof callback !== 'function') callback = function() {};\n\t\n\t\t\tif (typeof triggerDropdown !== 'boolean') {\n\t\t\t\ttriggerDropdown = true;\n\t\t\t}\n\t\n\t\t\tif (!self.canCreate(input)) {\n\t\t\t\tcallback();\n\t\t\t\treturn false;\n\t\t\t}\n\t\n\t\t\tself.lock();\n\t\n\t\t\tvar setup = (typeof self.settings.create === 'function') ? this.settings.create : function(input) {\n\t\t\t\tvar data = {};\n\t\t\t\tdata[self.settings.labelField] = input;\n\t\t\t\tdata[self.settings.valueField] = input;\n\t\t\t\treturn data;\n\t\t\t};\n\t\n\t\t\tvar create = once(function(data) {\n\t\t\t\tself.unlock();\n\t\n\t\t\t\tif (!data || typeof data !== 'object') return callback();\n\t\t\t\tvar value = hash_key(data[self.settings.valueField]);\n\t\t\t\tif (typeof value !== 'string') return callback();\n\t\n\t\t\t\tself.setTextboxValue('');\n\t\t\t\tself.addOption(data);\n\t\t\t\tself.setCaret(caret);\n\t\t\t\tself.addItem(value);\n\t\t\t\tself.refreshOptions(triggerDropdown && self.settings.mode !== 'single');\n\t\t\t\tcallback(data);\n\t\t\t});\n\t\n\t\t\tvar output = setup.apply(this, [input, create]);\n\t\t\tif (typeof output !== 'undefined') {\n\t\t\t\tcreate(output);\n\t\t\t}\n\t\n\t\t\treturn true;\n\t\t},\n\t\n\t\t/**\n\t\t * Re-renders the selected item lists.\n\t\t */\n\t\trefreshItems: function() {\n\t\t\tthis.lastQuery = null;\n\t\n\t\t\tif (this.isSetup) {\n\t\t\t\tthis.addItem(this.items);\n\t\t\t}\n\t\n\t\t\tthis.refreshState();\n\t\t\tthis.updateOriginalInput();\n\t\t},\n\t\n\t\t/**\n\t\t * Updates all state-dependent attributes\n\t\t * and CSS classes.\n\t\t */\n\t\trefreshState: function() {\n\t\t\tthis.refreshValidityState();\n\t\t\tthis.refreshClasses();\n\t\t},\n\t\n\t\t/**\n\t\t * Update the `required` attribute of both input and control input.\n\t\t *\n\t\t * The `required` property needs to be activated on the control input\n\t\t * for the error to be displayed at the right place. `required` also\n\t\t * needs to be temporarily deactivated on the input since the input is\n\t\t * hidden and can't show errors.\n\t\t */\n\t\trefreshValidityState: function() {\n\t\t\tif (!this.isRequired) return false;\n\t\n\t\t\tvar invalid = !this.items.length;\n\t\n\t\t\tthis.isInvalid = invalid;\n\t\t\tthis.$control_input.prop('required', invalid);\n\t\t\tthis.$input.prop('required', !invalid);\n\t\t},\n\t\n\t\t/**\n\t\t * Updates all state-dependent CSS classes.\n\t\t */\n\t\trefreshClasses: function() {\n\t\t\tvar self     = this;\n\t\t\tvar isFull   = self.isFull();\n\t\t\tvar isLocked = self.isLocked;\n\t\n\t\t\tself.$wrapper\n\t\t\t\t.toggleClass('rtl', self.rtl);\n\t\n\t\t\tself.$control\n\t\t\t\t.toggleClass('focus', self.isFocused)\n\t\t\t\t.toggleClass('disabled', self.isDisabled)\n\t\t\t\t.toggleClass('required', self.isRequired)\n\t\t\t\t.toggleClass('invalid', self.isInvalid)\n\t\t\t\t.toggleClass('locked', isLocked)\n\t\t\t\t.toggleClass('full', isFull).toggleClass('not-full', !isFull)\n\t\t\t\t.toggleClass('input-active', self.isFocused && !self.isInputHidden)\n\t\t\t\t.toggleClass('dropdown-active', self.isOpen)\n\t\t\t\t.toggleClass('has-options', !$.isEmptyObject(self.options))\n\t\t\t\t.toggleClass('has-items', self.items.length > 0);\n\t\n\t\t\tself.$control_input.data('grow', !isFull && !isLocked);\n\t\t},\n\t\n\t\t/**\n\t\t * Determines whether or not more items can be added\n\t\t * to the control without exceeding the user-defined maximum.\n\t\t *\n\t\t * @returns {boolean}\n\t\t */\n\t\tisFull: function() {\n\t\t\treturn this.settings.maxItems !== null && this.items.length >= this.settings.maxItems;\n\t\t},\n\t\n\t\t/**\n\t\t * Refreshes the original <select> or <input>\n\t\t * element to reflect the current state.\n\t\t */\n\t\tupdateOriginalInput: function(opts) {\n\t\t\tvar i, n, options, label, self = this;\n\t\t\topts = opts || {};\n\t\n\t\t\tif (self.tagType === TAG_SELECT) {\n\t\t\t\toptions = [];\n\t\t\t\tfor (i = 0, n = self.items.length; i < n; i++) {\n\t\t\t\t\tlabel = self.options[self.items[i]][self.settings.labelField] || '';\n\t\t\t\t\toptions.push('<option value=\"' + escape_html(self.items[i]) + '\" selected=\"selected\">' + escape_html(label) + '</option>');\n\t\t\t\t}\n\t\t\t\tif (!options.length && !this.$input.attr('multiple')) {\n\t\t\t\t\toptions.push('<option value=\"\" selected=\"selected\"></option>');\n\t\t\t\t}\n\t\t\t\tself.$input.html(options.join(''));\n\t\t\t} else {\n\t\t\t\tself.$input.val(self.getValue());\n\t\t\t\tself.$input.attr('value',self.$input.val());\n\t\t\t}\n\t\n\t\t\tif (self.isSetup) {\n\t\t\t\tif (!opts.silent) {\n\t\t\t\t\tself.trigger('change', self.$input.val());\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\n\t\t/**\n\t\t * Shows/hide the input placeholder depending\n\t\t * on if there items in the list already.\n\t\t */\n\t\tupdatePlaceholder: function() {\n\t\t\tif (!this.settings.placeholder) return;\n\t\t\tvar $input = this.$control_input;\n\t\n\t\t\tif (this.items.length) {\n\t\t\t\t$input.removeAttr('placeholder');\n\t\t\t} else {\n\t\t\t\t$input.attr('placeholder', this.settings.placeholder);\n\t\t\t}\n\t\t\t$input.triggerHandler('update', {force: true});\n\t\t},\n\t\n\t\t/**\n\t\t * Shows the autocomplete dropdown containing\n\t\t * the available options.\n\t\t */\n\t\topen: function() {\n\t\t\tvar self = this;\n\t\n\t\t\tif (self.isLocked || self.isOpen || (self.settings.mode === 'multi' && self.isFull())) return;\n\t\t\tself.focus();\n\t\t\tself.isOpen = true;\n\t\t\tself.refreshState();\n\t\t\tself.$dropdown.css({visibility: 'hidden', display: 'block'});\n\t\t\tself.positionDropdown();\n\t\t\tself.$dropdown.css({visibility: 'visible'});\n\t\t\tself.trigger('dropdown_open', self.$dropdown);\n\t\t},\n\t\n\t\t/**\n\t\t * Closes the autocomplete dropdown menu.\n\t\t */\n\t\tclose: function() {\n\t\t\tvar self = this;\n\t\t\tvar trigger = self.isOpen;\n\t\n\t\t\tif (self.settings.mode === 'single' && self.items.length) {\n\t\t\t\tself.hideInput();\n\t\n\t\t\t\t// Do not trigger blur while inside a blur event,\n\t\t\t\t// this fixes some weird tabbing behavior in FF and IE.\n\t\t\t\t// See #1164\n\t\t\t\tif (!self.isBlurring) {\n\t\t\t\t\tself.$control_input.blur(); // close keyboard on iOS\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\tself.isOpen = false;\n\t\t\tself.$dropdown.hide();\n\t\t\tself.setActiveOption(null);\n\t\t\tself.refreshState();\n\t\n\t\t\tif (trigger) self.trigger('dropdown_close', self.$dropdown);\n\t\t},\n\t\n\t\t/**\n\t\t * Calculates and applies the appropriate\n\t\t * position of the dropdown.\n\t\t */\n\t\tpositionDropdown: function() {\n\t\t\tvar $control = this.$control;\n\t\t\tvar offset = this.settings.dropdownParent === 'body' ? $control.offset() : $control.position();\n\t\t\toffset.top += $control.outerHeight(true);\n\t\n\t\t\tthis.$dropdown.css({\n\t\t\t\twidth : $control[0].getBoundingClientRect().width,\n\t\t\t\ttop   : offset.top,\n\t\t\t\tleft  : offset.left\n\t\t\t});\n\t\t},\n\t\n\t\t/**\n\t\t * Resets / clears all selected items\n\t\t * from the control.\n\t\t *\n\t\t * @param {boolean} silent\n\t\t */\n\t\tclear: function(silent) {\n\t\t\tvar self = this;\n\t\n\t\t\tif (!self.items.length) return;\n\t\t\tself.$control.children(':not(input)').remove();\n\t\t\tself.items = [];\n\t\t\tself.lastQuery = null;\n\t\t\tself.setCaret(0);\n\t\t\tself.setActiveItem(null);\n\t\t\tself.updatePlaceholder();\n\t\t\tself.updateOriginalInput({silent: silent});\n\t\t\tself.refreshState();\n\t\t\tself.showInput();\n\t\t\tself.trigger('clear');\n\t\t},\n\t\n\t\t/**\n\t\t * A helper method for inserting an element\n\t\t * at the current caret position.\n\t\t *\n\t\t * @param {object} $el\n\t\t */\n\t\tinsertAtCaret: function($el) {\n\t\t\tvar caret = Math.min(this.caretPos, this.items.length);\n\t\t\tvar el = $el[0];\n\t\t\tvar target = this.buffer || this.$control[0];\n\t\n\t\t\tif (caret === 0) {\n\t\t\t\ttarget.insertBefore(el, target.firstChild);\n\t\t\t} else {\n\t\t\t\ttarget.insertBefore(el, target.childNodes[caret]);\n\t\t\t}\n\t\n\t\t\tthis.setCaret(caret + 1);\n\t\t},\n\t\n\t\t/**\n\t\t * Removes the current selected item(s).\n\t\t *\n\t\t * @param {object} e (optional)\n\t\t * @returns {boolean}\n\t\t */\n\t\tdeleteSelection: function(e) {\n\t\t\tvar i, n, direction, selection, values, caret, option_select, $option_select, $tail;\n\t\t\tvar self = this;\n\t\n\t\t\tdirection = (e && e.keyCode === KEY_BACKSPACE) ? -1 : 1;\n\t\t\tselection = getSelection(self.$control_input[0]);\n\t\n\t\t\tif (self.$activeOption && !self.settings.hideSelected) {\n\t\t\t\toption_select = self.getAdjacentOption(self.$activeOption, -1).attr('data-value');\n\t\t\t}\n\t\n\t\t\t// determine items that will be removed\n\t\t\tvalues = [];\n\t\n\t\t\tif (self.$activeItems.length) {\n\t\t\t\t$tail = self.$control.children('.active:' + (direction > 0 ? 'last' : 'first'));\n\t\t\t\tcaret = self.$control.children(':not(input)').index($tail);\n\t\t\t\tif (direction > 0) { caret++; }\n\t\n\t\t\t\tfor (i = 0, n = self.$activeItems.length; i < n; i++) {\n\t\t\t\t\tvalues.push($(self.$activeItems[i]).attr('data-value'));\n\t\t\t\t}\n\t\t\t\tif (e) {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t}\n\t\t\t} else if ((self.isFocused || self.settings.mode === 'single') && self.items.length) {\n\t\t\t\tif (direction < 0 && selection.start === 0 && selection.length === 0) {\n\t\t\t\t\tvalues.push(self.items[self.caretPos - 1]);\n\t\t\t\t} else if (direction > 0 && selection.start === self.$control_input.val().length) {\n\t\t\t\t\tvalues.push(self.items[self.caretPos]);\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\t// allow the callback to abort\n\t\t\tif (!values.length || (typeof self.settings.onDelete === 'function' && self.settings.onDelete.apply(self, [values]) === false)) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\n\t\t\t// perform removal\n\t\t\tif (typeof caret !== 'undefined') {\n\t\t\t\tself.setCaret(caret);\n\t\t\t}\n\t\t\twhile (values.length) {\n\t\t\t\tself.removeItem(values.pop());\n\t\t\t}\n\t\n\t\t\tself.showInput();\n\t\t\tself.positionDropdown();\n\t\t\tself.refreshOptions(true);\n\t\n\t\t\t// select previous option\n\t\t\tif (option_select) {\n\t\t\t\t$option_select = self.getOption(option_select);\n\t\t\t\tif ($option_select.length) {\n\t\t\t\t\tself.setActiveOption($option_select);\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\treturn true;\n\t\t},\n\t\n\t\t/**\n\t\t * Selects the previous / next item (depending\n\t\t * on the `direction` argument).\n\t\t *\n\t\t * > 0 - right\n\t\t * < 0 - left\n\t\t *\n\t\t * @param {int} direction\n\t\t * @param {object} e (optional)\n\t\t */\n\t\tadvanceSelection: function(direction, e) {\n\t\t\tvar tail, selection, idx, valueLength, cursorAtEdge, $tail;\n\t\t\tvar self = this;\n\t\n\t\t\tif (direction === 0) return;\n\t\t\tif (self.rtl) direction *= -1;\n\t\n\t\t\ttail = direction > 0 ? 'last' : 'first';\n\t\t\tselection = getSelection(self.$control_input[0]);\n\t\n\t\t\tif (self.isFocused && !self.isInputHidden) {\n\t\t\t\tvalueLength = self.$control_input.val().length;\n\t\t\t\tcursorAtEdge = direction < 0\n\t\t\t\t\t? selection.start === 0 && selection.length === 0\n\t\t\t\t\t: selection.start === valueLength;\n\t\n\t\t\t\tif (cursorAtEdge && !valueLength) {\n\t\t\t\t\tself.advanceCaret(direction, e);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t$tail = self.$control.children('.active:' + tail);\n\t\t\t\tif ($tail.length) {\n\t\t\t\t\tidx = self.$control.children(':not(input)').index($tail);\n\t\t\t\t\tself.setActiveItem(null);\n\t\t\t\t\tself.setCaret(direction > 0 ? idx + 1 : idx);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\n\t\t/**\n\t\t * Moves the caret left / right.\n\t\t *\n\t\t * @param {int} direction\n\t\t * @param {object} e (optional)\n\t\t */\n\t\tadvanceCaret: function(direction, e) {\n\t\t\tvar self = this, fn, $adj;\n\t\n\t\t\tif (direction === 0) return;\n\t\n\t\t\tfn = direction > 0 ? 'next' : 'prev';\n\t\t\tif (self.isShiftDown) {\n\t\t\t\t$adj = self.$control_input[fn]();\n\t\t\t\tif ($adj.length) {\n\t\t\t\t\tself.hideInput();\n\t\t\t\t\tself.setActiveItem($adj);\n\t\t\t\t\te && e.preventDefault();\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tself.setCaret(self.caretPos + direction);\n\t\t\t}\n\t\t},\n\t\n\t\t/**\n\t\t * Moves the caret to the specified index.\n\t\t *\n\t\t * @param {int} i\n\t\t */\n\t\tsetCaret: function(i) {\n\t\t\tvar self = this;\n\t\n\t\t\tif (self.settings.mode === 'single') {\n\t\t\t\ti = self.items.length;\n\t\t\t} else {\n\t\t\t\ti = Math.max(0, Math.min(self.items.length, i));\n\t\t\t}\n\t\n\t\t\tif(!self.isPending) {\n\t\t\t\t// the input must be moved by leaving it in place and moving the\n\t\t\t\t// siblings, due to the fact that focus cannot be restored once lost\n\t\t\t\t// on mobile webkit devices\n\t\t\t\tvar j, n, fn, $children, $child;\n\t\t\t\t$children = self.$control.children(':not(input)');\n\t\t\t\tfor (j = 0, n = $children.length; j < n; j++) {\n\t\t\t\t\t$child = $($children[j]).detach();\n\t\t\t\t\tif (j <  i) {\n\t\t\t\t\t\tself.$control_input.before($child);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tself.$control.append($child);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\tself.caretPos = i;\n\t\t},\n\t\n\t\t/**\n\t\t * Disables user input on the control. Used while\n\t\t * items are being asynchronously created.\n\t\t */\n\t\tlock: function() {\n\t\t\tthis.close();\n\t\t\tthis.isLocked = true;\n\t\t\tthis.refreshState();\n\t\t},\n\t\n\t\t/**\n\t\t * Re-enables user input on the control.\n\t\t */\n\t\tunlock: function() {\n\t\t\tthis.isLocked = false;\n\t\t\tthis.refreshState();\n\t\t},\n\t\n\t\t/**\n\t\t * Disables user input on the control completely.\n\t\t * While disabled, it cannot receive focus.\n\t\t */\n\t\tdisable: function() {\n\t\t\tvar self = this;\n\t\t\tself.$input.prop('disabled', true);\n\t\t\tself.$control_input.prop('disabled', true).prop('tabindex', -1);\n\t\t\tself.isDisabled = true;\n\t\t\tself.lock();\n\t\t},\n\t\n\t\t/**\n\t\t * Enables the control so that it can respond\n\t\t * to focus and user input.\n\t\t */\n\t\tenable: function() {\n\t\t\tvar self = this;\n\t\t\tself.$input.prop('disabled', false);\n\t\t\tself.$control_input.prop('disabled', false).prop('tabindex', self.tabIndex);\n\t\t\tself.isDisabled = false;\n\t\t\tself.unlock();\n\t\t},\n\t\n\t\t/**\n\t\t * Completely destroys the control and\n\t\t * unbinds all event listeners so that it can\n\t\t * be garbage collected.\n\t\t */\n\t\tdestroy: function() {\n\t\t\tvar self = this;\n\t\t\tvar eventNS = self.eventNS;\n\t\t\tvar revertSettings = self.revertSettings;\n\t\n\t\t\tself.trigger('destroy');\n\t\t\tself.off();\n\t\t\tself.$wrapper.remove();\n\t\t\tself.$dropdown.remove();\n\t\n\t\t\tself.$input\n\t\t\t\t.html('')\n\t\t\t\t.append(revertSettings.$children)\n\t\t\t\t.removeAttr('tabindex')\n\t\t\t\t.removeClass('selectized')\n\t\t\t\t.attr({tabindex: revertSettings.tabindex})\n\t\t\t\t.show();\n\t\n\t\t\tself.$control_input.removeData('grow');\n\t\t\tself.$input.removeData('selectize');\n\t\n\t\t\tif (--Selectize.count == 0 && Selectize.$testInput) {\n\t\t\t\tSelectize.$testInput.remove();\n\t\t\t\tSelectize.$testInput = undefined;\n\t\t\t}\n\t\n\t\t\t$(window).off(eventNS);\n\t\t\t$(document).off(eventNS);\n\t\t\t$(document.body).off(eventNS);\n\t\n\t\t\tdelete self.$input[0].selectize;\n\t\t},\n\t\n\t\t/**\n\t\t * A helper method for rendering \"item\" and\n\t\t * \"option\" templates, given the data.\n\t\t *\n\t\t * @param {string} templateName\n\t\t * @param {object} data\n\t\t * @returns {string}\n\t\t */\n\t\trender: function(templateName, data) {\n\t\t\tvar value, id, label;\n\t\t\tvar html = '';\n\t\t\tvar cache = false;\n\t\t\tvar self = this;\n\t\t\tvar regex_tag = /^[\\t \\r\\n]*<([a-z][a-z0-9\\-_]*(?:\\:[a-z][a-z0-9\\-_]*)?)/i;\n\t\n\t\t\tif (templateName === 'option' || templateName === 'item') {\n\t\t\t\tvalue = hash_key(data[self.settings.valueField]);\n\t\t\t\tcache = !!value;\n\t\t\t}\n\t\n\t\t\t// pull markup from cache if it exists\n\t\t\tif (cache) {\n\t\t\t\tif (!isset(self.renderCache[templateName])) {\n\t\t\t\t\tself.renderCache[templateName] = {};\n\t\t\t\t}\n\t\t\t\tif (self.renderCache[templateName].hasOwnProperty(value)) {\n\t\t\t\t\treturn self.renderCache[templateName][value];\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\t// render markup\n\t\t\thtml = $(self.settings.render[templateName].apply(this, [data, escape_html]));\n\t\n\t\t\t// add mandatory attributes\n\t\t\tif (templateName === 'option' || templateName === 'option_create') {\n\t\t\t\tif (!data[self.settings.disabledField]) {\n\t\t\t\t\thtml.attr('data-selectable', '');\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (templateName === 'optgroup') {\n\t\t\t\tid = data[self.settings.optgroupValueField] || '';\n\t\t\t\thtml.attr('data-group', id);\n\t\t\t\tif(data[self.settings.disabledField]) {\n\t\t\t\t\thtml.attr('data-disabled', '');\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (templateName === 'option' || templateName === 'item') {\n\t\t\t\thtml.attr('data-value', value || '');\n\t\t\t}\n\t\n\t\t\t// update cache\n\t\t\tif (cache) {\n\t\t\t\tself.renderCache[templateName][value] = html[0];\n\t\t\t}\n\t\n\t\t\treturn html[0];\n\t\t},\n\t\n\t\t/**\n\t\t * Clears the render cache for a template. If\n\t\t * no template is given, clears all render\n\t\t * caches.\n\t\t *\n\t\t * @param {string} templateName\n\t\t */\n\t\tclearCache: function(templateName) {\n\t\t\tvar self = this;\n\t\t\tif (typeof templateName === 'undefined') {\n\t\t\t\tself.renderCache = {};\n\t\t\t} else {\n\t\t\t\tdelete self.renderCache[templateName];\n\t\t\t}\n\t\t},\n\t\n\t\t/**\n\t\t * Determines whether or not to display the\n\t\t * create item prompt, given a user input.\n\t\t *\n\t\t * @param {string} input\n\t\t * @return {boolean}\n\t\t */\n\t\tcanCreate: function(input) {\n\t\t\tvar self = this;\n\t\t\tif (!self.settings.create) return false;\n\t\t\tvar filter = self.settings.createFilter;\n\t\t\treturn input.length\n\t\t\t\t&& (typeof filter !== 'function' || filter.apply(self, [input]))\n\t\t\t\t&& (typeof filter !== 'string' || new RegExp(filter).test(input))\n\t\t\t\t&& (!(filter instanceof RegExp) || filter.test(input));\n\t\t}\n\t\n\t});\n\t\n\t\n\tSelectize.count = 0;\n\tSelectize.defaults = {\n\t\toptions: [],\n\t\toptgroups: [],\n\t\n\t\tplugins: [],\n\t\tdelimiter: ',',\n\t\tsplitOn: null, // regexp or string for splitting up values from a paste command\n\t\tpersist: true,\n\t\tdiacritics: true,\n\t\tcreate: false,\n\t\tcreateOnBlur: false,\n\t\tcreateFilter: null,\n\t\thighlight: true,\n\t\topenOnFocus: true,\n\t\tmaxOptions: 1000,\n\t\tmaxItems: null,\n\t\thideSelected: null,\n\t\taddPrecedence: false,\n\t\tselectOnTab: false,\n\t\tpreload: false,\n\t\tallowEmptyOption: false,\n\t\tcloseAfterSelect: false,\n\t\n\t\tscrollDuration: 60,\n\t\tloadThrottle: 300,\n\t\tloadingClass: 'loading',\n\t\n\t\tdataAttr: 'data-data',\n\t\toptgroupField: 'optgroup',\n\t\tvalueField: 'value',\n\t\tlabelField: 'text',\n\t\tdisabledField: 'disabled',\n\t\toptgroupLabelField: 'label',\n\t\toptgroupValueField: 'value',\n\t\tlockOptgroupOrder: false,\n\t\n\t\tsortField: '$order',\n\t\tsearchField: ['text'],\n\t\tsearchConjunction: 'and',\n\t\n\t\tmode: null,\n\t\twrapperClass: 'selectize-control',\n\t\tinputClass: 'selectize-input',\n\t\tdropdownClass: 'selectize-dropdown',\n\t\tdropdownContentClass: 'selectize-dropdown-content',\n\t\n\t\tdropdownParent: null,\n\t\n\t\tcopyClassesToDropdown: true,\n\t\n\t\t/*\n\t\tload                 : null, // function(query, callback) { ... }\n\t\tscore                : null, // function(search) { ... }\n\t\tonInitialize         : null, // function() { ... }\n\t\tonChange             : null, // function(value) { ... }\n\t\tonItemAdd            : null, // function(value, $item) { ... }\n\t\tonItemRemove         : null, // function(value) { ... }\n\t\tonClear              : null, // function() { ... }\n\t\tonOptionAdd          : null, // function(value, data) { ... }\n\t\tonOptionRemove       : null, // function(value) { ... }\n\t\tonOptionClear        : null, // function() { ... }\n\t\tonOptionGroupAdd     : null, // function(id, data) { ... }\n\t\tonOptionGroupRemove  : null, // function(id) { ... }\n\t\tonOptionGroupClear   : null, // function() { ... }\n\t\tonDropdownOpen       : null, // function($dropdown) { ... }\n\t\tonDropdownClose      : null, // function($dropdown) { ... }\n\t\tonType               : null, // function(str) { ... }\n\t\tonDelete             : null, // function(values) { ... }\n\t\t*/\n\t\n\t\trender: {\n\t\t\t/*\n\t\t\titem: null,\n\t\t\toptgroup: null,\n\t\t\toptgroup_header: null,\n\t\t\toption: null,\n\t\t\toption_create: null\n\t\t\t*/\n\t\t}\n\t};\n\t\n\t\n\t$.fn.selectize = function(settings_user) {\n\t\tvar defaults             = $.fn.selectize.defaults;\n\t\tvar settings             = $.extend({}, defaults, settings_user);\n\t\tvar attr_data            = settings.dataAttr;\n\t\tvar field_label          = settings.labelField;\n\t\tvar field_value          = settings.valueField;\n\t\tvar field_disabled       = settings.disabledField;\n\t\tvar field_optgroup       = settings.optgroupField;\n\t\tvar field_optgroup_label = settings.optgroupLabelField;\n\t\tvar field_optgroup_value = settings.optgroupValueField;\n\t\n\t\t/**\n\t\t * Initializes selectize from a <input type=\"text\"> element.\n\t\t *\n\t\t * @param {object} $input\n\t\t * @param {object} settings_element\n\t\t */\n\t\tvar init_textbox = function($input, settings_element) {\n\t\t\tvar i, n, values, option;\n\t\n\t\t\tvar data_raw = $input.attr(attr_data);\n\t\n\t\t\tif (!data_raw) {\n\t\t\t\tvar value = $.trim($input.val() || '');\n\t\t\t\tif (!settings.allowEmptyOption && !value.length) return;\n\t\t\t\tvalues = value.split(settings.delimiter);\n\t\t\t\tfor (i = 0, n = values.length; i < n; i++) {\n\t\t\t\t\toption = {};\n\t\t\t\t\toption[field_label] = values[i];\n\t\t\t\t\toption[field_value] = values[i];\n\t\t\t\t\tsettings_element.options.push(option);\n\t\t\t\t}\n\t\t\t\tsettings_element.items = values;\n\t\t\t} else {\n\t\t\t\tsettings_element.options = JSON.parse(data_raw);\n\t\t\t\tfor (i = 0, n = settings_element.options.length; i < n; i++) {\n\t\t\t\t\tsettings_element.items.push(settings_element.options[i][field_value]);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\n\t\t/**\n\t\t * Initializes selectize from a <select> element.\n\t\t *\n\t\t * @param {object} $input\n\t\t * @param {object} settings_element\n\t\t */\n\t\tvar init_select = function($input, settings_element) {\n\t\t\tvar i, n, tagName, $children, order = 0;\n\t\t\tvar options = settings_element.options;\n\t\t\tvar optionsMap = {};\n\t\n\t\t\tvar readData = function($el) {\n\t\t\t\tvar data = attr_data && $el.attr(attr_data);\n\t\t\t\tif (typeof data === 'string' && data.length) {\n\t\t\t\t\treturn JSON.parse(data);\n\t\t\t\t}\n\t\t\t\treturn null;\n\t\t\t};\n\t\n\t\t\tvar addOption = function($option, group) {\n\t\t\t\t$option = $($option);\n\t\n\t\t\t\tvar value = hash_key($option.val());\n\t\t\t\tif (!value && !settings.allowEmptyOption) return;\n\t\n\t\t\t\t// if the option already exists, it's probably been\n\t\t\t\t// duplicated in another optgroup. in this case, push\n\t\t\t\t// the current group to the \"optgroup\" property on the\n\t\t\t\t// existing option so that it's rendered in both places.\n\t\t\t\tif (optionsMap.hasOwnProperty(value)) {\n\t\t\t\t\tif (group) {\n\t\t\t\t\t\tvar arr = optionsMap[value][field_optgroup];\n\t\t\t\t\t\tif (!arr) {\n\t\t\t\t\t\t\toptionsMap[value][field_optgroup] = group;\n\t\t\t\t\t\t} else if (!$.isArray(arr)) {\n\t\t\t\t\t\t\toptionsMap[value][field_optgroup] = [arr, group];\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tarr.push(group);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\n\t\t\t\tvar option             = readData($option) || {};\n\t\t\t\toption[field_label]    = option[field_label] || $option.text();\n\t\t\t\toption[field_value]    = option[field_value] || value;\n\t\t\t\toption[field_disabled] = option[field_disabled] || $option.prop('disabled');\n\t\t\t\toption[field_optgroup] = option[field_optgroup] || group;\n\t\n\t\t\t\toptionsMap[value] = option;\n\t\t\t\toptions.push(option);\n\t\n\t\t\t\tif ($option.is(':selected')) {\n\t\t\t\t\tsettings_element.items.push(value);\n\t\t\t\t}\n\t\t\t};\n\t\n\t\t\tvar addGroup = function($optgroup) {\n\t\t\t\tvar i, n, id, optgroup, $options;\n\t\n\t\t\t\t$optgroup = $($optgroup);\n\t\t\t\tid = $optgroup.attr('label');\n\t\n\t\t\t\tif (id) {\n\t\t\t\t\toptgroup = readData($optgroup) || {};\n\t\t\t\t\toptgroup[field_optgroup_label] = id;\n\t\t\t\t\toptgroup[field_optgroup_value] = id;\n\t\t\t\t\toptgroup[field_disabled] = $optgroup.prop('disabled');\n\t\t\t\t\tsettings_element.optgroups.push(optgroup);\n\t\t\t\t}\n\t\n\t\t\t\t$options = $('option', $optgroup);\n\t\t\t\tfor (i = 0, n = $options.length; i < n; i++) {\n\t\t\t\t\taddOption($options[i], id);\n\t\t\t\t}\n\t\t\t};\n\t\n\t\t\tsettings_element.maxItems = $input.attr('multiple') ? null : 1;\n\t\n\t\t\t$children = $input.children();\n\t\t\tfor (i = 0, n = $children.length; i < n; i++) {\n\t\t\t\ttagName = $children[i].tagName.toLowerCase();\n\t\t\t\tif (tagName === 'optgroup') {\n\t\t\t\t\taddGroup($children[i]);\n\t\t\t\t} else if (tagName === 'option') {\n\t\t\t\t\taddOption($children[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\n\t\treturn this.each(function() {\n\t\t\tif (this.selectize) return;\n\t\n\t\t\tvar instance;\n\t\t\tvar $input = $(this);\n\t\t\tvar tag_name = this.tagName.toLowerCase();\n\t\t\tvar placeholder = $input.attr('placeholder') || $input.attr('data-placeholder');\n\t\t\tif (!placeholder && !settings.allowEmptyOption) {\n\t\t\t\tplaceholder = $input.children('option[value=\"\"]').text();\n\t\t\t}\n\t\n\t\t\tvar settings_element = {\n\t\t\t\t'placeholder' : placeholder,\n\t\t\t\t'options'     : [],\n\t\t\t\t'optgroups'   : [],\n\t\t\t\t'items'       : []\n\t\t\t};\n\t\n\t\t\tif (tag_name === 'select') {\n\t\t\t\tinit_select($input, settings_element);\n\t\t\t} else {\n\t\t\t\tinit_textbox($input, settings_element);\n\t\t\t}\n\t\n\t\t\tinstance = new Selectize($input, $.extend(true, {}, defaults, settings_element, settings_user));\n\t\t});\n\t};\n\t\n\t$.fn.selectize.defaults = Selectize.defaults;\n\t$.fn.selectize.support = {\n\t\tvalidity: SUPPORTS_VALIDITY_API\n\t};\n\t\n\t\n\tSelectize.define('drag_drop', function(options) {\n\t\tif (!$.fn.sortable) throw new Error('The \"drag_drop\" plugin requires jQuery UI \"sortable\".');\n\t\tif (this.settings.mode !== 'multi') return;\n\t\tvar self = this;\n\t\n\t\tself.lock = (function() {\n\t\t\tvar original = self.lock;\n\t\t\treturn function() {\n\t\t\t\tvar sortable = self.$control.data('sortable');\n\t\t\t\tif (sortable) sortable.disable();\n\t\t\t\treturn original.apply(self, arguments);\n\t\t\t};\n\t\t})();\n\t\n\t\tself.unlock = (function() {\n\t\t\tvar original = self.unlock;\n\t\t\treturn function() {\n\t\t\t\tvar sortable = self.$control.data('sortable');\n\t\t\t\tif (sortable) sortable.enable();\n\t\t\t\treturn original.apply(self, arguments);\n\t\t\t};\n\t\t})();\n\t\n\t\tself.setup = (function() {\n\t\t\tvar original = self.setup;\n\t\t\treturn function() {\n\t\t\t\toriginal.apply(this, arguments);\n\t\n\t\t\t\tvar $control = self.$control.sortable({\n\t\t\t\t\titems: '[data-value]',\n\t\t\t\t\tforcePlaceholderSize: true,\n\t\t\t\t\tdisabled: self.isLocked,\n\t\t\t\t\tstart: function(e, ui) {\n\t\t\t\t\t\tui.placeholder.css('width', ui.helper.css('width'));\n\t\t\t\t\t\t$control.css({overflow: 'visible'});\n\t\t\t\t\t},\n\t\t\t\t\tstop: function() {\n\t\t\t\t\t\t$control.css({overflow: 'hidden'});\n\t\t\t\t\t\tvar active = self.$activeItems ? self.$activeItems.slice() : null;\n\t\t\t\t\t\tvar values = [];\n\t\t\t\t\t\t$control.children('[data-value]').each(function() {\n\t\t\t\t\t\t\tvalues.push($(this).attr('data-value'));\n\t\t\t\t\t\t});\n\t\t\t\t\t\tself.setValue(values);\n\t\t\t\t\t\tself.setActiveItem(active);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t};\n\t\t})();\n\t\n\t});\n\t\n\tSelectize.define('dropdown_header', function(options) {\n\t\tvar self = this;\n\t\n\t\toptions = $.extend({\n\t\t\ttitle         : 'Untitled',\n\t\t\theaderClass   : 'selectize-dropdown-header',\n\t\t\ttitleRowClass : 'selectize-dropdown-header-title',\n\t\t\tlabelClass    : 'selectize-dropdown-header-label',\n\t\t\tcloseClass    : 'selectize-dropdown-header-close',\n\t\n\t\t\thtml: function(data) {\n\t\t\t\treturn (\n\t\t\t\t\t'<div class=\"' + data.headerClass + '\">' +\n\t\t\t\t\t\t'<div class=\"' + data.titleRowClass + '\">' +\n\t\t\t\t\t\t\t'<span class=\"' + data.labelClass + '\">' + data.title + '</span>' +\n\t\t\t\t\t\t\t'<a href=\"javascript:void(0)\" class=\"' + data.closeClass + '\">&times;</a>' +\n\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t'</div>'\n\t\t\t\t);\n\t\t\t}\n\t\t}, options);\n\t\n\t\tself.setup = (function() {\n\t\t\tvar original = self.setup;\n\t\t\treturn function() {\n\t\t\t\toriginal.apply(self, arguments);\n\t\t\t\tself.$dropdown_header = $(options.html(options));\n\t\t\t\tself.$dropdown.prepend(self.$dropdown_header);\n\t\t\t};\n\t\t})();\n\t\n\t});\n\t\n\tSelectize.define('optgroup_columns', function(options) {\n\t\tvar self = this;\n\t\n\t\toptions = $.extend({\n\t\t\tequalizeWidth  : true,\n\t\t\tequalizeHeight : true\n\t\t}, options);\n\t\n\t\tthis.getAdjacentOption = function($option, direction) {\n\t\t\tvar $options = $option.closest('[data-group]').find('[data-selectable]');\n\t\t\tvar index    = $options.index($option) + direction;\n\t\n\t\t\treturn index >= 0 && index < $options.length ? $options.eq(index) : $();\n\t\t};\n\t\n\t\tthis.onKeyDown = (function() {\n\t\t\tvar original = self.onKeyDown;\n\t\t\treturn function(e) {\n\t\t\t\tvar index, $option, $options, $optgroup;\n\t\n\t\t\t\tif (this.isOpen && (e.keyCode === KEY_LEFT || e.keyCode === KEY_RIGHT)) {\n\t\t\t\t\tself.ignoreHover = true;\n\t\t\t\t\t$optgroup = this.$activeOption.closest('[data-group]');\n\t\t\t\t\tindex = $optgroup.find('[data-selectable]').index(this.$activeOption);\n\t\n\t\t\t\t\tif(e.keyCode === KEY_LEFT) {\n\t\t\t\t\t\t$optgroup = $optgroup.prev('[data-group]');\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$optgroup = $optgroup.next('[data-group]');\n\t\t\t\t\t}\n\t\n\t\t\t\t\t$options = $optgroup.find('[data-selectable]');\n\t\t\t\t\t$option  = $options.eq(Math.min($options.length - 1, index));\n\t\t\t\t\tif ($option.length) {\n\t\t\t\t\t\tthis.setActiveOption($option);\n\t\t\t\t\t}\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\n\t\t\t\treturn original.apply(this, arguments);\n\t\t\t};\n\t\t})();\n\t\n\t\tvar getScrollbarWidth = function() {\n\t\t\tvar div;\n\t\t\tvar width = getScrollbarWidth.width;\n\t\t\tvar doc = document;\n\t\n\t\t\tif (typeof width === 'undefined') {\n\t\t\t\tdiv = doc.createElement('div');\n\t\t\t\tdiv.innerHTML = '<div style=\"width:50px;height:50px;position:absolute;left:-50px;top:-50px;overflow:auto;\"><div style=\"width:1px;height:100px;\"></div></div>';\n\t\t\t\tdiv = div.firstChild;\n\t\t\t\tdoc.body.appendChild(div);\n\t\t\t\twidth = getScrollbarWidth.width = div.offsetWidth - div.clientWidth;\n\t\t\t\tdoc.body.removeChild(div);\n\t\t\t}\n\t\t\treturn width;\n\t\t};\n\t\n\t\tvar equalizeSizes = function() {\n\t\t\tvar i, n, height_max, width, width_last, width_parent, $optgroups;\n\t\n\t\t\t$optgroups = $('[data-group]', self.$dropdown_content);\n\t\t\tn = $optgroups.length;\n\t\t\tif (!n || !self.$dropdown_content.width()) return;\n\t\n\t\t\tif (options.equalizeHeight) {\n\t\t\t\theight_max = 0;\n\t\t\t\tfor (i = 0; i < n; i++) {\n\t\t\t\t\theight_max = Math.max(height_max, $optgroups.eq(i).height());\n\t\t\t\t}\n\t\t\t\t$optgroups.css({height: height_max});\n\t\t\t}\n\t\n\t\t\tif (options.equalizeWidth) {\n\t\t\t\twidth_parent = self.$dropdown_content.innerWidth() - getScrollbarWidth();\n\t\t\t\twidth = Math.round(width_parent / n);\n\t\t\t\t$optgroups.css({width: width});\n\t\t\t\tif (n > 1) {\n\t\t\t\t\twidth_last = width_parent - width * (n - 1);\n\t\t\t\t\t$optgroups.eq(n - 1).css({width: width_last});\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\n\t\tif (options.equalizeHeight || options.equalizeWidth) {\n\t\t\thook.after(this, 'positionDropdown', equalizeSizes);\n\t\t\thook.after(this, 'refreshOptions', equalizeSizes);\n\t\t}\n\t\n\t\n\t});\n\t\n\tSelectize.define('remove_button', function(options) {\n\t\toptions = $.extend({\n\t\t\t\tlabel     : '&times;',\n\t\t\t\ttitle     : 'Remove',\n\t\t\t\tclassName : 'remove',\n\t\t\t\tappend    : true\n\t\t\t}, options);\n\t\n\t\t\tvar singleClose = function(thisRef, options) {\n\t\n\t\t\t\toptions.className = 'remove-single';\n\t\n\t\t\t\tvar self = thisRef;\n\t\t\t\tvar html = '<a href=\"javascript:void(0)\" class=\"' + options.className + '\" tabindex=\"-1\" title=\"' + escape_html(options.title) + '\">' + options.label + '</a>';\n\t\n\t\t\t\t/**\n\t\t\t\t * Appends an element as a child (with raw HTML).\n\t\t\t\t *\n\t\t\t\t * @param {string} html_container\n\t\t\t\t * @param {string} html_element\n\t\t\t\t * @return {string}\n\t\t\t\t */\n\t\t\t\tvar append = function(html_container, html_element) {\n\t\t\t\t\treturn $('<span>').append(html_container)\n\t\t\t\t\t\t.append(html_element);\n\t\t\t\t};\n\t\n\t\t\t\tthisRef.setup = (function() {\n\t\t\t\t\tvar original = self.setup;\n\t\t\t\t\treturn function() {\n\t\t\t\t\t\t// override the item rendering method to add the button to each\n\t\t\t\t\t\tif (options.append) {\n\t\t\t\t\t\t\tvar id = $(self.$input.context).attr('id');\n\t\t\t\t\t\t\tvar selectizer = $('#'+id);\n\t\n\t\t\t\t\t\t\tvar render_item = self.settings.render.item;\n\t\t\t\t\t\t\tself.settings.render.item = function(data) {\n\t\t\t\t\t\t\t\treturn append(render_item.apply(thisRef, arguments), html);\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\toriginal.apply(thisRef, arguments);\n\t\n\t\t\t\t\t\t// add event listener\n\t\t\t\t\t\tthisRef.$control.on('click', '.' + options.className, function(e) {\n\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\tif (self.isLocked) return;\n\t\n\t\t\t\t\t\t\tself.clear();\n\t\t\t\t\t\t});\n\t\n\t\t\t\t\t};\n\t\t\t\t})();\n\t\t\t};\n\t\n\t\t\tvar multiClose = function(thisRef, options) {\n\t\n\t\t\t\tvar self = thisRef;\n\t\t\t\tvar html = '<a href=\"javascript:void(0)\" class=\"' + options.className + '\" tabindex=\"-1\" title=\"' + escape_html(options.title) + '\">' + options.label + '</a>';\n\t\n\t\t\t\t/**\n\t\t\t\t * Appends an element as a child (with raw HTML).\n\t\t\t\t *\n\t\t\t\t * @param {string} html_container\n\t\t\t\t * @param {string} html_element\n\t\t\t\t * @return {string}\n\t\t\t\t */\n\t\t\t\tvar append = function(html_container, html_element) {\n\t\t\t\t\tvar pos = html_container.search(/(<\\/[^>]+>\\s*)$/);\n\t\t\t\t\treturn html_container.substring(0, pos) + html_element + html_container.substring(pos);\n\t\t\t\t};\n\t\n\t\t\t\tthisRef.setup = (function() {\n\t\t\t\t\tvar original = self.setup;\n\t\t\t\t\treturn function() {\n\t\t\t\t\t\t// override the item rendering method to add the button to each\n\t\t\t\t\t\tif (options.append) {\n\t\t\t\t\t\t\tvar render_item = self.settings.render.item;\n\t\t\t\t\t\t\tself.settings.render.item = function(data) {\n\t\t\t\t\t\t\t\treturn append(render_item.apply(thisRef, arguments), html);\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\toriginal.apply(thisRef, arguments);\n\t\n\t\t\t\t\t\t// add event listener\n\t\t\t\t\t\tthisRef.$control.on('click', '.' + options.className, function(e) {\n\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\tif (self.isLocked) return;\n\t\n\t\t\t\t\t\t\tvar $item = $(e.currentTarget).parent();\n\t\t\t\t\t\t\tself.setActiveItem($item);\n\t\t\t\t\t\t\tif (self.deleteSelection()) {\n\t\t\t\t\t\t\t\tself.setCaret(self.items.length);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\n\t\t\t\t\t};\n\t\t\t\t})();\n\t\t\t};\n\t\n\t\t\tif (this.settings.mode === 'single') {\n\t\t\t\tsingleClose(this, options);\n\t\t\t\treturn;\n\t\t\t} else {\n\t\t\t\tmultiClose(this, options);\n\t\t\t}\n\t});\n\t\n\t\n\tSelectize.define('restore_on_backspace', function(options) {\n\t\tvar self = this;\n\t\n\t\toptions.text = options.text || function(option) {\n\t\t\treturn option[this.settings.labelField];\n\t\t};\n\t\n\t\tthis.onKeyDown = (function() {\n\t\t\tvar original = self.onKeyDown;\n\t\t\treturn function(e) {\n\t\t\t\tvar index, option;\n\t\t\t\tif (e.keyCode === KEY_BACKSPACE && this.$control_input.val() === '' && !this.$activeItems.length) {\n\t\t\t\t\tindex = this.caretPos - 1;\n\t\t\t\t\tif (index >= 0 && index < this.items.length) {\n\t\t\t\t\t\toption = this.options[this.items[index]];\n\t\t\t\t\t\tif (this.deleteSelection(e)) {\n\t\t\t\t\t\t\tthis.setTextboxValue(options.text.apply(this, [option]));\n\t\t\t\t\t\t\tthis.refreshOptions(true);\n\t\t\t\t\t\t}\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn original.apply(this, arguments);\n\t\t\t};\n\t\t})();\n\t});\n\t\n\n\treturn Selectize;\n}));","/**\n * sifter.js\n * Copyright (c) 2013 Brian Reavis & contributors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this\n * file except in compliance with the License. You may obtain a copy of the License at:\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software distributed under\n * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF\n * ANY KIND, either express or implied. See the License for the specific language\n * governing permissions and limitations under the License.\n *\n * @author Brian Reavis <brian@thirdroute.com>\n */\n\n(function(root, factory) {\n\tif (typeof define === 'function' && define.amd) {\n\t\tdefine(factory);\n\t} else if (typeof exports === 'object') {\n\t\tmodule.exports = factory();\n\t} else {\n\t\troot.Sifter = factory();\n\t}\n}(this, function() {\n\n\t/**\n\t * Textually searches arrays and hashes of objects\n\t * by property (or multiple properties). Designed\n\t * specifically for autocomplete.\n\t *\n\t * @constructor\n\t * @param {array|object} items\n\t * @param {object} items\n\t */\n\tvar Sifter = function(items, settings) {\n\t\tthis.items = items;\n\t\tthis.settings = settings || {diacritics: true};\n\t};\n\n\t/**\n\t * Splits a search string into an array of individual\n\t * regexps to be used to match results.\n\t *\n\t * @param {string} query\n\t * @returns {array}\n\t */\n\tSifter.prototype.tokenize = function(query) {\n\t\tquery = trim(String(query || '').toLowerCase());\n\t\tif (!query || !query.length) return [];\n\n\t\tvar i, n, regex, letter;\n\t\tvar tokens = [];\n\t\tvar words = query.split(/ +/);\n\n\t\tfor (i = 0, n = words.length; i < n; i++) {\n\t\t\tregex = escape_regex(words[i]);\n\t\t\tif (this.settings.diacritics) {\n\t\t\t\tfor (letter in DIACRITICS) {\n\t\t\t\t\tif (DIACRITICS.hasOwnProperty(letter)) {\n\t\t\t\t\t\tregex = regex.replace(new RegExp(letter, 'g'), DIACRITICS[letter]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\ttokens.push({\n\t\t\t\tstring : words[i],\n\t\t\t\tregex  : new RegExp(regex, 'i')\n\t\t\t});\n\t\t}\n\n\t\treturn tokens;\n\t};\n\n\t/**\n\t * Iterates over arrays and hashes.\n\t *\n\t * ```\n\t * this.iterator(this.items, function(item, id) {\n\t *    // invoked for each item\n\t * });\n\t * ```\n\t *\n\t * @param {array|object} object\n\t */\n\tSifter.prototype.iterator = function(object, callback) {\n\t\tvar iterator;\n\t\tif (is_array(object)) {\n\t\t\titerator = Array.prototype.forEach || function(callback) {\n\t\t\t\tfor (var i = 0, n = this.length; i < n; i++) {\n\t\t\t\t\tcallback(this[i], i, this);\n\t\t\t\t}\n\t\t\t};\n\t\t} else {\n\t\t\titerator = function(callback) {\n\t\t\t\tfor (var key in this) {\n\t\t\t\t\tif (this.hasOwnProperty(key)) {\n\t\t\t\t\t\tcallback(this[key], key, this);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\n\t\titerator.apply(object, [callback]);\n\t};\n\n\t/**\n\t * Returns a function to be used to score individual results.\n\t *\n\t * Good matches will have a higher score than poor matches.\n\t * If an item is not a match, 0 will be returned by the function.\n\t *\n\t * @param {object|string} search\n\t * @param {object} options (optional)\n\t * @returns {function}\n\t */\n\tSifter.prototype.getScoreFunction = function(search, options) {\n\t\tvar self, fields, tokens, token_count, nesting;\n\n\t\tself        = this;\n\t\tsearch      = self.prepareSearch(search, options);\n\t\ttokens      = search.tokens;\n\t\tfields      = search.options.fields;\n\t\ttoken_count = tokens.length;\n\t\tnesting     = search.options.nesting;\n\n\t\t/**\n\t\t * Calculates how close of a match the\n\t\t * given value is against a search token.\n\t\t *\n\t\t * @param {mixed} value\n\t\t * @param {object} token\n\t\t * @return {number}\n\t\t */\n\t\tvar scoreValue = function(value, token) {\n\t\t\tvar score, pos;\n\n\t\t\tif (!value) return 0;\n\t\t\tvalue = String(value || '');\n\t\t\tpos = value.search(token.regex);\n\t\t\tif (pos === -1) return 0;\n\t\t\tscore = token.string.length / value.length;\n\t\t\tif (pos === 0) score += 0.5;\n\t\t\treturn score;\n\t\t};\n\n\t\t/**\n\t\t * Calculates the score of an object\n\t\t * against the search query.\n\t\t *\n\t\t * @param {object} token\n\t\t * @param {object} data\n\t\t * @return {number}\n\t\t */\n\t\tvar scoreObject = (function() {\n\t\t\tvar field_count = fields.length;\n\t\t\tif (!field_count) {\n\t\t\t\treturn function() { return 0; };\n\t\t\t}\n\t\t\tif (field_count === 1) {\n\t\t\t\treturn function(token, data) {\n\t\t\t\t\treturn scoreValue(getattr(data, fields[0], nesting), token);\n\t\t\t\t};\n\t\t\t}\n\t\t\treturn function(token, data) {\n\t\t\t\tfor (var i = 0, sum = 0; i < field_count; i++) {\n\t\t\t\t\tsum += scoreValue(getattr(data, fields[i], nesting), token);\n\t\t\t\t}\n\t\t\t\treturn sum / field_count;\n\t\t\t};\n\t\t})();\n\n\t\tif (!token_count) {\n\t\t\treturn function() { return 0; };\n\t\t}\n\t\tif (token_count === 1) {\n\t\t\treturn function(data) {\n\t\t\t\treturn scoreObject(tokens[0], data);\n\t\t\t};\n\t\t}\n\n\t\tif (search.options.conjunction === 'and') {\n\t\t\treturn function(data) {\n\t\t\t\tvar score;\n\t\t\t\tfor (var i = 0, sum = 0; i < token_count; i++) {\n\t\t\t\t\tscore = scoreObject(tokens[i], data);\n\t\t\t\t\tif (score <= 0) return 0;\n\t\t\t\t\tsum += score;\n\t\t\t\t}\n\t\t\t\treturn sum / token_count;\n\t\t\t};\n\t\t} else {\n\t\t\treturn function(data) {\n\t\t\t\tfor (var i = 0, sum = 0; i < token_count; i++) {\n\t\t\t\t\tsum += scoreObject(tokens[i], data);\n\t\t\t\t}\n\t\t\t\treturn sum / token_count;\n\t\t\t};\n\t\t}\n\t};\n\n\t/**\n\t * Returns a function that can be used to compare two\n\t * results, for sorting purposes. If no sorting should\n\t * be performed, `null` will be returned.\n\t *\n\t * @param {string|object} search\n\t * @param {object} options\n\t * @return function(a,b)\n\t */\n\tSifter.prototype.getSortFunction = function(search, options) {\n\t\tvar i, n, self, field, fields, fields_count, multiplier, multipliers, get_field, implicit_score, sort;\n\n\t\tself   = this;\n\t\tsearch = self.prepareSearch(search, options);\n\t\tsort   = (!search.query && options.sort_empty) || options.sort;\n\n\t\t/**\n\t\t * Fetches the specified sort field value\n\t\t * from a search result item.\n\t\t *\n\t\t * @param  {string} name\n\t\t * @param  {object} result\n\t\t * @return {mixed}\n\t\t */\n\t\tget_field = function(name, result) {\n\t\t\tif (name === '$score') return result.score;\n\t\t\treturn getattr(self.items[result.id], name, options.nesting);\n\t\t};\n\n\t\t// parse options\n\t\tfields = [];\n\t\tif (sort) {\n\t\t\tfor (i = 0, n = sort.length; i < n; i++) {\n\t\t\t\tif (search.query || sort[i].field !== '$score') {\n\t\t\t\t\tfields.push(sort[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// the \"$score\" field is implied to be the primary\n\t\t// sort field, unless it's manually specified\n\t\tif (search.query) {\n\t\t\timplicit_score = true;\n\t\t\tfor (i = 0, n = fields.length; i < n; i++) {\n\t\t\t\tif (fields[i].field === '$score') {\n\t\t\t\t\timplicit_score = false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (implicit_score) {\n\t\t\t\tfields.unshift({field: '$score', direction: 'desc'});\n\t\t\t}\n\t\t} else {\n\t\t\tfor (i = 0, n = fields.length; i < n; i++) {\n\t\t\t\tif (fields[i].field === '$score') {\n\t\t\t\t\tfields.splice(i, 1);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tmultipliers = [];\n\t\tfor (i = 0, n = fields.length; i < n; i++) {\n\t\t\tmultipliers.push(fields[i].direction === 'desc' ? -1 : 1);\n\t\t}\n\n\t\t// build function\n\t\tfields_count = fields.length;\n\t\tif (!fields_count) {\n\t\t\treturn null;\n\t\t} else if (fields_count === 1) {\n\t\t\tfield = fields[0].field;\n\t\t\tmultiplier = multipliers[0];\n\t\t\treturn function(a, b) {\n\t\t\t\treturn multiplier * cmp(\n\t\t\t\t\tget_field(field, a),\n\t\t\t\t\tget_field(field, b)\n\t\t\t\t);\n\t\t\t};\n\t\t} else {\n\t\t\treturn function(a, b) {\n\t\t\t\tvar i, result, a_value, b_value, field;\n\t\t\t\tfor (i = 0; i < fields_count; i++) {\n\t\t\t\t\tfield = fields[i].field;\n\t\t\t\t\tresult = multipliers[i] * cmp(\n\t\t\t\t\t\tget_field(field, a),\n\t\t\t\t\t\tget_field(field, b)\n\t\t\t\t\t);\n\t\t\t\t\tif (result) return result;\n\t\t\t\t}\n\t\t\t\treturn 0;\n\t\t\t};\n\t\t}\n\t};\n\n\t/**\n\t * Parses a search query and returns an object\n\t * with tokens and fields ready to be populated\n\t * with results.\n\t *\n\t * @param {string} query\n\t * @param {object} options\n\t * @returns {object}\n\t */\n\tSifter.prototype.prepareSearch = function(query, options) {\n\t\tif (typeof query === 'object') return query;\n\n\t\toptions = extend({}, options);\n\n\t\tvar option_fields     = options.fields;\n\t\tvar option_sort       = options.sort;\n\t\tvar option_sort_empty = options.sort_empty;\n\n\t\tif (option_fields && !is_array(option_fields)) options.fields = [option_fields];\n\t\tif (option_sort && !is_array(option_sort)) options.sort = [option_sort];\n\t\tif (option_sort_empty && !is_array(option_sort_empty)) options.sort_empty = [option_sort_empty];\n\n\t\treturn {\n\t\t\toptions : options,\n\t\t\tquery   : String(query || '').toLowerCase(),\n\t\t\ttokens  : this.tokenize(query),\n\t\t\ttotal   : 0,\n\t\t\titems   : []\n\t\t};\n\t};\n\n\t/**\n\t * Searches through all items and returns a sorted array of matches.\n\t *\n\t * The `options` parameter can contain:\n\t *\n\t *   - fields {string|array}\n\t *   - sort {array}\n\t *   - score {function}\n\t *   - filter {bool}\n\t *   - limit {integer}\n\t *\n\t * Returns an object containing:\n\t *\n\t *   - options {object}\n\t *   - query {string}\n\t *   - tokens {array}\n\t *   - total {int}\n\t *   - items {array}\n\t *\n\t * @param {string} query\n\t * @param {object} options\n\t * @returns {object}\n\t */\n\tSifter.prototype.search = function(query, options) {\n\t\tvar self = this, value, score, search, calculateScore;\n\t\tvar fn_sort;\n\t\tvar fn_score;\n\n\t\tsearch  = this.prepareSearch(query, options);\n\t\toptions = search.options;\n\t\tquery   = search.query;\n\n\t\t// generate result scoring function\n\t\tfn_score = options.score || self.getScoreFunction(search);\n\n\t\t// perform search and sort\n\t\tif (query.length) {\n\t\t\tself.iterator(self.items, function(item, id) {\n\t\t\t\tscore = fn_score(item);\n\t\t\t\tif (options.filter === false || score > 0) {\n\t\t\t\t\tsearch.items.push({'score': score, 'id': id});\n\t\t\t\t}\n\t\t\t});\n\t\t} else {\n\t\t\tself.iterator(self.items, function(item, id) {\n\t\t\t\tsearch.items.push({'score': 1, 'id': id});\n\t\t\t});\n\t\t}\n\n\t\tfn_sort = self.getSortFunction(search, options);\n\t\tif (fn_sort) search.items.sort(fn_sort);\n\n\t\t// apply limits\n\t\tsearch.total = search.items.length;\n\t\tif (typeof options.limit === 'number') {\n\t\t\tsearch.items = search.items.slice(0, options.limit);\n\t\t}\n\n\t\treturn search;\n\t};\n\n\t// utilities\n\t// - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\n\n\tvar cmp = function(a, b) {\n\t\tif (typeof a === 'number' && typeof b === 'number') {\n\t\t\treturn a > b ? 1 : (a < b ? -1 : 0);\n\t\t}\n\t\ta = asciifold(String(a || ''));\n\t\tb = asciifold(String(b || ''));\n\t\tif (a > b) return 1;\n\t\tif (b > a) return -1;\n\t\treturn 0;\n\t};\n\n\tvar extend = function(a, b) {\n\t\tvar i, n, k, object;\n\t\tfor (i = 1, n = arguments.length; i < n; i++) {\n\t\t\tobject = arguments[i];\n\t\t\tif (!object) continue;\n\t\t\tfor (k in object) {\n\t\t\t\tif (object.hasOwnProperty(k)) {\n\t\t\t\t\ta[k] = object[k];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn a;\n\t};\n\n\t/**\n\t * A property getter resolving dot-notation\n\t * @param  {Object}  obj     The root object to fetch property on\n\t * @param  {String}  name    The optionally dotted property name to fetch\n\t * @param  {Boolean} nesting Handle nesting or not\n\t * @return {Object}          The resolved property value\n\t */\n\tvar getattr = function(obj, name, nesting) {\n\t    if (!obj || !name) return;\n\t    if (!nesting) return obj[name];\n\t    var names = name.split(\".\");\n\t    while(names.length && (obj = obj[names.shift()]));\n\t    return obj;\n\t};\n\n\tvar trim = function(str) {\n\t\treturn (str + '').replace(/^\\s+|\\s+$|/g, '');\n\t};\n\n\tvar escape_regex = function(str) {\n\t\treturn (str + '').replace(/([.?*+^$[\\]\\\\(){}|-])/g, '\\\\$1');\n\t};\n\n\tvar is_array = Array.isArray || (typeof $ !== 'undefined' && $.isArray) || function(object) {\n\t\treturn Object.prototype.toString.call(object) === '[object Array]';\n\t};\n\n\tvar DIACRITICS = {\n\t\t'a': '[a]',\n\t\t'b': '[bB]',\n\t\t'c': '[cCc]',\n\t\t'd': '[dDd]',\n\t\t'e': '[e]',\n\t\t'f': '[f]',\n\t\t'g': '[g]',\n\t\t'h': '[h]',\n\t\t'i': '[iiI]',\n\t\t'j': '[j]',\n\t\t'k': '[k]',\n\t\t'l': '[l]',\n\t\t'n': '[nNn]',\n\t\t'o': '[o]',\n\t\t'p': '[p]',\n\t\t'q': '[qq]',\n\t\t'r': '[r]',\n\t\t's': '[sSs]',\n\t\t't': '[t]',\n\t\t'u': '[u]',\n\t\t'v': '[v]',\n\t\t'w': '[w]',\n\t\t'x': '[x]',\n\t\t'y': '[y]',\n\t\t'z': '[z]'\n\t};\n\n\tvar asciifold = (function() {\n\t\tvar i, n, k, chunk;\n\t\tvar foreignletters = '';\n\t\tvar lookup = {};\n\t\tfor (k in DIACRITICS) {\n\t\t\tif (DIACRITICS.hasOwnProperty(k)) {\n\t\t\t\tchunk = DIACRITICS[k].substring(2, DIACRITICS[k].length - 1);\n\t\t\t\tforeignletters += chunk;\n\t\t\t\tfor (i = 0, n = chunk.length; i < n; i++) {\n\t\t\t\t\tlookup[chunk.charAt(i)] = k;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tvar regexp = new RegExp('[' +  foreignletters + ']', 'g');\n\t\treturn function(str) {\n\t\t\treturn str.replace(regexp, function(foreignletter) {\n\t\t\t\treturn lookup[foreignletter];\n\t\t\t}).toLowerCase();\n\t\t};\n\t})();\n\n\n\t// export\n\t// - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\n\n\treturn Sifter;\n}));\n\n"],"sourceRoot":""}