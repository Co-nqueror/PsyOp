(self["webpackChunk_jupyterlab_application_top"]=self["webpackChunk_jupyterlab_application_top"]||[]).push([[863],{96453:(t,e,n)=>{"use strict";n.d(e,{WU:()=>v,jH:()=>x});var i=n(33085);function r(t,e){return function(n,i){var r=n.length,a=[],o=0,u=t[0],s=0;while(r>0&&u>0){if(s+u+1>i)u=Math.max(1,i-s);a.push(n.substring(r-=u,r+u));if((s+=u+1)>i)break;u=t[o=(o+1)%t.length]}return a.reverse().join(e)}}function a(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}var o=n(46196);function u(t){t:for(var e=t.length,n=1,i=-1,r;n<e;++n){switch(t[n]){case".":i=r=n;break;case"0":if(i===0)i=n;r=n;break;default:if(!+t[n])break t;if(i>0)i=0;break}}return i>0?t.slice(0,i)+t.slice(r+1):t}var s=n(38885);var l;function f(t,e){var n=(0,s.V)(t,e);if(!n)return t+"";var i=n[0],r=n[1],a=r-(l=Math.max(-8,Math.min(8,Math.floor(r/3)))*3)+1,o=i.length;return a===o?i:a>o?i+new Array(a-o+1).join("0"):a>0?i.slice(0,a)+"."+i.slice(a):"0."+new Array(1-a).join("0")+(0,s.V)(t,Math.max(0,e+a-1))[0]}function c(t,e){var n=(0,s.V)(t,e);if(!n)return t+"";var i=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}const h={"%":function(t,e){return(t*100).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:s.Z,e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return c(t*100,e)},r:c,s:f,X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}};function d(t){return t}var p=Array.prototype.map,g=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function m(t){var e=t.grouping===undefined||t.thousands===undefined?d:r(p.call(t.grouping,Number),t.thousands+""),n=t.currency===undefined?"":t.currency[0]+"",s=t.currency===undefined?"":t.currency[1]+"",f=t.decimal===undefined?".":t.decimal+"",c=t.numerals===undefined?d:a(p.call(t.numerals,String)),m=t.percent===undefined?"%":t.percent+"",y=t.minus===undefined?"-":t.minus+"",v=t.nan===undefined?"NaN":t.nan+"";function x(t){t=(0,o.Z)(t);var i=t.fill,r=t.align,a=t.sign,d=t.symbol,p=t.zero,x=t.width,_=t.comma,b=t.precision,w=t.trim,k=t.type;if(k==="n")_=true,k="g";else if(!h[k])b===undefined&&(b=12),w=true,k="g";if(p||i==="0"&&r==="=")p=true,i="0",r="=";var M=d==="$"?n:d==="#"&&/[boxX]/.test(k)?"0"+k.toLowerCase():"",A=d==="$"?s:/[%p]/.test(k)?m:"";var E=h[k],D=/[defgprs%]/.test(k);b=b===undefined?6:/[gprs]/.test(k)?Math.max(1,Math.min(21,b)):Math.max(0,Math.min(20,b));function C(t){var n=M,o=A,s,h,d;if(k==="c"){o=E(t)+o;t=""}else{t=+t;var m=t<0||1/t<0;t=isNaN(t)?v:E(Math.abs(t),b);if(w)t=u(t);if(m&&+t===0&&a!=="+")m=false;n=(m?a==="("?a:y:a==="-"||a==="("?"":a)+n;o=(k==="s"?g[8+l/3]:"")+o+(m&&a==="("?")":"");if(D){s=-1,h=t.length;while(++s<h){if(d=t.charCodeAt(s),48>d||d>57){o=(d===46?f+t.slice(s+1):t.slice(s))+o;t=t.slice(0,s);break}}}}if(_&&!p)t=e(t,Infinity);var C=n.length+t.length+o.length,F=C<x?new Array(x-C+1).join(i):"";if(_&&p)t=e(F+t,F.length?x-o.length:Infinity),F="";switch(r){case"<":t=n+t+o+F;break;case"=":t=n+F+t+o;break;case"^":t=F.slice(0,C=F.length>>1)+n+t+o+F.slice(C);break;default:t=F+n+t+o;break}return c(t)}C.toString=function(){return t+""};return C}function _(t,e){var n=x((t=(0,o.Z)(t),t.type="f",t)),r=Math.max(-8,Math.min(8,Math.floor((0,i.Z)(e)/3)))*3,a=Math.pow(10,-r),u=g[8+r/3];return function(t){return n(a*t)+u}}return{format:x,formatPrefix:_}}var y;var v;var x;_({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});function _(t){y=m(t);v=y.format;x=y.formatPrefix;return y}},33085:(t,e,n)=>{"use strict";n.d(e,{Z:()=>r});var i=n(38885);function r(t){return t=(0,i.V)(Math.abs(t)),t?t[1]:NaN}},38885:(t,e,n)=>{"use strict";n.d(e,{Z:()=>i,V:()=>r});function i(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function r(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,i=t.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+t.slice(n+1)]}},46196:(t,e,n)=>{"use strict";n.d(e,{Z:()=>r});var i=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function r(t){if(!(e=i.exec(t)))throw new Error("invalid format: "+t);var e;return new a({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}r.prototype=a.prototype;function a(t){this.fill=t.fill===undefined?" ":t.fill+"";this.align=t.align===undefined?">":t.align+"";this.sign=t.sign===undefined?"-":t.sign+"";this.symbol=t.symbol===undefined?"":t.symbol+"";this.zero=!!t.zero;this.width=t.width===undefined?undefined:+t.width;this.comma=!!t.comma;this.precision=t.precision===undefined?undefined:+t.precision;this.trim=!!t.trim;this.type=t.type===undefined?"":t.type+""}a.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===undefined?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===undefined?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type}},48823:(t,e,n)=>{"use strict";n.d(e,{cG:()=>k,jj:()=>_,kI:()=>w,Hq:()=>x,uU:()=>b,ZE:()=>i,Oj:()=>a,el:()=>r,IX:()=>G,j2:()=>et,l$:()=>K,qu:()=>tt,a9:()=>at,Ds:()=>ot,vU:()=>l,l7:()=>ut,We:()=>st,dI:()=>lt,k:()=>y,Xr:()=>dt,EP:()=>c,yl:()=>pt,nr:()=>ct,id:()=>h,yR:()=>d,XW:()=>gt,u5:()=>mt,kJ:()=>A,jn:()=>yt,J_:()=>vt,mf:()=>Z,TW:()=>xt,hj:()=>_t,Kn:()=>E,Kj:()=>bt,HD:()=>wt,Jy:()=>kt,t7:()=>Mt,kg:()=>M,$m:()=>Et,TS:()=>Dt,fE:()=>C,kX:()=>g,vk:()=>Ft,Dw:()=>P,mJ:()=>q,QA:()=>I,Zw:()=>L,fj:()=>T,mS:()=>J,rx:()=>Ct,yP:()=>St,_k:()=>f,m8:()=>Tt,sw:()=>Bt,ZU:()=>zt,He:()=>B,Rg:()=>Rt,BB:()=>Ot,$G:()=>Ut,yb:()=>m,N3:()=>V,FP:()=>$t,iL:()=>F,bM:()=>p,ay:()=>W,dH:()=>X,mK:()=>H,bV:()=>Y});function i(t,e,n){t.fields=e||[];t.fname=n;return t}function r(t){return t==null?null:t.fname}function a(t){return t==null?null:t.fields}function o(t){return t.length===1?u(t[0]):s(t)}const u=t=>function(e){return e[t]};const s=t=>{const e=t.length;return function(n){for(let i=0;i<e;++i){n=n[t[i]]}return n}};function l(t){throw Error(t)}function f(t){const e=[],n=t.length;let i=null,r=0,a="",o,u,s;t=t+"";function f(){e.push(a+t.substring(o,u));a="";o=u+1}for(o=u=0;u<n;++u){s=t[u];if(s==="\\"){a+=t.substring(o,u);a+=t.substring(++u,++u);o=u}else if(s===i){f();i=null;r=-1}else if(i){continue}else if(o===r&&s==='"'){o=u+1;i=s}else if(o===r&&s==="'"){o=u+1;i=s}else if(s==="."&&!r){if(u>o){f()}else{o=u+1}}else if(s==="["){if(u>o)f();r=o=u+1}else if(s==="]"){if(!r)l("Access path missing open bracket: "+t);if(r>0)f();r=0;o=u+1}}if(r)l("Access path missing closing bracket: "+t);if(i)l("Access path missing closing quote: "+t);if(u>o){u++;f()}return e}function c(t,e,n){const r=f(t);t=r.length===1?r[0]:t;return i((n&&n.get||o)(r),[t],e||t)}const h=c("id");const d=i((t=>t),[],"identity");const p=i((()=>0),[],"zero");const g=i((()=>1),[],"one");const m=i((()=>true),[],"true");const y=i((()=>false),[],"false");function v(t,e,n){const i=[e].concat([].slice.call(n));console[t].apply(console,i)}const x=0;const _=1;const b=2;const w=3;const k=4;function M(t,e,n=v){let i=t||x;return{level(t){if(arguments.length){i=+t;return this}else{return i}},error(){if(i>=_)n(e||"error","ERROR",arguments);return this},warn(){if(i>=b)n(e||"warn","WARN",arguments);return this},info(){if(i>=w)n(e||"log","INFO",arguments);return this},debug(){if(i>=k)n(e||"log","DEBUG",arguments);return this}}}var A=Array.isArray;function E(t){return t===Object(t)}const D=t=>t!=="__proto__";function C(...t){return t.reduce(((t,e)=>{for(const n in e){if(n==="signals"){t.signals=S(t.signals,e.signals)}else{const i=n==="legend"?{layout:1}:n==="style"?true:null;F(t,n,e[n],i)}}return t}),{})}function F(t,e,n,i){if(!D(e))return;let r,a;if(E(n)&&!A(n)){a=E(t[e])?t[e]:t[e]={};for(r in n){if(i&&(i===true||i[r])){F(a,r,n[r])}else if(D(r)){a[r]=n[r]}}}else{t[e]=n}}function S(t,e){if(t==null)return e;const n={},i=[];function r(t){if(!n[t.name]){n[t.name]=1;i.push(t)}}e.forEach(r);t.forEach(r);return i}function T(t){return t[t.length-1]}function B(t){return t==null||t===""?null:+t}const N=t=>e=>t*Math.exp(e);const z=t=>e=>Math.log(t*e);const O=t=>e=>Math.sign(e)*Math.log1p(Math.abs(e/t));const R=t=>e=>Math.sign(e)*Math.expm1(Math.abs(e))*t;const U=t=>e=>e<0?-Math.pow(-e,t):Math.pow(e,t);function $(t,e,n,i){const r=n(t[0]),a=n(T(t)),o=(a-r)*e;return[i(r-o),i(a-o)]}function P(t,e){return $(t,e,B,d)}function q(t,e){var n=Math.sign(t[0]);return $(t,e,z(n),N(n))}function I(t,e,n){return $(t,e,U(n),U(1/n))}function L(t,e,n){return $(t,e,O(n),R(n))}function j(t,e,n,i,r){const a=i(t[0]),o=i(T(t)),u=e!=null?i(e):(a+o)/2;return[r(u+(a-u)*n),r(u+(o-u)*n)]}function W(t,e,n){return j(t,e,n,B,d)}function X(t,e,n){const i=Math.sign(t[0]);return j(t,e,n,z(i),N(i))}function H(t,e,n,i){return j(t,e,n,U(i),U(1/i))}function Y(t,e,n,i){return j(t,e,n,O(i),R(i))}function J(t){return 1+~~(new Date(t).getMonth()/3)}function V(t){return 1+~~(new Date(t).getUTCMonth()/3)}function G(t){return t!=null?A(t)?t:[t]:[]}function K(t,e,n){let i=t[0],r=t[1],a;if(r<i){a=r;r=i;i=a}a=r-i;return a>=n-e?[e,n]:[i=Math.min(Math.max(i,e),n-a),i+a]}function Z(t){return typeof t==="function"}const Q="descending";function tt(t,e,n){n=n||{};e=G(e)||[];const r=[],o=[],u={},s=n.comparator||nt;G(t).forEach(((t,i)=>{if(t==null)return;r.push(e[i]===Q?-1:1);o.push(t=Z(t)?t:c(t,null,n));(a(t)||[]).forEach((t=>u[t]=1))}));return o.length===0?null:i(s(o,r),Object.keys(u))}const et=(t,e)=>(t<e||t==null)&&e!=null?-1:(t>e||e==null)&&t!=null?1:(e=e instanceof Date?+e:e,t=t instanceof Date?+t:t)!==t&&e===e?-1:e!==e&&t===t?1:0;const nt=(t,e)=>t.length===1?it(t[0],e[0]):rt(t,e,t.length);const it=(t,e)=>function(n,i){return et(t(n),t(i))*e};const rt=(t,e,n)=>{e.push(0);return function(i,r){let a,o=0,u=-1;while(o===0&&++u<n){a=t[u];o=et(a(i),a(r))}return o*e[u]}};function at(t){return Z(t)?t:()=>t}function ot(t,e){let n;return i=>{if(n)clearTimeout(n);n=setTimeout((()=>(e(i),n=null)),t)}}function ut(t){for(let e,n,i=1,r=arguments.length;i<r;++i){e=arguments[i];for(n in e){t[n]=e[n]}}return t}function st(t,e){let n=0,i,r,a,o;if(t&&(i=t.length)){if(e==null){for(r=t[n];n<i&&(r==null||r!==r);r=t[++n]);a=o=r;for(;n<i;++n){r=t[n];if(r!=null){if(r<a)a=r;if(r>o)o=r}}}else{for(r=e(t[n]);n<i&&(r==null||r!==r);r=e(t[++n]));a=o=r;for(;n<i;++n){r=e(t[n]);if(r!=null){if(r<a)a=r;if(r>o)o=r}}}}return[a,o]}function lt(t,e){const n=t.length;let i=-1,r,a,o,u,s;if(e==null){while(++i<n){a=t[i];if(a!=null&&a>=a){r=o=a;break}}if(i===n)return[-1,-1];u=s=i;while(++i<n){a=t[i];if(a!=null){if(r>a){r=a;u=i}if(o<a){o=a;s=i}}}}else{while(++i<n){a=e(t[i],i,t);if(a!=null&&a>=a){r=o=a;break}}if(i===n)return[-1,-1];u=s=i;while(++i<n){a=e(t[i],i,t);if(a!=null){if(r>a){r=a;u=i}if(o<a){o=a;s=i}}}}return[u,s]}const ft=Object.prototype.hasOwnProperty;function ct(t,e){return ft.call(t,e)}const ht={};function dt(t){let e={},n;function i(t){return ct(e,t)&&e[t]!==ht}const r={size:0,empty:0,object:e,has:i,get(t){return i(t)?e[t]:undefined},set(t,n){if(!i(t)){++r.size;if(e[t]===ht)--r.empty}e[t]=n;return this},delete(t){if(i(t)){--r.size;++r.empty;e[t]=ht}return this},clear(){r.size=r.empty=0;r.object=e={}},test(t){if(arguments.length){n=t;return r}else{return n}},clean(){const t={};let i=0;for(const r in e){const a=e[r];if(a!==ht&&(!n||!n(a))){t[r]=a;++i}}r.size=i;r.empty=0;r.object=e=t}};if(t)Object.keys(t).forEach((e=>{r.set(e,t[e])}));return r}function pt(t,e,n,i,r,a){if(!n&&n!==0)return a;const o=+n;let u=t[0],s=T(t),l;if(s<u){l=u;u=s;s=l}l=Math.abs(e-u);const f=Math.abs(s-e);return l<f&&l<=o?i:f<=o?r:a}function gt(t,e,n){const i=t.prototype=Object.create(e.prototype);Object.defineProperty(i,"constructor",{value:t,writable:true,enumerable:true,configurable:true});return ut(i,n)}function mt(t,e,n,i){let r=e[0],a=e[e.length-1],o;if(r>a){o=r;r=a;a=o}n=n===undefined||n;i=i===undefined||i;return(n?r<=t:r<t)&&(i?t<=a:t<a)}function yt(t){return typeof t==="boolean"}function vt(t){return Object.prototype.toString.call(t)==="[object Date]"}function xt(t){return t&&Z(t[Symbol.iterator])}function _t(t){return typeof t==="number"}function bt(t){return Object.prototype.toString.call(t)==="[object RegExp]"}function wt(t){return typeof t==="string"}function kt(t,e,n){if(t){t=e?G(t).map((t=>t.replace(/\\(.)/g,"$1"))):G(t)}const r=t&&t.length,a=n&&n.get||o,u=t=>a(e?[t]:f(t));let s;if(!r){s=function(){return""}}else if(r===1){const e=u(t[0]);s=function(t){return""+e(t)}}else{const e=t.map(u);s=function(t){let n=""+e[0](t),i=0;while(++i<r)n+="|"+e[i](t);return n}}return i(s,t,"key")}function Mt(t,e){const n=t[0],i=T(t),r=+e;return!r?n:r===1?i:n+r*(i-n)}const At=1e4;function Et(t){t=+t||At;let e,n,i;const r=()=>{e={};n={};i=0};const a=(r,a)=>{if(++i>t){n=e;e={};i=1}return e[r]=a};r();return{clear:r,has:t=>ct(e,t)||ct(n,t),get:t=>ct(e,t)?e[t]:ct(n,t)?a(t,n[t]):undefined,set:(t,n)=>ct(e,t)?e[t]=n:a(t,n)}}function Dt(t,e,n,i){const r=e.length,a=n.length;if(!a)return e;if(!r)return n;const o=i||new e.constructor(r+a);let u=0,s=0,l=0;for(;u<r&&s<a;++l){o[l]=t(e[u],n[s])>0?n[s++]:e[u++]}for(;u<r;++u,++l){o[l]=e[u]}for(;s<a;++s,++l){o[l]=n[s]}return o}function Ct(t,e){let n="";while(--e>=0)n+=t;return n}function Ft(t,e,n,i){const r=n||" ",a=t+"",o=e-a.length;return o<=0?a:i==="left"?Ct(r,o)+a:i==="center"?Ct(r,~~(o/2))+a+Ct(r,Math.ceil(o/2)):a+Ct(r,o)}function St(t){return t&&T(t)-t[0]||0}function Tt(t){return A(t)?"["+t.map(Tt)+"]":E(t)||wt(t)?JSON.stringify(t).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):t}function Bt(t){return t==null||t===""?null:!t||t==="false"||t==="0"?false:!!t}const Nt=t=>_t(t)?t:vt(t)?t:Date.parse(t);function zt(t,e){e=e||Nt;return t==null||t===""?null:e(t)}function Ot(t){return t==null||t===""?null:t+""}function Rt(t){const e={},n=t.length;for(let i=0;i<n;++i)e[t[i]]=true;return e}function Ut(t,e,n,i){const r=i!=null?i:"…",a=t+"",o=a.length,u=Math.max(0,e-r.length);return o<=e?a:n==="left"?r+a.slice(o-u):n==="center"?a.slice(0,Math.ceil(u/2))+r+a.slice(o-~~(u/2)):a.slice(0,u)+r}function $t(t,e,n){if(t){if(e){const i=t.length;for(let r=0;r<i;++r){const i=e(t[r]);if(i)n(i,r,t)}}else{t.forEach(n)}}}},30863:(t,e,n)=>{"use strict";n.r(e);n.d(e,{Bounds:()=>Rv,CanvasHandler:()=>nw,CanvasRenderer:()=>cw,DATE:()=>je,DAY:()=>We,DAYOFYEAR:()=>Xe,Dataflow:()=>Lo,Debug:()=>g.cG,Error:()=>g.jj,EventStream:()=>Va,Gradient:()=>yy,GroupItem:()=>$v,HOURS:()=>He,Handler:()=>Tb,Info:()=>g.kI,Item:()=>Uv,MILLISECONDS:()=>Ve,MINUTES:()=>Ye,MONTH:()=>Ie,Marks:()=>pb,MultiPulse:()=>Eo,None:()=>g.Hq,Operator:()=>Wa,Parameters:()=>$a,Pulse:()=>wo,QUARTER:()=>qe,RenderType:()=>mk,Renderer:()=>Nb,ResourceLoader:()=>Pv,SECONDS:()=>Je,SVGHandler:()=>gw,SVGRenderer:()=>Yw,SVGStringRenderer:()=>fk,Scenegraph:()=>wb,TIME_UNITS:()=>Ge,Transform:()=>Wo,View:()=>jY,WEEK:()=>Le,Warn:()=>g.uU,YEAR:()=>Pe,accessor:()=>g.ZE,accessorFields:()=>g.Oj,accessorName:()=>g.el,array:()=>g.IX,ascending:()=>g.j2,bandwidthNRD:()=>su,bin:()=>lu,bootstrapCI:()=>hu,boundClip:()=>Ak,boundContext:()=>ux,boundItem:()=>gb,boundMark:()=>yb,boundStroke:()=>Lv,changeset:()=>Ra,clampRange:()=>g.l$,codegenExpression:()=>UI,compare:()=>g.qu,constant:()=>g.a9,cumulativeLogNormal:()=>Fu,cumulativeNormal:()=>wu,cumulativeUniform:()=>Ou,dayofyear:()=>rn,debounce:()=>g.Ds,defaultLocale:()=>Ir,definition:()=>Ho,densityLogNormal:()=>Cu,densityNormal:()=>bu,densityUniform:()=>zu,domChild:()=>Eb,domClear:()=>Db,domCreate:()=>Mb,domFind:()=>Ab,dotbin:()=>du,error:()=>g.vU,expressionFunction:()=>$X,extend:()=>g.l7,extent:()=>g.We,extentIndex:()=>g.dI,falsy:()=>g.k,fastmap:()=>g.Xr,field:()=>g.EP,flush:()=>g.yl,font:()=>nb,fontFamily:()=>eb,fontSize:()=>Y_,format:()=>ya,formatLocale:()=>Br,formats:()=>va,hasOwnProperty:()=>g.nr,id:()=>g.id,identity:()=>g.yR,inferType:()=>sa,inferTypes:()=>la,ingest:()=>Sa,inherits:()=>g.XW,inrange:()=>g.u5,interpolate:()=>Sm,interpolateColors:()=>Em,interpolateRange:()=>Am,intersect:()=>xk,intersectBoxLine:()=>vx,intersectPath:()=>px,intersectPoint:()=>gx,intersectRule:()=>yx,isArray:()=>g.kJ,isBoolean:()=>g.jn,isDate:()=>g.J_,isFunction:()=>g.mf,isIterable:()=>g.TW,isNumber:()=>g.hj,isObject:()=>g.Kn,isRegExp:()=>g.Kj,isString:()=>g.HD,isTuple:()=>Da,key:()=>g.Jy,lerp:()=>g.t7,lineHeight:()=>J_,loader:()=>wa,locale:()=>qr,logger:()=>g.kg,lruCache:()=>g.$m,markup:()=>Pw,merge:()=>g.TS,mergeConfig:()=>g.fE,multiLineOffset:()=>K_,one:()=>g.kX,pad:()=>g.vk,panLinear:()=>g.Dw,panLog:()=>g.mJ,panPow:()=>g.QA,panSymlog:()=>g.Zw,parse:()=>SQ,parseExpression:()=>NI,parseSelector:()=>uJ,pathCurves:()=>xy,pathEqual:()=>Ck,pathParse:()=>wy,pathRectangle:()=>Vy,pathRender:()=>Oy,pathSymbols:()=>Py,pathTrail:()=>Gy,peek:()=>g.fj,point:()=>Fb,projection:()=>RB,quantileLogNormal:()=>Su,quantileNormal:()=>ku,quantileUniform:()=>Ru,quantiles:()=>ou,quantizeInterpolator:()=>Dm,quarter:()=>g.mS,quartiles:()=>uu,random:()=>fu,randomInteger:()=>mu,randomKDE:()=>Eu,randomLCG:()=>gu,randomLogNormal:()=>Tu,randomMixture:()=>Bu,randomNormal:()=>Au,randomUniform:()=>Uu,read:()=>_a,regressionExp:()=>Wu,regressionLinear:()=>Lu,regressionLoess:()=>Zu,regressionLog:()=>ju,regressionPoly:()=>Yu,regressionPow:()=>Xu,regressionQuad:()=>Hu,renderModule:()=>vk,repeat:()=>g.rx,resetDefaultLocale:()=>Lr,resetSVGClipId:()=>zv,resetSVGDefIds:()=>Sk,responseType:()=>xa,runtimeContext:()=>gH,sampleCurve:()=>is,sampleLogNormal:()=>Du,sampleNormal:()=>_u,sampleUniform:()=>Nu,scale:()=>pm,sceneEqual:()=>Dk,sceneFromJSON:()=>_b,scenePickVisit:()=>Sx,sceneToJSON:()=>xb,sceneVisit:()=>Fx,sceneZOrder:()=>Cx,scheme:()=>Um,serializeXML:()=>qw,setRandom:()=>cu,span:()=>g.yP,splitAccessPath:()=>g._k,stringValue:()=>g.m8,textMetrics:()=>I_,timeBin:()=>Kn,timeFloor:()=>bn,timeFormatLocale:()=>$r,timeInterval:()=>Dn,timeOffset:()=>Sn,timeSequence:()=>Nn,timeUnitSpecifier:()=>tn,timeUnits:()=>Ze,toBoolean:()=>g.sw,toDate:()=>g.ZU,toNumber:()=>g.He,toSet:()=>g.Rg,toString:()=>g.BB,transform:()=>Yo,transforms:()=>Xo,truncate:()=>g.$G,truthy:()=>g.yb,tupleid:()=>Ca,typeParsers:()=>aa,utcFloor:()=>Mn,utcInterval:()=>Cn,utcOffset:()=>Tn,utcSequence:()=>zn,utcdayofyear:()=>fn,utcquarter:()=>g.N3,utcweek:()=>cn,version:()=>JQ,visitArray:()=>g.FP,week:()=>an,writeConfig:()=>g.iL,zero:()=>g.bM,zoomLinear:()=>g.ay,zoomLog:()=>g.dH,zoomPow:()=>g.mK,zoomSymlog:()=>g.bV});var i={};n.r(i);n.d(i,{aggregate:()=>Es,bin:()=>Cs,collect:()=>Ss,compare:()=>Ts,countpattern:()=>Ns,cross:()=>Os,density:()=>Ls,dotbin:()=>Vs,expression:()=>Ks,extent:()=>Qs,facet:()=>el,field:()=>nl,filter:()=>rl,flatten:()=>al,fold:()=>ol,formula:()=>ul,generate:()=>sl,impute:()=>cl,joinaggregate:()=>gl,kde:()=>ml,key:()=>yl,load:()=>xl,lookup:()=>wl,multiextent:()=>kl,multivalues:()=>Al,params:()=>Dl,pivot:()=>Cl,prefacet:()=>Bl,project:()=>Nl,proxy:()=>Ol,quantile:()=>Rl,relay:()=>$l,sample:()=>Pl,sequence:()=>ql,sieve:()=>Il,subflow:()=>tl,timeunit:()=>Ll,tupleindex:()=>Wl,values:()=>Xl,window:()=>Ql});var r={};n.r(r);n.d(r,{interpolate:()=>yd,interpolateArray:()=>ud,interpolateBasis:()=>Yh,interpolateBasisClosed:()=>Jh,interpolateCubehelix:()=>Tg,interpolateCubehelixLong:()=>Bg,interpolateDate:()=>ld,interpolateDiscrete:()=>Dp,interpolateHcl:()=>yg,interpolateHclLong:()=>vg,interpolateHsl:()=>Wp,interpolateHslLong:()=>Xp,interpolateHue:()=>Cp,interpolateLab:()=>gg,interpolateNumber:()=>fd,interpolateNumberArray:()=>ad,interpolateObject:()=>cd,interpolateRgb:()=>ed,interpolateRgbBasis:()=>id,interpolateRgbBasisClosed:()=>rd,interpolateRound:()=>vd,interpolateString:()=>md,interpolateTransformCss:()=>Rp,interpolateTransformSvg:()=>Up,interpolateZoom:()=>Lp,piecewise:()=>yp,quantize:()=>Ng});var a={};n.r(a);n.d(a,{bound:()=>pM,identifier:()=>yM,mark:()=>xM,overlap:()=>bM,render:()=>FM,viewlayout:()=>aA});var o={};n.r(o);n.d(o,{axisticks:()=>fA,datajoin:()=>cA,encode:()=>pA,legendentries:()=>gA,linkpath:()=>_A,pie:()=>zA,scale:()=>PA,sortitems:()=>ZA,stack:()=>iE});var u={};n.r(u);n.d(u,{contour:()=>UN,geojson:()=>IN,geopath:()=>LN,geopoint:()=>WN,geoshape:()=>XN,graticule:()=>YN,heatmap:()=>JN,isocontour:()=>MN,kde2d:()=>NN,projection:()=>QN});var s={};n.r(s);n.d(s,{force:()=>EO});var l={};n.r(l);n.d(l,{nest:()=>uU,pack:()=>gU,partition:()=>yU,stratify:()=>vU,tree:()=>bU,treelinks:()=>wU,treemap:()=>AU});var f={};n.r(f);n.d(f,{label:()=>m$});var c={};n.r(c);n.d(c,{loess:()=>v$,regression:()=>b$});var h={};n.r(h);n.d(h,{voronoi:()=>V$});var d={};n.r(d);n.d(d,{wordcloud:()=>dP});var p={};n.r(p);n.d(p,{crossfilter:()=>AP,resolvefilter:()=>EP});var g=n(48823);var m={},y={},v=34,x=10,_=13;function b(t){return new Function("d","return {"+t.map((function(t,e){return JSON.stringify(t)+": d["+e+'] || ""'})).join(",")+"}")}function w(t,e){var n=b(t);return function(i,r){return e(n(i),r,t)}}function k(t){var e=Object.create(null),n=[];t.forEach((function(t){for(var i in t){if(!(i in e)){n.push(e[i]=i)}}}));return n}function M(t,e){var n=t+"",i=n.length;return i<e?new Array(e-i+1).join(0)+n:n}function A(t){return t<0?"-"+M(-t,6):t>9999?"+"+M(t,6):M(t,4)}function E(t){var e=t.getUTCHours(),n=t.getUTCMinutes(),i=t.getUTCSeconds(),r=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":A(t.getUTCFullYear(),4)+"-"+M(t.getUTCMonth()+1,2)+"-"+M(t.getUTCDate(),2)+(r?"T"+M(e,2)+":"+M(n,2)+":"+M(i,2)+"."+M(r,3)+"Z":i?"T"+M(e,2)+":"+M(n,2)+":"+M(i,2)+"Z":n||e?"T"+M(e,2)+":"+M(n,2)+"Z":"")}function D(t){var e=new RegExp('["'+t+"\n\r]"),n=t.charCodeAt(0);function i(t,e){var n,i,a=r(t,(function(t,r){if(n)return n(t,r-1);i=t,n=e?w(t,e):b(t)}));a.columns=i||[];return a}function r(t,e){var i=[],r=t.length,a=0,o=0,u,s=r<=0,l=false;if(t.charCodeAt(r-1)===x)--r;if(t.charCodeAt(r-1)===_)--r;function f(){if(s)return y;if(l)return l=false,m;var e,i=a,o;if(t.charCodeAt(i)===v){while(a++<r&&t.charCodeAt(a)!==v||t.charCodeAt(++a)===v);if((e=a)>=r)s=true;else if((o=t.charCodeAt(a++))===x)l=true;else if(o===_){l=true;if(t.charCodeAt(a)===x)++a}return t.slice(i+1,e-1).replace(/""/g,'"')}while(a<r){if((o=t.charCodeAt(e=a++))===x)l=true;else if(o===_){l=true;if(t.charCodeAt(a)===x)++a}else if(o!==n)continue;return t.slice(i,e)}return s=true,t.slice(i,r)}while((u=f())!==y){var c=[];while(u!==m&&u!==y)c.push(u),u=f();if(e&&(c=e(c,o++))==null)continue;i.push(c)}return i}function a(e,n){return e.map((function(e){return n.map((function(t){return f(e[t])})).join(t)}))}function o(e,n){if(n==null)n=k(e);return[n.map(f).join(t)].concat(a(e,n)).join("\n")}function u(t,e){if(e==null)e=k(t);return a(t,e).join("\n")}function s(t){return t.map(l).join("\n")}function l(e){return e.map(f).join(t)}function f(t){return t==null?"":t instanceof Date?E(t):e.test(t+="")?'"'+t.replace(/"/g,'""')+'"':t}return{parse:i,parseRows:r,format:o,formatBody:u,formatRows:s,formatRow:l,formatValue:f}}function C(t,e){var n,i=t.length,r=i-e;while(r<--i)n=t[r],t[r++]=t[i],t[i]=n}function F(t){return t}function S(t){if(t==null)return F;var e,n,i=t.scale[0],r=t.scale[1],a=t.translate[0],o=t.translate[1];return function(t,u){if(!u)e=n=0;var s=2,l=t.length,f=new Array(l);f[0]=(e+=t[0])*i+a;f[1]=(n+=t[1])*r+o;while(s<l)f[s]=t[s],++s;return f}}function T(t,e){if(typeof e==="string")e=t.objects[e];return e.type==="GeometryCollection"?{type:"FeatureCollection",features:e.geometries.map((function(e){return B(t,e)}))}:B(t,e)}function B(t,e){var n=e.id,i=e.bbox,r=e.properties==null?{}:e.properties,a=N(t,e);return n==null&&i==null?{type:"Feature",properties:r,geometry:a}:i==null?{type:"Feature",id:n,properties:r,geometry:a}:{type:"Feature",id:n,bbox:i,properties:r,geometry:a}}function N(t,e){var n=S(t.transform),i=t.arcs;function r(t,e){if(e.length)e.pop();for(var r=i[t<0?~t:t],a=0,o=r.length;a<o;++a){e.push(n(r[a],a))}if(t<0)C(e,o)}function a(t){return n(t)}function o(t){var e=[];for(var n=0,i=t.length;n<i;++n)r(t[n],e);if(e.length<2)e.push(e[0]);return e}function u(t){var e=o(t);while(e.length<4)e.push(e[0]);return e}function s(t){return t.map(u)}function l(t){var e=t.type,n;switch(e){case"GeometryCollection":return{type:e,geometries:t.geometries.map(l)};case"Point":n=a(t.coordinates);break;case"MultiPoint":n=t.coordinates.map(a);break;case"LineString":n=o(t.arcs);break;case"MultiLineString":n=t.arcs.map(o);break;case"Polygon":n=s(t.arcs);break;case"MultiPolygon":n=t.arcs.map(s);break;default:return null}return{type:e,coordinates:n}}return l(e)}function z(t,e){var n={},i={},r={},a=[],o=-1;e.forEach((function(n,i){var r=t.arcs[n<0?~n:n],a;if(r.length<3&&!r[1][0]&&!r[1][1]){a=e[++o],e[o]=n,e[i]=a}}));e.forEach((function(t){var e=u(t),n=e[0],a=e[1],o,s;if(o=r[n]){delete r[o.end];o.push(t);o.end=a;if(s=i[a]){delete i[s.start];var l=s===o?o:o.concat(s);i[l.start=o.start]=r[l.end=s.end]=l}else{i[o.start]=r[o.end]=o}}else if(o=i[a]){delete i[o.start];o.unshift(t);o.start=n;if(s=r[n]){delete r[s.end];var f=s===o?o:s.concat(o);i[f.start=s.start]=r[f.end=o.end]=f}else{i[o.start]=r[o.end]=o}}else{o=[t];i[o.start=n]=r[o.end=a]=o}}));function u(e){var n=t.arcs[e<0?~e:e],i=n[0],r;if(t.transform)r=[0,0],n.forEach((function(t){r[0]+=t[0],r[1]+=t[1]}));else r=n[n.length-1];return e<0?[r,i]:[i,r]}function s(t,e){for(var i in t){var r=t[i];delete e[r.start];delete r.start;delete r.end;r.forEach((function(t){n[t<0?~t:t]=1}));a.push(r)}}s(r,i);s(i,r);e.forEach((function(t){if(!n[t<0?~t:t])a.push([t])}));return a}function O(t){return N(t,R.apply(this,arguments))}function R(t,e,n){var i,r,a;if(arguments.length>1)i=U(t,e,n);else for(r=0,i=new Array(a=t.arcs.length);r<a;++r)i[r]=r;return{type:"MultiLineString",arcs:z(t,i)}}function U(t,e,n){var i=[],r=[],a;function o(t){var e=t<0?~t:t;(r[e]||(r[e]=[])).push({i:t,g:a})}function u(t){t.forEach(o)}function s(t){t.forEach(u)}function l(t){t.forEach(s)}function f(t){switch(a=t,t.type){case"GeometryCollection":t.geometries.forEach(f);break;case"LineString":u(t.arcs);break;case"MultiLineString":case"Polygon":s(t.arcs);break;case"MultiPolygon":l(t.arcs);break}}f(e);r.forEach(n==null?function(t){i.push(t[0].i)}:function(t){if(n(t[0].g,t[t.length-1].g))i.push(t[0].i)});return i}var $=Math.sqrt(50),P=Math.sqrt(10),q=Math.sqrt(2);function I(t,e,n){var i,r=-1,a,o,u;e=+e,t=+t,n=+n;if(t===e&&n>0)return[t];if(i=e<t)a=t,t=e,e=a;if((u=L(t,e,n))===0||!isFinite(u))return[];if(u>0){let n=Math.round(t/u),i=Math.round(e/u);if(n*u<t)++n;if(i*u>e)--i;o=new Array(a=i-n+1);while(++r<a)o[r]=(n+r)*u}else{u=-u;let n=Math.round(t*u),i=Math.round(e*u);if(n/u<t)++n;if(i/u>e)--i;o=new Array(a=i-n+1);while(++r<a)o[r]=(n+r)/u}if(i)o.reverse();return o}function L(t,e,n){var i=(e-t)/Math.max(0,n),r=Math.floor(Math.log(i)/Math.LN10),a=i/Math.pow(10,r);return r>=0?(a>=$?10:a>=P?5:a>=q?2:1)*Math.pow(10,r):-Math.pow(10,-r)/(a>=$?10:a>=P?5:a>=q?2:1)}function j(t,e,n){var i=Math.abs(e-t)/Math.max(0,n),r=Math.pow(10,Math.floor(Math.log(i)/Math.LN10)),a=i/r;if(a>=$)r*=10;else if(a>=P)r*=5;else if(a>=q)r*=2;return e<t?-r:r}var W=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function X(t){if(!(e=W.exec(t)))throw new Error("invalid format: "+t);var e;return new H({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}X.prototype=H.prototype;function H(t){this.fill=t.fill===undefined?" ":t.fill+"";this.align=t.align===undefined?">":t.align+"";this.sign=t.sign===undefined?"-":t.sign+"";this.symbol=t.symbol===undefined?"":t.symbol+"";this.zero=!!t.zero;this.width=t.width===undefined?undefined:+t.width;this.comma=!!t.comma;this.precision=t.precision===undefined?undefined:+t.precision;this.trim=!!t.trim;this.type=t.type===undefined?"":t.type+""}H.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===undefined?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===undefined?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Y(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function J(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,i=t.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+t.slice(n+1)]}function V(t){return t=J(Math.abs(t)),t?t[1]:NaN}function G(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(V(e)/3)))*3-V(Math.abs(t)))}function K(t,e){t=Math.abs(t),e=Math.abs(e)-t;return Math.max(0,V(e)-V(t))+1}function Z(t){return Math.max(0,-V(Math.abs(t)))}function Q(t,e){return function(n,i){var r=n.length,a=[],o=0,u=t[0],s=0;while(r>0&&u>0){if(s+u+1>i)u=Math.max(1,i-s);a.push(n.substring(r-=u,r+u));if((s+=u+1)>i)break;u=t[o=(o+1)%t.length]}return a.reverse().join(e)}}function tt(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}function et(t){t:for(var e=t.length,n=1,i=-1,r;n<e;++n){switch(t[n]){case".":i=r=n;break;case"0":if(i===0)i=n;r=n;break;default:if(!+t[n])break t;if(i>0)i=0;break}}return i>0?t.slice(0,i)+t.slice(r+1):t}var nt;function it(t,e){var n=J(t,e);if(!n)return t+"";var i=n[0],r=n[1],a=r-(nt=Math.max(-8,Math.min(8,Math.floor(r/3)))*3)+1,o=i.length;return a===o?i:a>o?i+new Array(a-o+1).join("0"):a>0?i.slice(0,a)+"."+i.slice(a):"0."+new Array(1-a).join("0")+J(t,Math.max(0,e+a-1))[0]}function rt(t,e){var n=J(t,e);if(!n)return t+"";var i=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}const at={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:Y,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>rt(t*100,e),r:rt,s:it,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function ot(t){return t}var ut=Array.prototype.map,st=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function lt(t){var e=t.grouping===undefined||t.thousands===undefined?ot:Q(ut.call(t.grouping,Number),t.thousands+""),n=t.currency===undefined?"":t.currency[0]+"",i=t.currency===undefined?"":t.currency[1]+"",r=t.decimal===undefined?".":t.decimal+"",a=t.numerals===undefined?ot:tt(ut.call(t.numerals,String)),o=t.percent===undefined?"%":t.percent+"",u=t.minus===undefined?"−":t.minus+"",s=t.nan===undefined?"NaN":t.nan+"";function l(t){t=X(t);var l=t.fill,f=t.align,c=t.sign,h=t.symbol,d=t.zero,p=t.width,g=t.comma,m=t.precision,y=t.trim,v=t.type;if(v==="n")g=true,v="g";else if(!at[v])m===undefined&&(m=12),y=true,v="g";if(d||l==="0"&&f==="=")d=true,l="0",f="=";var x=h==="$"?n:h==="#"&&/[boxX]/.test(v)?"0"+v.toLowerCase():"",_=h==="$"?i:/[%p]/.test(v)?o:"";var b=at[v],w=/[defgprs%]/.test(v);m=m===undefined?6:/[gprs]/.test(v)?Math.max(1,Math.min(21,m)):Math.max(0,Math.min(20,m));function k(t){var n=x,i=_,o,h,k;if(v==="c"){i=b(t)+i;t=""}else{t=+t;var M=t<0||1/t<0;t=isNaN(t)?s:b(Math.abs(t),m);if(y)t=et(t);if(M&&+t===0&&c!=="+")M=false;n=(M?c==="("?c:u:c==="-"||c==="("?"":c)+n;i=(v==="s"?st[8+nt/3]:"")+i+(M&&c==="("?")":"");if(w){o=-1,h=t.length;while(++o<h){if(k=t.charCodeAt(o),48>k||k>57){i=(k===46?r+t.slice(o+1):t.slice(o))+i;t=t.slice(0,o);break}}}}if(g&&!d)t=e(t,Infinity);var A=n.length+t.length+i.length,E=A<p?new Array(p-A+1).join(l):"";if(g&&d)t=e(E+t,E.length?p-i.length:Infinity),E="";switch(f){case"<":t=n+t+i+E;break;case"=":t=n+E+t+i;break;case"^":t=E.slice(0,A=E.length>>1)+n+t+i+E.slice(A);break;default:t=E+n+t+i;break}return a(t)}k.toString=function(){return t+""};return k}function f(t,e){var n=l((t=X(t),t.type="f",t)),i=Math.max(-8,Math.min(8,Math.floor(V(e)/3)))*3,r=Math.pow(10,-i),a=st[8+i/3];return function(t){return n(r*t)+a}}return{format:l,formatPrefix:f}}var ft;var ct;var ht;dt({thousands:",",grouping:[3],currency:["$",""]});function dt(t){ft=lt(t);ct=ft.format;ht=ft.formatPrefix;return ft}var pt=new Date,gt=new Date;function mt(t,e,n,i){function r(e){return t(e=arguments.length===0?new Date:new Date(+e)),e}r.floor=function(e){return t(e=new Date(+e)),e};r.ceil=function(n){return t(n=new Date(n-1)),e(n,1),t(n),n};r.round=function(t){var e=r(t),n=r.ceil(t);return t-e<n-t?e:n};r.offset=function(t,n){return e(t=new Date(+t),n==null?1:Math.floor(n)),t};r.range=function(n,i,a){var o=[],u;n=r.ceil(n);a=a==null?1:Math.floor(a);if(!(n<i)||!(a>0))return o;do{o.push(u=new Date(+n)),e(n,a),t(n)}while(u<n&&n<i);return o};r.filter=function(n){return mt((function(e){if(e>=e)while(t(e),!n(e))e.setTime(e-1)}),(function(t,i){if(t>=t){if(i<0)while(++i<=0){while(e(t,-1),!n(t)){}}else while(--i>=0){while(e(t,+1),!n(t)){}}}}))};if(n){r.count=function(e,i){pt.setTime(+e),gt.setTime(+i);t(pt),t(gt);return Math.floor(n(pt,gt))};r.every=function(t){t=Math.floor(t);return!isFinite(t)||!(t>0)?null:!(t>1)?r:r.filter(i?function(e){return i(e)%t===0}:function(e){return r.count(0,e)%t===0})}}return r}const yt=1e3;const vt=yt*60;const xt=vt*60;const _t=xt*24;const bt=_t*7;const wt=_t*30;const kt=_t*365;var Mt=mt((t=>t.setHours(0,0,0,0)),((t,e)=>t.setDate(t.getDate()+e)),((t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*vt)/_t),(t=>t.getDate()-1));const At=Mt;var Et=Mt.range;function Dt(t){return mt((function(e){e.setDate(e.getDate()-(e.getDay()+7-t)%7);e.setHours(0,0,0,0)}),(function(t,e){t.setDate(t.getDate()+e*7)}),(function(t,e){return(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*vt)/bt}))}var Ct=Dt(0);var Ft=Dt(1);var St=Dt(2);var Tt=Dt(3);var Bt=Dt(4);var Nt=Dt(5);var zt=Dt(6);var Ot=Ct.range;var Rt=Ft.range;var Ut=St.range;var $t=Tt.range;var Pt=Bt.range;var qt=Nt.range;var It=zt.range;var Lt=mt((function(t){t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCDate(t.getUTCDate()+e)}),(function(t,e){return(e-t)/_t}),(function(t){return t.getUTCDate()-1}));const jt=Lt;var Wt=Lt.range;function Xt(t){return mt((function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7);e.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCDate(t.getUTCDate()+e*7)}),(function(t,e){return(e-t)/bt}))}var Ht=Xt(0);var Yt=Xt(1);var Jt=Xt(2);var Vt=Xt(3);var Gt=Xt(4);var Kt=Xt(5);var Zt=Xt(6);var Qt=Ht.range;var te=Yt.range;var ee=Jt.range;var ne=Vt.range;var ie=Gt.range;var re=Kt.range;var ae=Zt.range;var oe=mt((function(t){t.setMonth(0,1);t.setHours(0,0,0,0)}),(function(t,e){t.setFullYear(t.getFullYear()+e)}),(function(t,e){return e.getFullYear()-t.getFullYear()}),(function(t){return t.getFullYear()}));oe.every=function(t){return!isFinite(t=Math.floor(t))||!(t>0)?null:mt((function(e){e.setFullYear(Math.floor(e.getFullYear()/t)*t);e.setMonth(0,1);e.setHours(0,0,0,0)}),(function(e,n){e.setFullYear(e.getFullYear()+n*t)}))};const ue=oe;var se=oe.range;var le=mt((function(t){t.setDate(1);t.setHours(0,0,0,0)}),(function(t,e){t.setMonth(t.getMonth()+e)}),(function(t,e){return e.getMonth()-t.getMonth()+(e.getFullYear()-t.getFullYear())*12}),(function(t){return t.getMonth()}));const fe=le;var ce=le.range;var he=mt((function(t){t.setTime(t-t.getMilliseconds()-t.getSeconds()*yt-t.getMinutes()*vt)}),(function(t,e){t.setTime(+t+e*xt)}),(function(t,e){return(e-t)/xt}),(function(t){return t.getHours()}));const de=he;var pe=he.range;var ge=mt((function(t){t.setTime(t-t.getMilliseconds()-t.getSeconds()*yt)}),(function(t,e){t.setTime(+t+e*vt)}),(function(t,e){return(e-t)/vt}),(function(t){return t.getMinutes()}));const me=ge;var ye=ge.range;var ve=mt((function(t){t.setTime(t-t.getMilliseconds())}),(function(t,e){t.setTime(+t+e*yt)}),(function(t,e){return(e-t)/yt}),(function(t){return t.getUTCSeconds()}));const xe=ve;var _e=ve.range;var be=mt((function(){}),(function(t,e){t.setTime(+t+e)}),(function(t,e){return e-t}));be.every=function(t){t=Math.floor(t);if(!isFinite(t)||!(t>0))return null;if(!(t>1))return be;return mt((function(e){e.setTime(Math.floor(e/t)*t)}),(function(e,n){e.setTime(+e+n*t)}),(function(e,n){return(n-e)/t}))};const we=be;var ke=be.range;var Me=mt((function(t){t.setUTCMonth(0,1);t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)}),(function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()}),(function(t){return t.getUTCFullYear()}));Me.every=function(t){return!isFinite(t=Math.floor(t))||!(t>0)?null:mt((function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t);e.setUTCMonth(0,1);e.setUTCHours(0,0,0,0)}),(function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n*t)}))};const Ae=Me;var Ee=Me.range;var De=mt((function(t){t.setUTCDate(1);t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCMonth(t.getUTCMonth()+e)}),(function(t,e){return e.getUTCMonth()-t.getUTCMonth()+(e.getUTCFullYear()-t.getUTCFullYear())*12}),(function(t){return t.getUTCMonth()}));const Ce=De;var Fe=De.range;var Se=mt((function(t){t.setUTCMinutes(0,0,0)}),(function(t,e){t.setTime(+t+e*xt)}),(function(t,e){return(e-t)/xt}),(function(t){return t.getUTCHours()}));const Te=Se;var Be=Se.range;var Ne=mt((function(t){t.setUTCSeconds(0,0)}),(function(t,e){t.setTime(+t+e*vt)}),(function(t,e){return(e-t)/vt}),(function(t){return t.getUTCMinutes()}));const ze=Ne;var Oe=Ne.range;function Re(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Ue(t){let e=t;let n=t;if(t.length===1){e=(e,n)=>t(e)-n;n=$e(t)}function i(t,e,i,r){if(i==null)i=0;if(r==null)r=t.length;while(i<r){const a=i+r>>>1;if(n(t[a],e)<0)i=a+1;else r=a}return i}function r(t,e,i,r){if(i==null)i=0;if(r==null)r=t.length;while(i<r){const a=i+r>>>1;if(n(t[a],e)>0)r=a;else i=a+1}return i}function a(t,n,r,a){if(r==null)r=0;if(a==null)a=t.length;const o=i(t,n,r,a-1);return o>r&&e(t[o-1],n)>-e(t[o],n)?o-1:o}return{left:i,center:a,right:r}}function $e(t){return(e,n)=>Re(t(e),n)}const Pe="year";const qe="quarter";const Ie="month";const Le="week";const je="date";const We="day";const Xe="dayofyear";const He="hours";const Ye="minutes";const Je="seconds";const Ve="milliseconds";const Ge=[Pe,qe,Ie,Le,je,We,Xe,He,Ye,Je,Ve];const Ke=Ge.reduce(((t,e,n)=>(t[e]=1+n,t)),{});function Ze(t){const e=(0,g.IX)(t).slice(),n={};if(!e.length)(0,g.vU)("Missing time unit.");e.forEach((t=>{if((0,g.nr)(Ke,t)){n[t]=1}else{(0,g.vU)("Invalid time unit: ".concat(t,"."))}}));const i=(n[Le]||n[We]?1:0)+(n[qe]||n[Ie]||n[je]?1:0)+(n[Xe]?1:0);if(i>1){(0,g.vU)("Incompatible time units: ".concat(t))}e.sort(((t,e)=>Ke[t]-Ke[e]));return e}const Qe={[Pe]:"%Y ",[qe]:"Q%q ",[Ie]:"%b ",[je]:"%d ",[Le]:"W%U ",[We]:"%a ",[Xe]:"%j ",[He]:"%H:00",[Ye]:"00:%M",[Je]:":%S",[Ve]:".%L",["".concat(Pe,"-").concat(Ie)]:"%Y-%m ",["".concat(Pe,"-").concat(Ie,"-").concat(je)]:"%Y-%m-%d ",["".concat(He,"-").concat(Ye)]:"%H:%M"};function tn(t,e){const n=(0,g.l7)({},Qe,e),i=Ze(t),r=i.length;let a="",o=0,u,s;for(o=0;o<r;){for(u=i.length;u>o;--u){s=i.slice(o,u).join("-");if(n[s]!=null){a+=n[s];o=u;break}}}return a.trim()}const en=new Date;function nn(t){en.setFullYear(t);en.setMonth(0);en.setDate(1);en.setHours(0,0,0,0);return en}function rn(t){return on(new Date(t))}function an(t){return un(new Date(t))}function on(t){return At.count(nn(t.getFullYear())-1,t)}function un(t){return Ct.count(nn(t.getFullYear())-1,t)}function sn(t){return nn(t).getDay()}function ln(t,e,n,i,r,a,o){if(0<=t&&t<100){const u=new Date(-1,e,n,i,r,a,o);u.setFullYear(t);return u}return new Date(t,e,n,i,r,a,o)}function fn(t){return hn(new Date(t))}function cn(t){return dn(new Date(t))}function hn(t){const e=Date.UTC(t.getUTCFullYear(),0,1);return jt.count(e-1,t)}function dn(t){const e=Date.UTC(t.getUTCFullYear(),0,1);return Ht.count(e-1,t)}function pn(t){en.setTime(Date.UTC(t,0,1));return en.getUTCDay()}function gn(t,e,n,i,r,a,o){if(0<=t&&t<100){const t=new Date(Date.UTC(-1,e,n,i,r,a,o));t.setUTCFullYear(n.y);return t}return new Date(Date.UTC(t,e,n,i,r,a,o))}function mn(t,e,n,i,r){const a=e||1,o=(0,g.fj)(t),u=(t,e,r)=>{r=r||t;return yn(n[r],i[r],t===o&&a,e)};const s=new Date,l=(0,g.Rg)(t),f=l[Pe]?u(Pe):(0,g.a9)(2012),c=l[Ie]?u(Ie):l[qe]?u(qe):g.bM,h=l[Le]&&l[We]?u(We,1,Le+We):l[Le]?u(Le,1):l[We]?u(We,1):l[je]?u(je,1):l[Xe]?u(Xe,1):g.kX,d=l[He]?u(He):g.bM,p=l[Ye]?u(Ye):g.bM,m=l[Je]?u(Je):g.bM,y=l[Ve]?u(Ve):g.bM;return function(t){s.setTime(+t);const e=f(s);return r(e,c(s),h(s,e),d(s),p(s),m(s),y(s))}}function yn(t,e,n,i){const r=n<=1?t:i?(e,r)=>i+n*Math.floor((t(e,r)-i)/n):(e,i)=>n*Math.floor(t(e,i)/n);return e?(t,n)=>e(r(t,n),n):r}function vn(t,e,n){return e+t*7-(n+6)%7}const xn={[Pe]:t=>t.getFullYear(),[qe]:t=>Math.floor(t.getMonth()/3),[Ie]:t=>t.getMonth(),[je]:t=>t.getDate(),[He]:t=>t.getHours(),[Ye]:t=>t.getMinutes(),[Je]:t=>t.getSeconds(),[Ve]:t=>t.getMilliseconds(),[Xe]:t=>on(t),[Le]:t=>un(t),[Le+We]:(t,e)=>vn(un(t),t.getDay(),sn(e)),[We]:(t,e)=>vn(1,t.getDay(),sn(e))};const _n={[qe]:t=>3*t,[Le]:(t,e)=>vn(t,0,sn(e))};function bn(t,e){return mn(t,e||1,xn,_n,ln)}const wn={[Pe]:t=>t.getUTCFullYear(),[qe]:t=>Math.floor(t.getUTCMonth()/3),[Ie]:t=>t.getUTCMonth(),[je]:t=>t.getUTCDate(),[He]:t=>t.getUTCHours(),[Ye]:t=>t.getUTCMinutes(),[Je]:t=>t.getUTCSeconds(),[Ve]:t=>t.getUTCMilliseconds(),[Xe]:t=>hn(t),[Le]:t=>dn(t),[We]:(t,e)=>vn(1,t.getUTCDay(),pn(e)),[Le+We]:(t,e)=>vn(dn(t),t.getUTCDay(),pn(e))};const kn={[qe]:t=>3*t,[Le]:(t,e)=>vn(t,0,pn(e))};function Mn(t,e){return mn(t,e||1,wn,kn,gn)}const An={[Pe]:ue,[qe]:fe.every(3),[Ie]:fe,[Le]:Ct,[je]:At,[We]:At,[Xe]:At,[He]:de,[Ye]:me,[Je]:xe,[Ve]:we};const En={[Pe]:Ae,[qe]:Ce.every(3),[Ie]:Ce,[Le]:Ht,[je]:jt,[We]:jt,[Xe]:jt,[He]:Te,[Ye]:ze,[Je]:xe,[Ve]:we};function Dn(t){return An[t]}function Cn(t){return En[t]}function Fn(t,e,n){return t?t.offset(e,n):undefined}function Sn(t,e,n){return Fn(Dn(t),e,n)}function Tn(t,e,n){return Fn(Cn(t),e,n)}function Bn(t,e,n,i){return t?t.range(e,n,i):undefined}function Nn(t,e,n,i){return Bn(Dn(t),e,n,i)}function zn(t,e,n,i){return Bn(Cn(t),e,n,i)}const On=1e3,Rn=On*60,Un=Rn*60,$n=Un*24,Pn=$n*7,qn=$n*30,In=$n*365;const Ln=[Pe,Ie,je,He,Ye,Je,Ve],jn=Ln.slice(0,-1),Wn=jn.slice(0,-1),Xn=Wn.slice(0,-1),Hn=Xn.slice(0,-1),Yn=[Pe,Le],Jn=[Pe,Ie],Vn=[Pe];const Gn=[[jn,1,On],[jn,5,5*On],[jn,15,15*On],[jn,30,30*On],[Wn,1,Rn],[Wn,5,5*Rn],[Wn,15,15*Rn],[Wn,30,30*Rn],[Xn,1,Un],[Xn,3,3*Un],[Xn,6,6*Un],[Xn,12,12*Un],[Hn,1,$n],[Yn,1,Pn],[Jn,1,qn],[Jn,3,3*qn],[Vn,1,In]];function Kn(t){const e=t.extent,n=t.maxbins||40,i=Math.abs((0,g.yP)(e))/n;let r=Ue((t=>t[2])).right(Gn,i),a,o;if(r===Gn.length){a=Vn,o=j(e[0]/In,e[1]/In,n)}else if(r){r=Gn[i/Gn[r-1][2]<Gn[r][2]/i?r-1:r];a=r[0];o=r[1]}else{a=Ln;o=Math.max(j(e[0],e[1],n),1)}return{units:a,step:o}}function Zn(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);e.setFullYear(t.y);return e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function Qn(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));e.setUTCFullYear(t.y);return e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function ti(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}function ei(t){var e=t.dateTime,n=t.date,i=t.time,r=t.periods,a=t.days,o=t.shortDays,u=t.months,s=t.shortMonths;var l=si(r),f=li(r),c=si(a),h=li(a),d=si(o),p=li(o),g=si(u),m=li(u),y=si(s),v=li(s);var x={a:N,A:z,b:O,B:R,c:null,d:Si,e:Si,f:Oi,g:Hi,G:Ji,H:Ti,I:Bi,j:Ni,L:zi,m:Ri,M:Ui,p:U,q:$,Q:yr,s:vr,S:$i,u:Pi,U:qi,V:Li,w:ji,W:Wi,x:null,X:null,y:Xi,Y:Yi,Z:Vi,"%":mr};var _={a:P,A:q,b:I,B:L,c:null,d:Gi,e:Gi,f:er,g:hr,G:pr,H:Ki,I:Zi,j:Qi,L:tr,m:nr,M:ir,p:j,q:W,Q:yr,s:vr,S:rr,u:ar,U:or,V:sr,w:lr,W:fr,x:null,X:null,y:cr,Y:dr,Z:gr,"%":mr};var b={a:E,A:D,b:C,B:F,c:S,d:_i,e:_i,f:Ei,g:mi,G:gi,H:wi,I:wi,j:bi,L:Ai,m:xi,M:ki,p:A,q:vi,Q:Ci,s:Fi,S:Mi,u:ci,U:hi,V:di,w:fi,W:pi,x:T,X:B,y:mi,Y:gi,Z:yi,"%":Di};x.x=w(n,x);x.X=w(i,x);x.c=w(e,x);_.x=w(n,_);_.X=w(i,_);_.c=w(e,_);function w(t,e){return function(n){var i=[],r=-1,a=0,o=t.length,u,s,l;if(!(n instanceof Date))n=new Date(+n);while(++r<o){if(t.charCodeAt(r)===37){i.push(t.slice(a,r));if((s=ni[u=t.charAt(++r)])!=null)u=t.charAt(++r);else s=u==="e"?" ":"0";if(l=e[u])u=l(n,s);i.push(u);a=r+1}}i.push(t.slice(a,r));return i.join("")}}function k(t,e){return function(n){var i=ti(1900,undefined,1),r=M(i,t,n+="",0),a,o;if(r!=n.length)return null;if("Q"in i)return new Date(i.Q);if("s"in i)return new Date(i.s*1e3+("L"in i?i.L:0));if(e&&!("Z"in i))i.Z=0;if("p"in i)i.H=i.H%12+i.p*12;if(i.m===undefined)i.m="q"in i?i.q:0;if("V"in i){if(i.V<1||i.V>53)return null;if(!("w"in i))i.w=1;if("Z"in i){a=Qn(ti(i.y,0,1)),o=a.getUTCDay();a=o>4||o===0?Yt.ceil(a):Yt(a);a=jt.offset(a,(i.V-1)*7);i.y=a.getUTCFullYear();i.m=a.getUTCMonth();i.d=a.getUTCDate()+(i.w+6)%7}else{a=Zn(ti(i.y,0,1)),o=a.getDay();a=o>4||o===0?Ft.ceil(a):Ft(a);a=At.offset(a,(i.V-1)*7);i.y=a.getFullYear();i.m=a.getMonth();i.d=a.getDate()+(i.w+6)%7}}else if("W"in i||"U"in i){if(!("w"in i))i.w="u"in i?i.u%7:"W"in i?1:0;o="Z"in i?Qn(ti(i.y,0,1)).getUTCDay():Zn(ti(i.y,0,1)).getDay();i.m=0;i.d="W"in i?(i.w+6)%7+i.W*7-(o+5)%7:i.w+i.U*7-(o+6)%7}if("Z"in i){i.H+=i.Z/100|0;i.M+=i.Z%100;return Qn(i)}return Zn(i)}}function M(t,e,n,i){var r=0,a=e.length,o=n.length,u,s;while(r<a){if(i>=o)return-1;u=e.charCodeAt(r++);if(u===37){u=e.charAt(r++);s=b[u in ni?e.charAt(r++):u];if(!s||(i=s(t,n,i))<0)return-1}else if(u!=n.charCodeAt(i++)){return-1}}return i}function A(t,e,n){var i=l.exec(e.slice(n));return i?(t.p=f.get(i[0].toLowerCase()),n+i[0].length):-1}function E(t,e,n){var i=d.exec(e.slice(n));return i?(t.w=p.get(i[0].toLowerCase()),n+i[0].length):-1}function D(t,e,n){var i=c.exec(e.slice(n));return i?(t.w=h.get(i[0].toLowerCase()),n+i[0].length):-1}function C(t,e,n){var i=y.exec(e.slice(n));return i?(t.m=v.get(i[0].toLowerCase()),n+i[0].length):-1}function F(t,e,n){var i=g.exec(e.slice(n));return i?(t.m=m.get(i[0].toLowerCase()),n+i[0].length):-1}function S(t,n,i){return M(t,e,n,i)}function T(t,e,i){return M(t,n,e,i)}function B(t,e,n){return M(t,i,e,n)}function N(t){return o[t.getDay()]}function z(t){return a[t.getDay()]}function O(t){return s[t.getMonth()]}function R(t){return u[t.getMonth()]}function U(t){return r[+(t.getHours()>=12)]}function $(t){return 1+~~(t.getMonth()/3)}function P(t){return o[t.getUTCDay()]}function q(t){return a[t.getUTCDay()]}function I(t){return s[t.getUTCMonth()]}function L(t){return u[t.getUTCMonth()]}function j(t){return r[+(t.getUTCHours()>=12)]}function W(t){return 1+~~(t.getUTCMonth()/3)}return{format:function(t){var e=w(t+="",x);e.toString=function(){return t};return e},parse:function(t){var e=k(t+="",false);e.toString=function(){return t};return e},utcFormat:function(t){var e=w(t+="",_);e.toString=function(){return t};return e},utcParse:function(t){var e=k(t+="",true);e.toString=function(){return t};return e}}}var ni={"-":"",_:" ",0:"0"},ii=/^\s*\d+/,ri=/^%/,ai=/[\\^$*+?|[\]().{}]/g;function oi(t,e,n){var i=t<0?"-":"",r=(i?-t:t)+"",a=r.length;return i+(a<n?new Array(n-a+1).join(e)+r:r)}function ui(t){return t.replace(ai,"\\$&")}function si(t){return new RegExp("^(?:"+t.map(ui).join("|")+")","i")}function li(t){return new Map(t.map(((t,e)=>[t.toLowerCase(),e])))}function fi(t,e,n){var i=ii.exec(e.slice(n,n+1));return i?(t.w=+i[0],n+i[0].length):-1}function ci(t,e,n){var i=ii.exec(e.slice(n,n+1));return i?(t.u=+i[0],n+i[0].length):-1}function hi(t,e,n){var i=ii.exec(e.slice(n,n+2));return i?(t.U=+i[0],n+i[0].length):-1}function di(t,e,n){var i=ii.exec(e.slice(n,n+2));return i?(t.V=+i[0],n+i[0].length):-1}function pi(t,e,n){var i=ii.exec(e.slice(n,n+2));return i?(t.W=+i[0],n+i[0].length):-1}function gi(t,e,n){var i=ii.exec(e.slice(n,n+4));return i?(t.y=+i[0],n+i[0].length):-1}function mi(t,e,n){var i=ii.exec(e.slice(n,n+2));return i?(t.y=+i[0]+(+i[0]>68?1900:2e3),n+i[0].length):-1}function yi(t,e,n){var i=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return i?(t.Z=i[1]?0:-(i[2]+(i[3]||"00")),n+i[0].length):-1}function vi(t,e,n){var i=ii.exec(e.slice(n,n+1));return i?(t.q=i[0]*3-3,n+i[0].length):-1}function xi(t,e,n){var i=ii.exec(e.slice(n,n+2));return i?(t.m=i[0]-1,n+i[0].length):-1}function _i(t,e,n){var i=ii.exec(e.slice(n,n+2));return i?(t.d=+i[0],n+i[0].length):-1}function bi(t,e,n){var i=ii.exec(e.slice(n,n+3));return i?(t.m=0,t.d=+i[0],n+i[0].length):-1}function wi(t,e,n){var i=ii.exec(e.slice(n,n+2));return i?(t.H=+i[0],n+i[0].length):-1}function ki(t,e,n){var i=ii.exec(e.slice(n,n+2));return i?(t.M=+i[0],n+i[0].length):-1}function Mi(t,e,n){var i=ii.exec(e.slice(n,n+2));return i?(t.S=+i[0],n+i[0].length):-1}function Ai(t,e,n){var i=ii.exec(e.slice(n,n+3));return i?(t.L=+i[0],n+i[0].length):-1}function Ei(t,e,n){var i=ii.exec(e.slice(n,n+6));return i?(t.L=Math.floor(i[0]/1e3),n+i[0].length):-1}function Di(t,e,n){var i=ri.exec(e.slice(n,n+1));return i?n+i[0].length:-1}function Ci(t,e,n){var i=ii.exec(e.slice(n));return i?(t.Q=+i[0],n+i[0].length):-1}function Fi(t,e,n){var i=ii.exec(e.slice(n));return i?(t.s=+i[0],n+i[0].length):-1}function Si(t,e){return oi(t.getDate(),e,2)}function Ti(t,e){return oi(t.getHours(),e,2)}function Bi(t,e){return oi(t.getHours()%12||12,e,2)}function Ni(t,e){return oi(1+At.count(ue(t),t),e,3)}function zi(t,e){return oi(t.getMilliseconds(),e,3)}function Oi(t,e){return zi(t,e)+"000"}function Ri(t,e){return oi(t.getMonth()+1,e,2)}function Ui(t,e){return oi(t.getMinutes(),e,2)}function $i(t,e){return oi(t.getSeconds(),e,2)}function Pi(t){var e=t.getDay();return e===0?7:e}function qi(t,e){return oi(Ct.count(ue(t)-1,t),e,2)}function Ii(t){var e=t.getDay();return e>=4||e===0?Bt(t):Bt.ceil(t)}function Li(t,e){t=Ii(t);return oi(Bt.count(ue(t),t)+(ue(t).getDay()===4),e,2)}function ji(t){return t.getDay()}function Wi(t,e){return oi(Ft.count(ue(t)-1,t),e,2)}function Xi(t,e){return oi(t.getFullYear()%100,e,2)}function Hi(t,e){t=Ii(t);return oi(t.getFullYear()%100,e,2)}function Yi(t,e){return oi(t.getFullYear()%1e4,e,4)}function Ji(t,e){var n=t.getDay();t=n>=4||n===0?Bt(t):Bt.ceil(t);return oi(t.getFullYear()%1e4,e,4)}function Vi(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+oi(e/60|0,"0",2)+oi(e%60,"0",2)}function Gi(t,e){return oi(t.getUTCDate(),e,2)}function Ki(t,e){return oi(t.getUTCHours(),e,2)}function Zi(t,e){return oi(t.getUTCHours()%12||12,e,2)}function Qi(t,e){return oi(1+jt.count(Ae(t),t),e,3)}function tr(t,e){return oi(t.getUTCMilliseconds(),e,3)}function er(t,e){return tr(t,e)+"000"}function nr(t,e){return oi(t.getUTCMonth()+1,e,2)}function ir(t,e){return oi(t.getUTCMinutes(),e,2)}function rr(t,e){return oi(t.getUTCSeconds(),e,2)}function ar(t){var e=t.getUTCDay();return e===0?7:e}function or(t,e){return oi(Ht.count(Ae(t)-1,t),e,2)}function ur(t){var e=t.getUTCDay();return e>=4||e===0?Gt(t):Gt.ceil(t)}function sr(t,e){t=ur(t);return oi(Gt.count(Ae(t),t)+(Ae(t).getUTCDay()===4),e,2)}function lr(t){return t.getUTCDay()}function fr(t,e){return oi(Yt.count(Ae(t)-1,t),e,2)}function cr(t,e){return oi(t.getUTCFullYear()%100,e,2)}function hr(t,e){t=ur(t);return oi(t.getUTCFullYear()%100,e,2)}function dr(t,e){return oi(t.getUTCFullYear()%1e4,e,4)}function pr(t,e){var n=t.getUTCDay();t=n>=4||n===0?Gt(t):Gt.ceil(t);return oi(t.getUTCFullYear()%1e4,e,4)}function gr(){return"+0000"}function mr(){return"%"}function yr(t){return+t}function vr(t){return Math.floor(+t/1e3)}var xr;var _r;var br;var wr;var kr;Mr({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function Mr(t){xr=ei(t);_r=xr.format;br=xr.parse;wr=xr.utcFormat;kr=xr.utcParse;return xr}function Ar(t){const e={};return n=>e[n]||(e[n]=t(n))}function Er(t,e){return n=>{const i=t(n),r=i.indexOf(e);if(r<0)return i;let a=Dr(i,r);const o=a<i.length?i.slice(a):"";while(--a>r)if(i[a]!=="0"){++a;break}return i.slice(0,a)+o}}function Dr(t,e){let n=t.lastIndexOf("e"),i;if(n>0)return n;for(n=t.length;--n>e;){i=t.charCodeAt(n);if(i>=48&&i<=57)return n+1}}function Cr(t){const e=Ar(t.format),n=t.formatPrefix;return{format:e,formatPrefix:n,formatFloat(t){const n=X(t||",");if(n.precision==null){n.precision=12;switch(n.type){case"%":n.precision-=2;break;case"e":n.precision-=1;break}return Er(e(n),e(".1f")(1)[1])}else{return e(n)}},formatSpan(t,i,r,a){a=X(a==null?",f":a);const o=j(t,i,r),u=Math.max(Math.abs(t),Math.abs(i));let s;if(a.precision==null){switch(a.type){case"s":{if(!isNaN(s=G(o,u))){a.precision=s}return n(a,u)}case"":case"e":case"g":case"p":case"r":{if(!isNaN(s=K(o,u))){a.precision=s-(a.type==="e")}break}case"f":case"%":{if(!isNaN(s=Z(o))){a.precision=s-(a.type==="%")*2}break}}}return e(a)}}}let Fr;Sr();function Sr(){return Fr=Cr({format:ct,formatPrefix:ht})}function Tr(t){return Cr(lt(t))}function Br(t){return arguments.length?Fr=Tr(t):Fr}function Nr(t,e,n){n=n||{};if(!(0,g.Kn)(n)){(0,g.vU)("Invalid time multi-format specifier: ".concat(n))}const i=e(Je),r=e(Ye),a=e(He),o=e(je),u=e(Le),s=e(Ie),l=e(qe),f=e(Pe),c=t(n[Ve]||".%L"),h=t(n[Je]||":%S"),d=t(n[Ye]||"%I:%M"),p=t(n[He]||"%I %p"),m=t(n[je]||n[We]||"%a %d"),y=t(n[Le]||"%b %d"),v=t(n[Ie]||"%B"),x=t(n[qe]||"%B"),_=t(n[Pe]||"%Y");return t=>(i(t)<t?c:r(t)<t?h:a(t)<t?d:o(t)<t?p:s(t)<t?u(t)<t?m:y:f(t)<t?l(t)<t?v:x:_)(t)}function zr(t){const e=Ar(t.format),n=Ar(t.utcFormat);return{timeFormat:t=>(0,g.HD)(t)?e(t):Nr(e,Dn,t),utcFormat:t=>(0,g.HD)(t)?n(t):Nr(n,Cn,t),timeParse:Ar(t.parse),utcParse:Ar(t.utcParse)}}let Or;Rr();function Rr(){return Or=zr({format:_r,parse:br,utcFormat:wr,utcParse:kr})}function Ur(t){return zr(ei(t))}function $r(t){return arguments.length?Or=Ur(t):Or}const Pr=(t,e)=>(0,g.l7)({},t,e);function qr(t,e){const n=t?Tr(t):Br();const i=e?Ur(e):$r();return Pr(n,i)}function Ir(t,e){const n=arguments.length;if(n&&n!==2){(0,g.vU)("defaultLocale expects either zero or two arguments.")}return n?Pr(Br(t),$r(e)):Pr(Br(),$r())}function Lr(){Sr();Rr();return Ir()}const jr=/^(data:|([A-Za-z]+:)?\/\/)/;const Wr=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i;const Xr=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g;const Hr="file://";function Yr(t,e){return n=>({options:n||{},sanitize:Vr,load:Jr,fileAccess:!!e,file:Gr(e),http:Zr(t)})}async function Jr(t,e){const n=await this.sanitize(t,e),i=n.href;return n.localFile?this.file(i):this.http(i,e)}async function Vr(t,e){e=(0,g.l7)({},this.options,e);const n=this.fileAccess,i={href:null};let r,a,o;const u=Wr.test(t.replace(Xr,""));if(t==null||typeof t!=="string"||!u){(0,g.vU)("Sanitize failure, invalid URI: "+(0,g.m8)(t))}const s=jr.test(t);if((o=e.baseURL)&&!s){if(!t.startsWith("/")&&!o.endsWith("/")){t="/"+t}t=o+t}a=(r=t.startsWith(Hr))||e.mode==="file"||e.mode!=="http"&&!s&&n;if(r){t=t.slice(Hr.length)}else if(t.startsWith("//")){if(e.defaultProtocol==="file"){t=t.slice(2);a=true}else{t=(e.defaultProtocol||"http")+":"+t}}Object.defineProperty(i,"localFile",{value:!!a});i.href=t;if(e.target){i.target=e.target+""}if(e.rel){i.rel=e.rel+""}if(e.context==="image"&&e.crossOrigin){i.crossOrigin=e.crossOrigin+""}return i}function Gr(t){return t?e=>new Promise(((n,i)=>{t.readFile(e,((t,e)=>{if(t)i(t);else n(e)}))})):Kr}async function Kr(){(0,g.vU)("No file system access.")}function Zr(t){return t?async function(e,n){const i=(0,g.l7)({},this.options.http,n),r=n&&n.response,a=await t(e,i);return!a.ok?(0,g.vU)(a.status+""+a.statusText):(0,g.mf)(a[r])?a[r]():a.text()}:Qr}async function Qr(){(0,g.vU)("No HTTP fetch method available.")}const ta=t=>t!=null&&t===t;const ea=t=>t==="true"||t==="false"||t===true||t===false;const na=t=>!Number.isNaN(Date.parse(t));const ia=t=>!Number.isNaN(+t)&&!(t instanceof Date);const ra=t=>ia(t)&&Number.isInteger(+t);const aa={boolean:g.sw,integer:g.He,number:g.He,date:g.ZU,string:g.BB,unknown:g.yR};const oa=[ea,ra,ia,na];const ua=["boolean","integer","number","date"];function sa(t,e){if(!t||!t.length)return"unknown";const n=t.length,i=oa.length,r=oa.map(((t,e)=>e+1));for(let a=0,o=0,u,s;a<n;++a){s=e?t[a][e]:t[a];for(u=0;u<i;++u){if(r[u]&&ta(s)&&!oa[u](s)){r[u]=0;++o;if(o===oa.length)return"string"}}}return ua[r.reduce(((t,e)=>t===0?e:t),0)-1]}function la(t,e){return e.reduce(((e,n)=>{e[n]=sa(t,n);return e}),{})}function fa(t){const e=function(e,n){const i={delimiter:t};return ca(e,n?(0,g.l7)(n,i):i)};e.responseType="text";return e}function ca(t,e){if(e.header){t=e.header.map(g.m8).join(e.delimiter)+"\n"+t}return D(e.delimiter).parse(t+"")}ca.responseType="text";function ha(t){return typeof Buffer==="function"&&(0,g.mf)(Buffer.isBuffer)?Buffer.isBuffer(t):false}function da(t,e){const n=e&&e.property?(0,g.EP)(e.property):g.yR;return(0,g.Kn)(t)&&!ha(t)?pa(n(t),e):n(JSON.parse(t))}da.responseType="json";function pa(t,e){if(!(0,g.kJ)(t)&&(0,g.TW)(t)){t=[...t]}return e&&e.copy?JSON.parse(JSON.stringify(t)):t}const ga={interior:(t,e)=>t!==e,exterior:(t,e)=>t===e};function ma(t,e){let n,i,r,a;t=da(t,e);if(e&&e.feature){n=T;r=e.feature}else if(e&&e.mesh){n=O;r=e.mesh;a=ga[e.filter]}else{(0,g.vU)("Missing TopoJSON feature or mesh parameter.")}i=(i=t.objects[r])?n(t,i,a):(0,g.vU)("Invalid TopoJSON object: "+r);return i&&i.features||[i]}ma.responseType="json";const ya={dsv:ca,csv:fa(","),tsv:fa("\t"),json:da,topojson:ma};function va(t,e){if(arguments.length>1){ya[t]=e;return this}else{return(0,g.nr)(ya,t)?ya[t]:null}}function xa(t){const e=va(t);return e&&e.responseType||"text"}function _a(t,e,n,i){e=e||{};const r=va(e.type||"json");if(!r)(0,g.vU)("Unknown data format type: "+e.type);t=r(t,e);if(e.parse)ba(t,e.parse,n,i);if((0,g.nr)(t,"columns"))delete t.columns;return t}function ba(t,e,n,i){if(!t.length)return;const r=$r();n=n||r.timeParse;i=i||r.utcParse;let a=t.columns||Object.keys(t[0]),o,u,s,l,f,c;if(e==="auto")e=la(t,a);a=Object.keys(e);const h=a.map((t=>{const r=e[t];let a,o;if(r&&(r.startsWith("date:")||r.startsWith("utc:"))){a=r.split(/:(.+)?/,2);o=a[1];if(o[0]==="'"&&o[o.length-1]==="'"||o[0]==='"'&&o[o.length-1]==='"'){o=o.slice(1,-1)}const t=a[0]==="utc"?i:n;return t(o)}if(!aa[r]){throw Error("Illegal format pattern: "+t+":"+r)}return aa[r]}));for(s=0,f=t.length,c=a.length;s<f;++s){o=t[s];for(l=0;l<c;++l){u=a[l];o[u]=h[l](o[u])}}}const wa=Yr(typeof fetch!=="undefined"&&fetch,null);function ka(t){const e=t||g.yR,n=[],i={};n.add=t=>{const r=e(t);if(!i[r]){i[r]=1;n.push(t)}return n};n.remove=t=>{const r=e(t);if(i[r]){i[r]=0;const e=n.indexOf(t);if(e>=0)n.splice(e,1)}return n};return n}async function Ma(t,e){try{await e(t)}catch(n){t.error(n)}}const Aa=Symbol("vega_id");let Ea=1;function Da(t){return!!(t&&Ca(t))}function Ca(t){return t[Aa]}function Fa(t,e){t[Aa]=e;return t}function Sa(t){const e=t===Object(t)?t:{data:t};return Ca(e)?e:Fa(e,Ea++)}function Ta(t){return Ba(t,Sa({}))}function Ba(t,e){for(const n in t)e[n]=t[n];return e}function Na(t,e){return Fa(e,Ca(t))}function za(t,e){return!t?null:e?(n,i)=>t(n,i)||Ca(e(n))-Ca(e(i)):(e,n)=>t(e,n)||Ca(e)-Ca(n)}function Oa(t){return t&&t.constructor===Ra}function Ra(){const t=[],e=[],n=[],i=[],r=[];let a=null,o=false;return{constructor:Ra,insert(e){const n=(0,g.IX)(e),i=n.length;for(let r=0;r<i;++r)t.push(n[r]);return this},remove(t){const n=(0,g.mf)(t)?i:e,r=(0,g.IX)(t),a=r.length;for(let e=0;e<a;++e)n.push(r[e]);return this},modify(t,e,i){const a={field:e,value:(0,g.a9)(i)};if((0,g.mf)(t)){a.filter=t;r.push(a)}else{a.tuple=t;n.push(a)}return this},encode(t,e){if((0,g.mf)(t))r.push({filter:t,field:e});else n.push({tuple:t,field:e});return this},clean(t){a=t;return this},reflow(){o=true;return this},pulse(u,s){const l={},f={};let c,h,d,p,g,m;for(c=0,h=s.length;c<h;++c){l[Ca(s[c])]=1}for(c=0,h=e.length;c<h;++c){g=e[c];l[Ca(g)]=-1}for(c=0,h=i.length;c<h;++c){p=i[c];s.forEach((t=>{if(p(t))l[Ca(t)]=-1}))}for(c=0,h=t.length;c<h;++c){g=t[c];m=Ca(g);if(l[m]){l[m]=1}else{u.add.push(Sa(t[c]))}}for(c=0,h=s.length;c<h;++c){g=s[c];if(l[Ca(g)]<0)u.rem.push(g)}function y(t,e,n){if(n){t[e]=n(t)}else{u.encode=e}if(!o)f[Ca(t)]=t}for(c=0,h=n.length;c<h;++c){d=n[c];g=d.tuple;p=d.field;m=l[Ca(g)];if(m>0){y(g,p,d.value);u.modifies(p)}}for(c=0,h=r.length;c<h;++c){d=r[c];p=d.filter;s.forEach((t=>{if(p(t)&&l[Ca(t)]>0){y(t,d.field,d.value)}}));u.modifies(d.field)}if(o){u.mod=e.length||i.length?s.filter((t=>l[Ca(t)]>0)):s.slice()}else{for(m in f)u.mod.push(f[m])}if(a||a==null&&(e.length||i.length)){u.clean(true)}return u}}}const Ua="_:mod:_";function $a(){Object.defineProperty(this,Ua,{writable:true,value:{}})}$a.prototype={set(t,e,n,i){const r=this,a=r[t],o=r[Ua];if(e!=null&&e>=0){if(a[e]!==n||i){a[e]=n;o[e+":"+t]=-1;o[t]=-1}}else if(a!==n||i){r[t]=n;o[t]=(0,g.kJ)(n)?1+n.length:-1}return r},modified(t,e){const n=this[Ua];if(!arguments.length){for(const t in n){if(n[t])return true}return false}else if((0,g.kJ)(t)){for(let e=0;e<t.length;++e){if(n[t[e]])return true}return false}return e!=null&&e>=0?e+1<n[t]||!!n[e+":"+t]:!!n[t]},clear(){this[Ua]={};return this}};let Pa=0;const qa="pulse",Ia=new $a;const La=1,ja=2;function Wa(t,e,n,i){this.id=++Pa;this.value=t;this.stamp=-1;this.rank=-1;this.qrank=-1;this.flags=0;if(e){this._update=e}if(n)this.parameters(n,i)}function Xa(t){return function(e){const n=this.flags;if(arguments.length===0)return!!(n&t);this.flags=e?n|t:n&~t;return this}}Wa.prototype={targets(){return this._targets||(this._targets=ka(g.id))},set(t){if(this.value!==t){this.value=t;return 1}else{return 0}},skip:Xa(La),modified:Xa(ja),parameters(t,e,n){e=e!==false;const i=this._argval=this._argval||new $a,r=this._argops=this._argops||[],a=[];let o,u,s,l;const f=(t,n,o)=>{if(o instanceof Wa){if(o!==this){if(e)o.targets().add(this);a.push(o)}r.push({op:o,name:t,index:n})}else{i.set(t,n,o)}};for(o in t){u=t[o];if(o===qa){(0,g.IX)(u).forEach((t=>{if(!(t instanceof Wa)){(0,g.vU)("Pulse parameters must be operator instances.")}else if(t!==this){t.targets().add(this);a.push(t)}}));this.source=u}else if((0,g.kJ)(u)){i.set(o,-1,Array(s=u.length));for(l=0;l<s;++l)f(o,l,u[l])}else{f(o,-1,u)}}this.marshall().clear();if(n)r.initonly=true;return a},marshall(t){const e=this._argval||Ia,n=this._argops;let i,r,a,o;if(n){const u=n.length;for(r=0;r<u;++r){i=n[r];a=i.op;o=a.modified()&&a.stamp===t;e.set(i.name,i.index,a.value,o)}if(n.initonly){for(r=0;r<u;++r){i=n[r];i.op.targets().remove(this)}this._argops=null;this._update=null}}return e},detach(){const t=this._argops;let e,n,i,r;if(t){for(e=0,n=t.length;e<n;++e){i=t[e];r=i.op;if(r._targets){r._targets.remove(this)}}}this.pulse=null;this.source=null},evaluate(t){const e=this._update;if(e){const n=this.marshall(t.stamp),i=e.call(this,n,t);n.clear();if(i!==this.value){this.value=i}else if(!this.modified()){return t.StopPropagation}}},run(t){if(t.stamp<this.stamp)return t.StopPropagation;let e;if(this.skip()){this.skip(false);e=0}else{e=this.evaluate(t)}return this.pulse=e||t}};function Ha(t,e,n,i){let r=1,a;if(t instanceof Wa){a=t}else if(t&&t.prototype instanceof Wa){a=new t}else if((0,g.mf)(t)){a=new Wa(null,t)}else{r=0;a=new Wa(t,e)}this.rank(a);if(r){i=n;n=e}if(n)this.connect(a,a.parameters(n,i));this.touch(a);return a}function Ya(t,e){const n=t.rank,i=e.length;for(let r=0;r<i;++r){if(n<e[r].rank){this.rerank(t);return}}}let Ja=0;function Va(t,e,n){this.id=++Ja;this.value=null;if(n)this.receive=n;if(t)this._filter=t;if(e)this._apply=e}function Ga(t,e,n){return new Va(t,e,n)}Va.prototype={_filter:g.yb,_apply:g.yR,targets(){return this._targets||(this._targets=ka(g.id))},consume(t){if(!arguments.length)return!!this._consume;this._consume=!!t;return this},receive(t){if(this._filter(t)){const e=this.value=this._apply(t),n=this._targets,i=n?n.length:0;for(let t=0;t<i;++t)n[t].receive(e);if(this._consume){t.preventDefault();t.stopPropagation()}}},filter(t){const e=Ga(t);this.targets().add(e);return e},apply(t){const e=Ga(null,t);this.targets().add(e);return e},merge(){const t=Ga();this.targets().add(t);for(let e=0,n=arguments.length;e<n;++e){arguments[e].targets().add(t)}return t},throttle(t){let e=-1;return this.filter((()=>{const n=Date.now();if(n-e>t){e=n;return 1}else{return 0}}))},debounce(t){const e=Ga();this.targets().add(Ga(null,null,(0,g.Ds)(t,(t=>{const n=t.dataflow;e.receive(t);if(n&&n.run)n.run()}))));return e},between(t,e){let n=false;t.targets().add(Ga(null,null,(()=>n=true)));e.targets().add(Ga(null,null,(()=>n=false)));return this.filter((()=>n))},detach(){this._filter=g.yb;this._targets=null}};function Ka(t,e,n,i){const r=this,a=Ga(n,i),o=function(t){t.dataflow=r;try{a.receive(t)}catch(e){r.error(e)}finally{r.run()}};let u;if(typeof t==="string"&&typeof document!=="undefined"){u=document.querySelectorAll(t)}else{u=(0,g.IX)(t)}const s=u.length;for(let l=0;l<s;++l){u[l].addEventListener(e,o)}return a}function Za(t,e){const n=this.locale();return _a(t,e,n.timeParse,n.utcParse)}function Qa(t,e,n){e=this.parse(e,n);return this.pulse(t,this.changeset().insert(e))}async function to(t,e){const n=this;let i=0,r;try{r=await n.loader().load(t,{context:"dataflow",response:xa(e&&e.type)});try{r=n.parse(r,e)}catch(a){i=-2;n.warn("Data ingestion failed",t,a)}}catch(a){i=-1;n.warn("Loading failed",t,a)}return{data:r,status:i}}async function eo(t,e,n){const i=this,r=i._pending||no(i);r.requests+=1;const a=await i.request(e,n);i.pulse(t,i.changeset().remove(g.yb).insert(a.data||[]));r.done();return a}function no(t){let e;const n=new Promise((t=>e=t));n.requests=0;n.done=()=>{if(--n.requests===0){t._pending=null;e(t)}};return t._pending=n}const io={skip:true};function ro(t,e,n,i,r){const a=t instanceof Wa?oo:ao;a(this,t,e,n,i,r);return this}function ao(t,e,n,i,r,a){const o=(0,g.l7)({},a,io);let u,s;if(!(0,g.mf)(n))n=(0,g.a9)(n);if(i===undefined){u=e=>t.touch(n(e))}else if((0,g.mf)(i)){s=new Wa(null,i,r,false);u=e=>{s.evaluate(e);const i=n(e),r=s.value;Oa(r)?t.pulse(i,r,a):t.update(i,r,o)}}else{u=e=>t.update(n(e),i,o)}e.apply(u)}function oo(t,e,n,i,r,a){if(i===undefined){e.targets().add(n)}else{const o=a||{},u=new Wa(null,uo(n,i),r,false);u.modified(o.force);u.rank=e.rank;e.targets().add(u);if(n){u.skip(true);u.value=n.value;u.targets().add(n);t.connect(n,[u])}}}function uo(t,e){e=(0,g.mf)(e)?e:(0,g.a9)(e);return t?function(n,i){const r=e(n,i);if(!t.skip()){t.skip(r!==this.value).value=r}return r}:e}function so(t){t.rank=++this._rank}function lo(t){const e=[t];let n,i,r;while(e.length){this.rank(n=e.pop());if(i=n._targets){for(r=i.length;--r>=0;){e.push(n=i[r]);if(n===t)(0,g.vU)("Cycle detected in dataflow graph.")}}}}const fo={};const co=1<<0,ho=1<<1,po=1<<2,go=co|ho,mo=co|po,yo=co|ho|po,vo=1<<3,xo=1<<4,_o=1<<5,bo=1<<6;function wo(t,e,n){this.dataflow=t;this.stamp=e==null?-1:e;this.add=[];this.rem=[];this.mod=[];this.fields=null;this.encode=n||null}function ko(t,e){const n=[];(0,g.FP)(t,e,(t=>n.push(t)));return n}function Mo(t,e){const n={};t.visit(e,(t=>{n[Ca(t)]=1}));return t=>n[Ca(t)]?null:t}function Ao(t,e){return t?(n,i)=>t(n,i)&&e(n,i):e}wo.prototype={StopPropagation:fo,ADD:co,REM:ho,MOD:po,ADD_REM:go,ADD_MOD:mo,ALL:yo,REFLOW:vo,SOURCE:xo,NO_SOURCE:_o,NO_FIELDS:bo,fork(t){return new wo(this.dataflow).init(this,t)},clone(){const t=this.fork(yo);t.add=t.add.slice();t.rem=t.rem.slice();t.mod=t.mod.slice();if(t.source)t.source=t.source.slice();return t.materialize(yo|xo)},addAll(){let t=this;const e=!t.source||t.add===t.rem||!t.rem.length&&t.source.length===t.add.length;if(e){return t}else{t=new wo(this.dataflow).init(this);t.add=t.source;t.rem=[];return t}},init(t,e){const n=this;n.stamp=t.stamp;n.encode=t.encode;if(t.fields&&!(e&bo)){n.fields=t.fields}if(e&co){n.addF=t.addF;n.add=t.add}else{n.addF=null;n.add=[]}if(e&ho){n.remF=t.remF;n.rem=t.rem}else{n.remF=null;n.rem=[]}if(e&po){n.modF=t.modF;n.mod=t.mod}else{n.modF=null;n.mod=[]}if(e&_o){n.srcF=null;n.source=null}else{n.srcF=t.srcF;n.source=t.source;if(t.cleans)n.cleans=t.cleans}return n},runAfter(t){this.dataflow.runAfter(t)},changed(t){const e=t||yo;return e&co&&this.add.length||e&ho&&this.rem.length||e&po&&this.mod.length},reflow(t){if(t)return this.fork(yo).reflow();const e=this.add.length,n=this.source&&this.source.length;if(n&&n!==e){this.mod=this.source;if(e)this.filter(po,Mo(this,co))}return this},clean(t){if(arguments.length){this.cleans=!!t;return this}else{return this.cleans}},modifies(t){const e=this.fields||(this.fields={});if((0,g.kJ)(t)){t.forEach((t=>e[t]=true))}else{e[t]=true}return this},modified(t,e){const n=this.fields;return!((e||this.mod.length)&&n)?false:!arguments.length?!!n:(0,g.kJ)(t)?t.some((t=>n[t])):n[t]},filter(t,e){const n=this;if(t&co)n.addF=Ao(n.addF,e);if(t&ho)n.remF=Ao(n.remF,e);if(t&po)n.modF=Ao(n.modF,e);if(t&xo)n.srcF=Ao(n.srcF,e);return n},materialize(t){t=t||yo;const e=this;if(t&co&&e.addF){e.add=ko(e.add,e.addF);e.addF=null}if(t&ho&&e.remF){e.rem=ko(e.rem,e.remF);e.remF=null}if(t&po&&e.modF){e.mod=ko(e.mod,e.modF);e.modF=null}if(t&xo&&e.srcF){e.source=e.source.filter(e.srcF);e.srcF=null}return e},visit(t,e){const n=this,i=e;if(t&xo){(0,g.FP)(n.source,n.srcF,i);return n}if(t&co)(0,g.FP)(n.add,n.addF,i);if(t&ho)(0,g.FP)(n.rem,n.remF,i);if(t&po)(0,g.FP)(n.mod,n.modF,i);const r=n.source;if(t&vo&&r){const t=n.add.length+n.mod.length;if(t===r.length);else if(t){(0,g.FP)(r,Mo(n,mo),i)}else{(0,g.FP)(r,n.srcF,i)}}return n}};function Eo(t,e,n,i){const r=this,a=n.length;let o=0;this.dataflow=t;this.stamp=e;this.fields=null;this.encode=i||null;this.pulses=n;for(let u=0;u<a;++u){const t=n[u];if(t.stamp!==e)continue;if(t.fields){const e=r.fields||(r.fields={});for(const n in t.fields){e[n]=1}}if(t.changed(r.ADD))o|=r.ADD;if(t.changed(r.REM))o|=r.REM;if(t.changed(r.MOD))o|=r.MOD}this.changes=o}(0,g.XW)(Eo,wo,{fork(t){const e=new wo(this.dataflow).init(this,t&this.NO_FIELDS);if(t!==undefined){if(t&e.ADD)this.visit(e.ADD,(t=>e.add.push(t)));if(t&e.REM)this.visit(e.REM,(t=>e.rem.push(t)));if(t&e.MOD)this.visit(e.MOD,(t=>e.mod.push(t)))}return e},changed(t){return this.changes&t},modified(t){const e=this,n=e.fields;return!(n&&e.changes&e.MOD)?0:(0,g.kJ)(t)?t.some((t=>n[t])):n[t]},filter(){(0,g.vU)("MultiPulse does not support filtering.")},materialize(){(0,g.vU)("MultiPulse does not support materialization.")},visit(t,e){const n=this,i=n.pulses,r=i.length;let a=0;if(t&n.SOURCE){for(;a<r;++a){i[a].visit(t,e)}}else{for(;a<r;++a){if(i[a].stamp===n.stamp){i[a].visit(t,e)}}}return n}});async function Do(t,e,n){const i=this,r=[];if(i._pulse)return To(i);if(i._pending)await i._pending;if(e)await Ma(i,e);if(!i._touched.length){i.debug("Dataflow invoked, but nothing to do.");return i}const a=++i._clock;i._pulse=new wo(i,a,t);i._touched.forEach((t=>i._enqueue(t,true)));i._touched=ka(g.id);let o=0,u,s,l;try{while(i._heap.size()>0){u=i._heap.pop();if(u.rank!==u.qrank){i._enqueue(u,true);continue}s=u.run(i._getPulse(u,t));if(s.then){s=await s}else if(s.async){r.push(s.async);s=fo}if(s!==fo){if(u._targets)u._targets.forEach((t=>i._enqueue(t)))}++o}}catch(f){i._heap.clear();l=f}i._input={};i._pulse=null;i.debug(`Pulse ${a}: ${o} operators`);if(l){i._postrun=[];i.error(l)}if(i._postrun.length){const t=i._postrun.sort(((t,e)=>e.priority-t.priority));i._postrun=[];for(let e=0;e<t.length;++e){await Ma(i,t[e].callback)}}if(n)await Ma(i,n);if(r.length){Promise.all(r).then((t=>i.runAsync(null,(()=>{t.forEach((t=>{try{t(i)}catch(f){i.error(f)}}))}))))}return i}async function Co(t,e,n){while(this._running)await this._running;const i=()=>this._running=null;(this._running=this.evaluate(t,e,n)).then(i,i);return this._running}function Fo(t,e,n){return this._pulse?To(this):(this.evaluate(t,e,n),this)}function So(t,e,n){if(this._pulse||e){this._postrun.push({priority:n||0,callback:t})}else{try{t(this)}catch(i){this.error(i)}}}function To(t){t.error("Dataflow already running. Use runAsync() to chain invocations.");return t}function Bo(t,e){const n=t.stamp<this._clock;if(n)t.stamp=this._clock;if(n||e){t.qrank=t.rank;this._heap.push(t)}}function No(t,e){const n=t.source,i=this._clock;return n&&(0,g.kJ)(n)?new Eo(this,i,n.map((t=>t.pulse)),e):this._input[t.id]||zo(this._pulse,n&&n.pulse)}function zo(t,e){if(e&&e.stamp===t.stamp){return e}t=t.fork();if(e&&e!==fo){t.source=e.source}return t}const Oo={skip:false,force:false};function Ro(t,e){const n=e||Oo;if(this._pulse){this._enqueue(t)}else{this._touched.add(t)}if(n.skip)t.skip(true);return this}function Uo(t,e,n){const i=n||Oo;if(t.set(e)||i.force){this.touch(t,i)}return this}function $o(t,e,n){this.touch(t,n||Oo);const i=new wo(this,this._clock+(this._pulse?0:1)),r=t.pulse&&t.pulse.source||[];i.target=t;this._input[t.id]=e.pulse(i,r);return this}function Po(t){let e=[];return{clear:()=>e=[],size:()=>e.length,peek:()=>e[0],push:n=>{e.push(n);return qo(e,0,e.length-1,t)},pop:()=>{const n=e.pop();let i;if(e.length){i=e[0];e[0]=n;Io(e,0,t)}else{i=n}return i}}}function qo(t,e,n,i){let r,a;const o=t[n];while(n>e){a=n-1>>1;r=t[a];if(i(o,r)<0){t[n]=r;n=a;continue}break}return t[n]=o}function Io(t,e,n){const i=e,r=t.length,a=t[e];let o=(e<<1)+1,u;while(o<r){u=o+1;if(u<r&&n(t[o],t[u])>=0){o=u}t[e]=t[o];e=o;o=(e<<1)+1}t[e]=a;return qo(t,i,e,n)}function Lo(){this.logger((0,g.kg)());this.logLevel(g.jj);this._clock=0;this._rank=0;this._locale=Ir();try{this._loader=wa()}catch(t){}this._touched=ka(g.id);this._input={};this._pulse=null;this._heap=Po(((t,e)=>t.qrank-e.qrank));this._postrun=[]}function jo(t){return function(){return this._log[t].apply(this,arguments)}}Lo.prototype={stamp(){return this._clock},loader(t){if(arguments.length){this._loader=t;return this}else{return this._loader}},locale(t){if(arguments.length){this._locale=t;return this}else{return this._locale}},logger(t){if(arguments.length){this._log=t;return this}else{return this._log}},error:jo("error"),warn:jo("warn"),info:jo("info"),debug:jo("debug"),logLevel:jo("level"),cleanThreshold:1e4,add:Ha,connect:Ya,rank:so,rerank:lo,pulse:$o,touch:Ro,update:Uo,changeset:Ra,ingest:Qa,parse:Za,preload:eo,request:to,events:Ka,on:ro,evaluate:Do,run:Fo,runAsync:Co,runAfter:So,_enqueue:Bo,_getPulse:No};function Wo(t,e){Wa.call(this,t,null,e)}(0,g.XW)(Wo,Wa,{run(t){if(t.stamp<this.stamp)return t.StopPropagation;let e;if(this.skip()){this.skip(false)}else{e=this.evaluate(t)}e=e||t;if(e.then){e=e.then((t=>this.pulse=t))}else if(e!==t.StopPropagation){this.pulse=e}return e},evaluate(t){const e=this.marshall(t.stamp),n=this.transform(e,t);e.clear();return n},transform(){}});const Xo={};function Ho(t){const e=Yo(t);return e&&e.Definition||null}function Yo(t){t=t&&t.toLowerCase();return(0,g.nr)(Xo,t)?Xo[t]:null}function Jo(t,e){let n;if(e===undefined){for(const e of t){if(e!=null&&(n<e||n===undefined&&e>=e)){n=e}}}else{let i=-1;for(let r of t){if((r=e(r,++i,t))!=null&&(n<r||n===undefined&&r>=r)){n=r}}}return n}function Vo(t,e){let n;if(e===undefined){for(const e of t){if(e!=null&&(n>e||n===undefined&&e>=e)){n=e}}}else{let i=-1;for(let r of t){if((r=e(r,++i,t))!=null&&(n>r||n===undefined&&r>=r)){n=r}}}return n}function Go(t,e,n=0,i=t.length-1,r=Re){while(i>n){if(i-n>600){const a=i-n+1;const o=e-n+1;const u=Math.log(a);const s=.5*Math.exp(2*u/3);const l=.5*Math.sqrt(u*s*(a-s)/a)*(o-a/2<0?-1:1);const f=Math.max(n,Math.floor(e-o*s/a+l));const c=Math.min(i,Math.floor(e+(a-o)*s/a+l));Go(t,e,f,c,r)}const a=t[e];let o=n;let u=i;Ko(t,n,e);if(r(t[i],a)>0)Ko(t,n,i);while(o<u){Ko(t,o,u),++o,--u;while(r(t[o],a)<0)++o;while(r(t[u],a)>0)--u}if(r(t[n],a)===0)Ko(t,n,u);else++u,Ko(t,u,i);if(u<=e)n=u+1;if(e<=u)i=u-1}return t}function Ko(t,e,n){const i=t[e];t[e]=t[n];t[n]=i}function Zo(t){return t===null?NaN:+t}function*Qo(t,e){if(e===undefined){for(let e of t){if(e!=null&&(e=+e)>=e){yield e}}}else{let n=-1;for(let i of t){if((i=e(i,++n,t))!=null&&(i=+i)>=i){yield i}}}}function tu(t,e,n){t=Float64Array.from(Qo(t,n));if(!(i=t.length))return;if((e=+e)<=0||i<2)return Vo(t);if(e>=1)return Jo(t);var i,r=(i-1)*e,a=Math.floor(r),o=Jo(Go(t,a).subarray(0,a+1)),u=Vo(t.subarray(a+1));return o+(u-o)*(r-a)}function eu(t,e,n=Zo){if(!(i=t.length))return;if((e=+e)<=0||i<2)return+n(t[0],0,t);if(e>=1)return+n(t[i-1],i-1,t);var i,r=(i-1)*e,a=Math.floor(r),o=+n(t[a],a,t),u=+n(t[a+1],a+1,t);return o+(u-o)*(r-a)}function nu(t,e){let n=0;let i;let r=0;let a=0;if(e===undefined){for(let e of t){if(e!=null&&(e=+e)>=e){i=e-r;r+=i/++n;a+=i*(e-r)}}}else{let o=-1;for(let u of t){if((u=e(u,++o,t))!=null&&(u=+u)>=u){i=u-r;r+=i/++n;a+=i*(u-r)}}}if(n>1)return a/(n-1)}function iu(t,e){const n=nu(t,e);return n?Math.sqrt(n):n}function ru(t,e){return tu(t,.5,e)}function*au(t,e){if(e==null){for(let e of t){if(e!=null&&e!==""&&(e=+e)>=e){yield e}}}else{let n=-1;for(let i of t){i=e(i,++n,t);if(i!=null&&i!==""&&(i=+i)>=i){yield i}}}}function ou(t,e,n){const i=Float64Array.from(au(t,n));i.sort(Re);return e.map((t=>eu(i,t)))}function uu(t,e){return ou(t,[.25,.5,.75],e)}function su(t,e){const n=t.length,i=iu(t,e),r=uu(t,e),a=(r[2]-r[0])/1.34,o=Math.min(i,a)||i||Math.abs(r[0])||1;return 1.06*o*Math.pow(n,-.2)}function lu(t){const e=t.maxbins||20,n=t.base||10,i=Math.log(n),r=t.divide||[5,2];let a=t.extent[0],o=t.extent[1],u,s,l,f,c,h;const d=t.span||o-a||Math.abs(a)||1;if(t.step){u=t.step}else if(t.steps){f=d/e;for(c=0,h=t.steps.length;c<h&&t.steps[c]<f;++c);u=t.steps[Math.max(0,c-1)]}else{s=Math.ceil(Math.log(e)/i);l=t.minstep||0;u=Math.max(l,Math.pow(n,Math.round(Math.log(d)/i)-s));while(Math.ceil(d/u)>e){u*=n}for(c=0,h=r.length;c<h;++c){f=u/r[c];if(f>=l&&d/f<=e)u=f}}f=Math.log(u);const p=f>=0?0:~~(-f/i)+1,g=Math.pow(n,-p-1);if(t.nice||t.nice===undefined){f=Math.floor(a/u+g)*u;a=a<f?f-u:f;o=Math.ceil(o/u)*u}return{start:a,stop:o===a?a+u:o,step:u}}var fu=Math.random;function cu(t){fu=t}function hu(t,e,n,i){if(!t.length)return[undefined,undefined];const r=Float64Array.from(au(t,i)),a=r.length,o=e;let u,s,l,f;for(l=0,f=Array(o);l<o;++l){for(u=0,s=0;s<a;++s){u+=r[~~(fu()*a)]}f[l]=u/a}f.sort(Re);return[tu(f,n/2),tu(f,1-n/2)]}function du(t,e,n,i){i=i||(t=>t);const r=t.length,a=new Float64Array(r);let o=0,u=1,s=i(t[0]),l=s,f=s+e,c;for(;u<r;++u){c=i(t[u]);if(c>=f){l=(s+l)/2;for(;o<u;++o)a[o]=l;f=c+e;s=c}l=c}l=(s+l)/2;for(;o<u;++o)a[o]=l;return n?pu(a,e+e/4):a}function pu(t,e){const n=t.length;let i=0,r=1,a,o;while(t[i]===t[r])++r;while(r<n){a=r+1;while(t[r]===t[a])++a;if(t[r]-t[r-1]<e){o=r+(i+a-r-r>>1);while(o<r)t[o++]=t[r];while(o>r)t[o--]=t[i]}i=r;r=a}return t}function gu(t){return function(){t=(1103515245*t+12345)%2147483647;return t/2147483647}}function mu(t,e){if(e==null){e=t;t=0}let n,i,r;const a={min(t){if(arguments.length){n=t||0;r=i-n;return a}else{return n}},max(t){if(arguments.length){i=t||0;r=i-n;return a}else{return i}},sample(){return n+Math.floor(r*fu())},pdf(t){return t===Math.floor(t)&&t>=n&&t<i?1/r:0},cdf(t){const e=Math.floor(t);return e<n?0:e>=i?1:(e-n+1)/r},icdf(t){return t>=0&&t<=1?n-1+Math.floor(t*r):NaN}};return a.min(t).max(e)}const yu=Math.sqrt(2*Math.PI);const vu=Math.SQRT2;let xu=NaN;function _u(t,e){t=t||0;e=e==null?1:e;let n=0,i=0,r,a;if(xu===xu){n=xu;xu=NaN}else{do{n=fu()*2-1;i=fu()*2-1;r=n*n+i*i}while(r===0||r>1);a=Math.sqrt(-2*Math.log(r)/r);n*=a;xu=i*a}return t+n*e}function bu(t,e,n){n=n==null?1:n;const i=(t-(e||0))/n;return Math.exp(-.5*i*i)/(n*yu)}function wu(t,e,n){e=e||0;n=n==null?1:n;const i=(t-e)/n,r=Math.abs(i);let a;if(r>37){a=0}else{const t=Math.exp(-r*r/2);let e;if(r<7.07106781186547){e=.0352624965998911*r+.700383064443688;e=e*r+6.37396220353165;e=e*r+33.912866078383;e=e*r+112.079291497871;e=e*r+221.213596169931;e=e*r+220.206867912376;a=t*e;e=.0883883476483184*r+1.75566716318264;e=e*r+16.064177579207;e=e*r+86.7807322029461;e=e*r+296.564248779674;e=e*r+637.333633378831;e=e*r+793.826512519948;e=e*r+440.413735824752;a=a/e}else{e=r+.65;e=r+4/e;e=r+3/e;e=r+2/e;e=r+1/e;a=t/e/2.506628274631}}return i>0?1-a:a}function ku(t,e,n){if(t<0||t>1)return NaN;return(e||0)+(n==null?1:n)*vu*Mu(2*t-1)}function Mu(t){let e=-Math.log((1-t)*(1+t)),n;if(e<6.25){e-=3.125;n=-364441206401782e-35;n=-16850591381820166e-35+n*e;n=128584807152564e-32+n*e;n=11157877678025181e-33+n*e;n=-1333171662854621e-31+n*e;n=20972767875968562e-33+n*e;n=6637638134358324e-30+n*e;n=-4054566272975207e-29+n*e;n=-8151934197605472e-29+n*e;n=26335093153082323e-28+n*e;n=-12975133253453532e-27+n*e;n=-5415412054294628e-26+n*e;n=1.0512122733215323e-9+n*e;n=-4.112633980346984e-9+n*e;n=-2.9070369957882005e-8+n*e;n=4.2347877827932404e-7+n*e;n=-13654692000834679e-22+n*e;n=-13882523362786469e-21+n*e;n=.00018673420803405714+n*e;n=-.000740702534166267+n*e;n=-.006033670871430149+n*e;n=.24015818242558962+n*e;n=1.6536545626831027+n*e}else if(e<16){e=Math.sqrt(e)-3.25;n=2.2137376921775787e-9;n=9.075656193888539e-8+n*e;n=-2.7517406297064545e-7+n*e;n=1.8239629214389228e-8+n*e;n=15027403968909828e-22+n*e;n=-4013867526981546e-21+n*e;n=29234449089955446e-22+n*e;n=12475304481671779e-21+n*e;n=-47318229009055734e-21+n*e;n=6828485145957318e-20+n*e;n=24031110387097894e-21+n*e;n=-.0003550375203628475+n*e;n=.0009532893797373805+n*e;n=-.0016882755560235047+n*e;n=.002491442096107851+n*e;n=-.003751208507569241+n*e;n=.005370914553590064+n*e;n=1.0052589676941592+n*e;n=3.0838856104922208+n*e}else if(Number.isFinite(e)){e=Math.sqrt(e)-5;n=-27109920616438573e-27;n=-2.555641816996525e-10+n*e;n=1.5076572693500548e-9+n*e;n=-3.789465440126737e-9+n*e;n=7.61570120807834e-9+n*e;n=-1.496002662714924e-8+n*e;n=2.914795345090108e-8+n*e;n=-6.771199775845234e-8+n*e;n=2.2900482228026655e-7+n*e;n=-9.9298272942317e-7+n*e;n=4526062597223154e-21+n*e;n=-1968177810553167e-20+n*e;n=7599527703001776e-20+n*e;n=-.00021503011930044477+n*e;n=-.00013871931833623122+n*e;n=1.0103004648645344+n*e;n=4.849906401408584+n*e}else{n=Infinity}return n*t}function Au(t,e){let n,i;const r={mean(t){if(arguments.length){n=t||0;return r}else{return n}},stdev(t){if(arguments.length){i=t==null?1:t;return r}else{return i}},sample:()=>_u(n,i),pdf:t=>bu(t,n,i),cdf:t=>wu(t,n,i),icdf:t=>ku(t,n,i)};return r.mean(t).stdev(e)}function Eu(t,e){const n=Au();let i=0;const r={data(n){if(arguments.length){t=n;i=n?n.length:0;return r.bandwidth(e)}else{return t}},bandwidth(n){if(!arguments.length)return e;e=n;if(!e&&t)e=su(t);return r},sample(){return t[~~(fu()*i)]+e*n.sample()},pdf(r){let a=0,o=0;for(;o<i;++o){a+=n.pdf((r-t[o])/e)}return a/e/i},cdf(r){let a=0,o=0;for(;o<i;++o){a+=n.cdf((r-t[o])/e)}return a/i},icdf(){throw Error("KDE icdf not supported.")}};return r.data(t)}function Du(t,e){t=t||0;e=e==null?1:e;return Math.exp(t+_u()*e)}function Cu(t,e,n){if(t<=0)return 0;e=e||0;n=n==null?1:n;const i=(Math.log(t)-e)/n;return Math.exp(-.5*i*i)/(n*yu*t)}function Fu(t,e,n){return wu(Math.log(t),e,n)}function Su(t,e,n){return Math.exp(ku(t,e,n))}function Tu(t,e){let n,i;const r={mean(t){if(arguments.length){n=t||0;return r}else{return n}},stdev(t){if(arguments.length){i=t==null?1:t;return r}else{return i}},sample:()=>Du(n,i),pdf:t=>Cu(t,n,i),cdf:t=>Fu(t,n,i),icdf:t=>Su(t,n,i)};return r.mean(t).stdev(e)}function Bu(t,e){let n=0,i;function r(t){const e=[];let i=0,r;for(r=0;r<n;++r){i+=e[r]=t[r]==null?1:+t[r]}for(r=0;r<n;++r){e[r]/=i}return e}const a={weights(t){if(arguments.length){i=r(e=t||[]);return a}return e},distributions(i){if(arguments.length){if(i){n=i.length;t=i}else{n=0;t=[]}return a.weights(e)}return t},sample(){const e=fu();let r=t[n-1],a=i[0],o=0;for(;o<n-1;a+=i[++o]){if(e<a){r=t[o];break}}return r.sample()},pdf(e){let r=0,a=0;for(;a<n;++a){r+=i[a]*t[a].pdf(e)}return r},cdf(e){let r=0,a=0;for(;a<n;++a){r+=i[a]*t[a].cdf(e)}return r},icdf(){throw Error("Mixture icdf not supported.")}};return a.distributions(t).weights(e)}function Nu(t,e){if(e==null){e=t==null?1:t;t=0}return t+(e-t)*fu()}function zu(t,e,n){if(n==null){n=e==null?1:e;e=0}return t>=e&&t<=n?1/(n-e):0}function Ou(t,e,n){if(n==null){n=e==null?1:e;e=0}return t<e?0:t>n?1:(t-e)/(n-e)}function Ru(t,e,n){if(n==null){n=e==null?1:e;e=0}return t>=0&&t<=1?e+t*(n-e):NaN}function Uu(t,e){let n,i;const r={min(t){if(arguments.length){n=t||0;return r}else{return n}},max(t){if(arguments.length){i=t==null?1:t;return r}else{return i}},sample:()=>Nu(n,i),pdf:t=>zu(t,n,i),cdf:t=>Ou(t,n,i),icdf:t=>Ru(t,n,i)};if(e==null){e=t==null?1:t;t=0}return r.min(t).max(e)}function $u(t,e,n,i){const r=i-t*t,a=Math.abs(r)<1e-24?0:(n-t*e)/r,o=e-a*t;return[o,a]}function Pu(t,e,n,i){t=t.filter((t=>{let i=e(t),r=n(t);return i!=null&&(i=+i)>=i&&r!=null&&(r=+r)>=r}));if(i){t.sort(((t,n)=>e(t)-e(n)))}const r=t.length,a=new Float64Array(r),o=new Float64Array(r);let u=0,s=0,l=0,f,c,h;for(h of t){a[u]=f=+e(h);o[u]=c=+n(h);++u;s+=(f-s)/u;l+=(c-l)/u}for(u=0;u<r;++u){a[u]-=s;o[u]-=l}return[a,o,s,l]}function qu(t,e,n,i){let r=-1,a,o;for(const u of t){a=e(u);o=n(u);if(a!=null&&(a=+a)>=a&&o!=null&&(o=+o)>=o){i(a,o,++r)}}}function Iu(t,e,n,i,r){let a=0,o=0;qu(t,e,n,((t,e)=>{const n=e-r(t),u=e-i;a+=n*n;o+=u*u}));return 1-a/o}function Lu(t,e,n){let i=0,r=0,a=0,o=0,u=0;qu(t,e,n,((t,e)=>{++u;i+=(t-i)/u;r+=(e-r)/u;a+=(t*e-a)/u;o+=(t*t-o)/u}));const s=$u(i,r,a,o),l=t=>s[0]+s[1]*t;return{coef:s,predict:l,rSquared:Iu(t,e,n,r,l)}}function ju(t,e,n){let i=0,r=0,a=0,o=0,u=0;qu(t,e,n,((t,e)=>{++u;t=Math.log(t);i+=(t-i)/u;r+=(e-r)/u;a+=(t*e-a)/u;o+=(t*t-o)/u}));const s=$u(i,r,a,o),l=t=>s[0]+s[1]*Math.log(t);return{coef:s,predict:l,rSquared:Iu(t,e,n,r,l)}}function Wu(t,e,n){const[i,r,a,o]=Pu(t,e,n);let u=0,s=0,l=0,f=0,c=0,h,d,p;qu(t,e,n,((t,e)=>{h=i[c++];d=Math.log(e);p=h*e;u+=(e*d-u)/c;s+=(p-s)/c;l+=(p*d-l)/c;f+=(h*p-f)/c}));const[g,m]=$u(s/o,u/o,l/o,f/o),y=t=>Math.exp(g+m*(t-a));return{coef:[Math.exp(g-m*a),m],predict:y,rSquared:Iu(t,e,n,o,y)}}function Xu(t,e,n){let i=0,r=0,a=0,o=0,u=0,s=0;qu(t,e,n,((t,e)=>{const n=Math.log(t),l=Math.log(e);++s;i+=(n-i)/s;r+=(l-r)/s;a+=(n*l-a)/s;o+=(n*n-o)/s;u+=(e-u)/s}));const l=$u(i,r,a,o),f=t=>l[0]*Math.pow(t,l[1]);l[0]=Math.exp(l[0]);return{coef:l,predict:f,rSquared:Iu(t,e,n,u,f)}}function Hu(t,e,n){const[i,r,a,o]=Pu(t,e,n),u=i.length;let s=0,l=0,f=0,c=0,h=0,d,p,g,m;for(d=0;d<u;){p=i[d];g=r[d++];m=p*p;s+=(m-s)/d;l+=(m*p-l)/d;f+=(m*m-f)/d;c+=(p*g-c)/d;h+=(m*g-h)/d}const y=f-s*s,v=s*y-l*l,x=(h*s-c*l)/v,_=(c*y-h*l)/v,b=-x*s,w=t=>{t=t-a;return x*t*t+_*t+b+o};return{coef:[b-_*a+x*a*a+o,_-2*x*a,x],predict:w,rSquared:Iu(t,e,n,o,w)}}function Yu(t,e,n,i){if(i===1)return Lu(t,e,n);if(i===2)return Hu(t,e,n);const[r,a,o,u]=Pu(t,e,n),s=r.length,l=[],f=[],c=i+1;let h,d,p,g,m;for(h=0;h<c;++h){for(p=0,g=0;p<s;++p){g+=Math.pow(r[p],h)*a[p]}l.push(g);m=new Float64Array(c);for(d=0;d<c;++d){for(p=0,g=0;p<s;++p){g+=Math.pow(r[p],h+d)}m[d]=g}f.push(m)}f.push(l);const y=Vu(f),v=t=>{t-=o;let e=u+y[0]+y[1]*t+y[2]*t*t;for(h=3;h<c;++h)e+=y[h]*Math.pow(t,h);return e};return{coef:Ju(c,y,-o,u),predict:v,rSquared:Iu(t,e,n,u,v)}}function Ju(t,e,n,i){const r=Array(t);let a,o,u,s;for(a=0;a<t;++a)r[a]=0;for(a=t-1;a>=0;--a){u=e[a];s=1;r[a]+=u;for(o=1;o<=a;++o){s*=(a+1-o)/o;r[a-o]+=u*Math.pow(n,o)*s}}r[0]+=i;return r}function Vu(t){const e=t.length-1,n=[];let i,r,a,o,u;for(i=0;i<e;++i){o=i;for(r=i+1;r<e;++r){if(Math.abs(t[i][r])>Math.abs(t[i][o])){o=r}}for(a=i;a<e+1;++a){u=t[a][i];t[a][i]=t[a][o];t[a][o]=u}for(r=i+1;r<e;++r){for(a=e;a>=i;a--){t[a][r]-=t[a][i]*t[i][r]/t[i][i]}}}for(r=e-1;r>=0;--r){u=0;for(a=r+1;a<e;++a){u+=t[a][r]*n[a]}n[r]=(t[e][r]-u)/t[r][r]}return n}const Gu=2,Ku=1e-12;function Zu(t,e,n,i){const[r,a,o,u]=Pu(t,e,n,true),s=r.length,l=Math.max(2,~~(i*s)),f=new Float64Array(s),c=new Float64Array(s),h=new Float64Array(s).fill(1);for(let d=-1;++d<=Gu;){const t=[0,l-1];for(let n=0;n<s;++n){const e=r[n],i=t[0],o=t[1],u=e-r[i]>r[o]-e?i:o;let s=0,l=0,d=0,p=0,g=0;const m=1/Math.abs(r[u]-e||1);for(let t=i;t<=o;++t){const n=r[t],i=a[t],o=Qu(Math.abs(e-n)*m)*h[t],u=n*o;s+=o;l+=u;d+=i*o;p+=i*u;g+=n*u}const[y,v]=$u(l/s,d/s,p/s,g/s);f[n]=y+v*e;c[n]=Math.abs(a[n]-f[n]);ts(r,n+1,t)}if(d===Gu){break}const e=ru(c);if(Math.abs(e)<Ku)break;for(let n=0,i,r;n<s;++n){i=c[n]/(6*e);h[n]=i>=1?Ku:(r=1-i*i)*r}}return es(r,f,o,u)}function Qu(t){return(t=1-t*t*t)*t*t}function ts(t,e,n){const i=t[e];let r=n[0],a=n[1]+1;if(a>=t.length)return;while(e>r&&t[a]-i<=i-t[r]){n[0]=++r;n[1]=a;++a}}function es(t,e,n,i){const r=t.length,a=[];let o=0,u=0,s=[],l;for(;o<r;++o){l=t[o]+n;if(s[0]===l){s[1]+=(e[o]-s[1])/++u}else{u=0;s[1]+=i;s=[l,e[o]];a.push(s)}}s[1]+=i;return a}const ns=.5*Math.PI/180;function is(t,e,n,i){n=n||25;i=Math.max(n,i||200);const r=e=>[e,t(e)],a=e[0],o=e[1],u=o-a,s=u/i,l=[r(a)],f=[];if(n===i){for(let t=1;t<i;++t){l.push(r(a+t/n*u))}l.push(r(o));return l}else{f.push(r(o));for(let t=n;--t>0;){f.push(r(a+t/n*u))}}let c=l[0];let h=f[f.length-1];const d=1/u;const p=rs(c[1],f);while(h){const t=r((c[0]+h[0])/2);const e=t[0]-c[0]>=s;if(e&&as(c,t,h,d,p)>ns){f.push(t)}else{c=h;l.push(h);f.pop()}h=f[f.length-1]}return l}function rs(t,e){let n=t;let i=t;const r=e.length;for(let a=0;a<r;++a){const t=e[a][1];if(t<n)n=t;if(t>i)i=t}return 1/(i-n)}function as(t,e,n,i,r){const a=Math.atan2(r*(n[1]-t[1]),i*(n[0]-t[0])),o=Math.atan2(r*(e[1]-t[1]),i*(e[0]-t[0]));return Math.abs(a-o)}function os(t,e){let n=0;let i=0;if(e===undefined){for(let e of t){if(e!=null&&(e=+e)>=e){++n,i+=e}}}else{let r=-1;for(let a of t){if((a=e(a,++r,t))!=null&&(a=+a)>=a){++n,i+=a}}}if(n)return i/n}function us(t,e,n){t=+t,e=+e,n=(r=arguments.length)<2?(e=t,t=0,1):r<3?1:+n;var i=-1,r=Math.max(0,Math.ceil((e-t)/n))|0,a=new Array(r);while(++i<r){a[i]=t+i*n}return a}function ss(t){return e=>{const n=t.length;let i=1,r=String(t[0](e));for(;i<n;++i){r+="|"+t[i](e)}return r}}function ls(t){return!t||!t.length?function(){return""}:t.length===1?t[0]:ss(t)}function fs(t,e,n){return n||t+(!e?"":"_"+e)}const cs=()=>{};const hs={init:cs,add:cs,rem:cs,idx:0};const ds={values:{init:t=>t.cell.store=true,value:t=>t.cell.data.values(),idx:-1},count:{value:t=>t.cell.num},__count__:{value:t=>t.missing+t.valid},missing:{value:t=>t.missing},valid:{value:t=>t.valid},sum:{init:t=>t.sum=0,value:t=>t.sum,add:(t,e)=>t.sum+=+e,rem:(t,e)=>t.sum-=e},product:{init:t=>t.product=1,value:t=>t.valid?t.product:undefined,add:(t,e)=>t.product*=e,rem:(t,e)=>t.product/=e},mean:{init:t=>t.mean=0,value:t=>t.valid?t.mean:undefined,add:(t,e)=>(t.mean_d=e-t.mean,t.mean+=t.mean_d/t.valid),rem:(t,e)=>(t.mean_d=e-t.mean,t.mean-=t.valid?t.mean_d/t.valid:t.mean)},average:{value:t=>t.valid?t.mean:undefined,req:["mean"],idx:1},variance:{init:t=>t.dev=0,value:t=>t.valid>1?t.dev/(t.valid-1):undefined,add:(t,e)=>t.dev+=t.mean_d*(e-t.mean),rem:(t,e)=>t.dev-=t.mean_d*(e-t.mean),req:["mean"],idx:1},variancep:{value:t=>t.valid>1?t.dev/t.valid:undefined,req:["variance"],idx:2},stdev:{value:t=>t.valid>1?Math.sqrt(t.dev/(t.valid-1)):undefined,req:["variance"],idx:2},stdevp:{value:t=>t.valid>1?Math.sqrt(t.dev/t.valid):undefined,req:["variance"],idx:2},stderr:{value:t=>t.valid>1?Math.sqrt(t.dev/(t.valid*(t.valid-1))):undefined,req:["variance"],idx:2},distinct:{value:t=>t.cell.data.distinct(t.get),req:["values"],idx:3},ci0:{value:t=>t.cell.data.ci0(t.get),req:["values"],idx:3},ci1:{value:t=>t.cell.data.ci1(t.get),req:["values"],idx:3},median:{value:t=>t.cell.data.q2(t.get),req:["values"],idx:3},q1:{value:t=>t.cell.data.q1(t.get),req:["values"],idx:3},q3:{value:t=>t.cell.data.q3(t.get),req:["values"],idx:3},min:{init:t=>t.min=undefined,value:t=>t.min=Number.isNaN(t.min)?t.cell.data.min(t.get):t.min,add:(t,e)=>{if(e<t.min||t.min===undefined)t.min=e},rem:(t,e)=>{if(e<=t.min)t.min=NaN},req:["values"],idx:4},max:{init:t=>t.max=undefined,value:t=>t.max=Number.isNaN(t.max)?t.cell.data.max(t.get):t.max,add:(t,e)=>{if(e>t.max||t.max===undefined)t.max=e},rem:(t,e)=>{if(e>=t.max)t.max=NaN},req:["values"],idx:4},argmin:{init:t=>t.argmin=undefined,value:t=>t.argmin||t.cell.data.argmin(t.get),add:(t,e,n)=>{if(e<t.min)t.argmin=n},rem:(t,e)=>{if(e<=t.min)t.argmin=undefined},req:["min","values"],idx:3},argmax:{init:t=>t.argmax=undefined,value:t=>t.argmax||t.cell.data.argmax(t.get),add:(t,e,n)=>{if(e>t.max)t.argmax=n},rem:(t,e)=>{if(e>=t.max)t.argmax=undefined},req:["max","values"],idx:3}};const ps=Object.keys(ds);function gs(t,e){return n=>(0,g.l7)({name:t,out:n||t},hs,e)}ps.forEach((t=>{ds[t]=gs(t,ds[t])}));function ms(t,e){return ds[t](e)}function ys(t,e){return t.idx-e.idx}function vs(t){const e={};t.forEach((t=>e[t.name]=t));const n=t=>{if(!t.req)return;t.req.forEach((t=>{if(!e[t])n(e[t]=ds[t]())}))};t.forEach(n);return Object.values(e).sort(ys)}function xs(){this.valid=0;this.missing=0;this._ops.forEach((t=>t.init(this)))}function _s(t,e){if(t==null||t===""){++this.missing;return}if(t!==t)return;++this.valid;this._ops.forEach((n=>n.add(this,t,e)))}function bs(t,e){if(t==null||t===""){--this.missing;return}if(t!==t)return;--this.valid;this._ops.forEach((n=>n.rem(this,t,e)))}function ws(t){this._out.forEach((e=>t[e.out]=e.value(this)));return t}function ks(t,e){const n=e||g.yR,i=vs(t),r=t.slice().sort(ys);function a(t){this._ops=i;this._out=r;this.cell=t;this.init()}a.prototype.init=xs;a.prototype.add=_s;a.prototype.rem=bs;a.prototype.set=ws;a.prototype.get=n;a.fields=t.map((t=>t.out));return a}function Ms(t){this._key=t?(0,g.EP)(t):Ca;this.reset()}const As=Ms.prototype;As.reset=function(){this._add=[];this._rem=[];this._ext=null;this._get=null;this._q=null};As.add=function(t){this._add.push(t)};As.rem=function(t){this._rem.push(t)};As.values=function(){this._get=null;if(this._rem.length===0)return this._add;const t=this._add,e=this._rem,n=this._key,i=t.length,r=e.length,a=Array(i-r),o={};let u,s,l;for(u=0;u<r;++u){o[n(e[u])]=1}for(u=0,s=0;u<i;++u){if(o[n(l=t[u])]){o[n(l)]=0}else{a[s++]=l}}this._rem=[];return this._add=a};As.distinct=function(t){const e=this.values(),n={};let i=e.length,r=0,a;while(--i>=0){a=t(e[i])+"";if(!(0,g.nr)(n,a)){n[a]=1;++r}}return r};As.extent=function(t){if(this._get!==t||!this._ext){const e=this.values(),n=(0,g.dI)(e,t);this._ext=[e[n[0]],e[n[1]]];this._get=t}return this._ext};As.argmin=function(t){return this.extent(t)[0]||{}};As.argmax=function(t){return this.extent(t)[1]||{}};As.min=function(t){const e=this.extent(t)[0];return e!=null?t(e):undefined};As.max=function(t){const e=this.extent(t)[1];return e!=null?t(e):undefined};As.quartile=function(t){if(this._get!==t||!this._q){this._q=uu(this.values(),t);this._get=t}return this._q};As.q1=function(t){return this.quartile(t)[0]};As.q2=function(t){return this.quartile(t)[1]};As.q3=function(t){return this.quartile(t)[2]};As.ci=function(t){if(this._get!==t||!this._ci){this._ci=hu(this.values(),1e3,.05,t);this._get=t}return this._ci};As.ci0=function(t){return this.ci(t)[0]};As.ci1=function(t){return this.ci(t)[1]};function Es(t){Wo.call(this,null,t);this._adds=[];this._mods=[];this._alen=0;this._mlen=0;this._drop=true;this._cross=false;this._dims=[];this._dnames=[];this._measures=[];this._countOnly=false;this._counts=null;this._prev=null;this._inputs=null;this._outputs=null}Es.Definition={type:"Aggregate",metadata:{generates:true,changes:true},params:[{name:"groupby",type:"field",array:true},{name:"ops",type:"enum",array:true,values:ps},{name:"fields",type:"field",null:true,array:true},{name:"as",type:"string",null:true,array:true},{name:"drop",type:"boolean",default:true},{name:"cross",type:"boolean",default:false},{name:"key",type:"field"}]};(0,g.XW)(Es,Wo,{transform(t,e){const n=this,i=e.fork(e.NO_SOURCE|e.NO_FIELDS),r=t.modified();n.stamp=i.stamp;if(n.value&&(r||e.modified(n._inputs,true))){n._prev=n.value;n.value=r?n.init(t):{};e.visit(e.SOURCE,(t=>n.add(t)))}else{n.value=n.value||n.init(t);e.visit(e.REM,(t=>n.rem(t)));e.visit(e.ADD,(t=>n.add(t)))}i.modifies(n._outputs);n._drop=t.drop!==false;if(t.cross&&n._dims.length>1){n._drop=false;n.cross()}if(e.clean()&&n._drop){i.clean(true).runAfter((()=>this.clean()))}return n.changes(i)},cross(){const t=this,e=t.value,n=t._dnames,i=n.map((()=>({}))),r=n.length;function a(t){let e,a,o,u;for(e in t){o=t[e].tuple;for(a=0;a<r;++a){i[a][u=o[n[a]]]=u}}}a(t._prev);a(e);function o(a,u,s){const l=n[s],f=i[s++];for(const n in f){const i=a?a+"|"+n:n;u[l]=f[n];if(s<r)o(i,u,s);else if(!e[i])t.cell(i,u)}}o("",{},0)},init(t){const e=this._inputs=[],n=this._outputs=[],i={};function r(t){const n=(0,g.IX)((0,g.Oj)(t)),r=n.length;let a=0,o;for(;a<r;++a){if(!i[o=n[a]]){i[o]=1;e.push(o)}}}this._dims=(0,g.IX)(t.groupby);this._dnames=this._dims.map((t=>{const e=(0,g.el)(t);r(t);n.push(e);return e}));this.cellkey=t.key?t.key:ls(this._dims);this._countOnly=true;this._counts=[];this._measures=[];const a=t.fields||[null],o=t.ops||["count"],u=t.as||[],s=a.length,l={};let f,c,h,d,p,m;if(s!==o.length){(0,g.vU)("Unmatched number of fields and aggregate ops.")}for(m=0;m<s;++m){f=a[m];c=o[m];if(f==null&&c!=="count"){(0,g.vU)("Null aggregate field specified.")}d=(0,g.el)(f);p=fs(c,d,u[m]);n.push(p);if(c==="count"){this._counts.push(p);continue}h=l[d];if(!h){r(f);h=l[d]=[];h.field=f;this._measures.push(h)}if(c!=="count")this._countOnly=false;h.push(ms(c,p))}this._measures=this._measures.map((t=>ks(t,t.field)));return{}},cellkey:ls(),cell(t,e){let n=this.value[t];if(!n){n=this.value[t]=this.newcell(t,e);this._adds[this._alen++]=n}else if(n.num===0&&this._drop&&n.stamp<this.stamp){n.stamp=this.stamp;this._adds[this._alen++]=n}else if(n.stamp<this.stamp){n.stamp=this.stamp;this._mods[this._mlen++]=n}return n},newcell(t,e){const n={key:t,num:0,agg:null,tuple:this.newtuple(e,this._prev&&this._prev[t]),stamp:this.stamp,store:false};if(!this._countOnly){const t=this._measures,e=t.length;n.agg=Array(e);for(let i=0;i<e;++i){n.agg[i]=new t[i](n)}}if(n.store){n.data=new Ms}return n},newtuple(t,e){const n=this._dnames,i=this._dims,r=i.length,a={};for(let o=0;o<r;++o){a[n[o]]=i[o](t)}return e?Na(e.tuple,a):Sa(a)},clean(){const t=this.value;for(const e in t){if(t[e].num===0){delete t[e]}}},add(t){const e=this.cellkey(t),n=this.cell(e,t);n.num+=1;if(this._countOnly)return;if(n.store)n.data.add(t);const i=n.agg;for(let r=0,a=i.length;r<a;++r){i[r].add(i[r].get(t),t)}},rem(t){const e=this.cellkey(t),n=this.cell(e,t);n.num-=1;if(this._countOnly)return;if(n.store)n.data.rem(t);const i=n.agg;for(let r=0,a=i.length;r<a;++r){i[r].rem(i[r].get(t),t)}},celltuple(t){const e=t.tuple,n=this._counts;if(t.store){t.data.values()}for(let i=0,r=n.length;i<r;++i){e[n[i]]=t.num}if(!this._countOnly){const n=t.agg;for(let t=0,i=n.length;t<i;++t){n[t].set(e)}}return e},changes(t){const e=this._adds,n=this._mods,i=this._prev,r=this._drop,a=t.add,o=t.rem,u=t.mod;let s,l,f,c;if(i)for(l in i){s=i[l];if(!r||s.num)o.push(s.tuple)}for(f=0,c=this._alen;f<c;++f){a.push(this.celltuple(e[f]));e[f]=null}for(f=0,c=this._mlen;f<c;++f){s=n[f];(s.num===0&&r?o:u).push(this.celltuple(s));n[f]=null}this._alen=this._mlen=0;this._prev=null;return t}});const Ds=1e-14;function Cs(t){Wo.call(this,null,t)}Cs.Definition={type:"Bin",metadata:{modifies:true},params:[{name:"field",type:"field",required:true},{name:"interval",type:"boolean",default:true},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:true,default:[5,2]},{name:"extent",type:"number",array:true,length:2,required:true},{name:"span",type:"number"},{name:"step",type:"number"},{name:"steps",type:"number",array:true},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:true},{name:"name",type:"string"},{name:"as",type:"string",array:true,length:2,default:["bin0","bin1"]}]};(0,g.XW)(Cs,Wo,{transform(t,e){const n=t.interval!==false,i=this._bins(t),r=i.start,a=i.step,o=t.as||["bin0","bin1"],u=o[0],s=o[1];let l;if(t.modified()){e=e.reflow(true);l=e.SOURCE}else{l=e.modified((0,g.Oj)(t.field))?e.ADD_MOD:e.ADD}e.visit(l,n?t=>{const e=i(t);t[u]=e;t[s]=e==null?null:r+a*(1+(e-r)/a)}:t=>t[u]=i(t));return e.modifies(n?o:u)},_bins(t){if(this.value&&!t.modified()){return this.value}const e=t.field,n=lu(t),i=n.step;let r=n.start,a=r+Math.ceil((n.stop-r)/i)*i,o,u;if((o=t.anchor)!=null){u=o-(r+i*Math.floor((o-r)/i));r+=u;a+=u}const s=function(t){let n=(0,g.He)(e(t));return n==null?null:n<r?-Infinity:n>a?+Infinity:(n=Math.max(r,Math.min(n,a-i)),r+i*Math.floor(Ds+(n-r)/i))};s.start=r;s.stop=n.stop;s.step=i;return this.value=(0,g.ZE)(s,(0,g.Oj)(e),t.name||"bin_"+(0,g.el)(e))}});function Fs(t,e,n){const i=t;let r=e||[],a=n||[],o={},u=0;return{add:t=>a.push(t),remove:t=>o[i(t)]=++u,size:()=>r.length,data:(t,e)=>{if(u){r=r.filter((t=>!o[i(t)]));o={};u=0}if(e&&t){r.sort(t)}if(a.length){r=t?(0,g.TS)(t,r,a.sort(t)):r.concat(a);a=[]}return r}}}function Ss(t){Wo.call(this,[],t)}Ss.Definition={type:"Collect",metadata:{source:true},params:[{name:"sort",type:"compare"}]};(0,g.XW)(Ss,Wo,{transform(t,e){const n=e.fork(e.ALL),i=Fs(Ca,this.value,n.materialize(n.ADD).add),r=t.sort,a=e.changed()||r&&(t.modified("sort")||e.modified(r.fields));n.visit(n.REM,i.remove);this.modified(a);this.value=n.source=i.data(za(r),a);if(e.source&&e.source.root){this.value.root=e.source.root}return n}});function Ts(t){Wa.call(this,null,Bs,t)}(0,g.XW)(Ts,Wa);function Bs(t){return this.value&&!t.modified()?this.value:(0,g.qu)(t.fields,t.orders)}function Ns(t){Wo.call(this,null,t)}Ns.Definition={type:"CountPattern",metadata:{generates:true,changes:true},params:[{name:"field",type:"field",required:true},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:true,length:2,default:["text","count"]}]};function zs(t,e,n){switch(e){case"upper":t=t.toUpperCase();break;case"lower":t=t.toLowerCase();break}return t.match(n)}(0,g.XW)(Ns,Wo,{transform(t,e){const n=e=>n=>{var i=zs(u(n),t.case,a)||[],r;for(var s=0,l=i.length;s<l;++s){if(!o.test(r=i[s]))e(r)}};const i=this._parameterCheck(t,e),r=this._counts,a=this._match,o=this._stop,u=t.field,s=t.as||["text","count"],l=n((t=>r[t]=1+(r[t]||0))),f=n((t=>r[t]-=1));if(i){e.visit(e.SOURCE,l)}else{e.visit(e.ADD,l);e.visit(e.REM,f)}return this._finish(e,s)},_parameterCheck(t,e){let n=false;if(t.modified("stopwords")||!this._stop){this._stop=new RegExp("^"+(t.stopwords||"")+"$","i");n=true}if(t.modified("pattern")||!this._match){this._match=new RegExp(t.pattern||"[\\w']+","g");n=true}if(t.modified("field")||e.modified(t.field.fields)){n=true}if(n)this._counts={};return n},_finish(t,e){const n=this._counts,i=this._tuples||(this._tuples={}),r=e[0],a=e[1],o=t.fork(t.NO_SOURCE|t.NO_FIELDS);let u,s,l;for(u in n){s=i[u];l=n[u]||0;if(!s&&l){i[u]=s=Sa({});s[r]=u;s[a]=l;o.add.push(s)}else if(l===0){if(s)o.rem.push(s);n[u]=null;i[u]=null}else if(s[a]!==l){s[a]=l;o.mod.push(s)}}return o.modifies(e)}});function Os(t){Wo.call(this,null,t)}Os.Definition={type:"Cross",metadata:{generates:true},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:true,length:2,default:["a","b"]}]};(0,g.XW)(Os,Wo,{transform(t,e){const n=e.fork(e.NO_SOURCE),i=t.as||["a","b"],r=i[0],a=i[1],o=!this.value||e.changed(e.ADD_REM)||t.modified("as")||t.modified("filter");let u=this.value;if(o){if(u)n.rem=u;u=e.materialize(e.SOURCE).source;n.add=this.value=Rs(u,r,a,t.filter||g.yb)}else{n.mod=u}n.source=this.value;return n.modifies(i)}});function Rs(t,e,n,i){var r=[],a={},o=t.length,u=0,s,l;for(;u<o;++u){a[e]=l=t[u];for(s=0;s<o;++s){a[n]=t[s];if(i(a)){r.push(Sa(a));a={};a[e]=l}}}return r}const Us={kde:Eu,mixture:Bu,normal:Au,lognormal:Tu,uniform:Uu};const $s="distributions",Ps="function",qs="field";function Is(t,e){const n=t[Ps];if(!(0,g.nr)(Us,n)){(0,g.vU)("Unknown distribution function: "+n)}const i=Us[n]();for(const r in t){if(r===qs){i.data((t.from||e()).map(t[r]))}else if(r===$s){i[r](t[r].map((t=>Is(t,e))))}else if(typeof i[r]===Ps){i[r](t[r])}}return i}function Ls(t){Wo.call(this,null,t)}const js=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"lognormal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:true},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}];const Ws={key:{function:"mixture"},params:[{name:"distributions",type:"param",array:true,params:js},{name:"weights",type:"number",array:true}]};Ls.Definition={type:"Density",metadata:{generates:true},params:[{name:"extent",type:"number",array:true,length:2},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:js.concat(Ws)},{name:"as",type:"string",array:true,default:["value","density"]}]};(0,g.XW)(Ls,Wo,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS);if(!this.value||e.changed()||t.modified()){const i=Is(t.distribution,Xs(e)),r=t.steps||t.minsteps||25,a=t.steps||t.maxsteps||200;let o=t.method||"pdf";if(o!=="pdf"&&o!=="cdf"){(0,g.vU)("Invalid density method: "+o)}if(!t.extent&&!i.data){(0,g.vU)("Missing density extent parameter.")}o=i[o];const u=t.as||["value","density"],s=t.extent||(0,g.We)(i.data()),l=is(o,s,r,a).map((t=>{const e={};e[u[0]]=t[0];e[u[1]]=t[1];return Sa(e)}));if(this.value)n.rem=this.value;this.value=n.add=n.source=l}return n}});function Xs(t){return()=>t.materialize(t.SOURCE).source}function Hs(t,e){if(!t)return null;return t.map(((t,n)=>e[n]||(0,g.el)(t)))}function Ys(t,e,n){const i=[],r=t=>t(s);let a,o,u,s,l,f;if(e==null){i.push(t.map(n))}else{for(a={},o=0,u=t.length;o<u;++o){s=t[o];l=e.map(r);f=a[l];if(!f){a[l]=f=[];f.dims=l;i.push(f)}f.push(n(s))}}return i}const Js="bin";function Vs(t){Wo.call(this,null,t)}Vs.Definition={type:"DotBin",metadata:{modifies:true},params:[{name:"field",type:"field",required:true},{name:"groupby",type:"field",array:true},{name:"step",type:"number"},{name:"smooth",type:"boolean",default:false},{name:"as",type:"string",default:Js}]};const Gs=(t,e)=>(0,g.yP)((0,g.We)(t,e))/30;(0,g.XW)(Vs,Wo,{transform(t,e){if(this.value&&!(t.modified()||e.changed())){return e}const n=e.materialize(e.SOURCE).source,i=Ys(e.source,t.groupby,g.yR),r=t.smooth||false,a=t.field,o=t.step||Gs(n,a),u=za(((t,e)=>a(t)-a(e))),s=t.as||Js,l=i.length;let f=Infinity,c=-Infinity,h=0,d;for(;h<l;++h){const t=i[h].sort(u);d=-1;for(const e of du(t,o,r,a)){if(e<f)f=e;if(e>c)c=e;t[++d][s]=e}}this.value={start:f,stop:c,step:o};return e.reflow(true).modifies(s)}});function Ks(t){Wa.call(this,null,Zs,t);this.modified(true)}(0,g.XW)(Ks,Wa);function Zs(t){const e=t.expr;return this.value&&!t.modified("expr")?this.value:(0,g.ZE)((n=>e(n,t)),(0,g.Oj)(e),(0,g.el)(e))}function Qs(t){Wo.call(this,[undefined,undefined],t)}Qs.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:true}]};(0,g.XW)(Qs,Wo,{transform(t,e){const n=this.value,i=t.field,r=e.changed()||e.modified(i.fields)||t.modified("field");let a=n[0],o=n[1];if(r||a==null){a=+Infinity;o=-Infinity}e.visit(r?e.SOURCE:e.ADD,(t=>{const e=(0,g.He)(i(t));if(e!=null){if(e<a)a=e;if(e>o)o=e}}));if(!Number.isFinite(a)||!Number.isFinite(o)){let t=(0,g.el)(i);if(t)t=` for field "${t}"`;e.dataflow.warn(`Infinite extent${t}: [${a}, ${o}]`);a=o=undefined}this.value=[a,o]}});function tl(t,e){Wa.call(this,t);this.parent=e;this.count=0}(0,g.XW)(tl,Wa,{connect(t){this.detachSubflow=t.detachSubflow;this.targets().add(t);return t.source=this},add(t){this.count+=1;this.value.add.push(t)},rem(t){this.count-=1;this.value.rem.push(t)},mod(t){this.value.mod.push(t)},init(t){this.value.init(t,t.NO_SOURCE)},evaluate(){return this.value}});function el(t){Wo.call(this,{},t);this._keys=(0,g.Xr)();const e=this._targets=[];e.active=0;e.forEach=t=>{for(let n=0,i=e.active;n<i;++n){t(e[n],n,e)}}}(0,g.XW)(el,Wo,{activate(t){this._targets[this._targets.active++]=t},subflow(t,e,n,i){const r=this.value;let a=(0,g.nr)(r,t)&&r[t],o,u;if(!a){u=i||(u=this._group[t])&&u.tuple;o=n.dataflow;a=new tl(n.fork(n.NO_SOURCE),this);o.add(a).connect(e(o,t,u));r[t]=a;this.activate(a)}else if(a.value.stamp<n.stamp){a.init(n);this.activate(a)}return a},clean(){const t=this.value;let e=0;for(const n in t){if(t[n].count===0){const i=t[n].detachSubflow;if(i)i();delete t[n];++e}}if(e){const t=this._targets.filter((t=>t&&t.count>0));this.initTargets(t)}},initTargets(t){const e=this._targets,n=e.length,i=t?t.length:0;let r=0;for(;r<i;++r){e[r]=t[r]}for(;r<n&&e[r]!=null;++r){e[r]=null}e.active=i},transform(t,e){const n=e.dataflow,i=t.key,r=t.subflow,a=this._keys,o=t.modified("key"),u=t=>this.subflow(t,r,e);this._group=t.group||{};this.initTargets();e.visit(e.REM,(t=>{const e=Ca(t),n=a.get(e);if(n!==undefined){a.delete(e);u(n).rem(t)}}));e.visit(e.ADD,(t=>{const e=i(t);a.set(Ca(t),e);u(e).add(t)}));if(o||e.modified(i.fields)){e.visit(e.MOD,(t=>{const e=Ca(t),n=a.get(e),r=i(t);if(n===r){u(r).mod(t)}else{a.set(e,r);u(n).rem(t);u(r).add(t)}}))}else if(e.changed(e.MOD)){e.visit(e.MOD,(t=>{u(a.get(Ca(t))).mod(t)}))}if(o){e.visit(e.REFLOW,(t=>{const e=Ca(t),n=a.get(e),r=i(t);if(n!==r){a.set(e,r);u(n).rem(t);u(r).add(t)}}))}if(e.clean()){n.runAfter((()=>{this.clean();a.clean()}))}else if(a.empty>n.cleanThreshold){n.runAfter(a.clean)}return e}});function nl(t){Wa.call(this,null,il,t)}(0,g.XW)(nl,Wa);function il(t){return this.value&&!t.modified()?this.value:(0,g.kJ)(t.name)?(0,g.IX)(t.name).map((t=>(0,g.EP)(t))):(0,g.EP)(t.name,t.as)}function rl(t){Wo.call(this,(0,g.Xr)(),t)}rl.Definition={type:"Filter",metadata:{changes:true},params:[{name:"expr",type:"expr",required:true}]};(0,g.XW)(rl,Wo,{transform(t,e){const n=e.dataflow,i=this.value,r=e.fork(),a=r.add,o=r.rem,u=r.mod,s=t.expr;let l=true;e.visit(e.REM,(t=>{const e=Ca(t);if(!i.has(e))o.push(t);else i.delete(e)}));e.visit(e.ADD,(e=>{if(s(e,t))a.push(e);else i.set(Ca(e),1)}));function f(e){const n=Ca(e),r=s(e,t),f=i.get(n);if(r&&f){i.delete(n);a.push(e)}else if(!r&&!f){i.set(n,1);o.push(e)}else if(l&&r&&!f){u.push(e)}}e.visit(e.MOD,f);if(t.modified()){l=false;e.visit(e.REFLOW,f)}if(i.empty>n.cleanThreshold)n.runAfter(i.clean);return r}});function al(t){Wo.call(this,[],t)}al.Definition={type:"Flatten",metadata:{generates:true},params:[{name:"fields",type:"field",array:true,required:true},{name:"index",type:"string"},{name:"as",type:"string",array:true}]};(0,g.XW)(al,Wo,{transform(t,e){const n=e.fork(e.NO_SOURCE),i=t.fields,r=Hs(i,t.as||[]),a=t.index||null,o=r.length;n.rem=this.value;e.visit(e.SOURCE,(t=>{const e=i.map((e=>e(t))),u=e.reduce(((t,e)=>Math.max(t,e.length)),0);let s=0,l,f,c;for(;s<u;++s){f=Ta(t);for(l=0;l<o;++l){f[r[l]]=(c=e[l][s])==null?null:c}if(a){f[a]=s}n.add.push(f)}}));this.value=n.source=n.add;if(a)n.modifies(a);return n.modifies(r)}});function ol(t){Wo.call(this,[],t)}ol.Definition={type:"Fold",metadata:{generates:true},params:[{name:"fields",type:"field",array:true,required:true},{name:"as",type:"string",array:true,length:2,default:["key","value"]}]};(0,g.XW)(ol,Wo,{transform(t,e){const n=e.fork(e.NO_SOURCE),i=t.fields,r=i.map(g.el),a=t.as||["key","value"],o=a[0],u=a[1],s=i.length;n.rem=this.value;e.visit(e.SOURCE,(t=>{for(let e=0,a;e<s;++e){a=Ta(t);a[o]=r[e];a[u]=i[e](t);n.add.push(a)}}));this.value=n.source=n.add;return n.modifies(a)}});function ul(t){Wo.call(this,null,t)}ul.Definition={type:"Formula",metadata:{modifies:true},params:[{name:"expr",type:"expr",required:true},{name:"as",type:"string",required:true},{name:"initonly",type:"boolean"}]};(0,g.XW)(ul,Wo,{transform(t,e){const n=t.expr,i=t.as,r=t.modified(),a=t.initonly?e.ADD:r?e.SOURCE:e.modified(n.fields)||e.modified(i)?e.ADD_MOD:e.ADD;if(r){e=e.materialize().reflow(true)}if(!t.initonly){e.modifies(i)}return e.visit(a,(e=>e[i]=n(e,t)))}});function sl(t){Wo.call(this,[],t)}(0,g.XW)(sl,Wo,{transform(t,e){const n=e.fork(e.ALL),i=t.generator;let r=this.value,a=t.size-r.length,o,u,s;if(a>0){for(o=[];--a>=0;){o.push(s=Sa(i(t)));r.push(s)}n.add=n.add.length?n.materialize(n.ADD).add.concat(o):o}else{u=r.slice(0,-a);n.rem=n.rem.length?n.materialize(n.REM).rem.concat(u):u;r=r.slice(-a)}n.source=this.value=r;return n}});const ll={value:"value",median:ru,mean:os,min:Vo,max:Jo};const fl=[];function cl(t){Wo.call(this,[],t)}cl.Definition={type:"Impute",metadata:{changes:true},params:[{name:"field",type:"field",required:true},{name:"key",type:"field",required:true},{name:"keyvals",array:true},{name:"groupby",type:"field",array:true},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]};function hl(t){var e=t.method||ll.value,n;if(ll[e]==null){(0,g.vU)("Unrecognized imputation method: "+e)}else if(e===ll.value){n=t.value!==undefined?t.value:0;return()=>n}else{return ll[e]}}function dl(t){const e=t.field;return t=>t?e(t):NaN}(0,g.XW)(cl,Wo,{transform(t,e){var n=e.fork(e.ALL),i=hl(t),r=dl(t),a=(0,g.el)(t.field),o=(0,g.el)(t.key),u=(t.groupby||[]).map(g.el),s=pl(e.source,t.groupby,t.key,t.keyvals),l=[],f=this.value,c=s.domain.length,h,d,p,m,y,v,x,_,b,w;for(y=0,_=s.length;y<_;++y){h=s[y];p=h.values;d=NaN;for(x=0;x<c;++x){if(h[x]!=null)continue;m=s.domain[x];w={_impute:true};for(v=0,b=p.length;v<b;++v)w[u[v]]=p[v];w[o]=m;w[a]=Number.isNaN(d)?d=i(h,r):d;l.push(Sa(w))}}if(l.length)n.add=n.materialize(n.ADD).add.concat(l);if(f.length)n.rem=n.materialize(n.REM).rem.concat(f);this.value=l;return n}});function pl(t,e,n,i){var r=t=>t(m),a=[],o=i?i.slice():[],u={},s={},l,f,c,h,d,p,g,m;o.forEach(((t,e)=>u[t]=e+1));for(h=0,g=t.length;h<g;++h){m=t[h];p=n(m);d=u[p]||(u[p]=o.push(p));f=(l=e?e.map(r):fl)+"";if(!(c=s[f])){c=s[f]=[];a.push(c);c.values=l}c[d-1]=m}a.domain=o;return a}function gl(t){Es.call(this,t)}gl.Definition={type:"JoinAggregate",metadata:{modifies:true},params:[{name:"groupby",type:"field",array:true},{name:"fields",type:"field",null:true,array:true},{name:"ops",type:"enum",array:true,values:ps},{name:"as",type:"string",null:true,array:true},{name:"key",type:"field"}]};(0,g.XW)(gl,Es,{transform(t,e){const n=this,i=t.modified();let r;if(n.value&&(i||e.modified(n._inputs,true))){r=n.value=i?n.init(t):{};e.visit(e.SOURCE,(t=>n.add(t)))}else{r=n.value=n.value||this.init(t);e.visit(e.REM,(t=>n.rem(t)));e.visit(e.ADD,(t=>n.add(t)))}n.changes();e.visit(e.SOURCE,(t=>{(0,g.l7)(t,r[n.cellkey(t)].tuple)}));return e.reflow(i).modifies(this._outputs)},changes(){const t=this._adds,e=this._mods;let n,i;for(n=0,i=this._alen;n<i;++n){this.celltuple(t[n]);t[n]=null}for(n=0,i=this._mlen;n<i;++n){this.celltuple(e[n]);e[n]=null}this._alen=this._mlen=0}});function ml(t){Wo.call(this,null,t)}ml.Definition={type:"KDE",metadata:{generates:true},params:[{name:"groupby",type:"field",array:true},{name:"field",type:"field",required:true},{name:"cumulative",type:"boolean",default:false},{name:"counts",type:"boolean",default:false},{name:"bandwidth",type:"number",default:0},{name:"extent",type:"number",array:true,length:2},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"as",type:"string",array:true,default:["value","density"]}]};(0,g.XW)(ml,Wo,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS);if(!this.value||e.changed()||t.modified()){const i=e.materialize(e.SOURCE).source,r=Ys(i,t.groupby,t.field),a=(t.groupby||[]).map(g.el),o=t.bandwidth,u=t.cumulative?"cdf":"pdf",s=t.as||["value","density"],l=[];let f=t.extent,c=t.steps||t.minsteps||25,h=t.steps||t.maxsteps||200;if(u!=="pdf"&&u!=="cdf"){(0,g.vU)("Invalid density method: "+u)}if(t.resolve==="shared"){if(!f)f=(0,g.We)(i,t.field);c=h=t.steps||h}r.forEach((e=>{const n=Eu(e,o)[u],i=t.counts?e.length:1,r=f||(0,g.We)(e);is(n,r,c,h).forEach((t=>{const n={};for(let i=0;i<a.length;++i){n[a[i]]=e.dims[i]}n[s[0]]=t[0];n[s[1]]=t[1]*i;l.push(Sa(n))}))}));if(this.value)n.rem=this.value;this.value=n.add=n.source=l}return n}});function yl(t){Wa.call(this,null,vl,t)}(0,g.XW)(yl,Wa);function vl(t){return this.value&&!t.modified()?this.value:(0,g.Jy)(t.fields,t.flat)}function xl(t){Wo.call(this,[],t);this._pending=null}(0,g.XW)(xl,Wo,{transform(t,e){const n=e.dataflow;if(this._pending){return bl(this,e,this._pending)}if(_l(t))return e.StopPropagation;if(t.values){return bl(this,e,n.parse(t.values,t.format))}else if(t.async){const e=n.request(t.url,t.format).then((t=>{this._pending=(0,g.IX)(t.data);return t=>t.touch(this)}));return{async:e}}else{return n.request(t.url,t.format).then((t=>bl(this,e,(0,g.IX)(t.data))))}}});function _l(t){return t.modified("async")&&!(t.modified("values")||t.modified("url")||t.modified("format"))}function bl(t,e,n){n.forEach(Sa);const i=e.fork(e.NO_FIELDS&e.NO_SOURCE);i.rem=t.value;t.value=i.source=i.add=n;t._pending=null;if(i.rem.length)i.clean(true);return i}function wl(t){Wo.call(this,{},t)}wl.Definition={type:"Lookup",metadata:{modifies:true},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:true},{name:"key",type:"field",required:true}]},{name:"values",type:"field",array:true},{name:"fields",type:"field",array:true,required:true},{name:"as",type:"string",array:true},{name:"default",default:null}]};(0,g.XW)(wl,Wo,{transform(t,e){const n=t.fields,i=t.index,r=t.values,a=t.default==null?null:t.default,o=t.modified(),u=n.length;let s=o?e.SOURCE:e.ADD,l=e,f=t.as,c,h,d;if(r){h=r.length;if(u>1&&!f){(0,g.vU)('Multi-field lookup requires explicit "as" parameter.')}if(f&&f.length!==u*h){(0,g.vU)('The "as" parameter has too few output field names.')}f=f||r.map(g.el);c=function(t){for(var e=0,o=0,s,l;e<u;++e){l=i.get(n[e](t));if(l==null)for(s=0;s<h;++s,++o)t[f[o]]=a;else for(s=0;s<h;++s,++o)t[f[o]]=r[s](l)}}}else{if(!f){(0,g.vU)("Missing output field names.")}c=function(t){for(var e=0,r;e<u;++e){r=i.get(n[e](t));t[f[e]]=r==null?a:r}}}if(o){l=e.reflow(true)}else{d=n.some((t=>e.modified(t.fields)));s|=d?e.MOD:0}e.visit(s,c);return l.modifies(f)}});function kl(t){Wa.call(this,null,Ml,t)}(0,g.XW)(kl,Wa);function Ml(t){if(this.value&&!t.modified()){return this.value}const e=t.extents,n=e.length;let i=+Infinity,r=-Infinity,a,o;for(a=0;a<n;++a){o=e[a];if(o[0]<i)i=o[0];if(o[1]>r)r=o[1]}return[i,r]}function Al(t){Wa.call(this,null,El,t)}(0,g.XW)(Al,Wa);function El(t){return this.value&&!t.modified()?this.value:t.values.reduce(((t,e)=>t.concat(e)),[])}function Dl(t){Wo.call(this,null,t)}(0,g.XW)(Dl,Wo,{transform(t,e){this.modified(t.modified());this.value=t;return e.fork(e.NO_SOURCE|e.NO_FIELDS)}});function Cl(t){Es.call(this,t)}Cl.Definition={type:"Pivot",metadata:{generates:true,changes:true},params:[{name:"groupby",type:"field",array:true},{name:"field",type:"field",required:true},{name:"value",type:"field",required:true},{name:"op",type:"enum",values:ps,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]};(0,g.XW)(Cl,Es,{_transform:Es.prototype.transform,transform(t,e){return this._transform(Fl(t,e),e)}});function Fl(t,e){const n=t.field,i=t.value,r=(t.op==="count"?"__count__":t.op)||"sum",a=(0,g.Oj)(n).concat((0,g.Oj)(i)),o=Tl(n,t.limit||0,e);if(e.changed())t.set("__pivot__",null,null,true);return{key:t.key,groupby:t.groupby,ops:o.map((()=>r)),fields:o.map((t=>Sl(t,n,i,a))),as:o.map((t=>t+"")),modified:t.modified.bind(t)}}function Sl(t,e,n,i){return(0,g.ZE)((i=>e(i)===t?n(i):NaN),i,t+"")}function Tl(t,e,n){const i={},r=[];n.visit(n.SOURCE,(e=>{const n=t(e);if(!i[n]){i[n]=1;r.push(n)}}));r.sort(g.j2);return e?r.slice(0,e):r}function Bl(t){el.call(this,t)}(0,g.XW)(Bl,el,{transform(t,e){const n=t.subflow,i=t.field,r=t=>this.subflow(Ca(t),n,e,t);if(t.modified("field")||i&&e.modified((0,g.Oj)(i))){(0,g.vU)("PreFacet does not support field modification.")}this.initTargets();if(i){e.visit(e.MOD,(t=>{const e=r(t);i(t).forEach((t=>e.mod(t)))}));e.visit(e.ADD,(t=>{const e=r(t);i(t).forEach((t=>e.add(Sa(t))))}));e.visit(e.REM,(t=>{const e=r(t);i(t).forEach((t=>e.rem(t)))}))}else{e.visit(e.MOD,(t=>r(t).mod(t)));e.visit(e.ADD,(t=>r(t).add(t)));e.visit(e.REM,(t=>r(t).rem(t)))}if(e.clean()){e.runAfter((()=>this.clean()))}return e}});function Nl(t){Wo.call(this,null,t)}Nl.Definition={type:"Project",metadata:{generates:true,changes:true},params:[{name:"fields",type:"field",array:true},{name:"as",type:"string",null:true,array:true}]};(0,g.XW)(Nl,Wo,{transform(t,e){const n=e.fork(e.NO_SOURCE),i=t.fields,r=Hs(t.fields,t.as||[]),a=i?(t,e)=>zl(t,e,i,r):Ba;let o;if(this.value){o=this.value}else{e=e.addAll();o=this.value={}}e.visit(e.REM,(t=>{const e=Ca(t);n.rem.push(o[e]);o[e]=null}));e.visit(e.ADD,(t=>{const e=a(t,Sa({}));o[Ca(t)]=e;n.add.push(e)}));e.visit(e.MOD,(t=>{n.mod.push(a(t,o[Ca(t)]))}));return n}});function zl(t,e,n,i){for(let r=0,a=n.length;r<a;++r){e[i[r]]=n[r](t)}return e}function Ol(t){Wo.call(this,null,t)}(0,g.XW)(Ol,Wo,{transform(t,e){this.value=t.value;return t.modified("value")?e.fork(e.NO_SOURCE|e.NO_FIELDS):e.StopPropagation}});function Rl(t){Wo.call(this,null,t)}Rl.Definition={type:"Quantile",metadata:{generates:true,changes:true},params:[{name:"groupby",type:"field",array:true},{name:"field",type:"field",required:true},{name:"probs",type:"number",array:true},{name:"step",type:"number",default:.01},{name:"as",type:"string",array:true,default:["prob","value"]}]};const Ul=1e-14;(0,g.XW)(Rl,Wo,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS),i=t.as||["prob","value"];if(this.value&&!t.modified()&&!e.changed()){n.source=this.value;return n}const r=e.materialize(e.SOURCE).source,a=Ys(r,t.groupby,t.field),o=(t.groupby||[]).map(g.el),u=[],s=t.step||.01,l=t.probs||us(s/2,1-Ul,s),f=l.length;a.forEach((t=>{const e=ou(t,l);for(let n=0;n<f;++n){const r={};for(let e=0;e<o.length;++e){r[o[e]]=t.dims[e]}r[i[0]]=l[n];r[i[1]]=e[n];u.push(Sa(r))}}));if(this.value)n.rem=this.value;this.value=n.add=n.source=u;return n}});function $l(t){Wo.call(this,null,t)}(0,g.XW)($l,Wo,{transform(t,e){let n,i;if(this.value){i=this.value}else{n=e=e.addAll();i=this.value={}}if(t.derive){n=e.fork(e.NO_SOURCE);e.visit(e.REM,(t=>{const e=Ca(t);n.rem.push(i[e]);i[e]=null}));e.visit(e.ADD,(t=>{const e=Ta(t);i[Ca(t)]=e;n.add.push(e)}));e.visit(e.MOD,(t=>{const e=i[Ca(t)];for(const i in t){e[i]=t[i];n.modifies(i)}n.mod.push(e)}))}return n}});function Pl(t){Wo.call(this,[],t);this.count=0}Pl.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]};(0,g.XW)(Pl,Wo,{transform(t,e){const n=e.fork(e.NO_SOURCE),i=t.modified("size"),r=t.size,a=this.value.reduce(((t,e)=>(t[Ca(e)]=1,t)),{});let o=this.value,u=this.count,s=0;function l(t){let e,i;if(o.length<r){o.push(t)}else{i=~~((u+1)*fu());if(i<o.length&&i>=s){e=o[i];if(a[Ca(e)])n.rem.push(e);o[i]=t}}++u}if(e.rem.length){e.visit(e.REM,(t=>{const e=Ca(t);if(a[e]){a[e]=-1;n.rem.push(t)}--u}));o=o.filter((t=>a[Ca(t)]!==-1))}if((e.rem.length||i)&&o.length<r&&e.source){s=u=o.length;e.visit(e.SOURCE,(t=>{if(!a[Ca(t)])l(t)}));s=-1}if(i&&o.length>r){const t=o.length-r;for(let e=0;e<t;++e){a[Ca(o[e])]=-1;n.rem.push(o[e])}o=o.slice(t)}if(e.mod.length){e.visit(e.MOD,(t=>{if(a[Ca(t)])n.mod.push(t)}))}if(e.add.length){e.visit(e.ADD,l)}if(e.add.length||s<0){n.add=o.filter((t=>!a[Ca(t)]))}this.count=u;this.value=n.source=o;return n}});function ql(t){Wo.call(this,null,t)}ql.Definition={type:"Sequence",metadata:{generates:true,changes:true},params:[{name:"start",type:"number",required:true},{name:"stop",type:"number",required:true},{name:"step",type:"number",default:1},{name:"as",type:"string",default:"data"}]};(0,g.XW)(ql,Wo,{transform(t,e){if(this.value&&!t.modified())return;const n=e.materialize().fork(e.MOD),i=t.as||"data";n.rem=this.value?e.rem.concat(this.value):e.rem;this.value=us(t.start,t.stop,t.step||1).map((t=>{const e={};e[i]=t;return Sa(e)}));n.add=e.add.concat(this.value);return n}});function Il(t){Wo.call(this,null,t);this.modified(true)}(0,g.XW)(Il,Wo,{transform(t,e){this.value=e.source;return e.changed()?e.fork(e.NO_SOURCE|e.NO_FIELDS):e.StopPropagation}});function Ll(t){Wo.call(this,null,t)}const jl=["unit0","unit1"];Ll.Definition={type:"TimeUnit",metadata:{modifies:true},params:[{name:"field",type:"field",required:true},{name:"interval",type:"boolean",default:true},{name:"units",type:"enum",values:Ge,array:true},{name:"step",type:"number",default:1},{name:"maxbins",type:"number",default:40},{name:"extent",type:"date",array:true},{name:"timezone",type:"enum",default:"local",values:["local","utc"]},{name:"as",type:"string",array:true,length:2,default:jl}]};(0,g.XW)(Ll,Wo,{transform(t,e){const n=t.field,i=t.interval!==false,r=t.timezone==="utc",a=this._floor(t,e),o=(r?Cn:Dn)(a.unit).offset,u=t.as||jl,s=u[0],l=u[1],f=a.step;let c=a.start||Infinity,h=a.stop||-Infinity,d=e.ADD;if(t.modified()||e.modified((0,g.Oj)(n))){e=e.reflow(true);d=e.SOURCE;c=Infinity;h=-Infinity}e.visit(d,(t=>{const e=n(t);let r,u;if(e==null){t[s]=null;if(i)t[l]=null}else{t[s]=r=u=a(e);if(i)t[l]=u=o(r,f);if(r<c)c=r;if(u>h)h=u}}));a.start=c;a.stop=h;return e.modifies(i?u:s)},_floor(t,e){const n=t.timezone==="utc";const{units:i,step:r}=t.units?{units:t.units,step:t.step||1}:Kn({extent:t.extent||(0,g.We)(e.materialize(e.SOURCE).source,t.field),maxbins:t.maxbins});const a=Ze(i),o=this.value||{},u=(n?Mn:bn)(a,r);u.unit=(0,g.fj)(a);u.units=a;u.step=r;u.start=o.start;u.stop=o.stop;return this.value=u}});function Wl(t){Wo.call(this,(0,g.Xr)(),t)}(0,g.XW)(Wl,Wo,{transform(t,e){const n=e.dataflow,i=t.field,r=this.value,a=t=>r.set(i(t),t);let o=true;if(t.modified("field")||e.modified(i.fields)){r.clear();e.visit(e.SOURCE,a)}else if(e.changed()){e.visit(e.REM,(t=>r.delete(i(t))));e.visit(e.ADD,a)}else{o=false}this.modified(o);if(r.empty>n.cleanThreshold)n.runAfter(r.clean);return e.fork()}});function Xl(t){Wo.call(this,null,t)}(0,g.XW)(Xl,Wo,{transform(t,e){const n=!this.value||t.modified("field")||t.modified("sort")||e.changed()||t.sort&&e.modified(t.sort.fields);if(n){this.value=(t.sort?e.source.slice().sort(za(t.sort)):e.source).map(t.field)}}});function Hl(t,e,n,i){const r=Yl[t](e,n);return{init:r.init||g.bM,update:function(t,e){e[i]=r.next(t)}}}const Yl={row_number:function(){return{next:t=>t.index+1}},rank:function(){let t;return{init:()=>t=1,next:e=>{const n=e.index,i=e.data;return n&&e.compare(i[n-1],i[n])?t=n+1:t}}},dense_rank:function(){let t;return{init:()=>t=1,next:e=>{const n=e.index,i=e.data;return n&&e.compare(i[n-1],i[n])?++t:t}}},percent_rank:function(){const t=Yl.rank(),e=t.next;return{init:t.init,next:t=>(e(t)-1)/(t.data.length-1)}},cume_dist:function(){let t;return{init:()=>t=0,next:e=>{const n=e.data,i=e.compare;let r=e.index;if(t<r){while(r+1<n.length&&!i(n[r],n[r+1]))++r;t=r}return(1+t)/n.length}}},ntile:function(t,e){e=+e;if(!(e>0))(0,g.vU)("ntile num must be greater than zero.");const n=Yl.cume_dist(),i=n.next;return{init:n.init,next:t=>Math.ceil(e*i(t))}},lag:function(t,e){e=+e||1;return{next:n=>{const i=n.index-e;return i>=0?t(n.data[i]):null}}},lead:function(t,e){e=+e||1;return{next:n=>{const i=n.index+e,r=n.data;return i<r.length?t(r[i]):null}}},first_value:function(t){return{next:e=>t(e.data[e.i0])}},last_value:function(t){return{next:e=>t(e.data[e.i1-1])}},nth_value:function(t,e){e=+e;if(!(e>0))(0,g.vU)("nth_value nth must be greater than zero.");return{next:n=>{const i=n.i0+(e-1);return i<n.i1?t(n.data[i]):null}}},prev_value:function(t){let e;return{init:()=>e=null,next:n=>{const i=t(n.data[n.index]);return i!=null?e=i:e}}},next_value:function(t){let e,n;return{init:()=>(e=null,n=-1),next:i=>{const r=i.data;return i.index<=n?e:(n=Jl(t,r,i.index))<0?(n=r.length,e=null):e=t(r[n])}}}};function Jl(t,e,n){for(let i=e.length;n<i;++n){const i=t(e[n]);if(i!=null)return n}return-1}const Vl=Object.keys(Yl);function Gl(t){const e=(0,g.IX)(t.ops),n=(0,g.IX)(t.fields),i=(0,g.IX)(t.params),r=(0,g.IX)(t.as),a=this.outputs=[],o=this.windows=[],u={},s={},l=[],f=[];let c=true;function h(t){(0,g.IX)((0,g.Oj)(t)).forEach((t=>u[t]=1))}h(t.sort);e.forEach(((t,e)=>{const u=n[e],d=(0,g.el)(u),p=fs(t,d,r[e]);h(u);a.push(p);if((0,g.nr)(Yl,t)){o.push(Hl(t,n[e],i[e],p))}else{if(u==null&&t!=="count"){(0,g.vU)("Null aggregate field specified.")}if(t==="count"){l.push(p);return}c=false;let e=s[d];if(!e){e=s[d]=[];e.field=u;f.push(e)}e.push(ms(t,p))}}));if(l.length||f.length){this.cell=Zl(f,l,c)}this.inputs=Object.keys(u)}const Kl=Gl.prototype;Kl.init=function(){this.windows.forEach((t=>t.init()));if(this.cell)this.cell.init()};Kl.update=function(t,e){const n=this.cell,i=this.windows,r=t.data,a=i&&i.length;let o;if(n){for(o=t.p0;o<t.i0;++o)n.rem(r[o]);for(o=t.p1;o<t.i1;++o)n.add(r[o]);n.set(e)}for(o=0;o<a;++o)i[o].update(t,e)};function Zl(t,e,n){t=t.map((t=>ks(t,t.field)));const i={num:0,agg:null,store:false,count:e};if(!n){var r=t.length,a=i.agg=Array(r),o=0;for(;o<r;++o)a[o]=new t[o](i)}if(i.store){var u=i.data=new Ms}i.add=function(t){i.num+=1;if(n)return;if(u)u.add(t);for(let e=0;e<r;++e){a[e].add(a[e].get(t),t)}};i.rem=function(t){i.num-=1;if(n)return;if(u)u.rem(t);for(let e=0;e<r;++e){a[e].rem(a[e].get(t),t)}};i.set=function(t){let r,o;if(u)u.values();for(r=0,o=e.length;r<o;++r)t[e[r]]=i.num;if(!n)for(r=0,o=a.length;r<o;++r)a[r].set(t)};i.init=function(){i.num=0;if(u)u.reset();for(let t=0;t<r;++t)a[t].init()};return i}function Ql(t){Wo.call(this,{},t);this._mlen=0;this._mods=[]}Ql.Definition={type:"Window",metadata:{modifies:true},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:true},{name:"ops",type:"enum",array:true,values:Vl.concat(ps)},{name:"params",type:"number",null:true,array:true},{name:"fields",type:"field",null:true,array:true},{name:"as",type:"string",null:true,array:true},{name:"frame",type:"number",null:true,array:true,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:false}]};(0,g.XW)(Ql,Wo,{transform(t,e){this.stamp=e.stamp;const n=t.modified(),i=za(t.sort),r=ls(t.groupby),a=t=>this.group(r(t));let o=this.state;if(!o||n){o=this.state=new Gl(t)}if(n||e.modified(o.inputs)){this.value={};e.visit(e.SOURCE,(t=>a(t).add(t)))}else{e.visit(e.REM,(t=>a(t).remove(t)));e.visit(e.ADD,(t=>a(t).add(t)))}for(let u=0,s=this._mlen;u<s;++u){tf(this._mods[u],o,i,t)}this._mlen=0;this._mods=[];return e.reflow(n).modifies(o.outputs)},group(t){let e=this.value[t];if(!e){e=this.value[t]=Fs(Ca);e.stamp=-1}if(e.stamp<this.stamp){e.stamp=this.stamp;this._mods[this._mlen++]=e}return e}});function tf(t,e,n,i){const r=i.sort,a=r&&!i.ignorePeers,o=i.frame||[null,0],u=t.data(n),s=u.length,l=a?Ue(r):null,f={i0:0,i1:0,p0:0,p1:0,index:0,data:u,compare:r||(0,g.a9)(-1)};e.init();for(let c=0;c<s;++c){ef(f,o,c,s);if(a)nf(f,l);e.update(f,u[c])}}function ef(t,e,n,i){t.p0=t.i0;t.p1=t.i1;t.i0=e[0]==null?0:Math.max(0,n-Math.abs(e[0]));t.i1=e[1]==null?i:Math.min(i,n+Math.abs(e[1])+1);t.index=n}function nf(t,e){const n=t.i0,i=t.i1-1,r=t.compare,a=t.data,o=a.length-1;if(n>0&&!r(a[n],a[n-1]))t.i0=e.left(a,a[n]);if(i<o&&!r(a[i],a[i+1]))t.i1=e.right(a,a[i])}function rf(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function af(t){this._context=t}af.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN;this._point=0},lineEnd:function(){switch(this._point){case 3:rf(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}if(this._line||this._line!==0&&this._point===1)this._context.closePath();this._line=1-this._line},point:function(t,e){t=+t,e=+e;switch(this._point){case 0:this._point=1;this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:rf(this,t,e);break}this._x0=this._x1,this._x1=t;this._y0=this._y1,this._y1=e}};function of(t){return new af(t)}function uf(){}function sf(t){this._context=t}sf.prototype={areaStart:uf,areaEnd:uf,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN;this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2);this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3);this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3);this._context.closePath();break}case 3:{this.point(this._x2,this._y2);this.point(this._x3,this._y3);this.point(this._x4,this._y4);break}}},point:function(t,e){t=+t,e=+e;switch(this._point){case 0:this._point=1;this._x2=t,this._y2=e;break;case 1:this._point=2;this._x3=t,this._y3=e;break;case 2:this._point=3;this._x4=t,this._y4=e;this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:rf(this,t,e);break}this._x0=this._x1,this._x1=t;this._y0=this._y1,this._y1=e}};function lf(t){return new sf(t)}function ff(t){this._context=t}ff.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN;this._point=0},lineEnd:function(){if(this._line||this._line!==0&&this._point===3)this._context.closePath();this._line=1-this._line},point:function(t,e){t=+t,e=+e;switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+t)/6,i=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(n,i):this._context.moveTo(n,i);break;case 3:this._point=4;default:rf(this,t,e);break}this._x0=this._x1,this._x1=t;this._y0=this._y1,this._y1=e}};function cf(t){return new ff(t)}function hf(t,e){this._basis=new af(t);this._beta=e}hf.prototype={lineStart:function(){this._x=[];this._y=[];this._basis.lineStart()},lineEnd:function(){var t=this._x,e=this._y,n=t.length-1;if(n>0){var i=t[0],r=e[0],a=t[n]-i,o=e[n]-r,u=-1,s;while(++u<=n){s=u/n;this._basis.point(this._beta*t[u]+(1-this._beta)*(i+s*a),this._beta*e[u]+(1-this._beta)*(r+s*o))}}this._x=this._y=null;this._basis.lineEnd()},point:function(t,e){this._x.push(+t);this._y.push(+e)}};const df=function t(e){function n(t){return e===1?new af(t):new hf(t,e)}n.beta=function(e){return t(+e)};return n}(.85);function pf(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function gf(t,e){this._context=t;this._k=(1-e)/6}gf.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN;this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:pf(this,this._x1,this._y1);break}if(this._line||this._line!==0&&this._point===1)this._context.closePath();this._line=1-this._line},point:function(t,e){t=+t,e=+e;switch(this._point){case 0:this._point=1;this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;this._x1=t,this._y1=e;break;case 2:this._point=3;default:pf(this,t,e);break}this._x0=this._x1,this._x1=this._x2,this._x2=t;this._y0=this._y1,this._y1=this._y2,this._y2=e}};const mf=function t(e){function n(t){return new gf(t,e)}n.tension=function(e){return t(+e)};return n}(0);function yf(t,e){this._context=t;this._k=(1-e)/6}yf.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN;this._point=0},lineEnd:function(){if(this._line||this._line!==0&&this._point===3)this._context.closePath();this._line=1-this._line},point:function(t,e){t=+t,e=+e;switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:pf(this,t,e);break}this._x0=this._x1,this._x1=this._x2,this._x2=t;this._y0=this._y1,this._y1=this._y2,this._y2=e}};const vf=function t(e){function n(t){return new yf(t,e)}n.tension=function(e){return t(+e)};return n}(0);function xf(t,e){this._context=t;this._k=(1-e)/6}xf.prototype={areaStart:uf,areaEnd:uf,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN;this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3);this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3);this._context.closePath();break}case 3:{this.point(this._x3,this._y3);this.point(this._x4,this._y4);this.point(this._x5,this._y5);break}}},point:function(t,e){t=+t,e=+e;switch(this._point){case 0:this._point=1;this._x3=t,this._y3=e;break;case 1:this._point=2;this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3;this._x5=t,this._y5=e;break;default:pf(this,t,e);break}this._x0=this._x1,this._x1=this._x2,this._x2=t;this._y0=this._y1,this._y1=this._y2,this._y2=e}};const _f=function t(e){function n(t){return new xf(t,e)}n.tension=function(e){return t(+e)};return n}(0);var bf=Math.abs;var wf=Math.atan2;var kf=Math.cos;var Mf=Math.max;var Af=Math.min;var Ef=Math.sin;var Df=Math.sqrt;var Cf=1e-12;var Ff=Math.PI;var Sf=Ff/2;var Tf=2*Ff;function Bf(t){return t>1?0:t<-1?Ff:Math.acos(t)}function Nf(t){return t>=1?Sf:t<=-1?-Sf:Math.asin(t)}function zf(t,e,n){var i=t._x1,r=t._y1,a=t._x2,o=t._y2;if(t._l01_a>Cf){var u=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,s=3*t._l01_a*(t._l01_a+t._l12_a);i=(i*u-t._x0*t._l12_2a+t._x2*t._l01_2a)/s;r=(r*u-t._y0*t._l12_2a+t._y2*t._l01_2a)/s}if(t._l23_a>Cf){var l=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,f=3*t._l23_a*(t._l23_a+t._l12_a);a=(a*l+t._x1*t._l23_2a-e*t._l12_2a)/f;o=(o*l+t._y1*t._l23_2a-n*t._l12_2a)/f}t._context.bezierCurveTo(i,r,a,o,t._x2,t._y2)}function Of(t,e){this._context=t;this._alpha=e}Of.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN;this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}if(this._line||this._line!==0&&this._point===1)this._context.closePath();this._line=1-this._line},point:function(t,e){t=+t,e=+e;if(this._point){var n=this._x2-t,i=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1;this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:zf(this,t,e);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a;this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a;this._x0=this._x1,this._x1=this._x2,this._x2=t;this._y0=this._y1,this._y1=this._y2,this._y2=e}};const Rf=function t(e){function n(t){return e?new Of(t,e):new gf(t,0)}n.alpha=function(e){return t(+e)};return n}(.5);function Uf(t,e){this._context=t;this._alpha=e}Uf.prototype={areaStart:uf,areaEnd:uf,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN;this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3);this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3);this._context.closePath();break}case 3:{this.point(this._x3,this._y3);this.point(this._x4,this._y4);this.point(this._x5,this._y5);break}}},point:function(t,e){t=+t,e=+e;if(this._point){var n=this._x2-t,i=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1;this._x3=t,this._y3=e;break;case 1:this._point=2;this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3;this._x5=t,this._y5=e;break;default:zf(this,t,e);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a;this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a;this._x0=this._x1,this._x1=this._x2,this._x2=t;this._y0=this._y1,this._y1=this._y2,this._y2=e}};const $f=function t(e){function n(t){return e?new Uf(t,e):new xf(t,0)}n.alpha=function(e){return t(+e)};return n}(.5);function Pf(t,e){this._context=t;this._alpha=e}Pf.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN;this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){if(this._line||this._line!==0&&this._point===3)this._context.closePath();this._line=1-this._line},point:function(t,e){t=+t,e=+e;if(this._point){var n=this._x2-t,i=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:zf(this,t,e);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a;this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a;this._x0=this._x1,this._x1=this._x2,this._x2=t;this._y0=this._y1,this._y1=this._y2,this._y2=e}};const qf=function t(e){function n(t){return e?new Pf(t,e):new yf(t,0)}n.alpha=function(e){return t(+e)};return n}(.5);function If(t){this._context=t}If.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){if(this._line||this._line!==0&&this._point===1)this._context.closePath();this._line=1-this._line},point:function(t,e){t=+t,e=+e;switch(this._point){case 0:this._point=1;this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function Lf(t){return new If(t)}function jf(t){this._context=t}jf.prototype={areaStart:uf,areaEnd:uf,lineStart:function(){this._point=0},lineEnd:function(){if(this._point)this._context.closePath()},point:function(t,e){t=+t,e=+e;if(this._point)this._context.lineTo(t,e);else this._point=1,this._context.moveTo(t,e)}};function Wf(t){return new jf(t)}function Xf(t){return t<0?-1:1}function Hf(t,e,n){var i=t._x1-t._x0,r=e-t._x1,a=(t._y1-t._y0)/(i||r<0&&-0),o=(n-t._y1)/(r||i<0&&-0),u=(a*r+o*i)/(i+r);return(Xf(a)+Xf(o))*Math.min(Math.abs(a),Math.abs(o),.5*Math.abs(u))||0}function Yf(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function Jf(t,e,n){var i=t._x0,r=t._y0,a=t._x1,o=t._y1,u=(a-i)/3;t._context.bezierCurveTo(i+u,r+u*e,a-u,o-u*n,a,o)}function Vf(t){this._context=t}Vf.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN;this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Jf(this,this._t0,Yf(this,this._t0));break}if(this._line||this._line!==0&&this._point===1)this._context.closePath();this._line=1-this._line},point:function(t,e){var n=NaN;t=+t,e=+e;if(t===this._x1&&e===this._y1)return;switch(this._point){case 0:this._point=1;this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;Jf(this,Yf(this,n=Hf(this,t,e)),n);break;default:Jf(this,this._t0,n=Hf(this,t,e));break}this._x0=this._x1,this._x1=t;this._y0=this._y1,this._y1=e;this._t0=n}};function Gf(t){this._context=new Kf(t)}(Gf.prototype=Object.create(Vf.prototype)).point=function(t,e){Vf.prototype.point.call(this,e,t)};function Kf(t){this._context=t}Kf.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,n,i,r,a){this._context.bezierCurveTo(e,t,i,n,a,r)}};function Zf(t){return new Vf(t)}function Qf(t){return new Gf(t)}function tc(t){this._context=t}tc.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[];this._y=[]},lineEnd:function(){var t=this._x,e=this._y,n=t.length;if(n){this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]);if(n===2){this._context.lineTo(t[1],e[1])}else{var i=ec(t),r=ec(e);for(var a=0,o=1;o<n;++a,++o){this._context.bezierCurveTo(i[0][a],r[0][a],i[1][a],r[1][a],t[o],e[o])}}}if(this._line||this._line!==0&&n===1)this._context.closePath();this._line=1-this._line;this._x=this._y=null},point:function(t,e){this._x.push(+t);this._y.push(+e)}};function ec(t){var e,n=t.length-1,i,r=new Array(n),a=new Array(n),o=new Array(n);r[0]=0,a[0]=2,o[0]=t[0]+2*t[1];for(e=1;e<n-1;++e)r[e]=1,a[e]=4,o[e]=4*t[e]+2*t[e+1];r[n-1]=2,a[n-1]=7,o[n-1]=8*t[n-1]+t[n];for(e=1;e<n;++e)i=r[e]/a[e-1],a[e]-=i,o[e]-=i*o[e-1];r[n-1]=o[n-1]/a[n-1];for(e=n-2;e>=0;--e)r[e]=(o[e]-r[e+1])/a[e];a[n-1]=(t[n]+r[n-1])/2;for(e=0;e<n-1;++e)a[e]=2*t[e+1]-r[e+1];return[r,a]}function nc(t){return new tc(t)}function ic(t,e){this._context=t;this._t=e}ic.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN;this._point=0},lineEnd:function(){if(0<this._t&&this._t<1&&this._point===2)this._context.lineTo(this._x,this._y);if(this._line||this._line!==0&&this._point===1)this._context.closePath();if(this._line>=0)this._t=1-this._t,this._line=1-this._line},point:function(t,e){t=+t,e=+e;switch(this._point){case 0:this._point=1;this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:{if(this._t<=0){this._context.lineTo(this._x,e);this._context.lineTo(t,e)}else{var n=this._x*(1-this._t)+t*this._t;this._context.lineTo(n,this._y);this._context.lineTo(n,e)}break}}this._x=t,this._y=e}};function rc(t){return new ic(t,.5)}function ac(t){return new ic(t,0)}function oc(t){return new ic(t,1)}const uc=Math.PI,sc=2*uc,lc=1e-6,fc=sc-lc;function cc(){this._x0=this._y0=this._x1=this._y1=null;this._=""}function hc(){return new cc}cc.prototype=hc.prototype={constructor:cc,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){if(this._x1!==null){this._x1=this._x0,this._y1=this._y0;this._+="Z"}},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,i){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+i)},bezierCurveTo:function(t,e,n,i,r,a){this._+="C"+ +t+","+ +e+","+ +n+","+ +i+","+(this._x1=+r)+","+(this._y1=+a)},arcTo:function(t,e,n,i,r){t=+t,e=+e,n=+n,i=+i,r=+r;var a=this._x1,o=this._y1,u=n-t,s=i-e,l=a-t,f=o-e,c=l*l+f*f;if(r<0)throw new Error("negative radius: "+r);if(this._x1===null){this._+="M"+(this._x1=t)+","+(this._y1=e)}else if(!(c>lc));else if(!(Math.abs(f*u-s*l)>lc)||!r){this._+="L"+(this._x1=t)+","+(this._y1=e)}else{var h=n-a,d=i-o,p=u*u+s*s,g=h*h+d*d,m=Math.sqrt(p),y=Math.sqrt(c),v=r*Math.tan((uc-Math.acos((p+c-g)/(2*m*y)))/2),x=v/y,_=v/m;if(Math.abs(x-1)>lc){this._+="L"+(t+x*l)+","+(e+x*f)}this._+="A"+r+","+r+",0,0,"+ +(f*h>l*d)+","+(this._x1=t+_*u)+","+(this._y1=e+_*s)}},arc:function(t,e,n,i,r,a){t=+t,e=+e,n=+n,a=!!a;var o=n*Math.cos(i),u=n*Math.sin(i),s=t+o,l=e+u,f=1^a,c=a?i-r:r-i;if(n<0)throw new Error("negative radius: "+n);if(this._x1===null){this._+="M"+s+","+l}else if(Math.abs(this._x1-s)>lc||Math.abs(this._y1-l)>lc){this._+="L"+s+","+l}if(!n)return;if(c<0)c=c%sc+sc;if(c>fc){this._+="A"+n+","+n+",0,1,"+f+","+(t-o)+","+(e-u)+"A"+n+","+n+",0,1,"+f+","+(this._x1=s)+","+(this._y1=l)}else if(c>lc){this._+="A"+n+","+n+",0,"+ +(c>=uc)+","+f+","+(this._x1=t+n*Math.cos(r))+","+(this._y1=e+n*Math.sin(r))}},rect:function(t,e,n,i){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +i+"h"+-n+"Z"},toString:function(){return this._}};const dc=hc;function pc(t){return function e(){return t}}function gc(t){return t.innerRadius}function mc(t){return t.outerRadius}function yc(t){return t.startAngle}function vc(t){return t.endAngle}function xc(t){return t&&t.padAngle}function _c(t,e,n,i,r,a,o,u){var s=n-t,l=i-e,f=o-r,c=u-a,h=c*s-f*l;if(h*h<Cf)return;h=(f*(e-a)-c*(t-r))/h;return[t+h*s,e+h*l]}function bc(t,e,n,i,r,a,o){var u=t-n,s=e-i,l=(o?a:-a)/Df(u*u+s*s),f=l*s,c=-l*u,h=t+f,d=e+c,p=n+f,g=i+c,m=(h+p)/2,y=(d+g)/2,v=p-h,x=g-d,_=v*v+x*x,b=r-a,w=h*g-p*d,k=(x<0?-1:1)*Df(Mf(0,b*b*_-w*w)),M=(w*x-v*k)/_,A=(-w*v-x*k)/_,E=(w*x+v*k)/_,D=(-w*v+x*k)/_,C=M-m,F=A-y,S=E-m,T=D-y;if(C*C+F*F>S*S+T*T)M=E,A=D;return{cx:M,cy:A,x01:-f,y01:-c,x11:M*(r/b-1),y11:A*(r/b-1)}}function wc(){var t=gc,e=mc,n=pc(0),i=null,r=yc,a=vc,o=xc,u=null;function s(){var s,l,f=+t.apply(this,arguments),c=+e.apply(this,arguments),h=r.apply(this,arguments)-Sf,d=a.apply(this,arguments)-Sf,p=bf(d-h),g=d>h;if(!u)u=s=dc();if(c<f)l=c,c=f,f=l;if(!(c>Cf))u.moveTo(0,0);else if(p>Tf-Cf){u.moveTo(c*kf(h),c*Ef(h));u.arc(0,0,c,h,d,!g);if(f>Cf){u.moveTo(f*kf(d),f*Ef(d));u.arc(0,0,f,d,h,g)}}else{var m=h,y=d,v=h,x=d,_=p,b=p,w=o.apply(this,arguments)/2,k=w>Cf&&(i?+i.apply(this,arguments):Df(f*f+c*c)),M=Af(bf(c-f)/2,+n.apply(this,arguments)),A=M,E=M,D,C;if(k>Cf){var F=Nf(k/f*Ef(w)),S=Nf(k/c*Ef(w));if((_-=F*2)>Cf)F*=g?1:-1,v+=F,x-=F;else _=0,v=x=(h+d)/2;if((b-=S*2)>Cf)S*=g?1:-1,m+=S,y-=S;else b=0,m=y=(h+d)/2}var T=c*kf(m),B=c*Ef(m),N=f*kf(x),z=f*Ef(x);if(M>Cf){var O=c*kf(y),R=c*Ef(y),U=f*kf(v),$=f*Ef(v),P;if(p<Ff&&(P=_c(T,B,U,$,O,R,N,z))){var q=T-P[0],I=B-P[1],L=O-P[0],j=R-P[1],W=1/Ef(Bf((q*L+I*j)/(Df(q*q+I*I)*Df(L*L+j*j)))/2),X=Df(P[0]*P[0]+P[1]*P[1]);A=Af(M,(f-X)/(W-1));E=Af(M,(c-X)/(W+1))}}if(!(b>Cf))u.moveTo(T,B);else if(E>Cf){D=bc(U,$,T,B,c,E,g);C=bc(O,R,N,z,c,E,g);u.moveTo(D.cx+D.x01,D.cy+D.y01);if(E<M)u.arc(D.cx,D.cy,E,wf(D.y01,D.x01),wf(C.y01,C.x01),!g);else{u.arc(D.cx,D.cy,E,wf(D.y01,D.x01),wf(D.y11,D.x11),!g);u.arc(0,0,c,wf(D.cy+D.y11,D.cx+D.x11),wf(C.cy+C.y11,C.cx+C.x11),!g);u.arc(C.cx,C.cy,E,wf(C.y11,C.x11),wf(C.y01,C.x01),!g)}}else u.moveTo(T,B),u.arc(0,0,c,m,y,!g);if(!(f>Cf)||!(_>Cf))u.lineTo(N,z);else if(A>Cf){D=bc(N,z,O,R,f,-A,g);C=bc(T,B,U,$,f,-A,g);u.lineTo(D.cx+D.x01,D.cy+D.y01);if(A<M)u.arc(D.cx,D.cy,A,wf(D.y01,D.x01),wf(C.y01,C.x01),!g);else{u.arc(D.cx,D.cy,A,wf(D.y01,D.x01),wf(D.y11,D.x11),!g);u.arc(0,0,f,wf(D.cy+D.y11,D.cx+D.x11),wf(C.cy+C.y11,C.cx+C.x11),g);u.arc(C.cx,C.cy,A,wf(C.y11,C.x11),wf(C.y01,C.x01),!g)}}else u.arc(0,0,f,x,v,g)}u.closePath();if(s)return u=null,s+""||null}s.centroid=function(){var n=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,i=(+r.apply(this,arguments)+ +a.apply(this,arguments))/2-Ff/2;return[kf(i)*n,Ef(i)*n]};s.innerRadius=function(e){return arguments.length?(t=typeof e==="function"?e:pc(+e),s):t};s.outerRadius=function(t){return arguments.length?(e=typeof t==="function"?t:pc(+t),s):e};s.cornerRadius=function(t){return arguments.length?(n=typeof t==="function"?t:pc(+t),s):n};s.padRadius=function(t){return arguments.length?(i=t==null?null:typeof t==="function"?t:pc(+t),s):i};s.startAngle=function(t){return arguments.length?(r=typeof t==="function"?t:pc(+t),s):r};s.endAngle=function(t){return arguments.length?(a=typeof t==="function"?t:pc(+t),s):a};s.padAngle=function(t){return arguments.length?(o=typeof t==="function"?t:pc(+t),s):o};s.context=function(t){return arguments.length?(u=t==null?null:t,s):u};return s}var kc=Array.prototype.slice;function Mc(t){return typeof t==="object"&&"length"in t?t:Array.from(t)}function Ac(t){return t[0]}function Ec(t){return t[1]}function Dc(t,e){var n=pc(true),i=null,r=Lf,a=null;t=typeof t==="function"?t:t===undefined?Ac:pc(t);e=typeof e==="function"?e:e===undefined?Ec:pc(e);function o(o){var u,s=(o=Mc(o)).length,l,f=false,c;if(i==null)a=r(c=dc());for(u=0;u<=s;++u){if(!(u<s&&n(l=o[u],u,o))===f){if(f=!f)a.lineStart();else a.lineEnd()}if(f)a.point(+t(l,u,o),+e(l,u,o))}if(c)return a=null,c+""||null}o.x=function(e){return arguments.length?(t=typeof e==="function"?e:pc(+e),o):t};o.y=function(t){return arguments.length?(e=typeof t==="function"?t:pc(+t),o):e};o.defined=function(t){return arguments.length?(n=typeof t==="function"?t:pc(!!t),o):n};o.curve=function(t){return arguments.length?(r=t,i!=null&&(a=r(i)),o):r};o.context=function(t){return arguments.length?(t==null?i=a=null:a=r(i=t),o):i};return o}function Cc(t,e,n){var i=null,r=pc(true),a=null,o=Lf,u=null;t=typeof t==="function"?t:t===undefined?Ac:pc(+t);e=typeof e==="function"?e:e===undefined?pc(0):pc(+e);n=typeof n==="function"?n:n===undefined?Ec:pc(+n);function s(s){var l,f,c,h=(s=Mc(s)).length,d,p=false,g,m=new Array(h),y=new Array(h);if(a==null)u=o(g=dc());for(l=0;l<=h;++l){if(!(l<h&&r(d=s[l],l,s))===p){if(p=!p){f=l;u.areaStart();u.lineStart()}else{u.lineEnd();u.lineStart();for(c=l-1;c>=f;--c){u.point(m[c],y[c])}u.lineEnd();u.areaEnd()}}if(p){m[l]=+t(d,l,s),y[l]=+e(d,l,s);u.point(i?+i(d,l,s):m[l],n?+n(d,l,s):y[l])}}if(g)return u=null,g+""||null}function l(){return Dc().defined(r).curve(o).context(a)}s.x=function(e){return arguments.length?(t=typeof e==="function"?e:pc(+e),i=null,s):t};s.x0=function(e){return arguments.length?(t=typeof e==="function"?e:pc(+e),s):t};s.x1=function(t){return arguments.length?(i=t==null?null:typeof t==="function"?t:pc(+t),s):i};s.y=function(t){return arguments.length?(e=typeof t==="function"?t:pc(+t),n=null,s):e};s.y0=function(t){return arguments.length?(e=typeof t==="function"?t:pc(+t),s):e};s.y1=function(t){return arguments.length?(n=t==null?null:typeof t==="function"?t:pc(+t),s):n};s.lineX0=s.lineY0=function(){return l().x(t).y(e)};s.lineY1=function(){return l().x(t).y(n)};s.lineX1=function(){return l().x(i).y(e)};s.defined=function(t){return arguments.length?(r=typeof t==="function"?t:pc(!!t),s):r};s.curve=function(t){return arguments.length?(o=t,a!=null&&(u=o(a)),s):o};s.context=function(t){return arguments.length?(t==null?a=u=null:u=o(a=t),s):a};return s}const Fc={draw:function(t,e){var n=Math.sqrt(e/Ff);t.moveTo(n,0);t.arc(0,0,n,0,Tf)}};const Sc={draw:function(t,e){var n=Math.sqrt(e/5)/2;t.moveTo(-3*n,-n);t.lineTo(-n,-n);t.lineTo(-n,-3*n);t.lineTo(n,-3*n);t.lineTo(n,-n);t.lineTo(3*n,-n);t.lineTo(3*n,n);t.lineTo(n,n);t.lineTo(n,3*n);t.lineTo(-n,3*n);t.lineTo(-n,n);t.lineTo(-3*n,n);t.closePath()}};var Tc=Math.sqrt(1/3),Bc=Tc*2;const Nc={draw:function(t,e){var n=Math.sqrt(e/Bc),i=n*Tc;t.moveTo(0,-n);t.lineTo(i,0);t.lineTo(0,n);t.lineTo(-i,0);t.closePath()}};var zc=.8908130915292852,Oc=Math.sin(Ff/10)/Math.sin(7*Ff/10),Rc=Math.sin(Tf/10)*Oc,Uc=-Math.cos(Tf/10)*Oc;const $c={draw:function(t,e){var n=Math.sqrt(e*zc),i=Rc*n,r=Uc*n;t.moveTo(0,-n);t.lineTo(i,r);for(var a=1;a<5;++a){var o=Tf*a/5,u=Math.cos(o),s=Math.sin(o);t.lineTo(s*n,-u*n);t.lineTo(u*i-s*r,s*i+u*r)}t.closePath()}};const Pc={draw:function(t,e){var n=Math.sqrt(e),i=-n/2;t.rect(i,i,n,n)}};var qc=Math.sqrt(3);const Ic={draw:function(t,e){var n=-Math.sqrt(e/(qc*3));t.moveTo(0,n*2);t.lineTo(-qc*n,-n);t.lineTo(qc*n,-n);t.closePath()}};var Lc=-.5,jc=Math.sqrt(3)/2,Wc=1/Math.sqrt(12),Xc=(Wc/2+1)*3;const Hc={draw:function(t,e){var n=Math.sqrt(e/Xc),i=n/2,r=n*Wc,a=i,o=n*Wc+n,u=-a,s=o;t.moveTo(i,r);t.lineTo(a,o);t.lineTo(u,s);t.lineTo(Lc*i-jc*r,jc*i+Lc*r);t.lineTo(Lc*a-jc*o,jc*a+Lc*o);t.lineTo(Lc*u-jc*s,jc*u+Lc*s);t.lineTo(Lc*i+jc*r,Lc*r-jc*i);t.lineTo(Lc*a+jc*o,Lc*o-jc*a);t.lineTo(Lc*u+jc*s,Lc*s-jc*u);t.closePath()}};var Yc=[Fc,Sc,Nc,Pc,$c,Ic,Hc];function Jc(t,e){var n=null;t=typeof t==="function"?t:pc(t||Fc);e=typeof e==="function"?e:pc(e===undefined?64:+e);function i(){var i;if(!n)n=i=dc();t.apply(this,arguments).draw(n,+e.apply(this,arguments));if(i)return n=null,i+""||null}i.type=function(e){return arguments.length?(t=typeof e==="function"?e:pc(e),i):t};i.size=function(t){return arguments.length?(e=typeof t==="function"?t:pc(+t),i):e};i.context=function(t){return arguments.length?(n=t==null?null:t,i):n};return i}function Vc(t,e){if(typeof document!=="undefined"&&document.createElement){const n=document.createElement("canvas");if(n&&n.getContext){n.width=t;n.height=e;return n}}return null}const Gc=()=>typeof Image!=="undefined"?Image:null;const Kc=Ue(Re);const Zc=Kc.right;const Qc=Kc.left;const th=Ue(Zo).center;const eh=Zc;function nh(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function ih(t,e){switch(arguments.length){case 0:break;case 1:{if(typeof t==="function")this.interpolator(t);else this.range(t);break}default:{this.domain(t);if(typeof e==="function")this.interpolator(e);else this.range(e);break}}return this}const rh=Symbol("implicit");function ah(){var t=new Map,e=[],n=[],i=rh;function r(r){var a=r+"",o=t.get(a);if(!o){if(i!==rh)return i;t.set(a,o=e.push(r))}return n[(o-1)%n.length]}r.domain=function(n){if(!arguments.length)return e.slice();e=[],t=new Map;for(const i of n){const n=i+"";if(t.has(n))continue;t.set(n,e.push(i))}return r};r.range=function(t){return arguments.length?(n=Array.from(t),r):n.slice()};r.unknown=function(t){return arguments.length?(i=t,r):i};r.copy=function(){return ah(e,n).unknown(i)};nh.apply(r,arguments);return r}var oh=n(46196);var uh=n(33085);function sh(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor((0,uh.Z)(e)/3)))*3-(0,uh.Z)(Math.abs(t)))}var lh=n(96453);function fh(t,e){t=Math.abs(t),e=Math.abs(e)-t;return Math.max(0,(0,uh.Z)(e)-(0,uh.Z)(t))+1}function ch(t){return Math.max(0,-(0,uh.Z)(Math.abs(t)))}function hh(t,e,n,i){var r=j(t,e,n),a;i=(0,oh.Z)(i==null?",f":i);switch(i.type){case"s":{var o=Math.max(Math.abs(t),Math.abs(e));if(i.precision==null&&!isNaN(a=sh(r,o)))i.precision=a;return(0,lh.jH)(i,o)}case"":case"e":case"g":case"p":case"r":{if(i.precision==null&&!isNaN(a=fh(r,Math.max(Math.abs(t),Math.abs(e)))))i.precision=a-(i.type==="e");break}case"f":case"%":{if(i.precision==null&&!isNaN(a=ch(r)))i.precision=a-(i.type==="%")*2;break}}return(0,lh.WU)(i)}function dh(t,e,n){t.prototype=e.prototype=n;n.constructor=t}function ph(t,e){var n=Object.create(t.prototype);for(var i in e)n[i]=e[i];return n}function gh(){}var mh=.7;var yh=1/mh;var vh="\\s*([+-]?\\d+)\\s*",xh="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",_h="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",bh=/^#([0-9a-f]{3,8})$/,wh=new RegExp("^rgb\\("+[vh,vh,vh]+"\\)$"),kh=new RegExp("^rgb\\("+[_h,_h,_h]+"\\)$"),Mh=new RegExp("^rgba\\("+[vh,vh,vh,xh]+"\\)$"),Ah=new RegExp("^rgba\\("+[_h,_h,_h,xh]+"\\)$"),Eh=new RegExp("^hsl\\("+[xh,_h,_h]+"\\)$"),Dh=new RegExp("^hsla\\("+[xh,_h,_h,xh]+"\\)$");var Ch={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};dh(gh,Bh,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:Fh,formatHex:Fh,formatHsl:Sh,formatRgb:Th,toString:Th});function Fh(){return this.rgb().formatHex()}function Sh(){return Lh(this).formatHsl()}function Th(){return this.rgb().formatRgb()}function Bh(t){var e,n;t=(t+"").trim().toLowerCase();return(e=bh.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?Nh(e):n===3?new Uh(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?zh(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?zh(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=wh.exec(t))?new Uh(e[1],e[2],e[3],1):(e=kh.exec(t))?new Uh(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=Mh.exec(t))?zh(e[1],e[2],e[3],e[4]):(e=Ah.exec(t))?zh(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=Eh.exec(t))?Ih(e[1],e[2]/100,e[3]/100,1):(e=Dh.exec(t))?Ih(e[1],e[2]/100,e[3]/100,e[4]):Ch.hasOwnProperty(t)?Nh(Ch[t]):t==="transparent"?new Uh(NaN,NaN,NaN,0):null}function Nh(t){return new Uh(t>>16&255,t>>8&255,t&255,1)}function zh(t,e,n,i){if(i<=0)t=e=n=NaN;return new Uh(t,e,n,i)}function Oh(t){if(!(t instanceof gh))t=Bh(t);if(!t)return new Uh;t=t.rgb();return new Uh(t.r,t.g,t.b,t.opacity)}function Rh(t,e,n,i){return arguments.length===1?Oh(t):new Uh(t,e,n,i==null?1:i)}function Uh(t,e,n,i){this.r=+t;this.g=+e;this.b=+n;this.opacity=+i}dh(Uh,Rh,ph(gh,{brighter:function(t){t=t==null?yh:Math.pow(yh,t);return new Uh(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){t=t==null?mh:Math.pow(mh,t);return new Uh(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&(-.5<=this.g&&this.g<255.5)&&(-.5<=this.b&&this.b<255.5)&&(0<=this.opacity&&this.opacity<=1)},hex:$h,formatHex:$h,formatRgb:Ph,toString:Ph}));function $h(){return"#"+qh(this.r)+qh(this.g)+qh(this.b)}function Ph(){var t=this.opacity;t=isNaN(t)?1:Math.max(0,Math.min(1,t));return(t===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(t===1?")":", "+t+")")}function qh(t){t=Math.max(0,Math.min(255,Math.round(t)||0));return(t<16?"0":"")+t.toString(16)}function Ih(t,e,n,i){if(i<=0)t=e=n=NaN;else if(n<=0||n>=1)t=e=NaN;else if(e<=0)t=NaN;return new Wh(t,e,n,i)}function Lh(t){if(t instanceof Wh)return new Wh(t.h,t.s,t.l,t.opacity);if(!(t instanceof gh))t=Bh(t);if(!t)return new Wh;if(t instanceof Wh)return t;t=t.rgb();var e=t.r/255,n=t.g/255,i=t.b/255,r=Math.min(e,n,i),a=Math.max(e,n,i),o=NaN,u=a-r,s=(a+r)/2;if(u){if(e===a)o=(n-i)/u+(n<i)*6;else if(n===a)o=(i-e)/u+2;else o=(e-n)/u+4;u/=s<.5?a+r:2-a-r;o*=60}else{u=s>0&&s<1?0:o}return new Wh(o,u,s,t.opacity)}function jh(t,e,n,i){return arguments.length===1?Lh(t):new Wh(t,e,n,i==null?1:i)}function Wh(t,e,n,i){this.h=+t;this.s=+e;this.l=+n;this.opacity=+i}dh(Wh,jh,ph(gh,{brighter:function(t){t=t==null?yh:Math.pow(yh,t);return new Wh(this.h,this.s,this.l*t,this.opacity)},darker:function(t){t=t==null?mh:Math.pow(mh,t);return new Wh(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,r=2*n-i;return new Uh(Xh(t>=240?t-240:t+120,r,i),Xh(t,r,i),Xh(t<120?t+240:t-120,r,i),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&(0<=this.l&&this.l<=1)&&(0<=this.opacity&&this.opacity<=1)},formatHsl:function(){var t=this.opacity;t=isNaN(t)?1:Math.max(0,Math.min(1,t));return(t===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(t===1?")":", "+t+")")}}));function Xh(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}function Hh(t,e,n,i,r){var a=t*t,o=a*t;return((1-3*t+3*a-o)*e+(4-6*a+3*o)*n+(1+3*t+3*a-3*o)*i+o*r)/6}function Yh(t){var e=t.length-1;return function(n){var i=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),r=t[i],a=t[i+1],o=i>0?t[i-1]:2*r-a,u=i<e-1?t[i+2]:2*a-r;return Hh((n-i/e)*e,o,r,a,u)}}function Jh(t){var e=t.length;return function(n){var i=Math.floor(((n%=1)<0?++n:n)*e),r=t[(i+e-1)%e],a=t[i%e],o=t[(i+1)%e],u=t[(i+2)%e];return Hh((n-i/e)*e,r,a,o,u)}}const Vh=t=>()=>t;function Gh(t,e){return function(n){return t+n*e}}function Kh(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(i){return Math.pow(t+i*e,n)}}function Zh(t,e){var n=e-t;return n?Gh(t,n>180||n<-180?n-360*Math.round(n/360):n):Vh(isNaN(t)?e:t)}function Qh(t){return(t=+t)===1?td:function(e,n){return n-e?Kh(e,n,t):Vh(isNaN(e)?n:e)}}function td(t,e){var n=e-t;return n?Gh(t,n):Vh(isNaN(t)?e:t)}const ed=function t(e){var n=Qh(e);function i(t,e){var i=n((t=Rh(t)).r,(e=Rh(e)).r),r=n(t.g,e.g),a=n(t.b,e.b),o=td(t.opacity,e.opacity);return function(e){t.r=i(e);t.g=r(e);t.b=a(e);t.opacity=o(e);return t+""}}i.gamma=t;return i}(1);function nd(t){return function(e){var n=e.length,i=new Array(n),r=new Array(n),a=new Array(n),o,u;for(o=0;o<n;++o){u=Rh(e[o]);i[o]=u.r||0;r[o]=u.g||0;a[o]=u.b||0}i=t(i);r=t(r);a=t(a);u.opacity=1;return function(t){u.r=i(t);u.g=r(t);u.b=a(t);return u+""}}}var id=nd(Yh);var rd=nd(Jh);function ad(t,e){if(!e)e=[];var n=t?Math.min(e.length,t.length):0,i=e.slice(),r;return function(a){for(r=0;r<n;++r)i[r]=t[r]*(1-a)+e[r]*a;return i}}function od(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function ud(t,e){return(od(e)?ad:sd)(t,e)}function sd(t,e){var n=e?e.length:0,i=t?Math.min(n,t.length):0,r=new Array(i),a=new Array(n),o;for(o=0;o<i;++o)r[o]=yd(t[o],e[o]);for(;o<n;++o)a[o]=e[o];return function(t){for(o=0;o<i;++o)a[o]=r[o](t);return a}}function ld(t,e){var n=new Date;return t=+t,e=+e,function(i){return n.setTime(t*(1-i)+e*i),n}}function fd(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function cd(t,e){var n={},i={},r;if(t===null||typeof t!=="object")t={};if(e===null||typeof e!=="object")e={};for(r in e){if(r in t){n[r]=yd(t[r],e[r])}else{i[r]=e[r]}}return function(t){for(r in n)i[r]=n[r](t);return i}}var hd=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,dd=new RegExp(hd.source,"g");function pd(t){return function(){return t}}function gd(t){return function(e){return t(e)+""}}function md(t,e){var n=hd.lastIndex=dd.lastIndex=0,i,r,a,o=-1,u=[],s=[];t=t+"",e=e+"";while((i=hd.exec(t))&&(r=dd.exec(e))){if((a=r.index)>n){a=e.slice(n,a);if(u[o])u[o]+=a;else u[++o]=a}if((i=i[0])===(r=r[0])){if(u[o])u[o]+=r;else u[++o]=r}else{u[++o]=null;s.push({i:o,x:fd(i,r)})}n=dd.lastIndex}if(n<e.length){a=e.slice(n);if(u[o])u[o]+=a;else u[++o]=a}return u.length<2?s[0]?gd(s[0].x):pd(e):(e=s.length,function(t){for(var n=0,i;n<e;++n)u[(i=s[n]).i]=i.x(t);return u.join("")})}function yd(t,e){var n=typeof e,i;return e==null||n==="boolean"?Vh(e):(n==="number"?fd:n==="string"?(i=Bh(e))?(e=i,ed):md:e instanceof Bh?ed:e instanceof Date?ld:od(e)?ad:Array.isArray(e)?sd:typeof e.valueOf!=="function"&&typeof e.toString!=="function"||isNaN(e)?cd:fd)(t,e)}function vd(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}function xd(t){return function(){return t}}function _d(t){return+t}var bd=[0,1];function wd(t){return t}function kd(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:xd(isNaN(e)?NaN:.5)}function Md(t,e){var n;if(t>e)n=t,t=e,e=n;return function(n){return Math.max(t,Math.min(e,n))}}function Ad(t,e,n){var i=t[0],r=t[1],a=e[0],o=e[1];if(r<i)i=kd(r,i),a=n(o,a);else i=kd(i,r),a=n(a,o);return function(t){return a(i(t))}}function Ed(t,e,n){var i=Math.min(t.length,e.length)-1,r=new Array(i),a=new Array(i),o=-1;if(t[i]<t[0]){t=t.slice().reverse();e=e.slice().reverse()}while(++o<i){r[o]=kd(t[o],t[o+1]);a[o]=n(e[o],e[o+1])}return function(e){var n=eh(t,e,1,i)-1;return a[n](r[n](e))}}function Dd(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function Cd(){var t=bd,e=bd,n=yd,i,r,a,o=wd,u,s,l;function f(){var n=Math.min(t.length,e.length);if(o!==wd)o=Md(t[0],t[n-1]);u=n>2?Ed:Ad;s=l=null;return c}function c(r){return r==null||isNaN(r=+r)?a:(s||(s=u(t.map(i),e,n)))(i(o(r)))}c.invert=function(n){return o(r((l||(l=u(e,t.map(i),fd)))(n)))};c.domain=function(e){return arguments.length?(t=Array.from(e,_d),f()):t.slice()};c.range=function(t){return arguments.length?(e=Array.from(t),f()):e.slice()};c.rangeRound=function(t){return e=Array.from(t),n=vd,f()};c.clamp=function(t){return arguments.length?(o=t?true:wd,f()):o!==wd};c.interpolate=function(t){return arguments.length?(n=t,f()):n};c.unknown=function(t){return arguments.length?(a=t,c):a};return function(t,e){i=t,r=e;return f()}}function Fd(){return Cd()(wd,wd)}function Sd(t){var e=t.domain;t.ticks=function(t){var n=e();return I(n[0],n[n.length-1],t==null?10:t)};t.tickFormat=function(t,n){var i=e();return hh(i[0],i[i.length-1],t==null?10:t,n)};t.nice=function(n){if(n==null)n=10;var i=e();var r=0;var a=i.length-1;var o=i[r];var u=i[a];var s;var l;var f=10;if(u<o){l=o,o=u,u=l;l=r,r=a,a=l}while(f-- >0){l=L(o,u,n);if(l===s){i[r]=o;i[a]=u;return e(i)}else if(l>0){o=Math.floor(o/l)*l;u=Math.ceil(u/l)*l}else if(l<0){o=Math.ceil(o*l)/l;u=Math.floor(u*l)/l}else{break}s=l}return t};return t}function Td(){var t=Fd();t.copy=function(){return Dd(t,Td())};nh.apply(t,arguments);return Sd(t)}function Bd(t){var e;function n(t){return t==null||isNaN(t=+t)?e:t}n.invert=n;n.domain=n.range=function(e){return arguments.length?(t=Array.from(e,_d),n):t.slice()};n.unknown=function(t){return arguments.length?(e=t,n):e};n.copy=function(){return Bd(t).unknown(e)};t=arguments.length?Array.from(t,_d):[0,1];return Sd(n)}function Nd(t,e){t=t.slice();var n=0,i=t.length-1,r=t[n],a=t[i],o;if(a<r){o=n,n=i,i=o;o=r,r=a,a=o}t[n]=e.floor(r);t[i]=e.ceil(a);return t}function zd(t){return Math.log(t)}function Od(t){return Math.exp(t)}function Rd(t){return-Math.log(-t)}function Ud(t){return-Math.exp(-t)}function $d(t){return isFinite(t)?+("1e"+t):t<0?0:t}function Pd(t){return t===10?$d:t===Math.E?Math.exp:function(e){return Math.pow(t,e)}}function qd(t){return t===Math.E?Math.log:t===10&&Math.log10||t===2&&Math.log2||(t=Math.log(t),function(e){return Math.log(e)/t})}function Id(t){return function(e){return-t(-e)}}function Ld(t){var e=t(zd,Od),n=e.domain,i=10,r,a;function o(){r=qd(i),a=Pd(i);if(n()[0]<0){r=Id(r),a=Id(a);t(Rd,Ud)}else{t(zd,Od)}return e}e.base=function(t){return arguments.length?(i=+t,o()):i};e.domain=function(t){return arguments.length?(n(t),o()):n()};e.ticks=function(t){var e=n(),o=e[0],u=e[e.length-1],s;if(s=u<o)l=o,o=u,u=l;var l=r(o),f=r(u),c,h,d,p=t==null?10:+t,g=[];if(!(i%1)&&f-l<p){l=Math.floor(l),f=Math.ceil(f);if(o>0)for(;l<=f;++l){for(h=1,c=a(l);h<i;++h){d=c*h;if(d<o)continue;if(d>u)break;g.push(d)}}else for(;l<=f;++l){for(h=i-1,c=a(l);h>=1;--h){d=c*h;if(d<o)continue;if(d>u)break;g.push(d)}}if(g.length*2<p)g=I(o,u,p)}else{g=I(l,f,Math.min(f-l,p)).map(a)}return s?g.reverse():g};e.tickFormat=function(t,n){if(n==null)n=i===10?".0e":",";if(typeof n!=="function")n=(0,lh.WU)(n);if(t===Infinity)return n;if(t==null)t=10;var o=Math.max(1,i*t/e.ticks().length);return function(t){var e=t/a(Math.round(r(t)));if(e*i<i-.5)e*=i;return e<=o?n(t):""}};e.nice=function(){return n(Nd(n(),{floor:function(t){return a(Math.floor(r(t)))},ceil:function(t){return a(Math.ceil(r(t)))}}))};return e}function jd(){var t=Ld(Cd()).domain([1,10]);t.copy=function(){return Dd(t,jd()).base(t.base())};nh.apply(t,arguments);return t}function Wd(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function Xd(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function Hd(t){return t<0?-t*t:t*t}function Yd(t){var e=t(wd,wd),n=1;function i(){return n===1?t(wd,wd):n===.5?t(Xd,Hd):t(Wd(n),Wd(1/n))}e.exponent=function(t){return arguments.length?(n=+t,i()):n};return Sd(e)}function Jd(){var t=Yd(Cd());t.copy=function(){return Dd(t,Jd()).exponent(t.exponent())};nh.apply(t,arguments);return t}function Vd(){return Jd.apply(null,arguments).exponent(.5)}function Gd(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function Kd(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function Zd(t){var e=1,n=t(Gd(e),Kd(e));n.constant=function(n){return arguments.length?t(Gd(e=+n),Kd(e)):e};return Sd(n)}function Qd(){var t=Zd(Cd());t.copy=function(){return Dd(t,Qd()).constant(t.constant())};return nh.apply(t,arguments)}function tp(t,e,n,i,r,a){const o=[[xe,1,yt],[xe,5,5*yt],[xe,15,15*yt],[xe,30,30*yt],[a,1,vt],[a,5,5*vt],[a,15,15*vt],[a,30,30*vt],[r,1,xt],[r,3,3*xt],[r,6,6*xt],[r,12,12*xt],[i,1,_t],[i,2,2*_t],[n,1,bt],[e,1,wt],[e,3,3*wt],[t,1,kt]];function u(t,e,n){const i=e<t;if(i)[t,e]=[e,t];const r=n&&typeof n.range==="function"?n:s(t,e,n);const a=r?r.range(t,+e+1):[];return i?a.reverse():a}function s(e,n,i){const r=Math.abs(n-e)/i;const a=Ue((([,,t])=>t)).right(o,r);if(a===o.length)return t.every(j(e/kt,n/kt,i));if(a===0)return we.every(Math.max(j(e,n,i),1));const[u,s]=o[r/o[a-1][2]<o[a][2]/r?a-1:a];return u.every(s)}return[u,s]}const[ep,np]=tp(Ae,Ce,Ht,jt,Te,ze);const[ip,rp]=tp(ue,fe,Ct,At,de,me);function ap(t){return new Date(t)}function op(t){return t instanceof Date?+t:+new Date(+t)}function up(t,e,n,i,r,a,o,u,s,l){var f=Fd(),c=f.invert,h=f.domain;var d=l(".%L"),p=l(":%S"),g=l("%I:%M"),m=l("%I %p"),y=l("%a %d"),v=l("%b %d"),x=l("%B"),_=l("%Y");function b(t){return(s(t)<t?d:u(t)<t?p:o(t)<t?g:a(t)<t?m:i(t)<t?r(t)<t?y:v:n(t)<t?x:_)(t)}f.invert=function(t){return new Date(c(t))};f.domain=function(t){return arguments.length?h(Array.from(t,op)):h().map(ap)};f.ticks=function(e){var n=h();return t(n[0],n[n.length-1],e==null?10:e)};f.tickFormat=function(t,e){return e==null?b:l(e)};f.nice=function(t){var n=h();if(!t||typeof t.range!=="function")t=e(n[0],n[n.length-1],t==null?10:t);return t?h(Nd(n,t)):f};f.copy=function(){return Dd(f,up(t,e,n,i,r,a,o,u,s,l))};return f}function sp(){return nh.apply(up(ip,rp,ue,fe,Ct,At,de,me,xe,_r).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function lp(){return nh.apply(up(ep,np,Ae,Ce,Ht,jt,Te,ze,xe,wr).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function fp(){var t=0,e=1,n,i,r,a,o=wd,u=false,s;function l(t){return t==null||isNaN(t=+t)?s:o(r===0?.5:(t=(a(t)-n)*r,u?Math.max(0,Math.min(1,t)):t))}l.domain=function(o){return arguments.length?([t,e]=o,n=a(t=+t),i=a(e=+e),r=n===i?0:1/(i-n),l):[t,e]};l.clamp=function(t){return arguments.length?(u=!!t,l):u};l.interpolator=function(t){return arguments.length?(o=t,l):o};function f(t){return function(e){var n,i;return arguments.length?([n,i]=e,o=t(n,i),l):[o(0),o(1)]}}l.range=f(yd);l.rangeRound=f(vd);l.unknown=function(t){return arguments.length?(s=t,l):s};return function(o){a=o,n=o(t),i=o(e),r=n===i?0:1/(i-n);return l}}function cp(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function hp(){var t=Sd(fp()(wd));t.copy=function(){return cp(t,hp())};return ih.apply(t,arguments)}function dp(){var t=Ld(fp()).domain([1,10]);t.copy=function(){return cp(t,dp()).base(t.base())};return ih.apply(t,arguments)}function pp(){var t=Zd(fp());t.copy=function(){return cp(t,pp()).constant(t.constant())};return ih.apply(t,arguments)}function gp(){var t=Yd(fp());t.copy=function(){return cp(t,gp()).exponent(t.exponent())};return ih.apply(t,arguments)}function mp(){return gp.apply(null,arguments).exponent(.5)}function yp(t,e){if(e===undefined)e=t,t=yd;var n=0,i=e.length-1,r=e[0],a=new Array(i<0?0:i);while(n<i)a[n]=t(r,r=e[++n]);return function(t){var e=Math.max(0,Math.min(i-1,Math.floor(t*=i)));return a[e](t-e)}}function vp(){var t=0,e=.5,n=1,i=1,r,a,o,u,s,l=wd,f,c=false,h;function d(t){return isNaN(t=+t)?h:(t=.5+((t=+f(t))-a)*(i*t<i*a?u:s),l(c?Math.max(0,Math.min(1,t)):t))}d.domain=function(l){return arguments.length?([t,e,n]=l,r=f(t=+t),a=f(e=+e),o=f(n=+n),u=r===a?0:.5/(a-r),s=a===o?0:.5/(o-a),i=a<r?-1:1,d):[t,e,n]};d.clamp=function(t){return arguments.length?(c=!!t,d):c};d.interpolator=function(t){return arguments.length?(l=t,d):l};function p(t){return function(e){var n,i,r;return arguments.length?([n,i,r]=e,l=yp(t,[n,i,r]),d):[l(0),l(.5),l(1)]}}d.range=p(yd);d.rangeRound=p(vd);d.unknown=function(t){return arguments.length?(h=t,d):h};return function(l){f=l,r=l(t),a=l(e),o=l(n),u=r===a?0:.5/(a-r),s=a===o?0:.5/(o-a),i=a<r?-1:1;return d}}function xp(){var t=Sd(vp()(wd));t.copy=function(){return cp(t,xp())};return ih.apply(t,arguments)}function _p(){var t=Ld(vp()).domain([.1,1,10]);t.copy=function(){return cp(t,_p()).base(t.base())};return ih.apply(t,arguments)}function bp(){var t=Zd(vp());t.copy=function(){return cp(t,bp()).constant(t.constant())};return ih.apply(t,arguments)}function wp(){var t=Yd(vp());t.copy=function(){return cp(t,wp()).exponent(t.exponent())};return ih.apply(t,arguments)}function kp(){return wp.apply(null,arguments).exponent(.5)}function Mp(){var t=[],e=[],n=[],i;function r(){var i=0,r=Math.max(1,e.length);n=new Array(r-1);while(++i<r)n[i-1]=eu(t,i/r);return a}function a(t){return t==null||isNaN(t=+t)?i:e[eh(n,t)]}a.invertExtent=function(i){var r=e.indexOf(i);return r<0?[NaN,NaN]:[r>0?n[r-1]:t[0],r<n.length?n[r]:t[t.length-1]]};a.domain=function(e){if(!arguments.length)return t.slice();t=[];for(let n of e)if(n!=null&&!isNaN(n=+n))t.push(n);t.sort(Re);return r()};a.range=function(t){return arguments.length?(e=Array.from(t),r()):e.slice()};a.unknown=function(t){return arguments.length?(i=t,a):i};a.quantiles=function(){return n.slice()};a.copy=function(){return Mp().domain(t).range(e).unknown(i)};return nh.apply(a,arguments)}function Ap(){var t=0,e=1,n=1,i=[.5],r=[0,1],a;function o(t){return t!=null&&t<=t?r[eh(i,t,0,n)]:a}function u(){var r=-1;i=new Array(n);while(++r<n)i[r]=((r+1)*e-(r-n)*t)/(n+1);return o}o.domain=function(n){return arguments.length?([t,e]=n,t=+t,e=+e,u()):[t,e]};o.range=function(t){return arguments.length?(n=(r=Array.from(t)).length-1,u()):r.slice()};o.invertExtent=function(a){var o=r.indexOf(a);return o<0?[NaN,NaN]:o<1?[t,i[0]]:o>=n?[i[n-1],e]:[i[o-1],i[o]]};o.unknown=function(t){return arguments.length?(a=t,o):o};o.thresholds=function(){return i.slice()};o.copy=function(){return Ap().domain([t,e]).range(r).unknown(a)};return nh.apply(Sd(o),arguments)}function Ep(){var t=[.5],e=[0,1],n,i=1;function r(r){return r!=null&&r<=r?e[eh(t,r,0,i)]:n}r.domain=function(n){return arguments.length?(t=Array.from(n),i=Math.min(t.length,e.length-1),r):t.slice()};r.range=function(n){return arguments.length?(e=Array.from(n),i=Math.min(t.length,e.length-1),r):e.slice()};r.invertExtent=function(n){var i=e.indexOf(n);return[t[i-1],t[i]]};r.unknown=function(t){return arguments.length?(n=t,r):n};r.copy=function(){return Ep().domain(t).range(e).unknown(n)};return nh.apply(r,arguments)}function Dp(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}}function Cp(t,e){var n=Zh(+t,+e);return function(t){var e=n(t);return e-360*Math.floor(e/360)}}var Fp=180/Math.PI;var Sp={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Tp(t,e,n,i,r,a){var o,u,s;if(o=Math.sqrt(t*t+e*e))t/=o,e/=o;if(s=t*n+e*i)n-=t*s,i-=e*s;if(u=Math.sqrt(n*n+i*i))n/=u,i/=u,s/=u;if(t*i<e*n)t=-t,e=-e,s=-s,o=-o;return{translateX:r,translateY:a,rotate:Math.atan2(e,t)*Fp,skewX:Math.atan(s)*Fp,scaleX:o,scaleY:u}}var Bp;function Np(t){const e=new(typeof DOMMatrix==="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?Sp:Tp(e.a,e.b,e.c,e.d,e.e,e.f)}function zp(t){if(t==null)return Sp;if(!Bp)Bp=document.createElementNS("http://www.w3.org/2000/svg","g");Bp.setAttribute("transform",t);if(!(t=Bp.transform.baseVal.consolidate()))return Sp;t=t.matrix;return Tp(t.a,t.b,t.c,t.d,t.e,t.f)}function Op(t,e,n,i){function r(t){return t.length?t.pop()+" ":""}function a(t,i,r,a,o,u){if(t!==r||i!==a){var s=o.push("translate(",null,e,null,n);u.push({i:s-4,x:fd(t,r)},{i:s-2,x:fd(i,a)})}else if(r||a){o.push("translate("+r+e+a+n)}}function o(t,e,n,a){if(t!==e){if(t-e>180)e+=360;else if(e-t>180)t+=360;a.push({i:n.push(r(n)+"rotate(",null,i)-2,x:fd(t,e)})}else if(e){n.push(r(n)+"rotate("+e+i)}}function u(t,e,n,a){if(t!==e){a.push({i:n.push(r(n)+"skewX(",null,i)-2,x:fd(t,e)})}else if(e){n.push(r(n)+"skewX("+e+i)}}function s(t,e,n,i,a,o){if(t!==n||e!==i){var u=a.push(r(a)+"scale(",null,",",null,")");o.push({i:u-4,x:fd(t,n)},{i:u-2,x:fd(e,i)})}else if(n!==1||i!==1){a.push(r(a)+"scale("+n+","+i+")")}}return function(e,n){var i=[],r=[];e=t(e),n=t(n);a(e.translateX,e.translateY,n.translateX,n.translateY,i,r);o(e.rotate,n.rotate,i,r);u(e.skewX,n.skewX,i,r);s(e.scaleX,e.scaleY,n.scaleX,n.scaleY,i,r);e=n=null;return function(t){var e=-1,n=r.length,a;while(++e<n)i[(a=r[e]).i]=a.x(t);return i.join("")}}}var Rp=Op(Np,"px, ","px)","deg)");var Up=Op(zp,", ",")",")");var $p=1e-12;function Pp(t){return((t=Math.exp(t))+1/t)/2}function qp(t){return((t=Math.exp(t))-1/t)/2}function Ip(t){return((t=Math.exp(2*t))-1)/(t+1)}const Lp=function t(e,n,i){function r(t,r){var a=t[0],o=t[1],u=t[2],s=r[0],l=r[1],f=r[2],c=s-a,h=l-o,d=c*c+h*h,p,g;if(d<$p){g=Math.log(f/u)/e;p=function(t){return[a+t*c,o+t*h,u*Math.exp(e*t*g)]}}else{var m=Math.sqrt(d),y=(f*f-u*u+i*d)/(2*u*n*m),v=(f*f-u*u-i*d)/(2*f*n*m),x=Math.log(Math.sqrt(y*y+1)-y),_=Math.log(Math.sqrt(v*v+1)-v);g=(_-x)/e;p=function(t){var i=t*g,r=Pp(x),s=u/(n*m)*(r*Ip(e*i+x)-qp(x));return[a+s*c,o+s*h,u*r/Pp(e*i+x)]}}p.duration=g*1e3*e/Math.SQRT2;return p}r.rho=function(e){var n=Math.max(.001,+e),i=n*n,r=i*i;return t(n,i,r)};return r}(Math.SQRT2,2,4);function jp(t){return function(e,n){var i=t((e=jh(e)).h,(n=jh(n)).h),r=td(e.s,n.s),a=td(e.l,n.l),o=td(e.opacity,n.opacity);return function(t){e.h=i(t);e.s=r(t);e.l=a(t);e.opacity=o(t);return e+""}}}const Wp=jp(Zh);var Xp=jp(td);const Hp=Math.PI/180;const Yp=180/Math.PI;const Jp=18,Vp=.96422,Gp=1,Kp=.82521,Zp=4/29,Qp=6/29,tg=3*Qp*Qp,eg=Qp*Qp*Qp;function ng(t){if(t instanceof ag)return new ag(t.l,t.a,t.b,t.opacity);if(t instanceof dg)return pg(t);if(!(t instanceof Uh))t=Oh(t);var e=lg(t.r),n=lg(t.g),i=lg(t.b),r=og((.2225045*e+.7168786*n+.0606169*i)/Gp),a,o;if(e===n&&n===i)a=o=r;else{a=og((.4360747*e+.3850649*n+.1430804*i)/Vp);o=og((.0139322*e+.0971045*n+.7141733*i)/Kp)}return new ag(116*r-16,500*(a-r),200*(r-o),t.opacity)}function ig(t,e){return new ag(t,0,0,e==null?1:e)}function rg(t,e,n,i){return arguments.length===1?ng(t):new ag(t,e,n,i==null?1:i)}function ag(t,e,n,i){this.l=+t;this.a=+e;this.b=+n;this.opacity=+i}dh(ag,rg,ph(gh,{brighter:function(t){return new ag(this.l+Jp*(t==null?1:t),this.a,this.b,this.opacity)},darker:function(t){return new ag(this.l-Jp*(t==null?1:t),this.a,this.b,this.opacity)},rgb:function(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;e=Vp*ug(e);t=Gp*ug(t);n=Kp*ug(n);return new Uh(sg(3.1338561*e-1.6168667*t-.4906146*n),sg(-.9787684*e+1.9161415*t+.033454*n),sg(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}}));function og(t){return t>eg?Math.pow(t,1/3):t/tg+Zp}function ug(t){return t>Qp?t*t*t:tg*(t-Zp)}function sg(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function lg(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function fg(t){if(t instanceof dg)return new dg(t.h,t.c,t.l,t.opacity);if(!(t instanceof ag))t=ng(t);if(t.a===0&&t.b===0)return new dg(NaN,0<t.l&&t.l<100?0:NaN,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*Yp;return new dg(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function cg(t,e,n,i){return arguments.length===1?fg(t):new dg(n,e,t,i==null?1:i)}function hg(t,e,n,i){return arguments.length===1?fg(t):new dg(t,e,n,i==null?1:i)}function dg(t,e,n,i){this.h=+t;this.c=+e;this.l=+n;this.opacity=+i}function pg(t){if(isNaN(t.h))return new ag(t.l,0,0,t.opacity);var e=t.h*Hp;return new ag(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}dh(dg,hg,ph(gh,{brighter:function(t){return new dg(this.h,this.c,this.l+Jp*(t==null?1:t),this.opacity)},darker:function(t){return new dg(this.h,this.c,this.l-Jp*(t==null?1:t),this.opacity)},rgb:function(){return pg(this).rgb()}}));function gg(t,e){var n=td((t=rg(t)).l,(e=rg(e)).l),i=td(t.a,e.a),r=td(t.b,e.b),a=td(t.opacity,e.opacity);return function(e){t.l=n(e);t.a=i(e);t.b=r(e);t.opacity=a(e);return t+""}}function mg(t){return function(e,n){var i=t((e=hg(e)).h,(n=hg(n)).h),r=td(e.c,n.c),a=td(e.l,n.l),o=td(e.opacity,n.opacity);return function(t){e.h=i(t);e.c=r(t);e.l=a(t);e.opacity=o(t);return e+""}}}const yg=mg(Zh);var vg=mg(td);var xg=-.14861,_g=+1.78277,bg=-.29227,wg=-.90649,kg=+1.97294,Mg=kg*wg,Ag=kg*_g,Eg=_g*bg-wg*xg;function Dg(t){if(t instanceof Fg)return new Fg(t.h,t.s,t.l,t.opacity);if(!(t instanceof Uh))t=Oh(t);var e=t.r/255,n=t.g/255,i=t.b/255,r=(Eg*i+Mg*e-Ag*n)/(Eg+Mg-Ag),a=i-r,o=(kg*(n-r)-bg*a)/wg,u=Math.sqrt(o*o+a*a)/(kg*r*(1-r)),s=u?Math.atan2(o,a)*Yp-120:NaN;return new Fg(s<0?s+360:s,u,r,t.opacity)}function Cg(t,e,n,i){return arguments.length===1?Dg(t):new Fg(t,e,n,i==null?1:i)}function Fg(t,e,n,i){this.h=+t;this.s=+e;this.l=+n;this.opacity=+i}dh(Fg,Cg,ph(gh,{brighter:function(t){t=t==null?yh:Math.pow(yh,t);return new Fg(this.h,this.s,this.l*t,this.opacity)},darker:function(t){t=t==null?mh:Math.pow(mh,t);return new Fg(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=isNaN(this.h)?0:(this.h+120)*Hp,e=+this.l,n=isNaN(this.s)?0:this.s*e*(1-e),i=Math.cos(t),r=Math.sin(t);return new Uh(255*(e+n*(xg*i+_g*r)),255*(e+n*(bg*i+wg*r)),255*(e+n*(kg*i)),this.opacity)}}));function Sg(t){return function e(n){n=+n;function i(e,i){var r=t((e=Cg(e)).h,(i=Cg(i)).h),a=td(e.s,i.s),o=td(e.l,i.l),u=td(e.opacity,i.opacity);return function(t){e.h=r(t);e.s=a(t);e.l=o(Math.pow(t,n));e.opacity=u(t);return e+""}}i.gamma=e;return i}(1)}const Tg=Sg(Zh);var Bg=Sg(td);function Ng(t,e){var n=new Array(e);for(var i=0;i<e;++i)n[i]=t(i/(e-1));return n}function zg(t,e,n){const i=t-e+n*2;return t?i>0?i:1:0}const Og="identity";const Rg="linear";const Ug="log";const $g="pow";const Pg="sqrt";const qg="symlog";const Ig="time";const Lg="utc";const jg="sequential";const Wg="diverging";const Xg="quantile";const Hg="quantize";const Yg="threshold";const Jg="ordinal";const Vg="point";const Gg="band";const Kg="bin-ordinal";const Zg="continuous";const Qg="discrete";const tm="discretizing";const em="interpolating";const nm="temporal";function im(t){return function(e){let n=e[0],i=e[1],r;if(i<n){r=n;n=i;i=r}return[t.invert(n),t.invert(i)]}}function rm(t){return function(e){const n=t.range();let i=e[0],r=e[1],a=-1,o,u,s,l;if(r<i){u=i;i=r;r=u}for(s=0,l=n.length;s<l;++s){if(n[s]>=i&&n[s]<=r){if(a<0)a=s;o=s}}if(a<0)return undefined;i=t.invertExtent(n[a]);r=t.invertExtent(n[o]);return[i[0]===undefined?i[1]:i[0],r[1]===undefined?r[0]:r[1]]}}function am(){const t=ah().unknown(undefined),e=t.domain,n=t.range;let i=[0,1],r,a,o=false,u=0,s=0,l=.5;delete t.unknown;function f(){const t=e().length,f=i[1]<i[0],c=i[1-f],h=zg(t,u,s);let d=i[f-0];r=(c-d)/(h||1);if(o){r=Math.floor(r)}d+=(c-d-r*(t-u))*l;a=r*(1-u);if(o){d=Math.round(d);a=Math.round(a)}const p=us(t).map((t=>d+r*t));return n(f?p.reverse():p)}t.domain=function(t){if(arguments.length){e(t);return f()}else{return e()}};t.range=function(t){if(arguments.length){i=[+t[0],+t[1]];return f()}else{return i.slice()}};t.rangeRound=function(t){i=[+t[0],+t[1]];o=true;return f()};t.bandwidth=function(){return a};t.step=function(){return r};t.round=function(t){if(arguments.length){o=!!t;return f()}else{return o}};t.padding=function(t){if(arguments.length){s=Math.max(0,Math.min(1,t));u=s;return f()}else{return u}};t.paddingInner=function(t){if(arguments.length){u=Math.max(0,Math.min(1,t));return f()}else{return u}};t.paddingOuter=function(t){if(arguments.length){s=Math.max(0,Math.min(1,t));return f()}else{return s}};t.align=function(t){if(arguments.length){l=Math.max(0,Math.min(1,t));return f()}else{return l}};t.invertRange=function(t){if(t[0]==null||t[1]==null)return;const r=i[1]<i[0],o=r?n().reverse():n(),u=o.length-1;let s=+t[0],l=+t[1],f,c,h;if(s!==s||l!==l)return;if(l<s){h=s;s=l;l=h}if(l<o[0]||s>i[1-r])return;f=Math.max(0,Zc(o,s)-1);c=s===l?f:Zc(o,l)-1;if(s-o[f]>a+1e-10)++f;if(r){h=f;f=u-c;c=u-h}return f>c?undefined:e().slice(f,c+1)};t.invert=function(e){const n=t.invertRange([e,e]);return n?n[0]:n};t.copy=function(){return am().domain(e()).range(i).round(o).paddingInner(u).paddingOuter(s).align(l)};return f()}function om(t){const e=t.copy;t.padding=t.paddingOuter;delete t.paddingInner;t.copy=function(){return om(e())};return t}function um(){return om(am().paddingInner(1))}var sm=Array.prototype.map;function lm(t){return sm.call(t,g.He)}const fm=Array.prototype.slice;function cm(){let t=[],e=[];function n(n){return n==null||n!==n?undefined:e[(eh(t,n)-1)%e.length]}n.domain=function(e){if(arguments.length){t=lm(e);return n}else{return t.slice()}};n.range=function(t){if(arguments.length){e=fm.call(t);return n}else{return e.slice()}};n.tickFormat=function(e,n){return hh(t[0],(0,g.fj)(t),e==null?10:e,n)};n.copy=function(){return cm().domain(n.domain()).range(n.range())};return n}const hm={};function dm(t,e,n){const i=function n(){const i=e();if(!i.invertRange){i.invertRange=i.invert?im(i):i.invertExtent?rm(i):undefined}i.type=t;return i};i.metadata=(0,g.Rg)((0,g.IX)(n));return i}function pm(t,e,n){if(arguments.length>1){hm[t]=dm(t,e,n);return this}else{return gm(t)?hm[t]:undefined}}pm(Og,Bd);pm(Rg,Td,Zg);pm(Ug,jd,[Zg,Ug]);pm($g,Jd,Zg);pm(Pg,Vd,Zg);pm(qg,Qd,Zg);pm(Ig,sp,[Zg,nm]);pm(Lg,lp,[Zg,nm]);pm(jg,hp,[Zg,em]);pm("".concat(jg,"-").concat(Rg),hp,[Zg,em]);pm("".concat(jg,"-").concat(Ug),dp,[Zg,em,Ug]);pm("".concat(jg,"-").concat($g),gp,[Zg,em]);pm("".concat(jg,"-").concat(Pg),mp,[Zg,em]);pm("".concat(jg,"-").concat(qg),pp,[Zg,em]);pm("".concat(Wg,"-").concat(Rg),xp,[Zg,em]);pm("".concat(Wg,"-").concat(Ug),_p,[Zg,em,Ug]);pm("".concat(Wg,"-").concat($g),wp,[Zg,em]);pm("".concat(Wg,"-").concat(Pg),kp,[Zg,em]);pm("".concat(Wg,"-").concat(qg),bp,[Zg,em]);pm(Xg,Mp,[tm,Xg]);pm(Hg,Ap,tm);pm(Yg,Ep,tm);pm(Kg,cm,[Qg,tm]);pm(Jg,ah,Qg);pm(Gg,am,Qg);pm(Vg,um,Qg);function gm(t){return(0,g.nr)(hm,t)}function mm(t,e){const n=hm[t];return n&&n.metadata[e]}function ym(t){return mm(t,Zg)}function vm(t){return mm(t,Qg)}function xm(t){return mm(t,tm)}function _m(t){return mm(t,Ug)}function bm(t){return mm(t,nm)}function wm(t){return mm(t,em)}function km(t){return mm(t,Xg)}const Mm=["clamp","base","constant","exponent"];function Am(t,e){const n=e[0],i=(0,g.fj)(e)-n;return function(e){return t(n+e*i)}}function Em(t,e,n){return yp(Sm(e||"rgb",n),t)}function Dm(t,e){const n=new Array(e),i=e+1;for(let r=0;r<e;)n[r]=t(++r/i);return n}function Cm(t){const e=t.type,n=t.copy();n.type=e;return n}function Fm(t,e,n){const i=n-e;let r,a,o;if(!i||!Number.isFinite(i)){return(0,g.a9)(.5)}else{r=(a=t.type).indexOf("-");a=r<0?a:a.slice(r+1);o=pm(a)().domain([e,n]).range([0,1]);Mm.forEach((e=>t[e]?o[e](t[e]()):0));return o}}function Sm(t,e){const n=r[Tm(t)];return e!=null&&n&&n.gamma?n.gamma(e):n}function Tm(t){return"interpolate"+t.toLowerCase().split("-").map((t=>t[0].toUpperCase()+t.slice(1))).join("")}const Bm={blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"};const Nm={category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"};function zm(t){const e=t.length/6|0,n=new Array(e);for(let i=0;i<e;){n[i]="#"+t.slice(i*6,++i*6)}return n}function Om(t,e){for(const n in t)Um(n,e(t[n]))}const Rm={};Om(Nm,zm);Om(Bm,(t=>Em(zm(t))));function Um(t,e){t=t&&t.toLowerCase();if(arguments.length>1){Rm[t]=e;return this}else{return Rm[t]}}const $m="symbol";const Pm="discrete";const qm="gradient";const Im=t=>(0,g.kJ)(t)?t.map((t=>String(t))):String(t);const Lm=(t,e)=>t[1]-e[1];const jm=(t,e)=>e[1]-t[1];function Wm(t,e,n){let i;if((0,g.hj)(e)){if(t.bins){e=Math.max(e,t.bins.length)}if(n!=null){e=Math.min(e,Math.floor((0,g.yP)(t.domain())/n||1))}}if((0,g.Kn)(e)){i=e.step;e=e.interval}if((0,g.HD)(e)){e=t.type===Ig?Dn(e):t.type==Lg?Cn(e):(0,g.vU)("Only time and utc scales accept interval strings.");if(i)e=e.every(i)}return e}function Xm(t,e,n){let i=t.range(),r=i[0],a=(0,g.fj)(i),o=Lm;if(r>a){i=a;a=r;r=i;o=jm}r=Math.floor(r);a=Math.ceil(a);e=e.map((e=>[e,t(e)])).filter((t=>r<=t[1]&&t[1]<=a)).sort(o).map((t=>t[0]));if(n>0&&e.length>1){const t=[e[0],(0,g.fj)(e)];while(e.length>n&&e.length>=3){e=e.filter(((t,e)=>!(e%2)))}if(e.length<3){e=t}}return e}function Hm(t,e){return t.bins?Xm(t,t.bins):t.ticks?t.ticks(e):t.domain()}function Ym(t,e,n,i,r,a){const o=e.type;let u=Im;if(o===Ig||r===Ig){u=t.timeFormat(i)}else if(o===Lg||r===Lg){u=t.utcFormat(i)}else if(_m(o)){const r=t.formatFloat(i);if(a||e.bins){u=r}else{const t=Jm(e,n,false);u=e=>t(e)?r(e):""}}else if(e.tickFormat){const r=e.domain();u=t.formatSpan(r[0],r[r.length-1],n,i)}else if(i){u=t.format(i)}return u}function Jm(t,e,n){const i=Hm(t,e),r=t.base(),a=Math.log(r),o=Math.max(1,r*e/i.length);const u=t=>{let e=t/Math.pow(r,Math.round(Math.log(t)/a));if(e*r<r-.5)e*=r;return e<=o};return n?i.filter(u):u}const Vm={[Xg]:"quantiles",[Hg]:"thresholds",[Yg]:"domain"};const Gm={[Xg]:"quantiles",[Hg]:"domain"};function Km(t,e){return t.bins?ty(t.bins):t.type===Ug?Jm(t,e,true):Vm[t.type]?Qm(t[Vm[t.type]]()):Hm(t,e)}function Zm(t,e,n){const i=e[Gm[e.type]](),r=i.length;let a=r>1?i[1]-i[0]:i[0],o;for(o=1;o<r;++o){a=Math.min(a,i[o]-i[o-1])}return t.formatSpan(0,a,3*10,n)}function Qm(t){const e=[-Infinity].concat(t);e.max=+Infinity;return e}function ty(t){const e=t.slice(0,-1);e.max=(0,g.fj)(t);return e}const ey=t=>Vm[t.type]||t.bins;function ny(t,e,n,i,r,a,o){const u=Gm[e.type]&&a!==Ig&&a!==Lg?Zm(t,e,r):Ym(t,e,n,r,a,o);return i===$m&&ey(e)?iy(u):i===Pm?ay(u):oy(u)}const iy=t=>(e,n,i)=>{const r=ry(i[n+1],ry(i.max,+Infinity)),a=uy(e,t),o=uy(r,t);return a&&o?a+" – "+o:o?"< "+o:"≥ "+a};const ry=(t,e)=>t!=null?t:e;const ay=t=>(e,n)=>n?t(e):null;const oy=t=>e=>t(e);const uy=(t,e)=>Number.isFinite(t)?e(t):null;function sy(t){const e=t.domain(),n=e.length-1;let i=+e[0],r=+(0,g.fj)(e),a=r-i;if(t.type===Yg){const t=n?a/n:.1;i-=t;r+=t;a=r-i}return t=>(t-i)/a}function ly(t,e,n,i){const r=i||e.type;if((0,g.HD)(n)&&bm(r)){n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")}return!n&&r===Ig?t.timeFormat("%A, %d %B %Y, %X"):!n&&r===Lg?t.utcFormat("%A, %d %B %Y, %X UTC"):ny(t,e,5,null,n,i,true)}function fy(t,e,n){n=n||{};const i=Math.max(3,n.maxlen||7),r=ly(t,e,n.format,n.formatType);if(xm(e.type)){const t=Km(e).slice(1).map(r),n=t.length;return"".concat(n," boundar").concat(n===1?"y":"ies",": ").concat(t.join(", "))}else if(vm(e.type)){const t=e.domain(),n=t.length,a=n>i?t.slice(0,i-2).map(r).join(", ")+", ending with "+t.slice(-1).map(r):t.map(r).join(", ");return"".concat(n," value").concat(n===1?"":"s",": ").concat(a)}else{const t=e.domain();return"values from ".concat(r(t[0])," to ").concat(r((0,g.fj)(t)))}}let cy=0;function hy(){cy=0}const dy="p_";function py(t){return t&&t.gradient}function gy(t,e,n){const i=t.gradient;let r=t.id,a=i==="radial"?dy:"";if(!r){r=t.id="gradient_"+cy++;if(i==="radial"){t.x1=my(t.x1,.5);t.y1=my(t.y1,.5);t.r1=my(t.r1,0);t.x2=my(t.x2,.5);t.y2=my(t.y2,.5);t.r2=my(t.r2,.5);a=dy}else{t.x1=my(t.x1,0);t.y1=my(t.y1,0);t.x2=my(t.x2,1);t.y2=my(t.y2,0)}}e[r]=t;return"url("+(n||"")+"#"+a+r+")"}function my(t,e){return t!=null?t:e}function yy(t,e){var n=[],i;return i={gradient:"linear",x1:t?t[0]:0,y1:t?t[1]:0,x2:e?e[0]:1,y2:e?e[1]:0,stops:n,stop:function(t,e){n.push({offset:t,color:e});return i}}}const vy={basis:{curve:of},"basis-closed":{curve:lf},"basis-open":{curve:cf},bundle:{curve:df,tension:"beta",value:.85},cardinal:{curve:mf,tension:"tension",value:0},"cardinal-open":{curve:vf,tension:"tension",value:0},"cardinal-closed":{curve:_f,tension:"tension",value:0},"catmull-rom":{curve:Rf,tension:"alpha",value:.5},"catmull-rom-closed":{curve:$f,tension:"alpha",value:.5},"catmull-rom-open":{curve:qf,tension:"alpha",value:.5},linear:{curve:Lf},"linear-closed":{curve:Wf},monotone:{horizontal:Qf,vertical:Zf},natural:{curve:nc},step:{curve:rc},"step-after":{curve:oc},"step-before":{curve:ac}};function xy(t,e,n){var i=(0,g.nr)(vy,t)&&vy[t],r=null;if(i){r=i.curve||i[e||"vertical"];if(i.tension&&n!=null){r=r[i.tension](n)}}return r}const _y={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},by=[/([MLHVCSQTAZmlhvcsqtaz])/g,/###/,/(\.\d+)(\.\d)/g,/(\d)([-+])/g,/\s|,|###/];function wy(t){const e=[];let n,i,r,a,o,u,s,l,f,c;const h=t.slice().replace(by[0],"###$1").split(by[1]).slice(1);for(s=0,f=h.length;s<f;++s){n=h[s];i=n.slice(1).trim().replace(by[2],"$1###$2").replace(by[3],"$1###$2").split(by[4]);o=n.charAt(0);r=[o];for(l=0,c=i.length;l<c;++l){if((a=+i[l])===a){r.push(a)}}u=_y[o.toLowerCase()];if(r.length-1>u){const t=r.length;l=1;e.push([o].concat(r.slice(l,l+=u)));o=o==="M"?"L":o==="m"?"l":o;for(;l<t;l+=u){e.push([o].concat(r.slice(l,l+u)))}}else{e.push(r)}}return e}const ky=Math.PI/180;const My=1e-14;const Ay=Math.PI/2;const Ey=Math.PI*2;const Dy=Math.sqrt(3)/2;var Cy={};var Fy={};var Sy=[].join;function Ty(t,e,n,i,r,a,o,u,s){const l=Sy.call(arguments);if(Cy[l]){return Cy[l]}const f=o*ky;const c=Math.sin(f);const h=Math.cos(f);n=Math.abs(n);i=Math.abs(i);const d=h*(u-t)*.5+c*(s-e)*.5;const p=h*(s-e)*.5-c*(u-t)*.5;let g=d*d/(n*n)+p*p/(i*i);if(g>1){g=Math.sqrt(g);n*=g;i*=g}const m=h/n;const y=c/n;const v=-c/i;const x=h/i;const _=m*u+y*s;const b=v*u+x*s;const w=m*t+y*e;const k=v*t+x*e;const M=(w-_)*(w-_)+(k-b)*(k-b);let A=1/M-.25;if(A<0)A=0;let E=Math.sqrt(A);if(a==r)E=-E;const D=.5*(_+w)-E*(k-b);const C=.5*(b+k)+E*(w-_);const F=Math.atan2(b-C,_-D);const S=Math.atan2(k-C,w-D);let T=S-F;if(T<0&&a===1){T+=Ey}else if(T>0&&a===0){T-=Ey}const B=Math.ceil(Math.abs(T/(Ay+.001)));const N=[];for(let z=0;z<B;++z){const t=F+z*T/B;const e=F+(z+1)*T/B;N[z]=[D,C,t,e,n,i,c,h]}return Cy[l]=N}function By(t){const e=Sy.call(t);if(Fy[e]){return Fy[e]}var n=t[0],i=t[1],r=t[2],a=t[3],o=t[4],u=t[5],s=t[6],l=t[7];const f=l*o;const c=-s*u;const h=s*o;const d=l*u;const p=Math.cos(r);const g=Math.sin(r);const m=Math.cos(a);const y=Math.sin(a);const v=.5*(a-r);const x=Math.sin(v*.5);const _=8/3*x*x/Math.sin(v);const b=n+p-_*g;const w=i+g+_*p;const k=n+m;const M=i+y;const A=k+_*y;const E=M-_*m;return Fy[e]=[f*b+c*w,h*b+d*w,f*A+c*E,h*A+d*E,f*k+c*M,h*k+d*M]}const Ny=["l",0,0,0,0,0,0,0];function zy(t,e,n){const i=Ny[0]=t[0];if(i==="a"||i==="A"){Ny[1]=e*t[1];Ny[2]=n*t[2];Ny[3]=t[3];Ny[4]=t[4];Ny[5]=t[5];Ny[6]=e*t[6];Ny[7]=n*t[7]}else if(i==="h"||i==="H"){Ny[1]=e*t[1]}else if(i==="v"||i==="V"){Ny[1]=n*t[1]}else{for(var r=1,a=t.length;r<a;++r){Ny[r]=(r%2==1?e:n)*t[r]}}return Ny}function Oy(t,e,n,i,r,a){var o,u=null,s=0,l=0,f=0,c=0,h,d,p,g;if(n==null)n=0;if(i==null)i=0;if(r==null)r=1;if(a==null)a=r;if(t.beginPath)t.beginPath();for(var m=0,y=e.length;m<y;++m){o=e[m];if(r!==1||a!==1){o=zy(o,r,a)}switch(o[0]){case"l":s+=o[1];l+=o[2];t.lineTo(s+n,l+i);break;case"L":s=o[1];l=o[2];t.lineTo(s+n,l+i);break;case"h":s+=o[1];t.lineTo(s+n,l+i);break;case"H":s=o[1];t.lineTo(s+n,l+i);break;case"v":l+=o[1];t.lineTo(s+n,l+i);break;case"V":l=o[1];t.lineTo(s+n,l+i);break;case"m":s+=o[1];l+=o[2];t.moveTo(s+n,l+i);break;case"M":s=o[1];l=o[2];t.moveTo(s+n,l+i);break;case"c":h=s+o[5];d=l+o[6];f=s+o[3];c=l+o[4];t.bezierCurveTo(s+o[1]+n,l+o[2]+i,f+n,c+i,h+n,d+i);s=h;l=d;break;case"C":s=o[5];l=o[6];f=o[3];c=o[4];t.bezierCurveTo(o[1]+n,o[2]+i,f+n,c+i,s+n,l+i);break;case"s":h=s+o[3];d=l+o[4];f=2*s-f;c=2*l-c;t.bezierCurveTo(f+n,c+i,s+o[1]+n,l+o[2]+i,h+n,d+i);f=s+o[1];c=l+o[2];s=h;l=d;break;case"S":h=o[3];d=o[4];f=2*s-f;c=2*l-c;t.bezierCurveTo(f+n,c+i,o[1]+n,o[2]+i,h+n,d+i);s=h;l=d;f=o[1];c=o[2];break;case"q":h=s+o[3];d=l+o[4];f=s+o[1];c=l+o[2];t.quadraticCurveTo(f+n,c+i,h+n,d+i);s=h;l=d;break;case"Q":h=o[3];d=o[4];t.quadraticCurveTo(o[1]+n,o[2]+i,h+n,d+i);s=h;l=d;f=o[1];c=o[2];break;case"t":h=s+o[1];d=l+o[2];if(u[0].match(/[QqTt]/)===null){f=s;c=l}else if(u[0]==="t"){f=2*s-p;c=2*l-g}else if(u[0]==="q"){f=2*s-f;c=2*l-c}p=f;g=c;t.quadraticCurveTo(f+n,c+i,h+n,d+i);s=h;l=d;f=s+o[1];c=l+o[2];break;case"T":h=o[1];d=o[2];f=2*s-f;c=2*l-c;t.quadraticCurveTo(f+n,c+i,h+n,d+i);s=h;l=d;break;case"a":Ry(t,s+n,l+i,[o[1],o[2],o[3],o[4],o[5],o[6]+s+n,o[7]+l+i]);s+=o[6];l+=o[7];break;case"A":Ry(t,s+n,l+i,[o[1],o[2],o[3],o[4],o[5],o[6]+n,o[7]+i]);s=o[6];l=o[7];break;case"z":case"Z":t.closePath();break}u=o}}function Ry(t,e,n,i){const r=Ty(i[5],i[6],i[0],i[1],i[3],i[4],i[2],e,n);for(let a=0;a<r.length;++a){const e=By(r[a]);t.bezierCurveTo(e[0],e[1],e[2],e[3],e[4],e[5])}}const Uy=.5773502691896257;const $y={circle:{draw:function(t,e){const n=Math.sqrt(e)/2;t.moveTo(n,0);t.arc(0,0,n,0,Ey)}},cross:{draw:function(t,e){var n=Math.sqrt(e)/2,i=n/2.5;t.moveTo(-n,-i);t.lineTo(-n,i);t.lineTo(-i,i);t.lineTo(-i,n);t.lineTo(i,n);t.lineTo(i,i);t.lineTo(n,i);t.lineTo(n,-i);t.lineTo(i,-i);t.lineTo(i,-n);t.lineTo(-i,-n);t.lineTo(-i,-i);t.closePath()}},diamond:{draw:function(t,e){const n=Math.sqrt(e)/2;t.moveTo(-n,0);t.lineTo(0,-n);t.lineTo(n,0);t.lineTo(0,n);t.closePath()}},square:{draw:function(t,e){var n=Math.sqrt(e),i=-n/2;t.rect(i,i,n,n)}},arrow:{draw:function(t,e){var n=Math.sqrt(e)/2,i=n/7,r=n/2.5,a=n/8;t.moveTo(-i,n);t.lineTo(i,n);t.lineTo(i,-a);t.lineTo(r,-a);t.lineTo(0,-n);t.lineTo(-r,-a);t.lineTo(-i,-a);t.closePath()}},wedge:{draw:function(t,e){var n=Math.sqrt(e)/2,i=Dy*n,r=i-n*Uy,a=n/4;t.moveTo(0,-i-r);t.lineTo(-a,i-r);t.lineTo(a,i-r);t.closePath()}},triangle:{draw:function(t,e){var n=Math.sqrt(e)/2,i=Dy*n,r=i-n*Uy;t.moveTo(0,-i-r);t.lineTo(-n,i-r);t.lineTo(n,i-r);t.closePath()}},"triangle-up":{draw:function(t,e){var n=Math.sqrt(e)/2,i=Dy*n;t.moveTo(0,-i);t.lineTo(-n,i);t.lineTo(n,i);t.closePath()}},"triangle-down":{draw:function(t,e){var n=Math.sqrt(e)/2,i=Dy*n;t.moveTo(0,i);t.lineTo(-n,-i);t.lineTo(n,-i);t.closePath()}},"triangle-right":{draw:function(t,e){var n=Math.sqrt(e)/2,i=Dy*n;t.moveTo(i,0);t.lineTo(-i,-n);t.lineTo(-i,n);t.closePath()}},"triangle-left":{draw:function(t,e){var n=Math.sqrt(e)/2,i=Dy*n;t.moveTo(-i,0);t.lineTo(i,-n);t.lineTo(i,n);t.closePath()}},stroke:{draw:function(t,e){const n=Math.sqrt(e)/2;t.moveTo(-n,0);t.lineTo(n,0)}}};function Py(t){return(0,g.nr)($y,t)?$y[t]:Iy(t)}var qy={};function Iy(t){if(!(0,g.nr)(qy,t)){const e=wy(t);qy[t]={draw:function(t,n){Oy(t,e,0,0,Math.sqrt(n)/2)}}}return qy[t]}const Ly=.448084975506;function jy(t){return t.x}function Wy(t){return t.y}function Xy(t){return t.width}function Hy(t){return t.height}function Yy(t){return typeof t==="function"?t:()=>+t}function Jy(t,e,n){return Math.max(e,Math.min(t,n))}function Vy(){var t=jy,e=Wy,n=Xy,i=Hy,r=Yy(0),a=r,o=r,u=r,s=null;function l(l,f,c){var h,d=f!=null?f:+t.call(this,l),p=c!=null?c:+e.call(this,l),g=+n.call(this,l),m=+i.call(this,l),y=Math.min(g,m)/2,v=Jy(+r.call(this,l),0,y),x=Jy(+a.call(this,l),0,y),_=Jy(+o.call(this,l),0,y),b=Jy(+u.call(this,l),0,y);if(!s)s=h=dc();if(v<=0&&x<=0&&_<=0&&b<=0){s.rect(d,p,g,m)}else{var w=d+g,k=p+m;s.moveTo(d+v,p);s.lineTo(w-x,p);s.bezierCurveTo(w-Ly*x,p,w,p+Ly*x,w,p+x);s.lineTo(w,k-b);s.bezierCurveTo(w,k-Ly*b,w-Ly*b,k,w-b,k);s.lineTo(d+_,k);s.bezierCurveTo(d+Ly*_,k,d,k-Ly*_,d,k-_);s.lineTo(d,p+v);s.bezierCurveTo(d,p+Ly*v,d+Ly*v,p,d+v,p);s.closePath()}if(h){s=null;return h+""||null}}l.x=function(e){if(arguments.length){t=Yy(e);return l}else{return t}};l.y=function(t){if(arguments.length){e=Yy(t);return l}else{return e}};l.width=function(t){if(arguments.length){n=Yy(t);return l}else{return n}};l.height=function(t){if(arguments.length){i=Yy(t);return l}else{return i}};l.cornerRadius=function(t,e,n,i){if(arguments.length){r=Yy(t);a=e!=null?Yy(e):r;u=n!=null?Yy(n):r;o=i!=null?Yy(i):a;return l}else{return r}};l.context=function(t){if(arguments.length){s=t==null?null:t;return l}else{return s}};return l}function Gy(){var t,e,n,i,r=null,a,o,u,s;function l(t,e,n){const i=n/2;if(a){var l=u-e,f=t-o;if(l||f){var c=Math.sqrt(l*l+f*f),h=(l/=c)*s,d=(f/=c)*s,p=Math.atan2(f,l);r.moveTo(o-h,u-d);r.lineTo(t-l*i,e-f*i);r.arc(t,e,i,p-Math.PI,p);r.lineTo(o+h,u+d);r.arc(o,u,s,p,p+Math.PI)}else{r.arc(t,e,i,0,Ey)}r.closePath()}else{a=1}o=t;u=e;s=i}function f(o){var u,s=o.length,f,c=false,h;if(r==null)r=h=dc();for(u=0;u<=s;++u){if(!(u<s&&i(f=o[u],u,o))===c){if(c=!c)a=0}if(c)l(+t(f,u,o),+e(f,u,o),+n(f,u,o))}if(h){r=null;return h+""||null}}f.x=function(e){if(arguments.length){t=e;return f}else{return t}};f.y=function(t){if(arguments.length){e=t;return f}else{return e}};f.size=function(t){if(arguments.length){n=t;return f}else{return n}};f.defined=function(t){if(arguments.length){i=t;return f}else{return i}};f.context=function(t){if(arguments.length){if(t==null){r=null}else{r=t}return f}else{return r}};return f}function Ky(t,e){return t!=null?t:e}const Zy=t=>t.x||0,Qy=t=>t.y||0,tv=t=>t.width||0,ev=t=>t.height||0,nv=t=>(t.x||0)+(t.width||0),iv=t=>(t.y||0)+(t.height||0),rv=t=>t.startAngle||0,av=t=>t.endAngle||0,ov=t=>t.padAngle||0,uv=t=>t.innerRadius||0,sv=t=>t.outerRadius||0,lv=t=>t.cornerRadius||0,fv=t=>Ky(t.cornerRadiusTopLeft,t.cornerRadius)||0,cv=t=>Ky(t.cornerRadiusTopRight,t.cornerRadius)||0,hv=t=>Ky(t.cornerRadiusBottomRight,t.cornerRadius)||0,dv=t=>Ky(t.cornerRadiusBottomLeft,t.cornerRadius)||0,pv=t=>Ky(t.size,64),gv=t=>t.size||1,mv=t=>!(t.defined===false),yv=t=>Py(t.shape||"circle");const vv=wc().startAngle(rv).endAngle(av).padAngle(ov).innerRadius(uv).outerRadius(sv).cornerRadius(lv),xv=Cc().x(Zy).y1(Qy).y0(iv).defined(mv),_v=Cc().y(Qy).x1(Zy).x0(nv).defined(mv),bv=Dc().x(Zy).y(Qy).defined(mv),wv=Vy().x(Zy).y(Qy).width(tv).height(ev).cornerRadius(fv,cv,hv,dv),kv=Jc().type(yv).size(pv),Mv=Gy().x(Zy).y(Qy).defined(mv).size(gv);function Av(t){return t.cornerRadius||t.cornerRadiusTopLeft||t.cornerRadiusTopRight||t.cornerRadiusBottomRight||t.cornerRadiusBottomLeft}function Ev(t,e){return vv.context(t)(e)}function Dv(t,e){const n=e[0],i=n.interpolate||"linear";return(n.orient==="horizontal"?_v:xv).curve(xy(i,n.orient,n.tension)).context(t)(e)}function Cv(t,e){const n=e[0],i=n.interpolate||"linear";return bv.curve(xy(i,n.orient,n.tension)).context(t)(e)}function Fv(t,e,n,i){return wv.context(t)(e,n,i)}function Sv(t,e){return(e.mark.shape||e.shape).context(t)(e)}function Tv(t,e){return kv.context(t)(e)}function Bv(t,e){return Mv.context(t)(e)}var Nv=1;function zv(){Nv=1}function Ov(t,e,n){var i=e.clip,r=t._defs,a=e.clip_id||(e.clip_id="clip"+Nv++),o=r.clipping[a]||(r.clipping[a]={id:a});if((0,g.mf)(i)){o.path=i(null)}else if(Av(n)){o.path=Fv(null,n,0,0)}else{o.width=n.width||0;o.height=n.height||0}return"url(#"+a+")"}function Rv(t){this.clear();if(t)this.union(t)}Rv.prototype={clone(){return new Rv(this)},clear(){this.x1=+Number.MAX_VALUE;this.y1=+Number.MAX_VALUE;this.x2=-Number.MAX_VALUE;this.y2=-Number.MAX_VALUE;return this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(t){return this.x1===t.x1&&this.y1===t.y1&&this.x2===t.x2&&this.y2===t.y2},set(t,e,n,i){if(n<t){this.x2=t;this.x1=n}else{this.x1=t;this.x2=n}if(i<e){this.y2=e;this.y1=i}else{this.y1=e;this.y2=i}return this},add(t,e){if(t<this.x1)this.x1=t;if(e<this.y1)this.y1=e;if(t>this.x2)this.x2=t;if(e>this.y2)this.y2=e;return this},expand(t){this.x1-=t;this.y1-=t;this.x2+=t;this.y2+=t;return this},round(){this.x1=Math.floor(this.x1);this.y1=Math.floor(this.y1);this.x2=Math.ceil(this.x2);this.y2=Math.ceil(this.y2);return this},scale(t){this.x1*=t;this.y1*=t;this.x2*=t;this.y2*=t;return this},translate(t,e){this.x1+=t;this.x2+=t;this.y1+=e;this.y2+=e;return this},rotate(t,e,n){const i=this.rotatedPoints(t,e,n);return this.clear().add(i[0],i[1]).add(i[2],i[3]).add(i[4],i[5]).add(i[6],i[7])},rotatedPoints(t,e,n){var{x1:i,y1:r,x2:a,y2:o}=this,u=Math.cos(t),s=Math.sin(t),l=e-e*u+n*s,f=n-e*s-n*u;return[u*i-s*r+l,s*i+u*r+f,u*i-s*o+l,s*i+u*o+f,u*a-s*r+l,s*a+u*r+f,u*a-s*o+l,s*a+u*o+f]},union(t){if(t.x1<this.x1)this.x1=t.x1;if(t.y1<this.y1)this.y1=t.y1;if(t.x2>this.x2)this.x2=t.x2;if(t.y2>this.y2)this.y2=t.y2;return this},intersect(t){if(t.x1>this.x1)this.x1=t.x1;if(t.y1>this.y1)this.y1=t.y1;if(t.x2<this.x2)this.x2=t.x2;if(t.y2<this.y2)this.y2=t.y2;return this},encloses(t){return t&&this.x1<=t.x1&&this.x2>=t.x2&&this.y1<=t.y1&&this.y2>=t.y2},alignsWith(t){return t&&(this.x1==t.x1||this.x2==t.x2||this.y1==t.y1||this.y2==t.y2)},intersects(t){return t&&!(this.x2<t.x1||this.x1>t.x2||this.y2<t.y1||this.y1>t.y2)},contains(t,e){return!(t<this.x1||t>this.x2||e<this.y1||e>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}};function Uv(t){this.mark=t;this.bounds=this.bounds||new Rv}function $v(t){Uv.call(this,t);this.items=this.items||[]}(0,g.XW)($v,Uv);function Pv(t){this._pending=0;this._loader=t||wa()}function qv(t){t._pending+=1}function Iv(t){t._pending-=1}Pv.prototype={pending(){return this._pending},sanitizeURL(t){const e=this;qv(e);return e._loader.sanitize(t,{context:"href"}).then((t=>{Iv(e);return t})).catch((()=>{Iv(e);return null}))},loadImage(t){const e=this,n=Gc();qv(e);return e._loader.sanitize(t,{context:"image"}).then((t=>{const i=t.href;if(!i||!n)throw{url:i};const r=new n;const a=(0,g.nr)(t,"crossOrigin")?t.crossOrigin:"anonymous";if(a!=null)r.crossOrigin=a;r.onload=()=>Iv(e);r.onerror=()=>Iv(e);r.src=i;return r})).catch((t=>{Iv(e);return{complete:false,width:0,height:0,src:t&&t.url||""}}))},ready(){const t=this;return new Promise((e=>{function n(i){if(!t.pending())e(i);else setTimeout((()=>{n(true)}),10)}n(false)}))}};function Lv(t,e,n){if(e.stroke&&e.opacity!==0&&e.strokeOpacity!==0){const i=e.strokeWidth!=null?+e.strokeWidth:1;t.expand(i+(n?jv(e,i):0))}return t}function jv(t,e){return t.strokeJoin&&t.strokeJoin!=="miter"?0:e}const Wv=Ey-1e-8;let Xv,Hv,Yv,Jv,Vv,Gv,Kv,Zv;const Qv=(t,e)=>Xv.add(t,e);const tx=(t,e)=>Qv(Hv=t,Yv=e);const ex=t=>Qv(t,Xv.y1);const nx=t=>Qv(Xv.x1,t);const ix=(t,e)=>Vv*t+Kv*e;const rx=(t,e)=>Gv*t+Zv*e;const ax=(t,e)=>Qv(ix(t,e),rx(t,e));const ox=(t,e)=>tx(ix(t,e),rx(t,e));function ux(t,e){Xv=t;if(e){Jv=e*ky;Vv=Zv=Math.cos(Jv);Gv=Math.sin(Jv);Kv=-Gv}else{Vv=Zv=1;Jv=Gv=Kv=0}return sx}const sx={beginPath(){},closePath(){},moveTo:ox,lineTo:ox,rect(t,e,n,i){if(Jv){ax(t+n,e);ax(t+n,e+i);ax(t,e+i);ox(t,e)}else{Qv(t+n,e+i);tx(t,e)}},quadraticCurveTo(t,e,n,i){const r=ix(t,e),a=rx(t,e),o=ix(n,i),u=rx(n,i);lx(Hv,r,o,ex);lx(Yv,a,u,nx);tx(o,u)},bezierCurveTo(t,e,n,i,r,a){const o=ix(t,e),u=rx(t,e),s=ix(n,i),l=rx(n,i),f=ix(r,a),c=rx(r,a);fx(Hv,o,s,f,ex);fx(Yv,u,l,c,nx);tx(f,c)},arc(t,e,n,i,r,a){i+=Jv;r+=Jv;Hv=n*Math.cos(r)+t;Yv=n*Math.sin(r)+e;if(Math.abs(r-i)>Wv){Qv(t-n,e-n);Qv(t+n,e+n)}else{const o=i=>Qv(n*Math.cos(i)+t,n*Math.sin(i)+e);let u,s;o(i);o(r);if(r!==i){i=i%Ey;if(i<0)i+=Ey;r=r%Ey;if(r<0)r+=Ey;if(r<i){a=!a;u=i;i=r;r=u}if(a){r-=Ey;u=i-i%Ay;for(s=0;s<4&&u>r;++s,u-=Ay)o(u)}else{u=i-i%Ay+Ay;for(s=0;s<4&&u<r;++s,u=u+Ay)o(u)}}}}};function lx(t,e,n,i){const r=(t-e)/(t+n-2*e);if(0<r&&r<1)i(t+(e-t)*r)}function fx(t,e,n,i,r){const a=i-t+3*e-3*n,o=t+n-2*e,u=t-e;let s=0,l=0,f;if(Math.abs(a)>My){f=o*o+u*a;if(f>=0){f=Math.sqrt(f);s=(-o+f)/a;l=(-o-f)/a}}else{s=.5*u/o}if(0<s&&s<1)r(cx(s,t,e,n,i));if(0<l&&l<1)r(cx(l,t,e,n,i))}function cx(t,e,n,i,r){const a=1-t,o=a*a,u=t*t;return o*a*e+3*o*t*n+3*a*u*i+u*t*r}var hx=(hx=Vc(1,1))?hx.getContext("2d"):null;const dx=new Rv;function px(t){return function(e,n){if(!hx)return true;t(hx,e);dx.clear().union(e.bounds).intersect(n).round();const{x1:i,y1:r,x2:a,y2:o}=dx;for(let t=r;t<=o;++t){for(let e=i;e<=a;++e){if(hx.isPointInPath(e,t)){return true}}}return false}}function gx(t,e){return e.contains(t.x||0,t.y||0)}function mx(t,e){const n=t.x||0,i=t.y||0,r=t.width||0,a=t.height||0;return e.intersects(dx.set(n,i,n+r,i+a))}function yx(t,e){const n=t.x||0,i=t.y||0,r=t.x2!=null?t.x2:n,a=t.y2!=null?t.y2:i;return vx(e,n,i,r,a)}function vx(t,e,n,i,r){const{x1:a,y1:o,x2:u,y2:s}=t,l=i-e,f=r-n;let c=0,h=1,d,p,g,m;for(m=0;m<4;++m){if(m===0){d=-l;p=-(a-e)}if(m===1){d=l;p=u-e}if(m===2){d=-f;p=-(o-n)}if(m===3){d=f;p=s-n}if(Math.abs(d)<1e-10&&p<0)return false;g=p/d;if(d<0){if(g>h)return false;else if(g>c)c=g}else if(d>0){if(g<c)return false;else if(g<h)h=g}}return true}function xx(t,e){t.globalCompositeOperation=e.blend||"source-over"}function _x(t,e){return t==null?e:t}function bx(t,e){const n=e.length;for(let i=0;i<n;++i){t.addColorStop(e[i].offset,e[i].color)}return t}function wx(t,e,n){const i=n.width(),r=n.height();let a;if(e.gradient==="radial"){a=t.createRadialGradient(n.x1+_x(e.x1,.5)*i,n.y1+_x(e.y1,.5)*r,Math.max(i,r)*_x(e.r1,0),n.x1+_x(e.x2,.5)*i,n.y1+_x(e.y2,.5)*r,Math.max(i,r)*_x(e.r2,.5))}else{const o=_x(e.x1,0),u=_x(e.y1,0),s=_x(e.x2,1),l=_x(e.y2,0);if(o===s||u===l||i===r){a=t.createLinearGradient(n.x1+o*i,n.y1+u*r,n.x1+s*i,n.y1+l*r)}else{const n=Vc(Math.ceil(i),Math.ceil(r)),a=n.getContext("2d");a.scale(i,r);a.fillStyle=bx(a.createLinearGradient(o,u,s,l),e.stops);a.fillRect(0,0,i,r);return t.createPattern(n,"no-repeat")}}return bx(a,e.stops)}function kx(t,e,n){return py(n)?wx(t,n,e.bounds):n}function Mx(t,e,n){n*=e.fillOpacity==null?1:e.fillOpacity;if(n>0){t.globalAlpha=n;t.fillStyle=kx(t,e,e.fill);return true}else{return false}}var Ax=[];function Ex(t,e,n){var i=(i=e.strokeWidth)!=null?i:1;if(i<=0)return false;n*=e.strokeOpacity==null?1:e.strokeOpacity;if(n>0){t.globalAlpha=n;t.strokeStyle=kx(t,e,e.stroke);t.lineWidth=i;t.lineCap=e.strokeCap||"butt";t.lineJoin=e.strokeJoin||"miter";t.miterLimit=e.strokeMiterLimit||10;if(t.setLineDash){t.setLineDash(e.strokeDash||Ax);t.lineDashOffset=e.strokeDashOffset||0}return true}else{return false}}function Dx(t,e){return t.zindex-e.zindex||t.index-e.index}function Cx(t){if(!t.zdirty)return t.zitems;var e=t.items,n=[],i,r,a;for(r=0,a=e.length;r<a;++r){i=e[r];i.index=r;if(i.zindex)n.push(i)}t.zdirty=false;return t.zitems=n.sort(Dx)}function Fx(t,e){var n=t.items,i,r;if(!n||!n.length)return;const a=Cx(t);if(a&&a.length){for(i=0,r=n.length;i<r;++i){if(!n[i].zindex)e(n[i])}n=a}for(i=0,r=n.length;i<r;++i){e(n[i])}}function Sx(t,e){var n=t.items,i,r;if(!n||!n.length)return null;const a=Cx(t);if(a&&a.length)n=a;for(r=n.length;--r>=0;){if(i=e(n[r]))return i}if(n===a){for(n=t.items,r=n.length;--r>=0;){if(!n[r].zindex){if(i=e(n[r]))return i}}}return null}function Tx(t){return function(e,n,i){Fx(n,(n=>{if(!i||i.intersects(n.bounds)){Nx(t,e,n,n)}}))}}function Bx(t){return function(e,n,i){if(n.items.length&&(!i||i.intersects(n.bounds))){Nx(t,e,n.items[0],n.items)}}}function Nx(t,e,n,i){var r=n.opacity==null?1:n.opacity;if(r===0)return;if(t(e,i))return;xx(e,n);if(n.fill&&Mx(e,n,r)){e.fill()}if(n.stroke&&Ex(e,n,r)){e.stroke()}}function zx(t){t=t||g.yb;return function(e,n,i,r,a,o){i*=e.pixelRatio;r*=e.pixelRatio;return Sx(n,(n=>{const u=n.bounds;if(u&&!u.contains(a,o)||!u)return;if(t(e,n,i,r,a,o))return n}))}}function Ox(t,e){return function(n,i,r,a){var o=Array.isArray(i)?i[0]:i,u=e==null?o.fill:e,s=o.stroke&&n.isPointInStroke,l,f;if(s){l=o.strokeWidth;f=o.strokeCap;n.lineWidth=l!=null?l:1;n.lineCap=f!=null?f:"butt"}return t(n,i)?false:u&&n.isPointInPath(r,a)||s&&n.isPointInStroke(r,a)}}function Rx(t){return zx(Ox(t))}function Ux(t,e){return"translate("+t+","+e+")"}function $x(t){return"rotate("+t+")"}function Px(t,e){return"scale("+t+","+e+")"}function qx(t){return Ux(t.x||0,t.y||0)}function Ix(t){return Ux(t.x||0,t.y||0)+(t.angle?" "+$x(t.angle):"")}function Lx(t){return Ux(t.x||0,t.y||0)+(t.angle?" "+$x(t.angle):"")+(t.scaleX||t.scaleY?" "+Px(t.scaleX||1,t.scaleY||1):"")}function jx(t,e,n){function i(t,n){t("transform",Ix(n));t("d",e(null,n))}function r(t,n){e(ux(t,n.angle),n);return Lv(t,n).translate(n.x||0,n.y||0)}function a(t,n){var i=n.x||0,r=n.y||0,a=n.angle||0;t.translate(i,r);if(a)t.rotate(a*=ky);t.beginPath();e(t,n);if(a)t.rotate(-a);t.translate(-i,-r)}return{type:t,tag:"path",nested:false,attr:i,bound:r,draw:Tx(a),pick:Rx(a),isect:n||px(a)}}var Wx=jx("arc",Ev);function Xx(t,e){var n=t[0].orient==="horizontal"?e[1]:e[0],i=t[0].orient==="horizontal"?"y":"x",r=t.length,a=+Infinity,o,u;while(--r>=0){if(t[r].defined===false)continue;u=Math.abs(t[r][i]-n);if(u<a){a=u;o=t[r]}}return o}function Hx(t,e){var n=Math.pow(t[0].strokeWidth||1,2),i=t.length,r,a,o;while(--i>=0){if(t[i].defined===false)continue;r=t[i].x-e[0];a=t[i].y-e[1];o=r*r+a*a;if(o<n)return t[i]}return null}function Yx(t,e){var n=t.length,i,r,a;while(--n>=0){if(t[n].defined===false)continue;i=t[n].x-e[0];r=t[n].y-e[1];a=i*i+r*r;i=t[n].size||1;if(a<i*i)return t[n]}return null}function Jx(t,e,n){function i(t,n){var i=n.mark.items;if(i.length)t("d",e(null,i))}function r(t,n){var i=n.items;if(i.length===0){return t}else{e(ux(t),i);return Lv(t,i[0])}}function a(t,n){t.beginPath();e(t,n)}const o=Ox(a);function u(t,e,n,i,r,a){var u=e.items,s=e.bounds;if(!u||!u.length||s&&!s.contains(r,a)){return null}n*=t.pixelRatio;i*=t.pixelRatio;return o(t,u,n,i)?u[0]:null}return{type:t,tag:"path",nested:true,attr:i,bound:r,draw:Bx(a),pick:u,isect:gx,tip:n}}var Vx=Jx("area",Dv,Xx);function Gx(t,e){var n=e.clip;t.save();if((0,g.mf)(n)){t.beginPath();n(t);t.clip()}else{Kx(t,e.group)}}function Kx(t,e){t.beginPath();Av(e)?Fv(t,e,0,0):t.rect(0,0,e.width||0,e.height||0);t.clip()}function Zx(t){const e=_x(t.strokeWidth,1);return t.strokeOffset!=null?t.strokeOffset:t.stroke&&e>.5&&e<1.5?.5-Math.abs(e-1):0}function Qx(t,e){t("transform",qx(e))}function t_(t,e){const n=Zx(e);t("d",Fv(null,e,n,n))}function e_(t,e){t("class","background");t("aria-hidden",true);t_(t,e)}function n_(t,e){t("class","foreground");t("aria-hidden",true);if(e.strokeForeground){t_(t,e)}else{t("d","")}}function i_(t,e,n){const i=e.clip?Ov(n,e,e):null;t("clip-path",i)}function r_(t,e){if(!e.clip&&e.items){const n=e.items,i=n.length;for(let e=0;e<i;++e){t.union(n[e].bounds)}}if((e.clip||e.width||e.height)&&!e.noBound){t.add(0,0).add(e.width||0,e.height||0)}Lv(t,e);return t.translate(e.x||0,e.y||0)}function a_(t,e,n,i){const r=Zx(e);t.beginPath();Fv(t,e,(n||0)+r,(i||0)+r)}const o_=Ox(a_);const u_=Ox(a_,false);const s_=Ox(a_,true);function l_(t,e,n){Fx(e,(e=>{const i=e.x||0,r=e.y||0,a=e.strokeForeground,o=e.opacity==null?1:e.opacity;if((e.stroke||e.fill)&&o){a_(t,e,i,r);xx(t,e);if(e.fill&&Mx(t,e,o)){t.fill()}if(e.stroke&&!a&&Ex(t,e,o)){t.stroke()}}t.save();t.translate(i,r);if(e.clip)Kx(t,e);if(n)n.translate(-i,-r);Fx(e,(e=>{this.draw(t,e,n)}));if(n)n.translate(i,r);t.restore();if(a&&e.stroke&&o){a_(t,e,i,r);xx(t,e);if(Ex(t,e,o)){t.stroke()}}}))}function f_(t,e,n,i,r,a){if(e.bounds&&!e.bounds.contains(r,a)||!e.items){return null}const o=n*t.pixelRatio,u=i*t.pixelRatio;return Sx(e,(s=>{let l,f,c;const h=s.bounds;if(h&&!h.contains(r,a))return;f=s.x||0;c=s.y||0;const d=f+(s.width||0),p=c+(s.height||0),g=s.clip;if(g&&(r<f||r>d||a<c||a>p))return;t.save();t.translate(f,c);f=r-f;c=a-c;if(g&&Av(s)&&!s_(t,s,o,u)){t.restore();return null}const m=s.strokeForeground,y=e.interactive!==false;if(y&&m&&s.stroke&&u_(t,s,o,u)){t.restore();return s}l=Sx(s,(t=>c_(t,f,c)?this.pick(t,n,i,f,c):null));if(!l&&y&&(s.fill||!m&&s.stroke)&&o_(t,s,o,u)){l=s}t.restore();return l||null}))}function c_(t,e,n){return(t.interactive!==false||t.marktype==="group")&&t.bounds&&t.bounds.contains(e,n)}var h_={type:"group",tag:"g",nested:false,attr:Qx,bound:r_,draw:l_,pick:f_,isect:mx,content:i_,background:e_,foreground:n_};var d_={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function p_(t,e){var n=t.image;if(!n||t.url&&t.url!==n.url){n={complete:false,width:0,height:0};e.loadImage(t.url).then((e=>{t.image=e;t.image.url=t.url}))}return n}function g_(t,e){return t.width!=null?t.width:!e||!e.width?0:t.aspect!==false&&t.height?t.height*e.width/e.height:e.width}function m_(t,e){return t.height!=null?t.height:!e||!e.height?0:t.aspect!==false&&t.width?t.width*e.height/e.width:e.height}function y_(t,e){return t==="center"?e/2:t==="right"?e:0}function v_(t,e){return t==="middle"?e/2:t==="bottom"?e:0}function x_(t,e,n){const i=p_(e,n),r=g_(e,i),a=m_(e,i),o=(e.x||0)-y_(e.align,r),u=(e.y||0)-v_(e.baseline,a),s=!i.src&&i.toDataURL?i.toDataURL():i.src||"";t("href",s,d_["xmlns:xlink"],"xlink:href");t("transform",Ux(o,u));t("width",r);t("height",a);t("preserveAspectRatio",e.aspect===false?"none":"xMidYMid")}function __(t,e){const n=e.image,i=g_(e,n),r=m_(e,n),a=(e.x||0)-y_(e.align,i),o=(e.y||0)-v_(e.baseline,r);return t.set(a,o,a+i,o+r)}function b_(t,e,n){Fx(e,(e=>{if(n&&!n.intersects(e.bounds))return;const i=p_(e,this);let r=g_(e,i);let a=m_(e,i);if(r===0||a===0)return;let o=(e.x||0)-y_(e.align,r),u=(e.y||0)-v_(e.baseline,a),s,l,f,c;if(e.aspect!==false){l=i.width/i.height;f=e.width/e.height;if(l===l&&f===f&&l!==f){if(f<l){c=r/l;u+=(a-c)/2;a=c}else{c=a*l;o+=(r-c)/2;r=c}}}if(i.complete||i.toDataURL){xx(t,e);t.globalAlpha=(s=e.opacity)!=null?s:1;t.imageSmoothingEnabled=e.smooth!==false;t.drawImage(i,o,u,r,a)}}))}var w_={type:"image",tag:"image",nested:false,attr:x_,bound:__,draw:b_,pick:zx(),isect:g.yb,get:p_,xOffset:y_,yOffset:v_};var k_=Jx("line",Cv,Hx);function M_(t,e){var n=e.scaleX||1,i=e.scaleY||1;if(n!==1||i!==1){t("vector-effect","non-scaling-stroke")}t("transform",Lx(e));t("d",e.path)}function A_(t,e){var n=e.path;if(n==null)return true;var i=e.x||0,r=e.y||0,a=e.scaleX||1,o=e.scaleY||1,u=(e.angle||0)*ky,s=e.pathCache;if(!s||s.path!==n){(e.pathCache=s=wy(n)).path=n}if(u&&t.rotate&&t.translate){t.translate(i,r);t.rotate(u);Oy(t,s,0,0,a,o);t.rotate(-u);t.translate(-i,-r)}else{Oy(t,s,i,r,a,o)}}function E_(t,e){return A_(ux(t,e.angle),e)?t.set(0,0,0,0):Lv(t,e,true)}var D_={type:"path",tag:"path",nested:false,attr:M_,bound:E_,draw:Tx(A_),pick:Rx(A_),isect:px(A_)};function C_(t,e){t("d",Fv(null,e))}function F_(t,e){var n,i;return Lv(t.set(n=e.x||0,i=e.y||0,n+e.width||0,i+e.height||0),e)}function S_(t,e){t.beginPath();Fv(t,e)}var T_={type:"rect",tag:"path",nested:false,attr:C_,bound:F_,draw:Tx(S_),pick:Rx(S_),isect:mx};function B_(t,e){t("transform",qx(e));t("x2",e.x2!=null?e.x2-(e.x||0):0);t("y2",e.y2!=null?e.y2-(e.y||0):0)}function N_(t,e){var n,i;return Lv(t.set(n=e.x||0,i=e.y||0,e.x2!=null?e.x2:n,e.y2!=null?e.y2:i),e)}function z_(t,e,n){var i,r,a,o;if(e.stroke&&Ex(t,e,n)){i=e.x||0;r=e.y||0;a=e.x2!=null?e.x2:i;o=e.y2!=null?e.y2:r;t.beginPath();t.moveTo(i,r);t.lineTo(a,o);return true}return false}function O_(t,e,n){Fx(e,(e=>{if(n&&!n.intersects(e.bounds))return;var i=e.opacity==null?1:e.opacity;if(i&&z_(t,e,i)){xx(t,e);t.stroke()}}))}function R_(t,e,n,i){if(!t.isPointInStroke)return false;return z_(t,e,1)&&t.isPointInStroke(n,i)}var U_={type:"rule",tag:"line",nested:false,attr:B_,bound:N_,draw:O_,pick:zx(R_),isect:yx};var $_=jx("shape",Sv);var P_=jx("symbol",Tv,gx);const q_=(0,g.$m)();var I_={height:Y_,measureWidth:X_,estimateWidth:j_,width:j_,canvas:L_};L_(true);function L_(t){I_.width=t&&hx?X_:j_}function j_(t,e){return W_(Z_(t,e),Y_(t))}function W_(t,e){return~~(.8*t.length*e)}function X_(t,e){return Y_(t)<=0||!(e=Z_(t,e))?0:H_(e,nb(t))}function H_(t,e){const n=`(${e}) ${t}`;let i=q_.get(n);if(i===undefined){hx.font=e;i=hx.measureText(t).width;q_.set(n,i)}return i}function Y_(t){return t.fontSize!=null?+t.fontSize||0:11}function J_(t){return t.lineHeight!=null?t.lineHeight:Y_(t)+2}function V_(t){return(0,g.kJ)(t)?t.length>1?t:t[0]:t}function G_(t){return V_(t.lineBreak&&t.text&&!(0,g.kJ)(t.text)?t.text.split(t.lineBreak):t.text)}function K_(t){const e=G_(t);return((0,g.kJ)(e)?e.length-1:0)*J_(t)}function Z_(t,e){const n=e==null?"":(e+"").trim();return t.limit>0&&n.length?tb(t,n):n}function Q_(t){if(I_.width===X_){const e=nb(t);return t=>H_(t,e)}else{const e=Y_(t);return t=>W_(t,e)}}function tb(t,e){var n=+t.limit,i=Q_(t);if(i(e)<n)return e;var r=t.ellipsis||"…",a=t.dir==="rtl",o=0,u=e.length,s;n-=i(r);if(a){while(o<u){s=o+u>>>1;if(i(e.slice(s))>n)o=s+1;else u=s}return r+e.slice(o)}else{while(o<u){s=1+(o+u>>>1);if(i(e.slice(0,s))<n)o=s;else u=s-1}return e.slice(0,o)+r}}function eb(t,e){var n=t.font;return(e&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function nb(t,e){return""+(t.fontStyle?t.fontStyle+" ":"")+(t.fontVariant?t.fontVariant+" ":"")+(t.fontWeight?t.fontWeight+" ":"")+Y_(t)+"px "+eb(t,e)}function ib(t){var e=t.baseline,n=Y_(t);return Math.round(e==="top"?.79*n:e==="middle"?.3*n:e==="bottom"?-.21*n:e==="line-top"?.29*n+.5*J_(t):e==="line-bottom"?.29*n-.5*J_(t):0)}const rb={left:"start",center:"middle",right:"end"};const ab=new Rv;function ob(t){var e=t.x||0,n=t.y||0,i=t.radius||0,r;if(i){r=(t.theta||0)-Ay;e+=i*Math.cos(r);n+=i*Math.sin(r)}ab.x1=e;ab.y1=n;return ab}function ub(t,e){var n=e.dx||0,i=(e.dy||0)+ib(e),r=ob(e),a=r.x1,o=r.y1,u=e.angle||0,s;t("text-anchor",rb[e.align]||"start");if(u){s=Ux(a,o)+" "+$x(u);if(n||i)s+=" "+Ux(n,i)}else{s=Ux(a+n,o+i)}t("transform",s)}function sb(t,e,n){var i=I_.height(e),r=e.align,a=ob(e),o=a.x1,u=a.y1,s=e.dx||0,l=(e.dy||0)+ib(e)-Math.round(.8*i),f=G_(e),c;if((0,g.kJ)(f)){i+=J_(e)*(f.length-1);c=f.reduce(((t,n)=>Math.max(t,I_.width(e,n))),0)}else{c=I_.width(e,f)}if(r==="center"){s-=c/2}else if(r==="right"){s-=c}else;t.set(s+=o,l+=u,s+c,l+i);if(e.angle&&!n){t.rotate(e.angle*ky,o,u)}else if(n===2){return t.rotatedPoints(e.angle*ky,o,u)}return t}function lb(t,e,n){Fx(e,(e=>{var i=e.opacity==null?1:e.opacity,r,a,o,u,s,l,f;if(n&&!n.intersects(e.bounds)||i===0||e.fontSize<=0||e.text==null||e.text.length===0)return;t.font=nb(e);t.textAlign=e.align||"left";r=ob(e);a=r.x1,o=r.y1;if(e.angle){t.save();t.translate(a,o);t.rotate(e.angle*ky);a=o=0}a+=e.dx||0;o+=(e.dy||0)+ib(e);l=G_(e);xx(t,e);if((0,g.kJ)(l)){s=J_(e);for(u=0;u<l.length;++u){f=Z_(e,l[u]);if(e.fill&&Mx(t,e,i)){t.fillText(f,a,o)}if(e.stroke&&Ex(t,e,i)){t.strokeText(f,a,o)}o+=s}}else{f=Z_(e,l);if(e.fill&&Mx(t,e,i)){t.fillText(f,a,o)}if(e.stroke&&Ex(t,e,i)){t.strokeText(f,a,o)}}if(e.angle)t.restore()}))}function fb(t,e,n,i,r,a){if(e.fontSize<=0)return false;if(!e.angle)return true;var o=ob(e),u=o.x1,s=o.y1,l=sb(ab,e,1),f=-e.angle*ky,c=Math.cos(f),h=Math.sin(f),d=c*r-h*a+(u-c*u+h*s),p=h*r+c*a+(s-h*u-c*s);return l.contains(d,p)}function cb(t,e){const n=sb(ab,t,2);return vx(e,n[0],n[1],n[2],n[3])||vx(e,n[0],n[1],n[4],n[5])||vx(e,n[4],n[5],n[6],n[7])||vx(e,n[2],n[3],n[6],n[7])}var hb={type:"text",tag:"text",nested:false,attr:ub,bound:sb,draw:lb,pick:zx(fb),isect:cb};var db=Jx("trail",Bv,Yx);var pb={arc:Wx,area:Vx,group:h_,image:w_,line:k_,path:D_,rect:T_,rule:U_,shape:$_,symbol:P_,text:hb,trail:db};function gb(t,e,n){var i=pb[t.mark.marktype],r=e||i.bound;if(i.nested)t=t.mark;return r(t.bounds||(t.bounds=new Rv),t,n)}var mb={mark:null};function yb(t,e,n){var i=pb[t.marktype],r=i.bound,a=t.items,o=a&&a.length,u,s,l,f;if(i.nested){if(o){l=a[0]}else{mb.mark=t;l=mb}f=gb(l,r,n);e=e&&e.union(f)||f;return e}e=e||t.bounds&&t.bounds.clear()||new Rv;if(o){for(u=0,s=a.length;u<s;++u){e.union(gb(a[u],r,n))}}return t.bounds=e}const vb=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function xb(t,e){return JSON.stringify(t,vb,e)}function _b(t){const e=typeof t==="string"?JSON.parse(t):t;return bb(e)}function bb(t){var e=t.marktype,n=t.items,i,r,a;if(n){for(r=0,a=n.length;r<a;++r){i=e?"mark":"group";n[r][i]=t;if(n[r].zindex)n[r][i].zdirty=true;if("group"===(e||i))bb(n[r])}}if(e)yb(t);return t}function wb(t){if(arguments.length){this.root=_b(t)}else{this.root=kb({marktype:"group",name:"root",role:"frame"});this.root.items=[new $v(this.root)]}}wb.prototype={toJSON(t){return xb(this.root,t||0)},mark(t,e,n){e=e||this.root.items[0];const i=kb(t,e);e.items[n]=i;if(i.zindex)i.group.zdirty=true;return i}};function kb(t,e){const n={bounds:new Rv,clip:!!t.clip,group:e,interactive:t.interactive===false?false:true,items:[],marktype:t.marktype,name:t.name||undefined,role:t.role||undefined,zindex:t.zindex||0};if(t.aria!=null){n.aria=t.aria}if(t.description){n.description=t.description}return n}function Mb(t,e,n){if(!t&&typeof document!=="undefined"&&document.createElement){t=document}return t?n?t.createElementNS(n,e):t.createElement(e):null}function Ab(t,e){e=e.toLowerCase();var n=t.childNodes,i=0,r=n.length;for(;i<r;++i)if(n[i].tagName.toLowerCase()===e){return n[i]}}function Eb(t,e,n,i){var r=t.childNodes[e],a;if(!r||r.tagName.toLowerCase()!==n.toLowerCase()){a=r||null;r=Mb(t.ownerDocument,n,i);t.insertBefore(r,a)}return r}function Db(t,e){var n=t.childNodes,i=n.length;while(i>e)t.removeChild(n[--i]);return t}function Cb(t){return"mark-"+t.marktype+(t.role?" role-"+t.role:"")+(t.name?" "+t.name:"")}function Fb(t,e){const n=e.getBoundingClientRect();return[t.clientX-n.left-(e.clientLeft||0),t.clientY-n.top-(e.clientTop||0)]}function Sb(t,e,n,i){var r=t&&t.mark,a,o;if(r&&(a=pb[r.marktype]).tip){o=Fb(e,n);o[0]-=i[0];o[1]-=i[1];while(t=t.mark.group){o[0]-=t.x||0;o[1]-=t.y||0}t=a.tip(r.items,o)}return t}function Tb(t,e){this._active=null;this._handlers={};this._loader=t||wa();this._tooltip=e||Bb}function Bb(t,e,n,i){t.element().setAttribute("title",i||"")}Tb.prototype={initialize(t,e,n){this._el=t;this._obj=n||null;return this.origin(e)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},origin(t){if(arguments.length){this._origin=t||[0,0];return this}else{return this._origin.slice()}},scene(t){if(!arguments.length)return this._scene;this._scene=t;return this},on(){},off(){},_handlerIndex(t,e,n){for(let i=t?t.length:0;--i>=0;){if(t[i].type===e&&(!n||t[i].handler===n)){return i}}return-1},handlers(t){const e=this._handlers,n=[];if(t){n.push(...e[this.eventName(t)])}else{for(const t in e){n.push(...e[t])}}return n},eventName(t){const e=t.indexOf(".");return e<0?t:t.slice(0,e)},handleHref(t,e,n){this._loader.sanitize(n,{context:"href"}).then((e=>{const n=new MouseEvent(t.type,t),i=Mb(null,"a");for(const t in e)i.setAttribute(t,e[t]);i.dispatchEvent(n)})).catch((()=>{}))},handleTooltip(t,e,n){if(e&&e.tooltip!=null){e=Sb(e,t,this.canvas(),this._origin);const i=n&&e&&e.tooltip||null;this._tooltip.call(this._obj,this,t,e,i)}},getItemBoundingClientRect(t){const e=this.canvas();if(!e)return;const n=e.getBoundingClientRect(),i=this._origin,r=t.bounds,a=r.width(),o=r.height();let u=r.x1+i[0]+n.left,s=r.y1+i[1]+n.top;while(t.mark&&(t=t.mark.group)){u+=t.x||0;s+=t.y||0}return{x:u,y:s,width:a,height:o,left:u,top:s,right:u+a,bottom:s+o}}};function Nb(t){this._el=null;this._bgcolor=null;this._loader=new Pv(t)}Nb.prototype={initialize(t,e,n,i,r){this._el=t;return this.resize(e,n,i,r)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},background(t){if(arguments.length===0)return this._bgcolor;this._bgcolor=t;return this},resize(t,e,n,i){this._width=t;this._height=e;this._origin=n||[0,0];this._scale=i||1;return this},dirty(){},render(t){const e=this;e._call=function(){e._render(t)};e._call();e._call=null;return e},_render(){},renderAsync(t){const e=this.render(t);return this._ready?this._ready.then((()=>e)):Promise.resolve(e)},_load(t,e){var n=this,i=n._loader[t](e);if(!n._ready){const t=n._call;n._ready=n._loader.ready().then((e=>{if(e)t();n._ready=null}))}return i},sanitizeURL(t){return this._load("sanitizeURL",t)},loadImage(t){return this._load("loadImage",t)}};const zb="keydown";const Ob="keypress";const Rb="keyup";const Ub="dragenter";const $b="dragleave";const Pb="dragover";const qb="mousedown";const Ib="mouseup";const Lb="mousemove";const jb="mouseout";const Wb="mouseover";const Xb="click";const Hb="dblclick";const Yb="wheel";const Jb="mousewheel";const Vb="touchstart";const Gb="touchmove";const Kb="touchend";const Zb=[zb,Ob,Rb,Ub,$b,Pb,qb,Ib,Lb,jb,Wb,Xb,Hb,Yb,Jb,Vb,Gb,Kb];const Qb=Lb;const tw=jb;const ew=Xb;function nw(t,e){Tb.call(this,t,e);this._down=null;this._touch=null;this._first=true;this._events={}}const iw=t=>t===Vb||t===Gb||t===Kb?[Vb,Gb,Kb]:[t];function rw(t,e){iw(e).forEach((e=>aw(t,e)))}function aw(t,e){const n=t.canvas();if(n&&!t._events[e]){t._events[e]=1;n.addEventListener(e,t[e]?n=>t[e](n):n=>t.fire(e,n))}}function ow(t,e,n){return function(i){const r=this._active,a=this.pickEvent(i);if(a===r){this.fire(t,i)}else{if(!r||!r.exit){this.fire(n,i)}this._active=a;this.fire(e,i);this.fire(t,i)}}}function uw(t){return function(e){this.fire(t,e);this._active=null}}(0,g.XW)(nw,Tb,{initialize(t,e,n){this._canvas=t&&Ab(t,"canvas");[Xb,qb,Lb,jb,$b].forEach((t=>rw(this,t)));return Tb.prototype.initialize.call(this,t,e,n)},canvas(){return this._canvas},context(){return this._canvas.getContext("2d")},events:Zb,DOMMouseScroll(t){this.fire(Jb,t)},mousemove:ow(Lb,Wb,jb),dragover:ow(Pb,Ub,$b),mouseout:uw(jb),dragleave:uw($b),mousedown(t){this._down=this._active;this.fire(qb,t)},click(t){if(this._down===this._active){this.fire(Xb,t);this._down=null}},touchstart(t){this._touch=this.pickEvent(t.changedTouches[0]);if(this._first){this._active=this._touch;this._first=false}this.fire(Vb,t,true)},touchmove(t){this.fire(Gb,t,true)},touchend(t){this.fire(Kb,t,true);this._touch=null},fire(t,e,n){const i=n?this._touch:this._active,r=this._handlers[t];e.vegaType=t;if(t===ew&&i&&i.href){this.handleHref(e,i,i.href)}else if(t===Qb||t===tw){this.handleTooltip(e,i,t!==tw)}if(r){for(let t=0,n=r.length;t<n;++t){r[t].handler.call(this._obj,e,i)}}},on(t,e){const n=this.eventName(t),i=this._handlers,r=this._handlerIndex(i[n],t,e);if(r<0){rw(this,t);(i[n]||(i[n]=[])).push({type:t,handler:e})}return this},off(t,e){const n=this.eventName(t),i=this._handlers[n],r=this._handlerIndex(i,t,e);if(r>=0){i.splice(r,1)}return this},pickEvent(t){const e=Fb(t,this._canvas),n=this._origin;return this.pick(this._scene,e[0],e[1],e[0]-n[0],e[1]-n[1])},pick(t,e,n,i,r){const a=this.context(),o=pb[t.marktype];return o.pick.call(this,a,t,e,n,i,r)}});function sw(){return typeof window!=="undefined"?window.devicePixelRatio||1:1}var lw=sw();function fw(t,e,n,i,r,a){const o=typeof HTMLElement!=="undefined"&&t instanceof HTMLElement&&t.parentNode!=null,u=t.getContext("2d"),s=o?lw:r;t.width=e*s;t.height=n*s;for(const l in a){u[l]=a[l]}if(o&&s!==1){t.style.width=e+"px";t.style.height=n+"px"}u.pixelRatio=s;u.setTransform(s,0,0,s,s*i[0],s*i[1]);return t}function cw(t){Nb.call(this,t);this._options={};this._redraw=false;this._dirty=new Rv;this._tempb=new Rv}const hw=Nb.prototype;const dw=(t,e,n)=>(new Rv).set(0,0,e,n).translate(-t[0],-t[1]);function pw(t,e,n){e.expand(1).round();if(t.pixelRatio%1){e.scale(t.pixelRatio).round().scale(1/t.pixelRatio)}e.translate(-(n[0]%1),-(n[1]%1));t.beginPath();t.rect(e.x1,e.y1,e.width(),e.height());t.clip();return e}(0,g.XW)(cw,Nb,{initialize(t,e,n,i,r,a){this._options=a||{};this._canvas=this._options.externalContext?null:Vc(1,1,this._options.type);if(t&&this._canvas){Db(t,0).appendChild(this._canvas);this._canvas.setAttribute("class","marks")}return hw.initialize.call(this,t,e,n,i,r)},resize(t,e,n,i){hw.resize.call(this,t,e,n,i);if(this._canvas){fw(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context)}else{const t=this._options.externalContext;if(!t)(0,g.vU)("CanvasRenderer is missing a valid canvas or context");t.scale(this._scale,this._scale);t.translate(this._origin[0],this._origin[1])}this._redraw=true;return this},canvas(){return this._canvas},context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)},dirty(t){const e=this._tempb.clear().union(t.bounds);let n=t.mark.group;while(n){e.translate(n.x||0,n.y||0);n=n.mark.group}this._dirty.union(e)},_render(t){const e=this.context(),n=this._origin,i=this._width,r=this._height,a=this._dirty,o=dw(n,i,r);e.save();const u=this._redraw||a.empty()?(this._redraw=false,o.expand(1)):pw(e,o.intersect(a),n);this.clear(-n[0],-n[1],i,r);this.draw(e,t,u);e.restore();a.clear();return this},draw(t,e,n){const i=pb[e.marktype];if(e.clip)Gx(t,e);i.draw.call(this,t,e,n);if(e.clip)t.restore()},clear(t,e,n,i){const r=this._options,a=this.context();if(r.type!=="pdf"&&!r.externalContext){a.clearRect(t,e,n,i)}if(this._bgcolor!=null){a.fillStyle=this._bgcolor;a.fillRect(t,e,n,i)}}});function gw(t,e){Tb.call(this,t,e);const n=this;n._hrefHandler=mw(n,((t,e)=>{if(e&&e.href)n.handleHref(t,e,e.href)}));n._tooltipHandler=mw(n,((t,e)=>{n.handleTooltip(t,e,t.type!==tw)}))}const mw=(t,e)=>n=>{let i=n.target.__data__;i=Array.isArray(i)?i[0]:i;n.vegaType=n.type;e.call(t._obj,n,i)};(0,g.XW)(gw,Tb,{initialize(t,e,n){let i=this._svg;if(i){i.removeEventListener(ew,this._hrefHandler);i.removeEventListener(Qb,this._tooltipHandler);i.removeEventListener(tw,this._tooltipHandler)}this._svg=i=t&&Ab(t,"svg");if(i){i.addEventListener(ew,this._hrefHandler);i.addEventListener(Qb,this._tooltipHandler);i.addEventListener(tw,this._tooltipHandler)}return Tb.prototype.initialize.call(this,t,e,n)},canvas(){return this._svg},on(t,e){const n=this.eventName(t),i=this._handlers,r=this._handlerIndex(i[n],t,e);if(r<0){const r={type:t,handler:e,listener:mw(this,e)};(i[n]||(i[n]=[])).push(r);if(this._svg){this._svg.addEventListener(n,r.listener)}}return this},off(t,e){const n=this.eventName(t),i=this._handlers[n],r=this._handlerIndex(i,t,e);if(r>=0){if(this._svg){this._svg.removeEventListener(n,i[r].listener)}i.splice(r,1)}return this}});const yw="aria-hidden";const vw="aria-label";const xw="role";const _w="aria-roledescription";const bw="graphics-object";const ww="graphics-symbol";const kw=(t,e,n)=>({[xw]:t,[_w]:e,[vw]:n||undefined});const Mw=(0,g.Rg)(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]);const Aw={axis:{desc:"axis",caption:Bw},legend:{desc:"legend",caption:Nw},"title-text":{desc:"title",caption:t=>`Title text '${Tw(t)}'`},"title-subtitle":{desc:"subtitle",caption:t=>`Subtitle text '${Tw(t)}'`}};const Ew={ariaRole:xw,ariaRoleDescription:_w,description:vw};function Dw(t,e){const n=e.aria===false;t(yw,n||undefined);if(n||e.description==null){for(const e in Ew){t(Ew[e],undefined)}}else{const n=e.mark.marktype;t(vw,e.description);t(xw,e.ariaRole||(n==="group"?bw:ww));t(_w,e.ariaRoleDescription||`${n} mark`)}}function Cw(t){return t.aria===false?{[yw]:true}:Mw[t.role]?null:Aw[t.role]?Sw(t,Aw[t.role]):Fw(t)}function Fw(t){const e=t.marktype;const n=e==="group"||e==="text"||t.items.some((t=>t.description!=null&&t.aria!==false));return kw(n?bw:ww,`${e} mark container`,t.description)}function Sw(t,e){try{const n=t.items[0],i=e.caption||(()=>"");return kw(e.role||ww,e.desc,n.description||i(n))}catch(n){return null}}function Tw(t){return(0,g.IX)(t.text).join(" ")}function Bw(t){const e=t.datum,n=t.orient,i=e.title?zw(t):null,r=t.context,a=r.scales[e.scale].value,o=r.dataflow.locale(),u=a.type,s=n==="left"||n==="right"?"Y":"X";return`${s}-axis`+(i?` titled '${i}'`:"")+` for a ${vm(u)?"discrete":u} scale`+` with ${fy(o,a,t)}`}function Nw(t){const e=t.datum,n=e.title?zw(t):null,i=`${e.type||""} legend`.trim(),r=e.scales,a=Object.keys(r),o=t.context,u=o.scales[r[a[0]]].value,s=o.dataflow.locale();return Rw(i)+(n?` titled '${n}'`:"")+` for ${Ow(a)}`+` with ${fy(s,u,t)}`}function zw(t){try{return(0,g.IX)((0,g.fj)(t.items).items[0].text).join(" ")}catch(e){return null}}function Ow(t){t=t.map((t=>t+(t==="fill"||t==="stroke"?" color":"")));return t.length<2?t[0]:t.slice(0,-1).join(", ")+" and "+(0,g.fj)(t)}function Rw(t){return t.length?t[0].toUpperCase()+t.slice(1):t}const Uw=t=>(t+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");const $w=t=>Uw(t).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;");function Pw(){let t="",e="",n="";const i=[],r=()=>e=n="",a=a=>{if(e){t+=`${e}>${n}`;r()}i.push(a)},o=(t,n)=>{if(n!=null)e+=` ${t}="${$w(n)}"`;return u},u={open(t,...n){a(t);e="<"+t;for(const e of n){for(const t in e)o(t,e[t])}return u},close(){const a=i.pop();if(e){t+=e+(n?`>${n}</${a}>`:"/>")}else{t+=`</${a}>`}r();return u},attr:o,text:t=>(n+=Uw(t),u),toString:()=>t};return u}const qw=t=>Iw(Pw(),t)+"";function Iw(t,e){t.open(e.tagName);if(e.hasAttributes()){const n=e.attributes,i=n.length;for(let e=0;e<i;++e){t.attr(n[e].name,n[e].value)}}if(e.hasChildNodes()){const n=e.childNodes,i=n.length;for(let e=0;e<i;e++){const i=n[e];i.nodeType===3?t.text(i.nodeValue):Iw(t,i)}}return t.close()}const Lw={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity",blend:"mix-blend-mode"};const jw={fill:"none","stroke-miterlimit":10};const Ww=0,Xw="http://www.w3.org/2000/xmlns/",Hw=d_.xmlns;function Yw(t){Nb.call(this,t);this._dirtyID=0;this._dirty=[];this._svg=null;this._root=null;this._defs=null}const Jw=Nb.prototype;(0,g.XW)(Yw,Nb,{initialize(t,e,n,i,r){this._defs={};this._clearDefs();if(t){this._svg=Eb(t,0,"svg",Hw);this._svg.setAttributeNS(Xw,"xmlns",Hw);this._svg.setAttributeNS(Xw,"xmlns:xlink",d_["xmlns:xlink"]);this._svg.setAttribute("version",d_["version"]);this._svg.setAttribute("class","marks");Db(t,1);this._root=Eb(this._svg,Ww,"g",Hw);ok(this._root,jw);Db(this._svg,Ww+1)}this.background(this._bgcolor);return Jw.initialize.call(this,t,e,n,i,r)},background(t){if(arguments.length&&this._svg){this._svg.style.setProperty("background-color",t)}return Jw.background.apply(this,arguments)},resize(t,e,n,i){Jw.resize.call(this,t,e,n,i);if(this._svg){ok(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`});this._root.setAttribute("transform",`translate(${this._origin})`)}this._dirty=[];return this},canvas(){return this._svg},svg(){const t=this._svg,e=this._bgcolor;if(!t)return null;let n;if(e){t.removeAttribute("style");n=Eb(t,Ww,"rect",Hw);ok(n,{width:this._width,height:this._height,fill:e})}const i=qw(t);if(e){t.removeChild(n);this._svg.style.setProperty("background-color",e)}return i},_render(t){if(this._dirtyCheck()){if(this._dirtyAll)this._clearDefs();this.mark(this._root,t);Db(this._root,1)}this.defs();this._dirty=[];++this._dirtyID;return this},dirty(t){if(t.dirty!==this._dirtyID){t.dirty=this._dirtyID;this._dirty.push(t)}},isDirty(t){return this._dirtyAll||!t._svg||t.dirty===this._dirtyID},_dirtyCheck(){this._dirtyAll=true;const t=this._dirty;if(!t.length||!this._dirtyID)return true;const e=++this._dirtyID;let n,i,r,a,o,u,s;for(o=0,u=t.length;o<u;++o){n=t[o];i=n.mark;if(i.marktype!==r){r=i.marktype;a=pb[r]}if(i.zdirty&&i.dirty!==e){this._dirtyAll=false;Vw(n,e);i.items.forEach((t=>{t.dirty=e}))}if(i.zdirty)continue;if(n.exit){if(a.nested&&i.items.length){s=i.items[0];if(s._svg)this._update(a,s._svg,s)}else if(n._svg){s=n._svg.parentNode;if(s)s.removeChild(n._svg)}n._svg=null;continue}n=a.nested?i.items[0]:n;if(n._update===e)continue;if(!n._svg||!n._svg.ownerSVGElement){this._dirtyAll=false;Vw(n,e)}else{this._update(a,n._svg,n)}n._update=e}return!this._dirtyAll},mark(t,e,n){if(!this.isDirty(e))return e._svg;const i=this._svg,r=pb[e.marktype],a=e.interactive===false?"none":null,o=r.tag==="g";let u=null,s=0;const l=Qw(e,t,n,"g",i);l.setAttribute("class",Cb(e));const f=Cw(e);for(const h in f)uk(l,h,f[h]);if(!o){uk(l,"pointer-events",a)}uk(l,"clip-path",e.clip?Ov(this,e,e.group):null);const c=t=>{const e=this.isDirty(t),n=Qw(t,l,u,r.tag,i);if(e){this._update(r,n,t);if(o)Zw(this,n,t)}u=n;++s};if(r.nested){if(e.items.length)c(e.items[0])}else{Fx(e,c)}Db(l,s);return l},_update(t,e,n){ek=e;nk=e.__values__;Dw(rk,n);t.attr(rk,n,this);const i=ik[t.type];if(i)i.call(this,t,e,n);if(ek)this.style(ek,n)},style(t,e){if(e==null)return;for(const n in Lw){let i=n==="font"?eb(e):e[n];if(i===nk[n])continue;const r=Lw[n];if(i==null){t.removeAttribute(r)}else{if(py(i)){i=gy(i,this._defs.gradient,lk())}t.setAttribute(r,i+"")}nk[n]=i}},defs(){const t=this._svg,e=this._defs;let n=e.el,i=0;for(const r in e.gradient){if(!n)e.el=n=Eb(t,Ww+1,"defs",Hw);i=Gw(n,e.gradient[r],i)}for(const r in e.clipping){if(!n)e.el=n=Eb(t,Ww+1,"defs",Hw);i=Kw(n,e.clipping[r],i)}if(n){i===0?(t.removeChild(n),e.el=null):Db(n,i)}},_clearDefs(){const t=this._defs;t.gradient={};t.clipping={}}});function Vw(t,e){for(;t&&t.dirty!==e;t=t.mark.group){t.dirty=e;if(t.mark&&t.mark.dirty!==e){t.mark.dirty=e}else return}}function Gw(t,e,n){let i,r,a;if(e.gradient==="radial"){let i=Eb(t,n++,"pattern",Hw);ok(i,{id:dy+e.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"});i=Eb(i,0,"rect",Hw);ok(i,{width:1,height:1,fill:`url(${lk()}#${e.id})`});t=Eb(t,n++,"radialGradient",Hw);ok(t,{id:e.id,fx:e.x1,fy:e.y1,fr:e.r1,cx:e.x2,cy:e.y2,r:e.r2})}else{t=Eb(t,n++,"linearGradient",Hw);ok(t,{id:e.id,x1:e.x1,x2:e.x2,y1:e.y1,y2:e.y2})}for(i=0,r=e.stops.length;i<r;++i){a=Eb(t,i,"stop",Hw);a.setAttribute("offset",e.stops[i].offset);a.setAttribute("stop-color",e.stops[i].color)}Db(t,i);return n}function Kw(t,e,n){let i;t=Eb(t,n,"clipPath",Hw);t.setAttribute("id",e.id);if(e.path){i=Eb(t,0,"path",Hw);i.setAttribute("d",e.path)}else{i=Eb(t,0,"rect",Hw);ok(i,{x:0,y:0,width:e.width,height:e.height})}Db(t,1);return n+1}function Zw(t,e,n){e=e.lastChild.previousSibling;let i,r=0;Fx(n,(n=>{i=t.mark(e,n,i);++r}));Db(e,1+r)}function Qw(t,e,n,i,r){let a=t._svg,o;if(!a){o=e.ownerDocument;a=Mb(o,i,Hw);t._svg=a;if(t.mark){a.__data__=t;a.__values__={fill:"default"};if(i==="g"){const e=Mb(o,"path",Hw);a.appendChild(e);e.__data__=t;const n=Mb(o,"g",Hw);a.appendChild(n);n.__data__=t;const i=Mb(o,"path",Hw);a.appendChild(i);i.__data__=t;i.__values__={fill:"default"}}}}if(a.ownerSVGElement!==r||tk(a,n)){e.insertBefore(a,n?n.nextSibling:e.firstChild)}return a}function tk(t,e){return t.parentNode&&t.parentNode.childNodes.length>1&&t.previousSibling!=e}let ek=null,nk=null;const ik={group(t,e,n){const i=ek=e.childNodes[2];nk=i.__values__;t.foreground(rk,n,this);nk=e.__values__;ek=e.childNodes[1];t.content(rk,n,this);const r=ek=e.childNodes[0];t.background(rk,n,this);const a=n.mark.interactive===false?"none":null;if(a!==nk.events){uk(i,"pointer-events",a);uk(r,"pointer-events",a);nk.events=a}if(n.strokeForeground&&n.stroke){const t=n.fill;uk(i,"display",null);this.style(r,n);uk(r,"stroke",null);if(t)n.fill=null;nk=i.__values__;this.style(i,n);if(t)n.fill=t;ek=null}else{uk(i,"display","none")}},image(t,e,n){if(n.smooth===false){ak(e,"image-rendering","optimizeSpeed");ak(e,"image-rendering","pixelated")}else{ak(e,"image-rendering",null)}},text(t,e,n){const i=G_(n);let r,a,o,u;if((0,g.kJ)(i)){a=i.map((t=>Z_(n,t)));r=a.join("\n");if(r!==nk.text){Db(e,0);o=e.ownerDocument;u=J_(n);a.forEach(((t,i)=>{const r=Mb(o,"tspan",Hw);r.__data__=n;r.textContent=t;if(i){r.setAttribute("x",0);r.setAttribute("dy",u)}e.appendChild(r)}));nk.text=r}}else{a=Z_(n,i);if(a!==nk.text){e.textContent=a;nk.text=a}}uk(e,"font-family",eb(n));uk(e,"font-size",Y_(n)+"px");uk(e,"font-style",n.fontStyle);uk(e,"font-variant",n.fontVariant);uk(e,"font-weight",n.fontWeight)}};function rk(t,e,n){if(e===nk[t])return;if(n){sk(ek,t,e,n)}else{uk(ek,t,e)}nk[t]=e}function ak(t,e,n){if(n!==nk[e]){if(n==null){t.style.removeProperty(e)}else{t.style.setProperty(e,n+"")}nk[e]=n}}function ok(t,e){for(const n in e){uk(t,n,e[n])}}function uk(t,e,n){if(n!=null){t.setAttribute(e,n)}else{t.removeAttribute(e)}}function sk(t,e,n,i){if(n!=null){t.setAttributeNS(i,e,n)}else{t.removeAttributeNS(i,e)}}function lk(){let t;return typeof window==="undefined"?"":(t=window.location).hash?t.href.slice(0,-t.hash.length):t.href}function fk(t){Nb.call(this,t);this._text=null;this._defs={gradient:{},clipping:{}}}(0,g.XW)(fk,Nb,{svg(){return this._text},_render(t){const e=Pw();e.open("svg",(0,g.l7)({},d_,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}));const n=this._bgcolor;if(n&&n!=="transparent"&&n!=="none"){e.open("rect",{width:this._width,height:this._height,fill:n}).close()}e.open("g",jw,{transform:"translate("+this._origin+")"});this.mark(e,t);e.close();this.defs(e);this._text=e.close()+"";return this},mark(t,e){const n=pb[e.marktype],i=n.tag,r=[Dw,n.attr];t.open("g",{class:Cb(e),"clip-path":e.clip?Ov(this,e,e.group):null},Cw(e),{"pointer-events":i!=="g"&&e.interactive===false?"none":null});const a=a=>{const o=this.href(a);if(o)t.open("a",o);t.open(i,this.attr(e,a,r,i!=="g"?i:null));if(i==="text"){const e=G_(a);if((0,g.kJ)(e)){const n={x:0,dy:J_(a)};for(let i=0;i<e.length;++i){t.open("tspan",i?n:null).text(Z_(a,e[i])).close()}}else{t.text(Z_(a,e))}}else if(i==="g"){const i=a.strokeForeground,r=a.fill,o=a.stroke;if(i&&o){a.stroke=null}t.open("path",this.attr(e,a,n.background,"bgrect")).close();t.open("g",this.attr(e,a,n.content));Fx(a,(e=>this.mark(t,e)));t.close();if(i&&o){if(r)a.fill=null;a.stroke=o;t.open("path",this.attr(e,a,n.foreground,"bgrect")).close();if(r)a.fill=r}else{t.open("path",this.attr(e,a,n.foreground,"bgfore")).close()}}t.close();if(o)t.close()};if(n.nested){if(e.items&&e.items.length)a(e.items[0])}else{Fx(e,a)}return t.close()},href(t){const e=t.href;let n;if(e){if(n=this._hrefs&&this._hrefs[e]){return n}else{this.sanitizeURL(e).then((t=>{t["xlink:href"]=t.href;t.href=null;(this._hrefs||(this._hrefs={}))[e]=t}))}}return null},attr(t,e,n,i){const r={},a=(t,e,n,i)=>{r[i||t]=e};if(Array.isArray(n)){n.forEach((t=>t(a,e,this)))}else{n(a,e,this)}if(i){ck(r,e,t,i,this._defs)}return r},defs(t){const e=this._defs.gradient,n=this._defs.clipping,i=Object.keys(e).length+Object.keys(n).length;if(i===0)return;t.open("defs");for(const r in e){const n=e[r],i=n.stops;if(n.gradient==="radial"){t.open("pattern",{id:dy+r,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"});t.open("rect",{width:"1",height:"1",fill:"url(#"+r+")"}).close();t.close();t.open("radialGradient",{id:r,fx:n.x1,fy:n.y1,fr:n.r1,cx:n.x2,cy:n.y2,r:n.r2})}else{t.open("linearGradient",{id:r,x1:n.x1,x2:n.x2,y1:n.y1,y2:n.y2})}for(let e=0;e<i.length;++e){t.open("stop",{offset:i[e].offset,"stop-color":i[e].color}).close()}t.close()}for(const r in n){const e=n[r];t.open("clipPath",{id:r});if(e.path){t.open("path",{d:e.path}).close()}else{t.open("rect",{x:0,y:0,width:e.width,height:e.height}).close()}t.close()}t.close()}});function ck(t,e,n,i,r){if(e==null)return t;if(i==="bgrect"&&n.interactive===false){t["pointer-events"]="none"}if(i==="bgfore"){if(n.interactive===false){t["pointer-events"]="none"}t.display="none";if(e.fill!==null)return t}if(i==="image"&&e.smooth===false){t.style="image-rendering: optimizeSpeed; image-rendering: pixelated;"}if(i==="text"){t["font-family"]=eb(e);t["font-size"]=Y_(e)+"px";t["font-style"]=e.fontStyle;t["font-variant"]=e.fontVariant;t["font-weight"]=e.fontWeight}for(const a in Lw){let n=e[a];const i=Lw[a];if(n==="transparent"&&(i==="fill"||i==="stroke"));else if(n!=null){if(py(n)){n=gy(n,r.gradient,"")}t[i]=n}}return t}const hk="canvas";const dk="png";const pk="svg";const gk="none";const mk={Canvas:hk,PNG:dk,SVG:pk,None:gk};const yk={};yk[hk]=yk[dk]={renderer:cw,headless:cw,handler:nw};yk[pk]={renderer:Yw,headless:fk,handler:gw};yk[gk]={};function vk(t,e){t=String(t||"").toLowerCase();if(arguments.length>1){yk[t]=e;return this}else{return yk[t]}}function xk(t,e,n){const i=[],r=(new Rv).union(e),a=t.marktype;return a?_k(t,r,n,i):a==="group"?wk(t,r,n,i):(0,g.vU)("Intersect scene must be mark node or group item.")}function _k(t,e,n,i){if(bk(t,e,n)){const r=t.items,a=t.marktype,o=r.length;let u=0;if(a==="group"){for(;u<o;++u){wk(r[u],e,n,i)}}else{for(const t=pb[a].isect;u<o;++u){const n=r[u];if(kk(n,e,t))i.push(n)}}}return i}function bk(t,e,n){return t.bounds&&e.intersects(t.bounds)&&(t.marktype==="group"||t.interactive!==false&&(!n||n(t)))}function wk(t,e,n,i){if(n&&n(t.mark)&&kk(t,e,pb.group.isect)){i.push(t)}const r=t.items,a=r&&r.length;if(a){const o=t.x||0,u=t.y||0;e.translate(-o,-u);for(let t=0;t<a;++t){_k(r[t],e,n,i)}e.translate(o,u)}return i}function kk(t,e,n){const i=t.bounds;return e.encloses(i)||e.intersects(i)&&n(t,e)}const Mk=new Rv;function Ak(t){const e=t.clip;if((0,g.mf)(e)){e(ux(Mk.clear()))}else if(e){Mk.set(0,0,t.group.width,t.group.height)}else return;t.bounds.intersect(Mk)}const Ek=1e-9;function Dk(t,e,n){return t===e?true:n==="path"?Ck(t,e):t instanceof Date&&e instanceof Date?+t===+e:(0,g.hj)(t)&&(0,g.hj)(e)?Math.abs(t-e)<=Ek:!t||!e||!(0,g.Kn)(t)&&!(0,g.Kn)(e)?t==e:Fk(t,e)}function Ck(t,e){return Dk(wy(t),wy(e))}function Fk(t,e){var n=Object.keys(t),i=Object.keys(e),r,a;if(n.length!==i.length)return false;n.sort();i.sort();for(a=n.length-1;a>=0;a--){if(n[a]!=i[a])return false}for(a=n.length-1;a>=0;a--){r=n[a];if(!Dk(t[r],e[r],r))return false}return typeof t===typeof e}function Sk(){zv();hy()}const Tk="top";const Bk="left";const Nk="right";const zk="bottom";const Ok="top-left";const Rk="top-right";const Uk="bottom-left";const $k="bottom-right";const Pk="start";const qk="middle";const Ik="end";const Lk="x";const jk="y";const Wk="group";const Xk="axis";const Hk="title";const Yk="frame";const Jk="scope";const Vk="legend";const Gk="row-header";const Kk="row-footer";const Zk="row-title";const Qk="column-header";const tM="column-footer";const eM="column-title";const nM="padding";const iM="symbol";const rM="fit";const aM="fit-x";const oM="fit-y";const uM="pad";const sM="none";const lM="all";const fM="each";const cM="flush";const hM="column";const dM="row";function pM(t){Wo.call(this,null,t)}(0,g.XW)(pM,Wo,{transform(t,e){const n=e.dataflow,i=t.mark,r=i.marktype,a=pb[r],o=a.bound;let u=i.bounds,s;if(a.nested){if(i.items.length)n.dirty(i.items[0]);u=gM(i,o);i.items.forEach((t=>{t.bounds.clear().union(u)}))}else if(r===Wk||t.modified()){e.visit(e.MOD,(t=>n.dirty(t)));u.clear();i.items.forEach((t=>u.union(gM(t,o))));switch(i.role){case Xk:case Vk:case Hk:e.reflow()}}else{s=e.changed(e.REM);e.visit(e.ADD,(t=>{u.union(gM(t,o))}));e.visit(e.MOD,(t=>{s=s||u.alignsWith(t.bounds);n.dirty(t);u.union(gM(t,o))}));if(s){u.clear();i.items.forEach((t=>u.union(t.bounds)))}}Ak(i);return e.modifies("bounds")}});function gM(t,e,n){return e(t.bounds.clear(),t,n)}const mM=":vega_identifier:";function yM(t){Wo.call(this,0,t)}yM.Definition={type:"Identifier",metadata:{modifies:true},params:[{name:"as",type:"string",required:true}]};(0,g.XW)(yM,Wo,{transform(t,e){const n=vM(e.dataflow),i=t.as;let r=n.value;e.visit(e.ADD,(t=>t[i]=t[i]||++r));n.set(this.value=r);return e}});function vM(t){return t._signals[mM]||(t._signals[mM]=t.add(0))}function xM(t){Wo.call(this,null,t)}(0,g.XW)(xM,Wo,{transform(t,e){let n=this.value;if(!n){n=e.dataflow.scenegraph().mark(t.markdef,_M(t),t.index);n.group.context=t.context;if(!t.context.group)t.context.group=n.group;n.source=this.source;n.clip=t.clip;n.interactive=t.interactive;this.value=n}const i=n.marktype===Wk?$v:Uv;e.visit(e.ADD,(t=>i.call(t,n)));if(t.modified("clip")||t.modified("interactive")){n.clip=t.clip;n.interactive=!!t.interactive;n.zdirty=true;e.reflow()}n.items=e.source;return e}});function _M(t){const e=t.groups,n=t.parent;return e&&e.size===1?e.get(Object.keys(e.object)[0]):e&&n?e.lookup(n):null}function bM(t){Wo.call(this,null,t)}const wM={parity:t=>t.filter(((t,e)=>e%2?t.opacity=0:1)),greedy:(t,e)=>{let n;return t.filter(((t,i)=>!i||!kM(n.bounds,t.bounds,e)?(n=t,1):t.opacity=0))}};const kM=(t,e,n)=>n>Math.max(e.x1-t.x2,t.x1-e.x2,e.y1-t.y2,t.y1-e.y2);const MM=(t,e)=>{for(var n=1,i=t.length,r=t[0].bounds,a;n<i;r=a,++n){if(kM(r,a=t[n].bounds,e))return true}};const AM=t=>{const e=t.bounds;return e.width()>1&&e.height()>1};const EM=(t,e,n)=>{var i=t.range(),r=new Rv;if(e===Tk||e===zk){r.set(i[0],-Infinity,i[1],+Infinity)}else{r.set(-Infinity,i[0],+Infinity,i[1])}r.expand(n||1);return t=>r.encloses(t.bounds)};const DM=t=>{t.forEach((t=>t.opacity=1));return t};const CM=(t,e)=>t.reflow(e.modified()).modifies("opacity");(0,g.XW)(bM,Wo,{transform(t,e){const n=wM[t.method]||wM.parity,i=t.separation||0;let r=e.materialize(e.SOURCE).source,a,o;if(!r||!r.length)return;if(!t.method){if(t.modified("method")){DM(r);e=CM(e,t)}return e}r=r.filter(AM);if(!r.length)return;if(t.sort){r=r.slice().sort(t.sort)}a=DM(r);e=CM(e,t);if(a.length>=3&&MM(a,i)){do{a=n(a,i)}while(a.length>=3&&MM(a,i));if(a.length<3&&!(0,g.fj)(r).opacity){if(a.length>1)(0,g.fj)(a).opacity=0;(0,g.fj)(r).opacity=1}}if(t.boundScale&&t.boundTolerance>=0){o=EM(t.boundScale,t.boundOrient,+t.boundTolerance);r.forEach((t=>{if(!o(t))t.opacity=0}))}const u=a[0].mark.bounds.clear();r.forEach((t=>{if(t.opacity)u.union(t.bounds)}));return e}});function FM(t){Wo.call(this,null,t)}(0,g.XW)(FM,Wo,{transform(t,e){const n=e.dataflow;e.visit(e.ALL,(t=>n.dirty(t)));if(e.fields&&e.fields["zindex"]){const t=e.source&&e.source[0];if(t)t.mark.zdirty=true}}});const SM=new Rv;function TM(t,e,n){return t[e]===n?0:(t[e]=n,1)}function BM(t){var e=t.items[0].orient;return e===Bk||e===Nk}function NM(t){let e=+t.grid;return[t.ticks?e++:-1,t.labels?e++:-1,e+ +t.domain]}function zM(t,e,n,i){var r=e.items[0],a=r.datum,o=r.translate!=null?r.translate:.5,u=r.orient,s=NM(a),l=r.range,f=r.offset,c=r.position,h=r.minExtent,d=r.maxExtent,p=a.title&&r.items[s[2]].items[0],g=r.titlePadding,m=r.bounds,y=p&&K_(p),v=0,x=0,_,b;SM.clear().union(m);m.clear();if((_=s[0])>-1)m.union(r.items[_].bounds);if((_=s[1])>-1)m.union(r.items[_].bounds);switch(u){case Tk:v=c||0;x=-f;b=Math.max(h,Math.min(d,-m.y1));m.add(0,-b).add(l,0);if(p)OM(t,p,b,g,y,0,-1,m);break;case Bk:v=-f;x=c||0;b=Math.max(h,Math.min(d,-m.x1));m.add(-b,0).add(0,l);if(p)OM(t,p,b,g,y,1,-1,m);break;case Nk:v=n+f;x=c||0;b=Math.max(h,Math.min(d,m.x2));m.add(0,0).add(b,l);if(p)OM(t,p,b,g,y,1,1,m);break;case zk:v=c||0;x=i+f;b=Math.max(h,Math.min(d,m.y2));m.add(0,0).add(l,b);if(p)OM(t,p,b,g,0,0,1,m);break;default:v=r.x;x=r.y}Lv(m.translate(v,x),r);if(TM(r,"x",v+o)|TM(r,"y",x+o)){r.bounds=SM;t.dirty(r);r.bounds=m;t.dirty(r)}return r.mark.bounds.clear().union(m)}function OM(t,e,n,i,r,a,o,u){const s=e.bounds;if(e.auto){const u=o*(n+r+i);let l=0,f=0;t.dirty(e);a?l=(e.x||0)-(e.x=u):f=(e.y||0)-(e.y=u);e.mark.bounds.clear().union(s.translate(-l,-f));t.dirty(e)}u.union(s)}const RM=(t,e)=>Math.floor(Math.min(t,e));const UM=(t,e)=>Math.ceil(Math.max(t,e));function $M(t){var e=t.items,n=e.length,i=0,r,a;const o={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};for(;i<n;++i){r=e[i];a=r.items;if(r.marktype===Wk){switch(r.role){case Xk:case Vk:case Hk:break;case Gk:o.rowheaders.push(...a);break;case Kk:o.rowfooters.push(...a);break;case Qk:o.colheaders.push(...a);break;case tM:o.colfooters.push(...a);break;case Zk:o.rowtitle=a[0];break;case eM:o.coltitle=a[0];break;default:o.marks.push(...a)}}}return o}function PM(t){return(new Rv).set(0,0,t.width||0,t.height||0)}function qM(t){const e=t.bounds.clone();return e.empty()?e.set(0,0,0,0):e.translate(-(t.x||0),-(t.y||0))}function IM(t,e,n){const i=(0,g.Kn)(t)?t[e]:t;return i!=null?i:n!==undefined?n:0}function LM(t){return t<0?Math.ceil(-t):0}function jM(t,e,n){var i=!n.nodirty,r=n.bounds===cM?PM:qM,a=SM.set(0,0,0,0),o=IM(n.align,hM),u=IM(n.align,dM),s=IM(n.padding,hM),l=IM(n.padding,dM),f=n.columns||e.length,c=f<=0?1:Math.ceil(e.length/f),h=e.length,d=Array(h),p=Array(f),g=0,m=Array(h),y=Array(c),v=0,x=Array(h),_=Array(h),b=Array(h),w,k,M,A,E,D,C,F,S,T,B;for(k=0;k<f;++k)p[k]=0;for(k=0;k<c;++k)y[k]=0;for(k=0;k<h;++k){D=e[k];E=b[k]=r(D);D.x=D.x||0;x[k]=0;D.y=D.y||0;_[k]=0;M=k%f;A=~~(k/f);g=Math.max(g,C=Math.ceil(E.x2));v=Math.max(v,F=Math.ceil(E.y2));p[M]=Math.max(p[M],C);y[A]=Math.max(y[A],F);d[k]=s+LM(E.x1);m[k]=l+LM(E.y1);if(i)t.dirty(e[k])}for(k=0;k<h;++k){if(k%f===0)d[k]=0;if(k<f)m[k]=0}if(o===fM){for(M=1;M<f;++M){for(B=0,k=M;k<h;k+=f){if(B<d[k])B=d[k]}for(k=M;k<h;k+=f){d[k]=B+p[M-1]}}}else if(o===lM){for(B=0,k=0;k<h;++k){if(k%f&&B<d[k])B=d[k]}for(k=0;k<h;++k){if(k%f)d[k]=B+g}}else{for(o=false,M=1;M<f;++M){for(k=M;k<h;k+=f){d[k]+=p[M-1]}}}if(u===fM){for(A=1;A<c;++A){for(B=0,k=A*f,w=k+f;k<w;++k){if(B<m[k])B=m[k]}for(k=A*f;k<w;++k){m[k]=B+y[A-1]}}}else if(u===lM){for(B=0,k=f;k<h;++k){if(B<m[k])B=m[k]}for(k=f;k<h;++k){m[k]=B+v}}else{for(u=false,A=1;A<c;++A){for(k=A*f,w=k+f;k<w;++k){m[k]+=y[A-1]}}}for(S=0,k=0;k<h;++k){S=d[k]+(k%f?S:0);x[k]+=S-e[k].x}for(M=0;M<f;++M){for(T=0,k=M;k<h;k+=f){T+=m[k];_[k]+=T-e[k].y}}if(o&&IM(n.center,hM)&&c>1){for(k=0;k<h;++k){E=o===lM?g:p[k%f];S=E-b[k].x2-e[k].x-x[k];if(S>0)x[k]+=S/2}}if(u&&IM(n.center,dM)&&f!==1){for(k=0;k<h;++k){E=u===lM?v:y[~~(k/f)];T=E-b[k].y2-e[k].y-_[k];if(T>0)_[k]+=T/2}}for(k=0;k<h;++k){a.union(b[k].translate(x[k],_[k]))}S=IM(n.anchor,Lk);T=IM(n.anchor,jk);switch(IM(n.anchor,hM)){case Ik:S-=a.width();break;case qk:S-=a.width()/2}switch(IM(n.anchor,dM)){case Ik:T-=a.height();break;case qk:T-=a.height()/2}S=Math.round(S);T=Math.round(T);a.clear();for(k=0;k<h;++k){e[k].mark.bounds.clear()}for(k=0;k<h;++k){D=e[k];D.x+=x[k]+=S;D.y+=_[k]+=T;a.union(D.mark.bounds.union(D.bounds.translate(x[k],_[k])));if(i)t.dirty(D)}return a}function WM(t,e,n){var i=$M(e),r=i.marks,a=n.bounds===cM?XM:HM,o=n.offset,u=n.columns||r.length,s=u<=0?1:Math.ceil(r.length/u),l=s*u,f,c,h,d,p,g,m;const y=jM(t,r,n);if(y.empty())y.set(0,0,0,0);if(i.rowheaders){g=IM(n.headerBand,dM,null);f=YM(t,i.rowheaders,r,u,s,-IM(o,"rowHeader"),RM,0,a,"x1",0,u,1,g)}if(i.colheaders){g=IM(n.headerBand,hM,null);c=YM(t,i.colheaders,r,u,u,-IM(o,"columnHeader"),RM,1,a,"y1",0,1,u,g)}if(i.rowfooters){g=IM(n.footerBand,dM,null);h=YM(t,i.rowfooters,r,u,s,IM(o,"rowFooter"),UM,0,a,"x2",u-1,u,1,g)}if(i.colfooters){g=IM(n.footerBand,hM,null);d=YM(t,i.colfooters,r,u,u,IM(o,"columnFooter"),UM,1,a,"y2",l-u,1,u,g)}if(i.rowtitle){p=IM(n.titleAnchor,dM);m=IM(o,"rowTitle");m=p===Ik?h+m:f-m;g=IM(n.titleBand,dM,.5);JM(t,i.rowtitle,m,0,y,g)}if(i.coltitle){p=IM(n.titleAnchor,hM);m=IM(o,"columnTitle");m=p===Ik?d+m:c-m;g=IM(n.titleBand,hM,.5);JM(t,i.coltitle,m,1,y,g)}}function XM(t,e){return e==="x1"?t.x||0:e==="y1"?t.y||0:e==="x2"?(t.x||0)+(t.width||0):e==="y2"?(t.y||0)+(t.height||0):undefined}function HM(t,e){return t.bounds[e]}function YM(t,e,n,i,r,a,o,u,s,l,f,c,h,d){var p=n.length,g=0,m=0,y,v,x,_,b,w,k,M,A;if(!p)return g;for(y=f;y<p;y+=c){if(n[y])g=o(g,s(n[y],l))}if(!e.length)return g;if(e.length>r){t.warn("Grid headers exceed limit: "+r);e=e.slice(0,r)}g+=a;for(v=0,_=e.length;v<_;++v){t.dirty(e[v]);e[v].mark.bounds.clear()}for(y=f,v=0,_=e.length;v<_;++v,y+=c){w=e[v];b=w.mark.bounds;for(x=y;x>=0&&(k=n[x])==null;x-=h);if(u){M=d==null?k.x:Math.round(k.bounds.x1+d*k.bounds.width());A=g}else{M=g;A=d==null?k.y:Math.round(k.bounds.y1+d*k.bounds.height())}b.union(w.bounds.translate(M-(w.x||0),A-(w.y||0)));w.x=M;w.y=A;t.dirty(w);m=o(m,b[l])}return m}function JM(t,e,n,i,r,a){if(!e)return;t.dirty(e);var o=n,u=n;i?o=Math.round(r.x1+a*r.width()):u=Math.round(r.y1+a*r.height());e.bounds.translate(o-(e.x||0),u-(e.y||0));e.mark.bounds.clear().union(e.bounds);e.x=o;e.y=u;t.dirty(e)}function VM(t,e){const n=t[e]||{};return(e,i)=>n[e]!=null?n[e]:t[e]!=null?t[e]:i}function GM(t,e){let n=-Infinity;t.forEach((t=>{if(t.offset!=null)n=Math.max(n,t.offset)}));return n>-Infinity?n:e}function KM(t,e,n,i,r,a,o){const u=VM(n,e),s=GM(t,u("offset",0)),l=u("anchor",Pk),f=l===Ik?1:l===qk?.5:0;const c={align:fM,bounds:u("bounds",cM),columns:u("direction")==="vertical"?1:t.length,padding:u("margin",8),center:u("center"),nodirty:true};switch(e){case Bk:c.anchor={x:Math.floor(i.x1)-s,column:Ik,y:f*(o||i.height()+2*i.y1),row:l};break;case Nk:c.anchor={x:Math.ceil(i.x2)+s,y:f*(o||i.height()+2*i.y1),row:l};break;case Tk:c.anchor={y:Math.floor(r.y1)-s,row:Ik,x:f*(a||r.width()+2*r.x1),column:l};break;case zk:c.anchor={y:Math.ceil(r.y2)+s,x:f*(a||r.width()+2*r.x1),column:l};break;case Ok:c.anchor={x:s,y:s};break;case Rk:c.anchor={x:a-s,y:s,column:Ik};break;case Uk:c.anchor={x:s,y:o-s,row:Ik};break;case $k:c.anchor={x:a-s,y:o-s,column:Ik,row:Ik};break}return c}function ZM(t,e){var n=e.items[0],i=n.datum,r=n.orient,a=n.bounds,o=n.x,u=n.y,s,l;n._bounds?n._bounds.clear().union(a):n._bounds=a.clone();a.clear();tA(t,n,n.items[0].items[0]);a=QM(n,a);s=2*n.padding;l=2*n.padding;if(!a.empty()){s=Math.ceil(a.width()+s);l=Math.ceil(a.height()+l)}if(i.type===iM){iA(n.items[0].items[0].items[0].items)}if(r!==sM){n.x=o=0;n.y=u=0}n.width=s;n.height=l;Lv(a.set(o,u,o+s,u+l),n);n.mark.bounds.clear().union(a);return n}function QM(t,e){t.items.forEach((t=>e.union(t.bounds)));e.x1=t.padding;e.y1=t.padding;return e}function tA(t,e,n){var i=e.padding,r=i-n.x,a=i-n.y;if(!e.datum.title){if(r||a)nA(t,n,r,a)}else{var o=e.items[1].items[0],u=o.anchor,s=e.titlePadding||0,l=i-o.x,f=i-o.y;switch(o.orient){case Bk:r+=Math.ceil(o.bounds.width())+s;break;case Nk:case zk:break;default:a+=o.bounds.height()+s}if(r||a)nA(t,n,r,a);switch(o.orient){case Bk:f+=eA(e,n,o,u,1,1);break;case Nk:l+=eA(e,n,o,Ik,0,0)+s;f+=eA(e,n,o,u,1,1);break;case zk:l+=eA(e,n,o,u,0,0);f+=eA(e,n,o,Ik,-1,0,1)+s;break;default:l+=eA(e,n,o,u,0,0)}if(l||f)nA(t,o,l,f);if((l=Math.round(o.bounds.x1-i))<0){nA(t,n,-l,0);nA(t,o,-l,0)}}}function eA(t,e,n,i,r,a,o){const u=t.datum.type!=="symbol",s=n.datum.vgrad,l=u&&(a||!s)&&!o?e.items[0]:e,f=l.bounds[r?"y2":"x2"]-t.padding,c=s&&a?f:0,h=s&&a?0:f,d=r<=0?0:K_(n);return Math.round(i===Pk?c:i===Ik?h-d:.5*(f-d))}function nA(t,e,n,i){e.x+=n;e.y+=i;e.bounds.translate(n,i);e.mark.bounds.translate(n,i);t.dirty(e)}function iA(t){const e=t.reduce(((t,e)=>{t[e.column]=Math.max(e.bounds.x2-e.x,t[e.column]||0);return t}),{});t.forEach((t=>{t.width=e[t.column];t.height=t.bounds.y2-t.y}))}function rA(t,e,n,i,r){var a=e.items[0],o=a.frame,u=a.orient,s=a.anchor,l=a.offset,f=a.padding,c=a.items[0].items[0],h=a.items[1]&&a.items[1].items[0],d=u===Bk||u===Nk?i:n,p=0,g=0,m=0,y=0,v=0,x;if(o!==Wk){u===Bk?(p=r.y2,d=r.y1):u===Nk?(p=r.y1,d=r.y2):(p=r.x1,d=r.x2)}else if(u===Bk){p=i,d=0}x=s===Pk?p:s===Ik?d:(p+d)/2;if(h&&h.text){switch(u){case Tk:case zk:v=c.bounds.height()+f;break;case Bk:y=c.bounds.width()+f;break;case Nk:y=-c.bounds.width()-f;break}SM.clear().union(h.bounds);SM.translate(y-(h.x||0),v-(h.y||0));if(TM(h,"x",y)|TM(h,"y",v)){t.dirty(h);h.bounds.clear().union(SM);h.mark.bounds.clear().union(SM);t.dirty(h)}SM.clear().union(h.bounds)}else{SM.clear()}SM.union(c.bounds);switch(u){case Tk:g=x;m=r.y1-SM.height()-l;break;case Bk:g=r.x1-SM.width()-l;m=x;break;case Nk:g=r.x2+SM.width()+l;m=x;break;case zk:g=x;m=r.y2+l;break;default:g=a.x;m=a.y}if(TM(a,"x",g)|TM(a,"y",m)){SM.translate(g,m);t.dirty(a);a.bounds.clear().union(SM);e.bounds.clear().union(SM);t.dirty(a)}return a.bounds}function aA(t){Wo.call(this,null,t)}(0,g.XW)(aA,Wo,{transform(t,e){const n=e.dataflow;t.mark.items.forEach((e=>{if(t.layout)WM(n,e,t.layout);uA(n,e,t)}));return oA(t.mark.group)?e.reflow():e}});function oA(t){return t&&t.mark.role!=="legend-entry"}function uA(t,e,n){var i=e.items,r=Math.max(0,e.width||0),a=Math.max(0,e.height||0),o=(new Rv).set(0,0,r,a),u=o.clone(),s=o.clone(),l=[],f,c,h,d,p,g;for(p=0,g=i.length;p<g;++p){c=i[p];switch(c.role){case Xk:d=BM(c)?u:s;d.union(zM(t,c,r,a));break;case Hk:f=c;break;case Vk:l.push(ZM(t,c));break;case Yk:case Jk:case Gk:case Kk:case Zk:case Qk:case tM:case eM:u.union(c.bounds);s.union(c.bounds);break;default:o.union(c.bounds)}}if(l.length){const e={};l.forEach((t=>{h=t.orient||Nk;if(h!==sM)(e[h]||(e[h]=[])).push(t)}));for(const i in e){const o=e[i];jM(t,o,KM(o,i,n.legends,u,s,r,a))}l.forEach((e=>{const i=e.bounds;if(!i.equals(e._bounds)){e.bounds=e._bounds;t.dirty(e);e.bounds=i;t.dirty(e)}if(n.autosize&&n.autosize.type===rM){switch(e.orient){case Bk:case Nk:o.add(i.x1,0).add(i.x2,0);break;case Tk:case zk:o.add(0,i.y1).add(0,i.y2)}}else{o.union(i)}}))}o.union(u).union(s);if(f){o.union(rA(t,f,r,a,o))}if(e.clip){o.set(0,0,e.width||0,e.height||0)}sA(t,e,o,n)}function sA(t,e,n,i){const r=i.autosize||{},a=r.type;if(t._autosize<1||!a)return;let o=t._width,u=t._height,s=Math.max(0,e.width||0),l=Math.max(0,Math.ceil(-n.x1)),f=Math.max(0,e.height||0),c=Math.max(0,Math.ceil(-n.y1));const h=Math.max(0,Math.ceil(n.x2-s)),d=Math.max(0,Math.ceil(n.y2-f));if(r.contains===nM){const e=t.padding();o-=e.left+e.right;u-=e.top+e.bottom}if(a===sM){l=0;c=0;s=o;f=u}else if(a===rM){s=Math.max(0,o-l-h);f=Math.max(0,u-c-d)}else if(a===aM){s=Math.max(0,o-l-h);u=f+c+d}else if(a===oM){o=s+l+h;f=Math.max(0,u-c-d)}else if(a===uM){o=s+l+h;u=f+c+d}t._resizeView(o,u,s,f,[l,c],r.resize)}function lA(t,e){let n=0;if(e===undefined){for(let e of t){if(e=+e){n+=e}}}else{let i=-1;for(let r of t){if(r=+e(r,++i,t)){n+=r}}}return n}function fA(t){Wo.call(this,null,t)}(0,g.XW)(fA,Wo,{transform(t,e){if(this.value&&!t.modified()){return e.StopPropagation}var n=e.dataflow.locale(),i=e.fork(e.NO_SOURCE|e.NO_FIELDS),r=this.value,a=t.scale,o=t.count==null?t.values?t.values.length:10:t.count,u=Wm(a,o,t.minstep),s=t.format||Ym(n,a,u,t.formatSpecifier,t.formatType,!!t.values),l=t.values?Xm(a,t.values,u):Hm(a,u);if(r)i.rem=r;r=l.map(((t,e)=>Sa({index:e/(l.length-1||1),value:t,label:s(t)})));if(t.extra&&r.length){r.push(Sa({index:-1,extra:{value:r[0].value},label:""}))}i.source=r;i.add=r;this.value=r;return i}});function cA(t){Wo.call(this,null,t)}function hA(){return Sa({})}function dA(t){const e=(0,g.Xr)().test((t=>t.exit));e.lookup=n=>e.get(t(n));return e}(0,g.XW)(cA,Wo,{transform(t,e){var n=e.dataflow,i=e.fork(e.NO_SOURCE|e.NO_FIELDS),r=t.item||hA,a=t.key||Ca,o=this.value;if((0,g.kJ)(i.encode)){i.encode=null}if(o&&(t.modified("key")||e.modified(a))){(0,g.vU)("DataJoin does not support modified key function or fields.")}if(!o){e=e.addAll();this.value=o=dA(a)}e.visit(e.ADD,(t=>{const e=a(t);let n=o.get(e);if(n){if(n.exit){o.empty--;i.add.push(n)}else{i.mod.push(n)}}else{n=r(t);o.set(e,n);i.add.push(n)}n.datum=t;n.exit=false}));e.visit(e.MOD,(t=>{const e=a(t),n=o.get(e);if(n){n.datum=t;i.mod.push(n)}}));e.visit(e.REM,(t=>{const e=a(t),n=o.get(e);if(t===n.datum&&!n.exit){i.rem.push(n);n.exit=true;++o.empty}}));if(e.changed(e.ADD_MOD))i.modifies("datum");if(e.clean()||t.clean&&o.empty>n.cleanThreshold){n.runAfter(o.clean)}return i}});function pA(t){Wo.call(this,null,t)}(0,g.XW)(pA,Wo,{transform(t,e){var n=e.fork(e.ADD_REM),i=t.mod||false,r=t.encoders,a=e.encode;if((0,g.kJ)(a)){if(n.changed()||a.every((t=>r[t]))){a=a[0];n.encode=null}else{return e.StopPropagation}}var o=a==="enter",u=r.update||g.k,s=r.enter||g.k,l=r.exit||g.k,f=(a&&!o?r[a]:u)||g.k;if(e.changed(e.ADD)){e.visit(e.ADD,(e=>{s(e,t);u(e,t)}));n.modifies(s.output);n.modifies(u.output);if(f!==g.k&&f!==u){e.visit(e.ADD,(e=>{f(e,t)}));n.modifies(f.output)}}if(e.changed(e.REM)&&l!==g.k){e.visit(e.REM,(e=>{l(e,t)}));n.modifies(l.output)}if(o||f!==g.k){const r=e.MOD|(t.modified()?e.REFLOW:0);if(o){e.visit(r,(e=>{const r=s(e,t)||i;if(f(e,t)||r)n.mod.push(e)}));if(n.mod.length)n.modifies(s.output)}else{e.visit(r,(e=>{if(f(e,t)||i)n.mod.push(e)}))}if(n.mod.length)n.modifies(f.output)}return n.changed()?n:e.StopPropagation}});function gA(t){Wo.call(this,[],t)}(0,g.XW)(gA,Wo,{transform(t,e){if(this.value!=null&&!t.modified()){return e.StopPropagation}var n=e.dataflow.locale(),i=e.fork(e.NO_SOURCE|e.NO_FIELDS),r=this.value,a=t.type||$m,o=t.scale,u=+t.limit,s=Wm(o,t.count==null?5:t.count,t.minstep),l=!!t.values||a===$m,f=t.format||ny(n,o,s,a,t.formatSpecifier,t.formatType,l),c=t.values||Km(o,s),h,d,p,m,y;if(r)i.rem=r;if(a===$m){if(u&&c.length>u){e.dataflow.warn("Symbol legend count exceeds limit, filtering items.");r=c.slice(0,u-1);y=true}else{r=c}if((0,g.mf)(p=t.size)){if(!t.values&&o(r[0])===0){r=r.slice(1)}m=r.reduce(((e,n)=>Math.max(e,p(n,t))),0)}else{p=(0,g.a9)(m=p||8)}r=r.map(((e,n)=>Sa({index:n,label:f(e,n,r),value:e,offset:m,size:p(e,t)})));if(y){y=c[r.length];r.push(Sa({index:r.length,label:"…".concat(c.length-r.length," entries"),value:y,offset:m,size:p(y,t)}))}}else if(a===qm){h=o.domain(),d=Fm(o,h[0],(0,g.fj)(h));if(c.length<3&&!t.values&&h[0]!==(0,g.fj)(h)){c=[h[0],(0,g.fj)(h)]}r=c.map(((t,e)=>Sa({index:e,label:f(t,e,c),value:t,perc:d(t)})))}else{p=c.length-1;d=sy(o);r=c.map(((t,e)=>Sa({index:e,label:f(t,e,c),value:t,perc:e?d(t):0,perc2:e===p?1:d(c[e+1])})))}i.source=r;i.add=r;this.value=r;return i}});const mA=t=>t.source.x;const yA=t=>t.source.y;const vA=t=>t.target.x;const xA=t=>t.target.y;function _A(t){Wo.call(this,{},t)}_A.Definition={type:"LinkPath",metadata:{modifies:true},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string",default:"path"}]};(0,g.XW)(_A,Wo,{transform(t,e){var n=t.sourceX||mA,i=t.sourceY||yA,r=t.targetX||vA,a=t.targetY||xA,o=t.as||"path",u=t.orient||"vertical",s=t.shape||"line",l=NA.get(s+"-"+u)||NA.get(s);if(!l){(0,g.vU)("LinkPath unsupported type: "+t.shape+(t.orient?"-"+t.orient:""))}e.visit(e.SOURCE,(t=>{t[o]=l(n(t),i(t),r(t),a(t))}));return e.reflow(t.modified()).modifies(o)}});const bA=(t,e,n,i)=>"M"+t+","+e+"L"+n+","+i;const wA=(t,e,n,i)=>bA(e*Math.cos(t),e*Math.sin(t),i*Math.cos(n),i*Math.sin(n));const kA=(t,e,n,i)=>{var r=n-t,a=i-e,o=Math.sqrt(r*r+a*a)/2,u=180*Math.atan2(a,r)/Math.PI;return"M"+t+","+e+"A"+o+","+o+" "+u+" 0 1"+" "+n+","+i};const MA=(t,e,n,i)=>kA(e*Math.cos(t),e*Math.sin(t),i*Math.cos(n),i*Math.sin(n));const AA=(t,e,n,i)=>{const r=n-t,a=i-e,o=.2*(r+a),u=.2*(a-r);return"M"+t+","+e+"C"+(t+o)+","+(e+u)+" "+(n+u)+","+(i-o)+" "+n+","+i};const EA=(t,e,n,i)=>AA(e*Math.cos(t),e*Math.sin(t),i*Math.cos(n),i*Math.sin(n));const DA=(t,e,n,i)=>"M"+t+","+e+"V"+i+"H"+n;const CA=(t,e,n,i)=>"M"+t+","+e+"H"+n+"V"+i;const FA=(t,e,n,i)=>{const r=Math.cos(t),a=Math.sin(t),o=Math.cos(n),u=Math.sin(n),s=Math.abs(n-t)>Math.PI?n<=t:n>t;return"M"+e*r+","+e*a+"A"+e+","+e+" 0 0,"+(s?1:0)+" "+e*o+","+e*u+"L"+i*o+","+i*u};const SA=(t,e,n,i)=>{const r=(t+n)/2;return"M"+t+","+e+"C"+r+","+e+" "+r+","+i+" "+n+","+i};const TA=(t,e,n,i)=>{const r=(e+i)/2;return"M"+t+","+e+"C"+t+","+r+" "+n+","+r+" "+n+","+i};const BA=(t,e,n,i)=>{const r=Math.cos(t),a=Math.sin(t),o=Math.cos(n),u=Math.sin(n),s=(e+i)/2;return"M"+e*r+","+e*a+"C"+s*r+","+s*a+" "+s*o+","+s*u+" "+i*o+","+i*u};const NA=(0,g.Xr)({line:bA,"line-radial":wA,arc:kA,"arc-radial":MA,curve:AA,"curve-radial":EA,"orthogonal-horizontal":DA,"orthogonal-vertical":CA,"orthogonal-radial":FA,"diagonal-horizontal":SA,"diagonal-vertical":TA,"diagonal-radial":BA});function zA(t){Wo.call(this,null,t)}zA.Definition={type:"Pie",metadata:{modifies:true},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:false},{name:"as",type:"string",array:true,length:2,default:["startAngle","endAngle"]}]};(0,g.XW)(zA,Wo,{transform(t,e){var n=t.as||["startAngle","endAngle"],i=n[0],r=n[1],a=t.field||g.kX,o=t.startAngle||0,u=t.endAngle!=null?t.endAngle:2*Math.PI,s=e.source,l=s.map(a),f=l.length,c=o,h=(u-o)/lA(l),d=us(f),p,m,y;if(t.sort){d.sort(((t,e)=>l[t]-l[e]))}for(p=0;p<f;++p){y=l[d[p]];m=s[d[p]];m[i]=c;m[r]=c+=y*h}this.value=l;return e.reflow(t.modified()).modifies(n)}});const OA=5;function RA(t){const e=t.type;return!t.bins&&(e===Rg||e===$g||e===Pg)}function UA(t){return ym(t)&&t!==jg}const $A=(0,g.Rg)(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function PA(t){Wo.call(this,null,t);this.modified(true)}(0,g.XW)(PA,Wo,{transform(t,e){var n=e.dataflow,i=this.value,r=qA(t);if(!i||r!==i.type){this.value=i=pm(r)()}for(r in t)if(!$A[r]){if(r==="padding"&&UA(i.type))continue;(0,g.mf)(i[r])?i[r](t[r]):n.warn("Unsupported scale property: "+r)}YA(i,t,HA(i,t,LA(i,t,n)));return e.fork(e.NO_SOURCE|e.NO_FIELDS)}});function qA(t){var e=t.type,n="",i;if(e===jg)return jg+"-"+Rg;if(IA(t)){i=t.rawDomain?t.rawDomain.length:t.domain?t.domain.length+ +(t.domainMid!=null):0;n=i===2?jg+"-":i===3?Wg+"-":""}return(n+e||Rg).toLowerCase()}function IA(t){const e=t.type;return ym(e)&&e!==Ig&&e!==Lg&&(t.scheme||t.range&&t.range.length&&t.range.every(g.HD))}function LA(t,e,n){const i=jA(t,e.domainRaw,n);if(i>-1)return i;var r=e.domain,a=t.type,o=e.zero||e.zero===undefined&&RA(t),u,s;if(!r)return 0;if(UA(a)&&e.padding&&r[0]!==(0,g.fj)(r)){r=WA(a,r,e.range,e.padding,e.exponent,e.constant)}if(o||e.domainMin!=null||e.domainMax!=null||e.domainMid!=null){u=(r=r.slice()).length-1||1;if(o){if(r[0]>0)r[0]=0;if(r[u]<0)r[u]=0}if(e.domainMin!=null)r[0]=e.domainMin;if(e.domainMax!=null)r[u]=e.domainMax;if(e.domainMid!=null){s=e.domainMid;const t=s>r[u]?u+1:s<r[0]?0:u;if(t!==u)n.warn("Scale domainMid exceeds domain min or max.",s);r.splice(t,0,s)}}t.domain(XA(a,r,n));if(a===Jg){t.unknown(e.domainImplicit?rh:undefined)}if(e.nice&&t.nice){t.nice(e.nice!==true&&Wm(t,e.nice)||null)}return r.length}function jA(t,e,n){if(e){t.domain(XA(t.type,e,n));return e.length}else{return-1}}function WA(t,e,n,i,r,a){var o=Math.abs((0,g.fj)(n)-n[0]),u=o/(o-2*i),s=t===Ug?(0,g.dH)(e,null,u):t===Pg?(0,g.mK)(e,null,u,.5):t===$g?(0,g.mK)(e,null,u,r||1):t===qg?(0,g.bV)(e,null,u,a||1):(0,g.ay)(e,null,u);e=e.slice();e[0]=s[0];e[e.length-1]=s[1];return e}function XA(t,e,n){if(_m(t)){var i=Math.abs(e.reduce(((t,e)=>t+(e<0?-1:e>0?1:0)),0));if(i!==e.length){n.warn("Log scale domain includes zero: "+(0,g.m8)(e))}}return e}function HA(t,e,n){let i=e.bins;if(i&&!(0,g.kJ)(i)){const e=t.domain(),n=e[0],r=(0,g.fj)(e),a=i.step;let o=i.start==null?n:i.start,u=i.stop==null?r:i.stop;if(!a)(0,g.vU)("Scale bins parameter missing step property.");if(o<n)o=a*Math.ceil(n/a);if(u>r)u=a*Math.floor(r/a);i=us(o,u+a/2,a)}if(i){t.bins=i}else if(t.bins){delete t.bins}if(t.type===Kg){if(!i){t.bins=t.domain()}else if(!e.domain&&!e.domainRaw){t.domain(i);n=i.length}}return n}function YA(t,e,n){var i=t.type,r=e.round||false,a=e.range;if(e.rangeStep!=null){a=JA(i,e,n)}else if(e.scheme){a=VA(i,e,n);if((0,g.mf)(a)){if(t.interpolator){return t.interpolator(a)}else{(0,g.vU)("Scale type ".concat(i," does not support interpolating color schemes."))}}}if(a&&wm(i)){return t.interpolator(Em(KA(a,e.reverse),e.interpolate,e.interpolateGamma))}if(a&&e.interpolate&&t.interpolate){t.interpolate(Sm(e.interpolate,e.interpolateGamma))}else if((0,g.mf)(t.round)){t.round(r)}else if((0,g.mf)(t.rangeRound)){t.interpolate(r?vd:yd)}if(a)t.range(KA(a,e.reverse))}function JA(t,e,n){if(t!==Gg&&t!==Vg){(0,g.vU)("Only band and point scales support rangeStep.")}var i=(e.paddingOuter!=null?e.paddingOuter:e.padding)||0,r=t===Vg?1:(e.paddingInner!=null?e.paddingInner:e.padding)||0;return[0,e.rangeStep*zg(n,r,i)]}function VA(t,e,n){var i=e.schemeExtent,r,a;if((0,g.kJ)(e.scheme)){a=Em(e.scheme,e.interpolate,e.interpolateGamma)}else{r=e.scheme.toLowerCase();a=Um(r);if(!a)(0,g.vU)("Unrecognized scheme name: ".concat(e.scheme))}n=t===Yg?n+1:t===Kg?n-1:t===Xg||t===Hg?+e.schemeCount||OA:n;return wm(t)?GA(a,i,e.reverse):(0,g.mf)(a)?Dm(GA(a,i),n):t===Jg?a:a.slice(0,n)}function GA(t,e,n){return(0,g.mf)(t)&&(e||n)?Am(t,KA(e||[0,1],n)):t}function KA(t,e){return e?t.slice().reverse():t}function ZA(t){Wo.call(this,null,t)}(0,g.XW)(ZA,Wo,{transform(t,e){const n=t.modified("sort")||e.changed(e.ADD)||e.modified(t.sort.fields)||e.modified("datum");if(n)e.source.sort(za(t.sort));this.modified(n);return e}});const QA="zero",tE="center",eE="normalize",nE=["y0","y1"];function iE(t){Wo.call(this,null,t)}iE.Definition={type:"Stack",metadata:{modifies:true},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:true},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:QA,values:[QA,tE,eE]},{name:"as",type:"string",array:true,length:2,default:nE}]};(0,g.XW)(iE,Wo,{transform(t,e){var n=t.as||nE,i=n[0],r=n[1],a=za(t.sort),o=t.field||g.kX,u=t.offset===tE?rE:t.offset===eE?aE:oE,s,l,f,c;s=uE(e.source,t.groupby,a,o);for(l=0,f=s.length,c=s.max;l<f;++l){u(s[l],c,o,i,r)}return e.reflow(t.modified()).modifies(n)}});function rE(t,e,n,i,r){var a=(e-t.sum)/2,o=t.length,u=0,s;for(;u<o;++u){s=t[u];s[i]=a;s[r]=a+=Math.abs(n(s))}}function aE(t,e,n,i,r){var a=1/t.sum,o=0,u=t.length,s=0,l=0,f;for(;s<u;++s){f=t[s];f[i]=o;f[r]=o=a*(l+=Math.abs(n(f)))}}function oE(t,e,n,i,r){var a=0,o=0,u=t.length,s=0,l,f;for(;s<u;++s){f=t[s];l=+n(f);if(l<0){f[i]=o;f[r]=o+=l}else{f[i]=a;f[r]=a+=l}}}function uE(t,e,n,i){var r=[],a=t=>t(f),o,u,s,l,f,c,h,d,p;if(e==null){r.push(t.slice())}else{for(o={},u=0,s=t.length;u<s;++u){f=t[u];c=e.map(a);h=o[c];if(!h){o[c]=h=[];r.push(h)}h.push(f)}}for(c=0,p=0,l=r.length;c<l;++c){h=r[c];for(u=0,d=0,s=h.length;u<s;++u){d+=Math.abs(i(h[u]))}h.sum=d;if(d>p)p=d;if(n)h.sort(n)}r.max=p;return r}const sE=t=>t;function lE(t,e){if(t&&cE.hasOwnProperty(t.type)){cE[t.type](t,e)}}var fE={Feature:function(t,e){lE(t.geometry,e)},FeatureCollection:function(t,e){var n=t.features,i=-1,r=n.length;while(++i<r)lE(n[i].geometry,e)}};var cE={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates;e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){var n=t.coordinates,i=-1,r=n.length;while(++i<r)t=n[i],e.point(t[0],t[1],t[2])},LineString:function(t,e){hE(t.coordinates,e,0)},MultiLineString:function(t,e){var n=t.coordinates,i=-1,r=n.length;while(++i<r)hE(n[i],e,0)},Polygon:function(t,e){dE(t.coordinates,e)},MultiPolygon:function(t,e){var n=t.coordinates,i=-1,r=n.length;while(++i<r)dE(n[i],e)},GeometryCollection:function(t,e){var n=t.geometries,i=-1,r=n.length;while(++i<r)lE(n[i],e)}};function hE(t,e,n){var i=-1,r=t.length-n,a;e.lineStart();while(++i<r)a=t[i],e.point(a[0],a[1],a[2]);e.lineEnd()}function dE(t,e){var n=-1,i=t.length;e.polygonStart();while(++n<i)hE(t[n],e,1);e.polygonEnd()}function pE(t,e){if(t&&fE.hasOwnProperty(t.type)){fE[t.type](t,e)}else{lE(t,e)}}class gE{constructor(){this._partials=new Float64Array(32);this._n=0}add(t){const e=this._partials;let n=0;for(let i=0;i<this._n&&i<32;i++){const r=e[i],a=t+r,o=Math.abs(t)<Math.abs(r)?t-(a-r):r-(a-t);if(o)e[n++]=o;t=a}e[n]=t;this._n=n+1;return this}valueOf(){const t=this._partials;let e=this._n,n,i,r,a=0;if(e>0){a=t[--e];while(e>0){n=a;i=t[--e];a=n+i;r=i-(a-n);if(r)break}if(e>0&&(r<0&&t[e-1]<0||r>0&&t[e-1]>0)){i=r*2;n=a+i;if(i==n-a)a=n}}return a}}function mE(t,e){const n=new gE;if(e===undefined){for(let e of t){if(e=+e){n.add(e)}}}else{let i=-1;for(let r of t){if(r=+e(r,++i,t)){n.add(r)}}}return+n}function yE(t,e){const n=new gE;let i=-1;return Float64Array.from(t,e===undefined?t=>n.add(+t||0):r=>n.add(+e(r,++i,t)||0))}var vE=1e-6;var xE=1e-12;var _E=Math.PI;var bE=_E/2;var wE=_E/4;var kE=_E*2;var ME=180/_E;var AE=_E/180;var EE=Math.abs;var DE=Math.atan;var CE=Math.atan2;var FE=Math.cos;var SE=Math.ceil;var TE=Math.exp;var BE=Math.floor;var NE=Math.hypot;var zE=Math.log;var OE=Math.pow;var RE=Math.sin;var UE=Math.sign||function(t){return t>0?1:t<0?-1:0};var $E=Math.sqrt;var PE=Math.tan;function qE(t){return t>1?0:t<-1?_E:Math.acos(t)}function IE(t){return t>1?bE:t<-1?-bE:Math.asin(t)}function LE(t){return(t=RE(t/2))*t}function jE(){}var WE=new gE,XE=new gE,HE,YE,JE,VE;var GE={point:jE,lineStart:jE,lineEnd:jE,polygonStart:function(){GE.lineStart=KE;GE.lineEnd=tD},polygonEnd:function(){GE.lineStart=GE.lineEnd=GE.point=jE;WE.add(EE(XE));XE=new gE},result:function(){var t=WE/2;WE=new gE;return t}};function KE(){GE.point=ZE}function ZE(t,e){GE.point=QE;HE=JE=t,YE=VE=e}function QE(t,e){XE.add(VE*t-JE*e);JE=t,VE=e}function tD(){QE(HE,YE)}const eD=GE;var nD=Infinity,iD=nD,rD=-nD,aD=rD;var oD={point:uD,lineStart:jE,lineEnd:jE,polygonStart:jE,polygonEnd:jE,result:function(){var t=[[nD,iD],[rD,aD]];rD=aD=-(iD=nD=Infinity);return t}};function uD(t,e){if(t<nD)nD=t;if(t>rD)rD=t;if(e<iD)iD=e;if(e>aD)aD=e}const sD=oD;var lD=0,fD=0,cD=0,hD=0,dD=0,pD=0,gD=0,mD=0,yD=0,vD,xD,_D,bD;var wD={point:kD,lineStart:MD,lineEnd:DD,polygonStart:function(){wD.lineStart=CD;wD.lineEnd=FD},polygonEnd:function(){wD.point=kD;wD.lineStart=MD;wD.lineEnd=DD},result:function(){var t=yD?[gD/yD,mD/yD]:pD?[hD/pD,dD/pD]:cD?[lD/cD,fD/cD]:[NaN,NaN];lD=fD=cD=hD=dD=pD=gD=mD=yD=0;return t}};function kD(t,e){lD+=t;fD+=e;++cD}function MD(){wD.point=AD}function AD(t,e){wD.point=ED;kD(_D=t,bD=e)}function ED(t,e){var n=t-_D,i=e-bD,r=$E(n*n+i*i);hD+=r*(_D+t)/2;dD+=r*(bD+e)/2;pD+=r;kD(_D=t,bD=e)}function DD(){wD.point=kD}function CD(){wD.point=SD}function FD(){TD(vD,xD)}function SD(t,e){wD.point=TD;kD(vD=_D=t,xD=bD=e)}function TD(t,e){var n=t-_D,i=e-bD,r=$E(n*n+i*i);hD+=r*(_D+t)/2;dD+=r*(bD+e)/2;pD+=r;r=bD*t-_D*e;gD+=r*(_D+t);mD+=r*(bD+e);yD+=r*3;kD(_D=t,bD=e)}const BD=wD;function ND(t){this._context=t}ND.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){if(this._line===0)this._context.closePath();this._point=NaN},point:function(t,e){switch(this._point){case 0:{this._context.moveTo(t,e);this._point=1;break}case 1:{this._context.lineTo(t,e);break}default:{this._context.moveTo(t+this._radius,e);this._context.arc(t,e,this._radius,0,kE);break}}},result:jE};var zD=new gE,OD,RD,UD,$D,PD;var qD={point:jE,lineStart:function(){qD.point=ID},lineEnd:function(){if(OD)LD(RD,UD);qD.point=jE},polygonStart:function(){OD=true},polygonEnd:function(){OD=null},result:function(){var t=+zD;zD=new gE;return t}};function ID(t,e){qD.point=LD;RD=$D=t,UD=PD=e}function LD(t,e){$D-=t,PD-=e;zD.add($E($D*$D+PD*PD));$D=t,PD=e}const jD=qD;function WD(){this._string=[]}WD.prototype={_radius:4.5,_circle:XD(4.5),pointRadius:function(t){if((t=+t)!==this._radius)this._radius=t,this._circle=null;return this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){if(this._line===0)this._string.push("Z");this._point=NaN},point:function(t,e){switch(this._point){case 0:{this._string.push("M",t,",",e);this._point=1;break}case 1:{this._string.push("L",t,",",e);break}default:{if(this._circle==null)this._circle=XD(this._radius);this._string.push("M",t,",",e,this._circle);break}}},result:function(){if(this._string.length){var t=this._string.join("");this._string=[];return t}else{return null}}};function XD(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}function HD(t,e){var n=4.5,i,r;function a(t){if(t){if(typeof n==="function")r.pointRadius(+n.apply(this,arguments));pE(t,i(r))}return r.result()}a.area=function(t){pE(t,i(eD));return eD.result()};a.measure=function(t){pE(t,i(jD));return jD.result()};a.bounds=function(t){pE(t,i(sD));return sD.result()};a.centroid=function(t){pE(t,i(BD));return BD.result()};a.projection=function(e){return arguments.length?(i=e==null?(t=null,sE):(t=e).stream,a):t};a.context=function(t){if(!arguments.length)return e;r=t==null?(e=null,new WD):new ND(e=t);if(typeof n!=="function")r.pointRadius(n);return a};a.pointRadius=function(t){if(!arguments.length)return n;n=typeof t==="function"?t:(r.pointRadius(+t),+t);return a};return a.projection(t).context(e)}function YD(){var t=[],e;return{point:function(t,n,i){e.push([t,n,i])},lineStart:function(){t.push(e=[])},lineEnd:jE,rejoin:function(){if(t.length>1)t.push(t.pop().concat(t.shift()))},result:function(){var n=t;t=[];e=null;return n}}}function JD(t,e){return EE(t[0]-e[0])<vE&&EE(t[1]-e[1])<vE}function VD(t,e,n,i){this.x=t;this.z=e;this.o=n;this.e=i;this.v=false;this.n=this.p=null}function GD(t,e,n,i,r){var a=[],o=[],u,s;t.forEach((function(t){if((e=t.length-1)<=0)return;var e,n=t[0],i=t[e],s;if(JD(n,i)){if(!n[2]&&!i[2]){r.lineStart();for(u=0;u<e;++u)r.point((n=t[u])[0],n[1]);r.lineEnd();return}i[0]+=2*vE}a.push(s=new VD(n,t,null,true));o.push(s.o=new VD(n,null,s,false));a.push(s=new VD(i,t,null,false));o.push(s.o=new VD(i,null,s,true))}));if(!a.length)return;o.sort(e);KD(a);KD(o);for(u=0,s=o.length;u<s;++u){o[u].e=n=!n}var l=a[0],f,c;while(1){var h=l,d=true;while(h.v)if((h=h.n)===l)return;f=h.z;r.lineStart();do{h.v=h.o.v=true;if(h.e){if(d){for(u=0,s=f.length;u<s;++u)r.point((c=f[u])[0],c[1])}else{i(h.x,h.n.x,1,r)}h=h.n}else{if(d){f=h.p.z;for(u=f.length-1;u>=0;--u)r.point((c=f[u])[0],c[1])}else{i(h.x,h.p.x,-1,r)}h=h.p}h=h.o;f=h.z;d=!d}while(!h.v);r.lineEnd()}}function KD(t){if(!(e=t.length))return;var e,n=0,i=t[0],r;while(++n<e){i.n=r=t[n];r.p=i;i=r}i.n=r=t[0];r.p=i}function ZD(t){return[CE(t[1],t[0]),IE(t[2])]}function QD(t){var e=t[0],n=t[1],i=FE(n);return[i*FE(e),i*RE(e),RE(n)]}function tC(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function eC(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function nC(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function iC(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function rC(t){var e=$E(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function aC(t){if(EE(t[0])<=_E)return t[0];else return UE(t[0])*((EE(t[0])+_E)%kE-_E)}function oC(t,e){var n=aC(e),i=e[1],r=RE(i),a=[RE(n),-FE(n),0],o=0,u=0;var s=new gE;if(r===1)i=bE+vE;else if(r===-1)i=-bE-vE;for(var l=0,f=t.length;l<f;++l){if(!(h=(c=t[l]).length))continue;var c,h,d=c[h-1],p=aC(d),g=d[1]/2+wE,m=RE(g),y=FE(g);for(var v=0;v<h;++v,p=_,m=w,y=k,d=x){var x=c[v],_=aC(x),b=x[1]/2+wE,w=RE(b),k=FE(b),M=_-p,A=M>=0?1:-1,E=A*M,D=E>_E,C=m*w;s.add(CE(C*A*RE(E),y*k+C*FE(E)));o+=D?M+A*kE:M;if(D^p>=n^_>=n){var F=eC(QD(d),QD(x));rC(F);var S=eC(a,F);rC(S);var T=(D^M>=0?-1:1)*IE(S[2]);if(i>T||i===T&&(F[0]||F[1])){u+=D^M>=0?1:-1}}}}return(o<-vE||o<vE&&s<-xE)^u&1}function*uC(t){for(const e of t){yield*e}}function sC(t){return Array.from(uC(t))}function lC(t,e,n,i){return function(r){var a=e(r),o=YD(),u=e(o),s=false,l,f,c;var h={point:d,lineStart:g,lineEnd:m,polygonStart:function(){h.point=y;h.lineStart=v;h.lineEnd=x;f=[];l=[]},polygonEnd:function(){h.point=d;h.lineStart=g;h.lineEnd=m;f=sC(f);var t=oC(l,i);if(f.length){if(!s)r.polygonStart(),s=true;GD(f,cC,t,n,r)}else if(t){if(!s)r.polygonStart(),s=true;r.lineStart();n(null,null,1,r);r.lineEnd()}if(s)r.polygonEnd(),s=false;f=l=null},sphere:function(){r.polygonStart();r.lineStart();n(null,null,1,r);r.lineEnd();r.polygonEnd()}};function d(e,n){if(t(e,n))r.point(e,n)}function p(t,e){a.point(t,e)}function g(){h.point=p;a.lineStart()}function m(){h.point=d;a.lineEnd()}function y(t,e){c.push([t,e]);u.point(t,e)}function v(){u.lineStart();c=[]}function x(){y(c[0][0],c[0][1]);u.lineEnd();var t=u.clean(),e=o.result(),n,i=e.length,a,h,d;c.pop();l.push(c);c=null;if(!i)return;if(t&1){h=e[0];if((a=h.length-1)>0){if(!s)r.polygonStart(),s=true;r.lineStart();for(n=0;n<a;++n)r.point((d=h[n])[0],d[1]);r.lineEnd()}return}if(i>1&&t&2)e.push(e.pop().concat(e.shift()));f.push(e.filter(fC))}return h}}function fC(t){return t.length>1}function cC(t,e){return((t=t.x)[0]<0?t[1]-bE-vE:bE-t[1])-((e=e.x)[0]<0?e[1]-bE-vE:bE-e[1])}const hC=lC((function(){return true}),dC,gC,[-_E,-bE]);function dC(t){var e=NaN,n=NaN,i=NaN,r;return{lineStart:function(){t.lineStart();r=1},point:function(a,o){var u=a>0?_E:-_E,s=EE(a-e);if(EE(s-_E)<vE){t.point(e,n=(n+o)/2>0?bE:-bE);t.point(i,n);t.lineEnd();t.lineStart();t.point(u,n);t.point(a,n);r=0}else if(i!==u&&s>=_E){if(EE(e-i)<vE)e-=i*vE;if(EE(a-u)<vE)a-=u*vE;n=pC(e,n,a,o);t.point(i,n);t.lineEnd();t.lineStart();t.point(u,n);r=0}t.point(e=a,n=o);i=u},lineEnd:function(){t.lineEnd();e=n=NaN},clean:function(){return 2-r}}}function pC(t,e,n,i){var r,a,o=RE(t-n);return EE(o)>vE?DE((RE(e)*(a=FE(i))*RE(n)-RE(i)*(r=FE(e))*RE(t))/(r*a*o)):(e+i)/2}function gC(t,e,n,i){var r;if(t==null){r=n*bE;i.point(-_E,r);i.point(0,r);i.point(_E,r);i.point(_E,0);i.point(_E,-r);i.point(0,-r);i.point(-_E,-r);i.point(-_E,0);i.point(-_E,r)}else if(EE(t[0]-e[0])>vE){var a=t[0]<e[0]?_E:-_E;r=n*a/2;i.point(-a,r);i.point(0,r);i.point(a,r)}else{i.point(e[0],e[1])}}function mC(t,e,n,i,r,a){if(!n)return;var o=FE(e),u=RE(e),s=i*n;if(r==null){r=e+i*kE;a=e-s/2}else{r=yC(o,r);a=yC(o,a);if(i>0?r<a:r>a)r+=i*kE}for(var l,f=r;i>0?f>a:f<a;f-=s){l=ZD([o,-u*FE(f),-u*RE(f)]);t.point(l[0],l[1])}}function yC(t,e){e=QD(e),e[0]-=t;rC(e);var n=qE(-e[1]);return((-e[2]<0?-n:n)+kE-vE)%kE}function vC(){var t=constant([0,0]),e=constant(90),n=constant(6),i,r,a={point:o};function o(t,e){i.push(t=r(t,e));t[0]*=degrees,t[1]*=degrees}function u(){var o=t.apply(this,arguments),u=e.apply(this,arguments)*radians,s=n.apply(this,arguments)*radians;i=[];r=rotateRadians(-o[0]*radians,-o[1]*radians,0).invert;mC(a,u,s,1);o={type:"Polygon",coordinates:[i]};i=r=null;return o}u.center=function(e){return arguments.length?(t=typeof e==="function"?e:constant([+e[0],+e[1]]),u):t};u.radius=function(t){return arguments.length?(e=typeof t==="function"?t:constant(+t),u):e};u.precision=function(t){return arguments.length?(n=typeof t==="function"?t:constant(+t),u):n};return u}function xC(t){var e=FE(t),n=6*AE,i=e>0,r=EE(e)>vE;function a(e,i,r,a){mC(a,t,n,r,e,i)}function o(t,n){return FE(t)*FE(n)>e}function u(t){var e,n,a,u,f;return{lineStart:function(){u=a=false;f=1},point:function(c,h){var d=[c,h],p,g=o(c,h),m=i?g?0:l(c,h):g?l(c+(c<0?_E:-_E),h):0;if(!e&&(u=a=g))t.lineStart();if(g!==a){p=s(e,d);if(!p||JD(e,p)||JD(d,p))d[2]=1}if(g!==a){f=0;if(g){t.lineStart();p=s(d,e);t.point(p[0],p[1])}else{p=s(e,d);t.point(p[0],p[1],2);t.lineEnd()}e=p}else if(r&&e&&i^g){var y;if(!(m&n)&&(y=s(d,e,true))){f=0;if(i){t.lineStart();t.point(y[0][0],y[0][1]);t.point(y[1][0],y[1][1]);t.lineEnd()}else{t.point(y[1][0],y[1][1]);t.lineEnd();t.lineStart();t.point(y[0][0],y[0][1],3)}}}if(g&&(!e||!JD(e,d))){t.point(d[0],d[1])}e=d,a=g,n=m},lineEnd:function(){if(a)t.lineEnd();e=null},clean:function(){return f|(u&&a)<<1}}}function s(t,n,i){var r=QD(t),a=QD(n);var o=[1,0,0],u=eC(r,a),s=tC(u,u),l=u[0],f=s-l*l;if(!f)return!i&&t;var c=e*s/f,h=-e*l/f,d=eC(o,u),p=iC(o,c),g=iC(u,h);nC(p,g);var m=d,y=tC(p,m),v=tC(m,m),x=y*y-v*(tC(p,p)-1);if(x<0)return;var _=$E(x),b=iC(m,(-y-_)/v);nC(b,p);b=ZD(b);if(!i)return b;var w=t[0],k=n[0],M=t[1],A=n[1],E;if(k<w)E=w,w=k,k=E;var D=k-w,C=EE(D-_E)<vE,F=C||D<vE;if(!C&&A<M)E=M,M=A,A=E;if(F?C?M+A>0^b[1]<(EE(b[0]-w)<vE?M:A):M<=b[1]&&b[1]<=A:D>_E^(w<=b[0]&&b[0]<=k)){var S=iC(m,(-y+_)/v);nC(S,p);return[b,ZD(S)]}}function l(e,n){var r=i?t:_E-t,a=0;if(e<-r)a|=1;else if(e>r)a|=2;if(n<-r)a|=4;else if(n>r)a|=8;return a}return lC(o,u,a,i?[0,-t]:[-_E,t-_E])}function _C(t,e,n,i,r,a){var o=t[0],u=t[1],s=e[0],l=e[1],f=0,c=1,h=s-o,d=l-u,p;p=n-o;if(!h&&p>0)return;p/=h;if(h<0){if(p<f)return;if(p<c)c=p}else if(h>0){if(p>c)return;if(p>f)f=p}p=r-o;if(!h&&p<0)return;p/=h;if(h<0){if(p>c)return;if(p>f)f=p}else if(h>0){if(p<f)return;if(p<c)c=p}p=i-u;if(!d&&p>0)return;p/=d;if(d<0){if(p<f)return;if(p<c)c=p}else if(d>0){if(p>c)return;if(p>f)f=p}p=a-u;if(!d&&p<0)return;p/=d;if(d<0){if(p>c)return;if(p>f)f=p}else if(d>0){if(p<f)return;if(p<c)c=p}if(f>0)t[0]=o+f*h,t[1]=u+f*d;if(c<1)e[0]=o+c*h,e[1]=u+c*d;return true}var bC=1e9,wC=-bC;function kC(t,e,n,i){function r(r,a){return t<=r&&r<=n&&e<=a&&a<=i}function a(r,a,u,l){var f=0,c=0;if(r==null||(f=o(r,u))!==(c=o(a,u))||s(r,a)<0^u>0){do{l.point(f===0||f===3?t:n,f>1?i:e)}while((f=(f+u+4)%4)!==c)}else{l.point(a[0],a[1])}}function o(i,r){return EE(i[0]-t)<vE?r>0?0:3:EE(i[0]-n)<vE?r>0?2:1:EE(i[1]-e)<vE?r>0?1:0:r>0?3:2}function u(t,e){return s(t.x,e.x)}function s(t,e){var n=o(t,1),i=o(e,1);return n!==i?n-i:n===0?e[1]-t[1]:n===1?t[0]-e[0]:n===2?t[1]-e[1]:e[0]-t[0]}return function(o){var s=o,l=YD(),f,c,h,d,p,g,m,y,v,x,_;var b={point:w,lineStart:E,lineEnd:D,polygonStart:M,polygonEnd:A};function w(t,e){if(r(t,e))s.point(t,e)}function k(){var e=0;for(var n=0,r=c.length;n<r;++n){for(var a=c[n],o=1,u=a.length,s=a[0],l,f,h=s[0],d=s[1];o<u;++o){l=h,f=d,s=a[o],h=s[0],d=s[1];if(f<=i){if(d>i&&(h-l)*(i-f)>(d-f)*(t-l))++e}else{if(d<=i&&(h-l)*(i-f)<(d-f)*(t-l))--e}}}return e}function M(){s=l,f=[],c=[],_=true}function A(){var t=k(),e=_&&t,n=(f=sC(f)).length;if(e||n){o.polygonStart();if(e){o.lineStart();a(null,null,1,o);o.lineEnd()}if(n){GD(f,u,t,a,o)}o.polygonEnd()}s=o,f=c=h=null}function E(){b.point=C;if(c)c.push(h=[]);x=true;v=false;m=y=NaN}function D(){if(f){C(d,p);if(g&&v)l.rejoin();f.push(l.result())}b.point=w;if(v)s.lineEnd()}function C(a,o){var u=r(a,o);if(c)h.push([a,o]);if(x){d=a,p=o,g=u;x=false;if(u){s.lineStart();s.point(a,o)}}else{if(u&&v)s.point(a,o);else{var l=[m=Math.max(wC,Math.min(bC,m)),y=Math.max(wC,Math.min(bC,y))],f=[a=Math.max(wC,Math.min(bC,a)),o=Math.max(wC,Math.min(bC,o))];if(_C(l,f,t,e,n,i)){if(!v){s.lineStart();s.point(l[0],l[1])}s.point(f[0],f[1]);if(!u)s.lineEnd();_=false}else if(u){s.lineStart();s.point(a,o);_=false}}}m=a,y=o,v=u}return b}}function MC(t,e){function n(n,i){return n=t(n,i),e(n[0],n[1])}if(t.invert&&e.invert)n.invert=function(n,i){return n=e.invert(n,i),n&&t.invert(n[0],n[1])};return n}function AC(t,e){return[EE(t)>_E?t+Math.round(-t/kE)*kE:t,e]}AC.invert=AC;function EC(t,e,n){return(t%=kE)?e||n?MC(CC(t),FC(e,n)):CC(t):e||n?FC(e,n):AC}function DC(t){return function(e,n){return e+=t,[e>_E?e-kE:e<-_E?e+kE:e,n]}}function CC(t){var e=DC(t);e.invert=DC(-t);return e}function FC(t,e){var n=FE(t),i=RE(t),r=FE(e),a=RE(e);function o(t,e){var o=FE(e),u=FE(t)*o,s=RE(t)*o,l=RE(e),f=l*n+u*i;return[CE(s*r-f*a,u*n-l*i),IE(f*r+s*a)]}o.invert=function(t,e){var o=FE(e),u=FE(t)*o,s=RE(t)*o,l=RE(e),f=l*r-s*a;return[CE(s*r+l*a,u*n+f*i),IE(f*n-u*i)]};return o}function SC(t){t=EC(t[0]*AE,t[1]*AE,t.length>2?t[2]*AE:0);function e(e){e=t(e[0]*AE,e[1]*AE);return e[0]*=ME,e[1]*=ME,e}e.invert=function(e){e=t.invert(e[0]*AE,e[1]*AE);return e[0]*=ME,e[1]*=ME,e};return e}function TC(t){return{stream:BC(t)}}function BC(t){return function(e){var n=new NC;for(var i in t)n[i]=t[i];n.stream=e;return n}}function NC(){}NC.prototype={constructor:NC,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function zC(t,e,n){var i=t.clipExtent&&t.clipExtent();t.scale(150).translate([0,0]);if(i!=null)t.clipExtent(null);pE(n,t.stream(sD));e(sD.result());if(i!=null)t.clipExtent(i);return t}function OC(t,e,n){return zC(t,(function(n){var i=e[1][0]-e[0][0],r=e[1][1]-e[0][1],a=Math.min(i/(n[1][0]-n[0][0]),r/(n[1][1]-n[0][1])),o=+e[0][0]+(i-a*(n[1][0]+n[0][0]))/2,u=+e[0][1]+(r-a*(n[1][1]+n[0][1]))/2;t.scale(150*a).translate([o,u])}),n)}function RC(t,e,n){return OC(t,[[0,0],e],n)}function UC(t,e,n){return zC(t,(function(n){var i=+e,r=i/(n[1][0]-n[0][0]),a=(i-r*(n[1][0]+n[0][0]))/2,o=-r*n[0][1];t.scale(150*r).translate([a,o])}),n)}function $C(t,e,n){return zC(t,(function(n){var i=+e,r=i/(n[1][1]-n[0][1]),a=-r*n[0][0],o=(i-r*(n[1][1]+n[0][1]))/2;t.scale(150*r).translate([a,o])}),n)}var PC=16,qC=FE(30*AE);function IC(t,e){return+e?jC(t,e):LC(t)}function LC(t){return BC({point:function(e,n){e=t(e,n);this.stream.point(e[0],e[1])}})}function jC(t,e){function n(i,r,a,o,u,s,l,f,c,h,d,p,g,m){var y=l-i,v=f-r,x=y*y+v*v;if(x>4*e&&g--){var _=o+h,b=u+d,w=s+p,k=$E(_*_+b*b+w*w),M=IE(w/=k),A=EE(EE(w)-1)<vE||EE(a-c)<vE?(a+c)/2:CE(b,_),E=t(A,M),D=E[0],C=E[1],F=D-i,S=C-r,T=v*F-y*S;if(T*T/x>e||EE((y*F+v*S)/x-.5)>.3||o*h+u*d+s*p<qC){n(i,r,a,o,u,s,D,C,A,_/=k,b/=k,w,g,m);m.point(D,C);n(D,C,A,_,b,w,l,f,c,h,d,p,g,m)}}}return function(e){var i,r,a,o,u,s,l,f,c,h,d,p;var g={point:m,lineStart:y,lineEnd:x,polygonStart:function(){e.polygonStart();g.lineStart=_},polygonEnd:function(){e.polygonEnd();g.lineStart=y}};function m(n,i){n=t(n,i);e.point(n[0],n[1])}function y(){f=NaN;g.point=v;e.lineStart()}function v(i,r){var a=QD([i,r]),o=t(i,r);n(f,c,l,h,d,p,f=o[0],c=o[1],l=i,h=a[0],d=a[1],p=a[2],PC,e);e.point(f,c)}function x(){g.point=m;e.lineEnd()}function _(){y();g.point=b;g.lineEnd=w}function b(t,e){v(i=t,e),r=f,a=c,o=h,u=d,s=p;g.point=v}function w(){n(f,c,l,h,d,p,r,a,i,o,u,s,PC,e);g.lineEnd=x;x()}return g}}var WC=BC({point:function(t,e){this.stream.point(t*AE,e*AE)}});function XC(t){return BC({point:function(e,n){var i=t(e,n);return this.stream.point(i[0],i[1])}})}function HC(t,e,n,i,r){function a(a,o){a*=i;o*=r;return[e+t*a,n-t*o]}a.invert=function(a,o){return[(a-e)/t*i,(n-o)/t*r]};return a}function YC(t,e,n,i,r,a){if(!a)return HC(t,e,n,i,r);var o=FE(a),u=RE(a),s=o*t,l=u*t,f=o/t,c=u/t,h=(u*n-o*e)/t,d=(u*e+o*n)/t;function p(t,a){t*=i;a*=r;return[s*t-l*a+e,n-l*t-s*a]}p.invert=function(t,e){return[i*(f*t-c*e+h),r*(d-c*t-f*e)]};return p}function JC(t){return VC((function(){return t}))()}function VC(t){var e,n=150,i=480,r=250,a=0,o=0,u=0,s=0,l=0,f,c=0,h=1,d=1,p=null,g=hC,m=null,y,v,x,_=sE,b=.5,w,k,M,A,E;function D(t){return M(t[0]*AE,t[1]*AE)}function C(t){t=M.invert(t[0],t[1]);return t&&[t[0]*ME,t[1]*ME]}D.stream=function(t){return A&&E===t?A:A=WC(XC(f)(g(w(_(E=t)))))};D.preclip=function(t){return arguments.length?(g=t,p=undefined,S()):g};D.postclip=function(t){return arguments.length?(_=t,m=y=v=x=null,S()):_};D.clipAngle=function(t){return arguments.length?(g=+t?xC(p=t*AE):(p=null,hC),S()):p*ME};D.clipExtent=function(t){return arguments.length?(_=t==null?(m=y=v=x=null,sE):kC(m=+t[0][0],y=+t[0][1],v=+t[1][0],x=+t[1][1]),S()):m==null?null:[[m,y],[v,x]]};D.scale=function(t){return arguments.length?(n=+t,F()):n};D.translate=function(t){return arguments.length?(i=+t[0],r=+t[1],F()):[i,r]};D.center=function(t){return arguments.length?(a=t[0]%360*AE,o=t[1]%360*AE,F()):[a*ME,o*ME]};D.rotate=function(t){return arguments.length?(u=t[0]%360*AE,s=t[1]%360*AE,l=t.length>2?t[2]%360*AE:0,F()):[u*ME,s*ME,l*ME]};D.angle=function(t){return arguments.length?(c=t%360*AE,F()):c*ME};D.reflectX=function(t){return arguments.length?(h=t?-1:1,F()):h<0};D.reflectY=function(t){return arguments.length?(d=t?-1:1,F()):d<0};D.precision=function(t){return arguments.length?(w=IC(k,b=t*t),S()):$E(b)};D.fitExtent=function(t,e){return OC(D,t,e)};D.fitSize=function(t,e){return RC(D,t,e)};D.fitWidth=function(t,e){return UC(D,t,e)};D.fitHeight=function(t,e){return $C(D,t,e)};function F(){var t=YC(n,0,0,h,d,c).apply(null,e(a,o)),p=YC(n,i-t[0],r-t[1],h,d,c);f=EC(u,s,l);k=MC(e,p);M=MC(f,k);w=IC(k,b);return S()}function S(){A=E=null;return D}return function(){e=t.apply(this,arguments);D.invert=e.invert&&C;return F()}}function GC(t){var e=0,n=_E/3,i=VC(t),r=i(e,n);r.parallels=function(t){return arguments.length?i(e=t[0]*AE,n=t[1]*AE):[e*ME,n*ME]};return r}function KC(t){var e=FE(t);function n(t,n){return[t*e,RE(n)/e]}n.invert=function(t,n){return[t/e,IE(n*e)]};return n}function ZC(t,e){var n=RE(t),i=(n+RE(e))/2;if(EE(i)<vE)return KC(t);var r=1+n*(2*i-n),a=$E(r)/i;function o(t,e){var n=$E(r-2*i*RE(e))/i;return[n*RE(t*=i),a-n*FE(t)]}o.invert=function(t,e){var n=a-e,o=CE(t,EE(n))*UE(n);if(n*i<0)o-=_E*UE(t)*UE(n);return[o/i,IE((r-(t*t+n*n)*i*i)/(2*i))]};return o}function QC(){return GC(ZC).scale(155.424).center([0,33.6442])}function tF(){return QC().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function eF(t){var e=t.length;return{point:function(n,i){var r=-1;while(++r<e)t[r].point(n,i)},sphere:function(){var n=-1;while(++n<e)t[n].sphere()},lineStart:function(){var n=-1;while(++n<e)t[n].lineStart()},lineEnd:function(){var n=-1;while(++n<e)t[n].lineEnd()},polygonStart:function(){var n=-1;while(++n<e)t[n].polygonStart()},polygonEnd:function(){var n=-1;while(++n<e)t[n].polygonEnd()}}}function nF(){var t,e,n=tF(),i,r=QC().rotate([154,0]).center([-2,58.5]).parallels([55,65]),a,o=QC().rotate([157,0]).center([-3,19.9]).parallels([8,18]),u,s,l={point:function(t,e){s=[t,e]}};function f(t){var e=t[0],n=t[1];return s=null,(i.point(e,n),s)||(a.point(e,n),s)||(u.point(e,n),s)}f.invert=function(t){var e=n.scale(),i=n.translate(),a=(t[0]-i[0])/e,u=(t[1]-i[1])/e;return(u>=.12&&u<.234&&a>=-.425&&a<-.214?r:u>=.166&&u<.234&&a>=-.214&&a<-.115?o:n).invert(t)};f.stream=function(i){return t&&e===i?t:t=eF([n.stream(e=i),r.stream(i),o.stream(i)])};f.precision=function(t){if(!arguments.length)return n.precision();n.precision(t),r.precision(t),o.precision(t);return c()};f.scale=function(t){if(!arguments.length)return n.scale();n.scale(t),r.scale(t*.35),o.scale(t);return f.translate(n.translate())};f.translate=function(t){if(!arguments.length)return n.translate();var e=n.scale(),s=+t[0],f=+t[1];i=n.translate(t).clipExtent([[s-.455*e,f-.238*e],[s+.455*e,f+.238*e]]).stream(l);a=r.translate([s-.307*e,f+.201*e]).clipExtent([[s-.425*e+vE,f+.12*e+vE],[s-.214*e-vE,f+.234*e-vE]]).stream(l);u=o.translate([s-.205*e,f+.212*e]).clipExtent([[s-.214*e+vE,f+.166*e+vE],[s-.115*e-vE,f+.234*e-vE]]).stream(l);return c()};f.fitExtent=function(t,e){return OC(f,t,e)};f.fitSize=function(t,e){return RC(f,t,e)};f.fitWidth=function(t,e){return UC(f,t,e)};f.fitHeight=function(t,e){return $C(f,t,e)};function c(){t=e=null;return f}return f.scale(1070)}function iF(t){return function(e,n){var i=FE(e),r=FE(n),a=t(i*r);if(a===Infinity)return[2,0];return[a*r*RE(e),a*RE(n)]}}function rF(t){return function(e,n){var i=$E(e*e+n*n),r=t(i),a=RE(r),o=FE(r);return[CE(e*a,i*o),IE(i&&n*a/i)]}}var aF=iF((function(t){return $E(2/(1+t))}));aF.invert=rF((function(t){return 2*IE(t/2)}));function oF(){return JC(aF).scale(124.75).clipAngle(180-.001)}var uF=iF((function(t){return(t=qE(t))&&t/RE(t)}));uF.invert=rF((function(t){return t}));function sF(){return JC(uF).scale(79.4188).clipAngle(180-.001)}function lF(t,e){return[t,zE(PE((bE+e)/2))]}lF.invert=function(t,e){return[t,2*DE(TE(e))-bE]};function fF(){return cF(lF).scale(961/kE)}function cF(t){var e=JC(t),n=e.center,i=e.scale,r=e.translate,a=e.clipExtent,o=null,u,s,l;e.scale=function(t){return arguments.length?(i(t),f()):i()};e.translate=function(t){return arguments.length?(r(t),f()):r()};e.center=function(t){return arguments.length?(n(t),f()):n()};e.clipExtent=function(t){return arguments.length?(t==null?o=u=s=l=null:(o=+t[0][0],u=+t[0][1],s=+t[1][0],l=+t[1][1]),f()):o==null?null:[[o,u],[s,l]]};function f(){var n=_E*i(),r=e(SC(e.rotate()).invert([0,0]));return a(o==null?[[r[0]-n,r[1]-n],[r[0]+n,r[1]+n]]:t===lF?[[Math.max(r[0]-n,o),u],[Math.min(r[0]+n,s),l]]:[[o,Math.max(r[1]-n,u)],[s,Math.min(r[1]+n,l)]])}return f()}function hF(t){return PE((bE+t)/2)}function dF(t,e){var n=FE(t),i=t===e?RE(t):zE(n/FE(e))/zE(hF(e)/hF(t)),r=n*OE(hF(t),i)/i;if(!i)return lF;function a(t,e){if(r>0){if(e<-bE+vE)e=-bE+vE}else{if(e>bE-vE)e=bE-vE}var n=r/OE(hF(e),i);return[n*RE(i*t),r-n*FE(i*t)]}a.invert=function(t,e){var n=r-e,a=UE(i)*$E(t*t+n*n),o=CE(t,EE(n))*UE(n);if(n*i<0)o-=_E*UE(t)*UE(n);return[o/i,2*DE(OE(r/a,1/i))-bE]};return a}function pF(){return GC(dF).scale(109.5).parallels([30,30])}function gF(t,e){return[t,e]}gF.invert=gF;function mF(){return JC(gF).scale(152.63)}function yF(t,e){var n=FE(t),i=t===e?RE(t):(n-FE(e))/(e-t),r=n/i+t;if(EE(i)<vE)return gF;function a(t,e){var n=r-e,a=i*t;return[n*RE(a),r-n*FE(a)]}a.invert=function(t,e){var n=r-e,a=CE(t,EE(n))*UE(n);if(n*i<0)a-=_E*UE(t)*UE(n);return[a/i,r-UE(i)*$E(t*t+n*n)]};return a}function vF(){return GC(yF).scale(131.154).center([0,13.9389])}var xF=1.340264,_F=-.081106,bF=893e-6,wF=.003796,kF=$E(3)/2,MF=12;function AF(t,e){var n=IE(kF*RE(e)),i=n*n,r=i*i*i;return[t*FE(n)/(kF*(xF+3*_F*i+r*(7*bF+9*wF*i))),n*(xF+_F*i+r*(bF+wF*i))]}AF.invert=function(t,e){var n=e,i=n*n,r=i*i*i;for(var a=0,o,u,s;a<MF;++a){u=n*(xF+_F*i+r*(bF+wF*i))-e;s=xF+3*_F*i+r*(7*bF+9*wF*i);n-=o=u/s,i=n*n,r=i*i*i;if(EE(o)<xE)break}return[kF*t*(xF+3*_F*i+r*(7*bF+9*wF*i))/FE(n),IE(RE(n)/kF)]};function EF(){return JC(AF).scale(177.158)}function DF(t,e){var n=FE(e),i=FE(t)*n;return[n*RE(t)/i,RE(e)/i]}DF.invert=rF(DE);function CF(){return JC(DF).scale(144.049).clipAngle(60)}function FF(){var t=1,e=0,n=0,i=1,r=1,a=0,o,u,s=null,l,f,c,h=1,d=1,p=BC({point:function(t,e){var n=x([t,e]);this.stream.point(n[0],n[1])}}),g=sE,m,y;function v(){h=t*i;d=t*r;m=y=null;return x}function x(t){var i=t[0]*h,r=t[1]*d;if(a){var s=r*o-i*u;i=i*o+r*u;r=s}return[i+e,r+n]}x.invert=function(t){var i=t[0]-e,r=t[1]-n;if(a){var s=r*o+i*u;i=i*o-r*u;r=s}return[i/h,r/d]};x.stream=function(t){return m&&y===t?m:m=p(g(y=t))};x.postclip=function(t){return arguments.length?(g=t,s=l=f=c=null,v()):g};x.clipExtent=function(t){return arguments.length?(g=t==null?(s=l=f=c=null,sE):kC(s=+t[0][0],l=+t[0][1],f=+t[1][0],c=+t[1][1]),v()):s==null?null:[[s,l],[f,c]]};x.scale=function(e){return arguments.length?(t=+e,v()):t};x.translate=function(t){return arguments.length?(e=+t[0],n=+t[1],v()):[e,n]};x.angle=function(t){return arguments.length?(a=t%360*AE,u=RE(a),o=FE(a),v()):a*ME};x.reflectX=function(t){return arguments.length?(i=t?-1:1,v()):i<0};x.reflectY=function(t){return arguments.length?(r=t?-1:1,v()):r<0};x.fitExtent=function(t,e){return OC(x,t,e)};x.fitSize=function(t,e){return RC(x,t,e)};x.fitWidth=function(t,e){return UC(x,t,e)};x.fitHeight=function(t,e){return $C(x,t,e)};return x}function SF(t,e){var n=e*e,i=n*n;return[t*(.8707-.131979*n+i*(-.013791+i*(.003971*n-.001529*i))),e*(1.007226+n*(.015085+i*(-.044475+.028874*n-.005916*i)))]}SF.invert=function(t,e){var n=e,i=25,r;do{var a=n*n,o=a*a;n-=r=(n*(1.007226+a*(.015085+o*(-.044475+.028874*a-.005916*o)))-e)/(1.007226+a*(.015085*3+o*(-.044475*7+.028874*9*a-.005916*11*o)))}while(EE(r)>vE&&--i>0);return[t/(.8707+(a=n*n)*(-.131979+a*(-.013791+a*a*a*(.003971-.001529*a)))),n]};function TF(){return JC(SF).scale(175.295)}function BF(t,e){return[FE(e)*RE(t),RE(e)]}BF.invert=rF(IE);function NF(){return JC(BF).scale(249.5).clipAngle(90+vE)}function zF(t,e){var n=FE(e),i=1+FE(t)*n;return[n*RE(t)/i,RE(e)/i]}zF.invert=rF((function(t){return 2*DE(t)}));function OF(){return JC(zF).scale(250).clipAngle(142)}function RF(t,e){return[zE(PE((bE+e)/2)),-t]}RF.invert=function(t,e){return[-e,2*DE(TE(t))-bE]};function UF(){var t=cF(RF),e=t.center,n=t.rotate;t.center=function(t){return arguments.length?e([-t[1],t[0]]):(t=e(),[t[1],-t[0]])};t.rotate=function(t){return arguments.length?n([t[0],t[1],t.length>2?t[2]+90:90]):(t=n(),[t[0],t[1],t[2]-90])};return n([0,0,90]).scale(159.155)}function $F(){}function PF(){var t=[],e;return{point:function(t,n,i){e.push([t,n,i])},lineStart:function(){t.push(e=[])},lineEnd:$F,rejoin:function(){if(t.length>1)t.push(t.pop().concat(t.shift()))},result:function(){var n=t;t=[];e=null;return n}}}var qF=1e-6;var IF=1e-12;var LF=Math.PI;var jF=LF/2;var WF=LF/4;var XF=LF*2;var HF=180/LF;var YF=LF/180;var JF=Math.abs;var VF=Math.atan;var GF=Math.atan2;var KF=Math.cos;var ZF=Math.ceil;var QF=Math.exp;var tS=Math.floor;var eS=Math.log;var nS=Math.pow;var iS=Math.sin;var rS=Math.sign||function(t){return t>0?1:t<0?-1:0};var aS=Math.sqrt;var oS=Math.tan;function uS(t){return t>1?0:t<-1?LF:Math.acos(t)}function sS(t){return t>1?jF:t<-1?-jF:Math.asin(t)}function lS(t){return(t=iS(t/2))*t}function fS(t,e){return JF(t[0]-e[0])<qF&&JF(t[1]-e[1])<qF}function cS(t,e,n,i){this.x=t;this.z=e;this.o=n;this.e=i;this.v=false;this.n=this.p=null}function hS(t,e,n,i,r){var a=[],o=[],u,s;t.forEach((function(t){if((e=t.length-1)<=0)return;var e,n=t[0],i=t[e],s;if(fS(n,i)){if(!n[2]&&!i[2]){r.lineStart();for(u=0;u<e;++u)r.point((n=t[u])[0],n[1]);r.lineEnd();return}i[0]+=2*qF}a.push(s=new cS(n,t,null,true));o.push(s.o=new cS(n,null,s,false));a.push(s=new cS(i,t,null,false));o.push(s.o=new cS(i,null,s,true))}));if(!a.length)return;o.sort(e);dS(a);dS(o);for(u=0,s=o.length;u<s;++u){o[u].e=n=!n}var l=a[0],f,c;while(1){var h=l,d=true;while(h.v)if((h=h.n)===l)return;f=h.z;r.lineStart();do{h.v=h.o.v=true;if(h.e){if(d){for(u=0,s=f.length;u<s;++u)r.point((c=f[u])[0],c[1])}else{i(h.x,h.n.x,1,r)}h=h.n}else{if(d){f=h.p.z;for(u=f.length-1;u>=0;--u)r.point((c=f[u])[0],c[1])}else{i(h.x,h.p.x,-1,r)}h=h.p}h=h.o;f=h.z;d=!d}while(!h.v);r.lineEnd()}}function dS(t){if(!(e=t.length))return;var e,n=0,i=t[0],r;while(++n<e){i.n=r=t[n];r.p=i;i=r}i.n=r=t[0];r.p=i}function pS(){return new gS}function gS(){this.reset()}gS.prototype={constructor:gS,reset:function(){this.s=this.t=0},add:function(t){yS(mS,t,this.t);yS(this,mS.s,this.s);if(this.s)this.t+=mS.t;else this.s=mS.t},valueOf:function(){return this.s}};var mS=new gS;function yS(t,e,n){var i=t.s=e+n,r=i-e,a=i-r;t.t=e-a+(n-r)}function vS(t){return[GF(t[1],t[0]),sS(t[2])]}function xS(t){var e=t[0],n=t[1],i=KF(n);return[i*KF(e),i*iS(e),iS(n)]}function _S(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function bS(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function wS(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function kS(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function MS(t){var e=aS(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}var AS=pS();function ES(t){if(JF(t[0])<=LF)return t[0];else return rS(t[0])*((JF(t[0])+LF)%XF-LF)}function DS(t,e){var n=ES(e),i=e[1],r=iS(i),a=[iS(n),-KF(n),0],o=0,u=0;AS.reset();if(r===1)i=jF+qF;else if(r===-1)i=-jF-qF;for(var s=0,l=t.length;s<l;++s){if(!(c=(f=t[s]).length))continue;var f,c,h=f[c-1],d=ES(h),p=h[1]/2+WF,g=iS(p),m=KF(p);for(var y=0;y<c;++y,d=x,g=b,m=w,h=v){var v=f[y],x=ES(v),_=v[1]/2+WF,b=iS(_),w=KF(_),k=x-d,M=k>=0?1:-1,A=M*k,E=A>LF,D=g*b;AS.add(GF(D*M*iS(A),m*w+D*KF(A)));o+=E?k+M*XF:k;if(E^d>=n^x>=n){var C=bS(xS(h),xS(v));MS(C);var F=bS(a,C);MS(F);var S=(E^k>=0?-1:1)*sS(F[2]);if(i>S||i===S&&(C[0]||C[1])){u+=E^k>=0?1:-1}}}}return(o<-qF||o<qF&&AS<-qF)^u&1}function CS(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function FS(t){if(t.length===1)t=SS(t);return{left:function(e,n,i,r){if(i==null)i=0;if(r==null)r=e.length;while(i<r){var a=i+r>>>1;if(t(e[a],n)<0)i=a+1;else r=a}return i},right:function(e,n,i,r){if(i==null)i=0;if(r==null)r=e.length;while(i<r){var a=i+r>>>1;if(t(e[a],n)>0)r=a;else i=a+1}return i}}}function SS(t){return function(e,n){return CS(t(e),n)}}var TS=FS(CS);var BS=TS.right;var NS=TS.left;const zS=null&&BS;var OS=Array.prototype;var RS=OS.slice;var US=OS.map;var $S=Math.sqrt(50),PS=Math.sqrt(10),qS=Math.sqrt(2);function IS(t,e,n){var i,r=-1,a,o,u;e=+e,t=+t,n=+n;if(t===e&&n>0)return[t];if(i=e<t)a=t,t=e,e=a;if((u=LS(t,e,n))===0||!isFinite(u))return[];if(u>0){t=Math.ceil(t/u);e=Math.floor(e/u);o=new Array(a=Math.ceil(e-t+1));while(++r<a)o[r]=(t+r)*u}else{t=Math.floor(t*u);e=Math.ceil(e*u);o=new Array(a=Math.ceil(t-e+1));while(++r<a)o[r]=(t-r)/u}if(i)o.reverse();return o}function LS(t,e,n){var i=(e-t)/Math.max(0,n),r=Math.floor(Math.log(i)/Math.LN10),a=i/Math.pow(10,r);return r>=0?(a>=$S?10:a>=PS?5:a>=qS?2:1)*Math.pow(10,r):-Math.pow(10,-r)/(a>=$S?10:a>=PS?5:a>=qS?2:1)}function jS(t,e,n){var i=Math.abs(e-t)/Math.max(0,n),r=Math.pow(10,Math.floor(Math.log(i)/Math.LN10)),a=i/r;if(a>=$S)r*=10;else if(a>=PS)r*=5;else if(a>=qS)r*=2;return e<t?-r:r}function WS(){var t=identity,e=extent,n=sturges;function i(i){var r,a=i.length,o,u=new Array(a);for(r=0;r<a;++r){u[r]=t(i[r],r,i)}var s=e(u),l=s[0],f=s[1],c=n(u,l,f);if(!Array.isArray(c)){c=tickStep(l,f,c);c=range(Math.ceil(l/c)*c,f,c)}var h=c.length;while(c[0]<=l)c.shift(),--h;while(c[h-1]>f)c.pop(),--h;var d=new Array(h+1),p;for(r=0;r<=h;++r){p=d[r]=[];p.x0=r>0?c[r-1]:l;p.x1=r<h?c[r]:f}for(r=0;r<a;++r){o=u[r];if(l<=o&&o<=f){d[bisect(c,o,0,h)].push(i[r])}}return d}i.value=function(e){return arguments.length?(t=typeof e==="function"?e:constant(e),i):t};i.domain=function(t){return arguments.length?(e=typeof t==="function"?t:constant([t[0],t[1]]),i):e};i.thresholds=function(t){return arguments.length?(n=typeof t==="function"?t:Array.isArray(t)?constant(slice.call(t)):constant(t),i):n};return i}function XS(t,e,n){t=map.call(t,number).sort(ascending);return Math.ceil((n-e)/(2*(quantile(t,.75)-quantile(t,.25))*Math.pow(t.length,-1/3)))}function HS(t){var e=t.length,n,i=-1,r=0,a,o;while(++i<e)r+=t[i].length;a=new Array(r);while(--e>=0){o=t[e];n=o.length;while(--n>=0){a[--r]=o[n]}}return a}function YS(t,e,n,i){return function(r){var a=e(r),o=PF(),u=e(o),s=false,l,f,c;var h={point:d,lineStart:g,lineEnd:m,polygonStart:function(){h.point=y;h.lineStart=v;h.lineEnd=x;f=[];l=[]},polygonEnd:function(){h.point=d;h.lineStart=g;h.lineEnd=m;f=HS(f);var t=DS(l,i);if(f.length){if(!s)r.polygonStart(),s=true;hS(f,VS,t,n,r)}else if(t){if(!s)r.polygonStart(),s=true;r.lineStart();n(null,null,1,r);r.lineEnd()}if(s)r.polygonEnd(),s=false;f=l=null},sphere:function(){r.polygonStart();r.lineStart();n(null,null,1,r);r.lineEnd();r.polygonEnd()}};function d(e,n){if(t(e,n))r.point(e,n)}function p(t,e){a.point(t,e)}function g(){h.point=p;a.lineStart()}function m(){h.point=d;a.lineEnd()}function y(t,e){c.push([t,e]);u.point(t,e)}function v(){u.lineStart();c=[]}function x(){y(c[0][0],c[0][1]);u.lineEnd();var t=u.clean(),e=o.result(),n,i=e.length,a,h,d;c.pop();l.push(c);c=null;if(!i)return;if(t&1){h=e[0];if((a=h.length-1)>0){if(!s)r.polygonStart(),s=true;r.lineStart();for(n=0;n<a;++n)r.point((d=h[n])[0],d[1]);r.lineEnd()}return}if(i>1&&t&2)e.push(e.pop().concat(e.shift()));f.push(e.filter(JS))}return h}}function JS(t){return t.length>1}function VS(t,e){return((t=t.x)[0]<0?t[1]-jF-qF:jF-t[1])-((e=e.x)[0]<0?e[1]-jF-qF:jF-e[1])}const GS=YS((function(){return true}),KS,QS,[-LF,-jF]);function KS(t){var e=NaN,n=NaN,i=NaN,r;return{lineStart:function(){t.lineStart();r=1},point:function(a,o){var u=a>0?LF:-LF,s=JF(a-e);if(JF(s-LF)<qF){t.point(e,n=(n+o)/2>0?jF:-jF);t.point(i,n);t.lineEnd();t.lineStart();t.point(u,n);t.point(a,n);r=0}else if(i!==u&&s>=LF){if(JF(e-i)<qF)e-=i*qF;if(JF(a-u)<qF)a-=u*qF;n=ZS(e,n,a,o);t.point(i,n);t.lineEnd();t.lineStart();t.point(u,n);r=0}t.point(e=a,n=o);i=u},lineEnd:function(){t.lineEnd();e=n=NaN},clean:function(){return 2-r}}}function ZS(t,e,n,i){var r,a,o=iS(t-n);return JF(o)>qF?VF((iS(e)*(a=KF(i))*iS(n)-iS(i)*(r=KF(e))*iS(t))/(r*a*o)):(e+i)/2}function QS(t,e,n,i){var r;if(t==null){r=n*jF;i.point(-LF,r);i.point(0,r);i.point(LF,r);i.point(LF,0);i.point(LF,-r);i.point(0,-r);i.point(-LF,-r);i.point(-LF,0);i.point(-LF,r)}else if(JF(t[0]-e[0])>qF){var a=t[0]<e[0]?LF:-LF;r=n*a/2;i.point(-a,r);i.point(0,r);i.point(a,r)}else{i.point(e[0],e[1])}}function tT(t,e,n,i,r,a){if(!n)return;var o=KF(e),u=iS(e),s=i*n;if(r==null){r=e+i*XF;a=e-s/2}else{r=eT(o,r);a=eT(o,a);if(i>0?r<a:r>a)r+=i*XF}for(var l,f=r;i>0?f>a:f<a;f-=s){l=vS([o,-u*KF(f),-u*iS(f)]);t.point(l[0],l[1])}}function eT(t,e){e=xS(e),e[0]-=t;MS(e);var n=uS(-e[1]);return((-e[2]<0?-n:n)+XF-qF)%XF}function nT(){var t=constant([0,0]),e=constant(90),n=constant(6),i,r,a={point:o};function o(t,e){i.push(t=r(t,e));t[0]*=degrees,t[1]*=degrees}function u(){var o=t.apply(this,arguments),u=e.apply(this,arguments)*radians,s=n.apply(this,arguments)*radians;i=[];r=rotateRadians(-o[0]*radians,-o[1]*radians,0).invert;tT(a,u,s,1);o={type:"Polygon",coordinates:[i]};i=r=null;return o}u.center=function(e){return arguments.length?(t=typeof e==="function"?e:constant([+e[0],+e[1]]),u):t};u.radius=function(t){return arguments.length?(e=typeof t==="function"?t:constant(+t),u):e};u.precision=function(t){return arguments.length?(n=typeof t==="function"?t:constant(+t),u):n};return u}function iT(t){var e=KF(t),n=6*YF,i=e>0,r=JF(e)>qF;function a(e,i,r,a){tT(a,t,n,r,e,i)}function o(t,n){return KF(t)*KF(n)>e}function u(t){var e,n,a,u,f;return{lineStart:function(){u=a=false;f=1},point:function(c,h){var d=[c,h],p,g=o(c,h),m=i?g?0:l(c,h):g?l(c+(c<0?LF:-LF),h):0;if(!e&&(u=a=g))t.lineStart();if(g!==a){p=s(e,d);if(!p||fS(e,p)||fS(d,p))d[2]=1}if(g!==a){f=0;if(g){t.lineStart();p=s(d,e);t.point(p[0],p[1])}else{p=s(e,d);t.point(p[0],p[1],2);t.lineEnd()}e=p}else if(r&&e&&i^g){var y;if(!(m&n)&&(y=s(d,e,true))){f=0;if(i){t.lineStart();t.point(y[0][0],y[0][1]);t.point(y[1][0],y[1][1]);t.lineEnd()}else{t.point(y[1][0],y[1][1]);t.lineEnd();t.lineStart();t.point(y[0][0],y[0][1],3)}}}if(g&&(!e||!fS(e,d))){t.point(d[0],d[1])}e=d,a=g,n=m},lineEnd:function(){if(a)t.lineEnd();e=null},clean:function(){return f|(u&&a)<<1}}}function s(t,n,i){var r=xS(t),a=xS(n);var o=[1,0,0],u=bS(r,a),s=_S(u,u),l=u[0],f=s-l*l;if(!f)return!i&&t;var c=e*s/f,h=-e*l/f,d=bS(o,u),p=kS(o,c),g=kS(u,h);wS(p,g);var m=d,y=_S(p,m),v=_S(m,m),x=y*y-v*(_S(p,p)-1);if(x<0)return;var _=aS(x),b=kS(m,(-y-_)/v);wS(b,p);b=vS(b);if(!i)return b;var w=t[0],k=n[0],M=t[1],A=n[1],E;if(k<w)E=w,w=k,k=E;var D=k-w,C=JF(D-LF)<qF,F=C||D<qF;if(!C&&A<M)E=M,M=A,A=E;if(F?C?M+A>0^b[1]<(JF(b[0]-w)<qF?M:A):M<=b[1]&&b[1]<=A:D>LF^(w<=b[0]&&b[0]<=k)){var S=kS(m,(-y+_)/v);wS(S,p);return[b,vS(S)]}}function l(e,n){var r=i?t:LF-t,a=0;if(e<-r)a|=1;else if(e>r)a|=2;if(n<-r)a|=4;else if(n>r)a|=8;return a}return YS(o,u,a,i?[0,-t]:[-LF,t-LF])}function rT(t,e,n,i,r,a){var o=t[0],u=t[1],s=e[0],l=e[1],f=0,c=1,h=s-o,d=l-u,p;p=n-o;if(!h&&p>0)return;p/=h;if(h<0){if(p<f)return;if(p<c)c=p}else if(h>0){if(p>c)return;if(p>f)f=p}p=r-o;if(!h&&p<0)return;p/=h;if(h<0){if(p>c)return;if(p>f)f=p}else if(h>0){if(p<f)return;if(p<c)c=p}p=i-u;if(!d&&p>0)return;p/=d;if(d<0){if(p<f)return;if(p<c)c=p}else if(d>0){if(p>c)return;if(p>f)f=p}p=a-u;if(!d&&p<0)return;p/=d;if(d<0){if(p>c)return;if(p>f)f=p}else if(d>0){if(p<f)return;if(p<c)c=p}if(f>0)t[0]=o+f*h,t[1]=u+f*d;if(c<1)e[0]=o+c*h,e[1]=u+c*d;return true}var aT=1e9,oT=-aT;function uT(t,e,n,i){function r(r,a){return t<=r&&r<=n&&e<=a&&a<=i}function a(r,a,u,l){var f=0,c=0;if(r==null||(f=o(r,u))!==(c=o(a,u))||s(r,a)<0^u>0){do{l.point(f===0||f===3?t:n,f>1?i:e)}while((f=(f+u+4)%4)!==c)}else{l.point(a[0],a[1])}}function o(i,r){return JF(i[0]-t)<qF?r>0?0:3:JF(i[0]-n)<qF?r>0?2:1:JF(i[1]-e)<qF?r>0?1:0:r>0?3:2}function u(t,e){return s(t.x,e.x)}function s(t,e){var n=o(t,1),i=o(e,1);return n!==i?n-i:n===0?e[1]-t[1]:n===1?t[0]-e[0]:n===2?t[1]-e[1]:e[0]-t[0]}return function(o){var s=o,l=PF(),f,c,h,d,p,g,m,y,v,x,_;var b={point:w,lineStart:E,lineEnd:D,polygonStart:M,polygonEnd:A};function w(t,e){if(r(t,e))s.point(t,e)}function k(){var e=0;for(var n=0,r=c.length;n<r;++n){for(var a=c[n],o=1,u=a.length,s=a[0],l,f,h=s[0],d=s[1];o<u;++o){l=h,f=d,s=a[o],h=s[0],d=s[1];if(f<=i){if(d>i&&(h-l)*(i-f)>(d-f)*(t-l))++e}else{if(d<=i&&(h-l)*(i-f)<(d-f)*(t-l))--e}}}return e}function M(){s=l,f=[],c=[],_=true}function A(){var t=k(),e=_&&t,n=(f=HS(f)).length;if(e||n){o.polygonStart();if(e){o.lineStart();a(null,null,1,o);o.lineEnd()}if(n){hS(f,u,t,a,o)}o.polygonEnd()}s=o,f=c=h=null}function E(){b.point=C;if(c)c.push(h=[]);x=true;v=false;m=y=NaN}function D(){if(f){C(d,p);if(g&&v)l.rejoin();f.push(l.result())}b.point=w;if(v)s.lineEnd()}function C(a,o){var u=r(a,o);if(c)h.push([a,o]);if(x){d=a,p=o,g=u;x=false;if(u){s.lineStart();s.point(a,o)}}else{if(u&&v)s.point(a,o);else{var l=[m=Math.max(oT,Math.min(aT,m)),y=Math.max(oT,Math.min(aT,y))],f=[a=Math.max(oT,Math.min(aT,a)),o=Math.max(oT,Math.min(aT,o))];if(rT(l,f,t,e,n,i)){if(!v){s.lineStart();s.point(l[0],l[1])}s.point(f[0],f[1]);if(!u)s.lineEnd();_=false}else if(u){s.lineStart();s.point(a,o);_=false}}}m=a,y=o,v=u}return b}}function sT(t,e){function n(n,i){return n=t(n,i),e(n[0],n[1])}if(t.invert&&e.invert)n.invert=function(n,i){return n=e.invert(n,i),n&&t.invert(n[0],n[1])};return n}function lT(t){return t}function fT(t,e){return[JF(t)>LF?t+Math.round(-t/XF)*XF:t,e]}fT.invert=fT;function cT(t,e,n){return(t%=XF)?e||n?sT(dT(t),pT(e,n)):dT(t):e||n?pT(e,n):fT}function hT(t){return function(e,n){return e+=t,[e>LF?e-XF:e<-LF?e+XF:e,n]}}function dT(t){var e=hT(t);e.invert=hT(-t);return e}function pT(t,e){var n=KF(t),i=iS(t),r=KF(e),a=iS(e);function o(t,e){var o=KF(e),u=KF(t)*o,s=iS(t)*o,l=iS(e),f=l*n+u*i;return[GF(s*r-f*a,u*n-l*i),sS(f*r+s*a)]}o.invert=function(t,e){var o=KF(e),u=KF(t)*o,s=iS(t)*o,l=iS(e),f=l*r-s*a;return[GF(s*r+l*a,u*n+f*i),sS(f*n-u*i)]};return o}function gT(t){t=cT(t[0]*radians,t[1]*radians,t.length>2?t[2]*radians:0);function e(e){e=t(e[0]*radians,e[1]*radians);return e[0]*=degrees,e[1]*=degrees,e}e.invert=function(e){e=t.invert(e[0]*radians,e[1]*radians);return e[0]*=degrees,e[1]*=degrees,e};return e}function mT(t){return{stream:yT(t)}}function yT(t){return function(e){var n=new vT;for(var i in t)n[i]=t[i];n.stream=e;return n}}function vT(){}vT.prototype={constructor:vT,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function xT(t,e){if(t&&bT.hasOwnProperty(t.type)){bT[t.type](t,e)}}var _T={Feature:function(t,e){xT(t.geometry,e)},FeatureCollection:function(t,e){var n=t.features,i=-1,r=n.length;while(++i<r)xT(n[i].geometry,e)}};var bT={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates;e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){var n=t.coordinates,i=-1,r=n.length;while(++i<r)t=n[i],e.point(t[0],t[1],t[2])},LineString:function(t,e){wT(t.coordinates,e,0)},MultiLineString:function(t,e){var n=t.coordinates,i=-1,r=n.length;while(++i<r)wT(n[i],e,0)},Polygon:function(t,e){kT(t.coordinates,e)},MultiPolygon:function(t,e){var n=t.coordinates,i=-1,r=n.length;while(++i<r)kT(n[i],e)},GeometryCollection:function(t,e){var n=t.geometries,i=-1,r=n.length;while(++i<r)xT(n[i],e)}};function wT(t,e,n){var i=-1,r=t.length-n,a;e.lineStart();while(++i<r)a=t[i],e.point(a[0],a[1],a[2]);e.lineEnd()}function kT(t,e){var n=-1,i=t.length;e.polygonStart();while(++n<i)wT(t[n],e,1);e.polygonEnd()}function MT(t,e){if(t&&_T.hasOwnProperty(t.type)){_T[t.type](t,e)}else{xT(t,e)}}var AT=Infinity,ET=AT,DT=-AT,CT=DT;var FT={point:ST,lineStart:$F,lineEnd:$F,polygonStart:$F,polygonEnd:$F,result:function(){var t=[[AT,ET],[DT,CT]];DT=CT=-(ET=AT=Infinity);return t}};function ST(t,e){if(t<AT)AT=t;if(t>DT)DT=t;if(e<ET)ET=e;if(e>CT)CT=e}const TT=FT;function BT(t,e,n){var i=t.clipExtent&&t.clipExtent();t.scale(150).translate([0,0]);if(i!=null)t.clipExtent(null);MT(n,t.stream(TT));e(TT.result());if(i!=null)t.clipExtent(i);return t}function NT(t,e,n){return BT(t,(function(n){var i=e[1][0]-e[0][0],r=e[1][1]-e[0][1],a=Math.min(i/(n[1][0]-n[0][0]),r/(n[1][1]-n[0][1])),o=+e[0][0]+(i-a*(n[1][0]+n[0][0]))/2,u=+e[0][1]+(r-a*(n[1][1]+n[0][1]))/2;t.scale(150*a).translate([o,u])}),n)}function zT(t,e,n){return NT(t,[[0,0],e],n)}function OT(t,e,n){return BT(t,(function(n){var i=+e,r=i/(n[1][0]-n[0][0]),a=(i-r*(n[1][0]+n[0][0]))/2,o=-r*n[0][1];t.scale(150*r).translate([a,o])}),n)}function RT(t,e,n){return BT(t,(function(n){var i=+e,r=i/(n[1][1]-n[0][1]),a=-r*n[0][0],o=(i-r*(n[1][1]+n[0][1]))/2;t.scale(150*r).translate([a,o])}),n)}var UT=16,$T=KF(30*YF);function PT(t,e){return+e?IT(t,e):qT(t)}function qT(t){return yT({point:function(e,n){e=t(e,n);this.stream.point(e[0],e[1])}})}function IT(t,e){function n(i,r,a,o,u,s,l,f,c,h,d,p,g,m){var y=l-i,v=f-r,x=y*y+v*v;if(x>4*e&&g--){var _=o+h,b=u+d,w=s+p,k=aS(_*_+b*b+w*w),M=sS(w/=k),A=JF(JF(w)-1)<qF||JF(a-c)<qF?(a+c)/2:GF(b,_),E=t(A,M),D=E[0],C=E[1],F=D-i,S=C-r,T=v*F-y*S;if(T*T/x>e||JF((y*F+v*S)/x-.5)>.3||o*h+u*d+s*p<$T){n(i,r,a,o,u,s,D,C,A,_/=k,b/=k,w,g,m);m.point(D,C);n(D,C,A,_,b,w,l,f,c,h,d,p,g,m)}}}return function(e){var i,r,a,o,u,s,l,f,c,h,d,p;var g={point:m,lineStart:y,lineEnd:x,polygonStart:function(){e.polygonStart();g.lineStart=_},polygonEnd:function(){e.polygonEnd();g.lineStart=y}};function m(n,i){n=t(n,i);e.point(n[0],n[1])}function y(){f=NaN;g.point=v;e.lineStart()}function v(i,r){var a=xS([i,r]),o=t(i,r);n(f,c,l,h,d,p,f=o[0],c=o[1],l=i,h=a[0],d=a[1],p=a[2],UT,e);e.point(f,c)}function x(){g.point=m;e.lineEnd()}function _(){y();g.point=b;g.lineEnd=w}function b(t,e){v(i=t,e),r=f,a=c,o=h,u=d,s=p;g.point=v}function w(){n(f,c,l,h,d,p,r,a,i,o,u,s,UT,e);g.lineEnd=x;x()}return g}}var LT=yT({point:function(t,e){this.stream.point(t*YF,e*YF)}});function jT(t){return yT({point:function(e,n){var i=t(e,n);return this.stream.point(i[0],i[1])}})}function WT(t,e,n,i,r){function a(a,o){a*=i;o*=r;return[e+t*a,n-t*o]}a.invert=function(a,o){return[(a-e)/t*i,(n-o)/t*r]};return a}function XT(t,e,n,i,r,a){var o=KF(a),u=iS(a),s=o*t,l=u*t,f=o/t,c=u/t,h=(u*n-o*e)/t,d=(u*e+o*n)/t;function p(t,a){t*=i;a*=r;return[s*t-l*a+e,n-l*t-s*a]}p.invert=function(t,e){return[i*(f*t-c*e+h),r*(d-c*t-f*e)]};return p}function HT(t){return YT((function(){return t}))()}function YT(t){var e,n=150,i=480,r=250,a=0,o=0,u=0,s=0,l=0,f,c=0,h=1,d=1,p=null,g=GS,m=null,y,v,x,_=lT,b=.5,w,k,M,A,E;function D(t){return M(t[0]*YF,t[1]*YF)}function C(t){t=M.invert(t[0],t[1]);return t&&[t[0]*HF,t[1]*HF]}D.stream=function(t){return A&&E===t?A:A=LT(jT(f)(g(w(_(E=t)))))};D.preclip=function(t){return arguments.length?(g=t,p=undefined,S()):g};D.postclip=function(t){return arguments.length?(_=t,m=y=v=x=null,S()):_};D.clipAngle=function(t){return arguments.length?(g=+t?iT(p=t*YF):(p=null,GS),S()):p*HF};D.clipExtent=function(t){return arguments.length?(_=t==null?(m=y=v=x=null,lT):uT(m=+t[0][0],y=+t[0][1],v=+t[1][0],x=+t[1][1]),S()):m==null?null:[[m,y],[v,x]]};D.scale=function(t){return arguments.length?(n=+t,F()):n};D.translate=function(t){return arguments.length?(i=+t[0],r=+t[1],F()):[i,r]};D.center=function(t){return arguments.length?(a=t[0]%360*YF,o=t[1]%360*YF,F()):[a*HF,o*HF]};D.rotate=function(t){return arguments.length?(u=t[0]%360*YF,s=t[1]%360*YF,l=t.length>2?t[2]%360*YF:0,F()):[u*HF,s*HF,l*HF]};D.angle=function(t){return arguments.length?(c=t%360*YF,F()):c*HF};D.reflectX=function(t){return arguments.length?(h=t?-1:1,F()):h<0};D.reflectY=function(t){return arguments.length?(d=t?-1:1,F()):d<0};D.precision=function(t){return arguments.length?(w=PT(k,b=t*t),S()):aS(b)};D.fitExtent=function(t,e){return NT(D,t,e)};D.fitSize=function(t,e){return zT(D,t,e)};D.fitWidth=function(t,e){return OT(D,t,e)};D.fitHeight=function(t,e){return RT(D,t,e)};function F(){var t=XT(n,0,0,h,d,c).apply(null,e(a,o)),p=(c?XT:WT)(n,i-t[0],r-t[1],h,d,c);f=cT(u,s,l);k=sT(e,p);M=sT(f,k);w=PT(k,b);return S()}function S(){A=E=null;return D}return function(){e=t.apply(this,arguments);D.invert=e.invert&&C;return F()}}var JT=Math.abs;var VT=Math.atan;var GT=Math.atan2;var KT=Math.ceil;var ZT=Math.cos;var QT=Math.exp;var tB=Math.floor;var eB=Math.log;var nB=Math.max;var iB=Math.min;var rB=Math.pow;var aB=Math.round;var oB=Math.sign||function(t){return t>0?1:t<0?-1:0};var uB=Math.sin;var sB=Math.tan;var lB=1e-6;var fB=1e-12;var cB=Math.PI;var hB=cB/2;var dB=cB/4;var pB=Math.SQRT1_2;var gB=kB(2);var mB=kB(cB);var yB=cB*2;var vB=180/cB;var xB=cB/180;function _B(t){return t?t/Math.sin(t):1}function bB(t){return t>1?hB:t<-1?-hB:Math.asin(t)}function wB(t){return t>1?0:t<-1?cB:Math.acos(t)}function kB(t){return t>0?Math.sqrt(t):0}function MB(t){t=QT(2*t);return(t-1)/(t+1)}function AB(t){return(QT(t)-QT(-t))/2}function EB(t){return(QT(t)+QT(-t))/2}function DB(t){return eB(t+kB(t*t+1))}function CB(t){return eB(t+kB(t*t-1))}function FB(t,e){var n=t*uB(e),i=30,r;do{e-=r=(e+uB(e)-n)/(1+ZT(e))}while(JT(r)>lB&&--i>0);return e/2}function SB(t,e,n){function i(i,r){return[t*i*ZT(r=FB(n,r)),e*uB(r)]}i.invert=function(i,r){return r=bB(r/e),[i/(t*ZT(r)),bB((2*r+uB(2*r))/n)]};return i}var TB=SB(gB/hB,gB,cB);function BB(){return HT(TB).scale(169.529)}const NB=HD();const zB=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function OB(t,e){return function n(){const i=e();i.type=t;i.path=HD().projection(i);i.copy=i.copy||function(){const t=n();zB.forEach((e=>{if(i[e])t[e](i[e]())}));t.path.pointRadius(i.path.pointRadius());return t};return i}}function RB(t,e){if(!t||typeof t!=="string"){throw new Error("Projection type must be a name string.")}t=t.toLowerCase();if(arguments.length>1){$B[t]=OB(t,e);return this}else{return $B[t]||null}}function UB(t){return t&&t.path||NB}const $B={albers:tF,albersusa:nF,azimuthalequalarea:oF,azimuthalequidistant:sF,conicconformal:pF,conicequalarea:QC,conicequidistant:vF,equalEarth:EF,equirectangular:mF,gnomonic:CF,identity:FF,mercator:fF,mollweide:BB,naturalEarth1:TF,orthographic:NF,stereographic:OF,transversemercator:UF};for(const VQ in $B){RB(VQ,$B[VQ])}var PB=1e-6;var qB=1e-12;var IB=Math.PI;var LB=IB/2;var jB=IB/4;var WB=IB*2;var XB=180/IB;var HB=IB/180;var YB=Math.abs;var JB=Math.atan;var VB=Math.atan2;var GB=Math.cos;var KB=Math.ceil;var ZB=Math.exp;var QB=Math.floor;var tN=Math.hypot;var eN=Math.log;var nN=Math.pow;var iN=Math.sin;var rN=Math.sign||function(t){return t>0?1:t<0?-1:0};var aN=Math.sqrt;var oN=Math.tan;function uN(t){return t>1?0:t<-1?IB:Math.acos(t)}function sN(t){return t>1?LB:t<-1?-LB:Math.asin(t)}function lN(t){return(t=iN(t/2))*t}function fN(t,e,n){var i=us(t,e-PB,n).concat(e);return function(t){return i.map((function(e){return[t,e]}))}}function cN(t,e,n){var i=us(t,e-PB,n).concat(e);return function(t){return i.map((function(e){return[e,t]}))}}function hN(){var t,e,n,i,r,a,o,u,s=10,l=s,f=90,c=360,h,d,p,g,m=2.5;function y(){return{type:"MultiLineString",coordinates:v()}}function v(){return us(KB(i/f)*f,n,f).map(p).concat(us(KB(u/c)*c,o,c).map(g)).concat(us(KB(e/s)*s,t,s).filter((function(t){return YB(t%f)>PB})).map(h)).concat(us(KB(a/l)*l,r,l).filter((function(t){return YB(t%c)>PB})).map(d))}y.lines=function(){return v().map((function(t){return{type:"LineString",coordinates:t}}))};y.outline=function(){return{type:"Polygon",coordinates:[p(i).concat(g(o).slice(1),p(n).reverse().slice(1),g(u).reverse().slice(1))]}};y.extent=function(t){if(!arguments.length)return y.extentMinor();return y.extentMajor(t).extentMinor(t)};y.extentMajor=function(t){if(!arguments.length)return[[i,u],[n,o]];i=+t[0][0],n=+t[1][0];u=+t[0][1],o=+t[1][1];if(i>n)t=i,i=n,n=t;if(u>o)t=u,u=o,o=t;return y.precision(m)};y.extentMinor=function(n){if(!arguments.length)return[[e,a],[t,r]];e=+n[0][0],t=+n[1][0];a=+n[0][1],r=+n[1][1];if(e>t)n=e,e=t,t=n;if(a>r)n=a,a=r,r=n;return y.precision(m)};y.step=function(t){if(!arguments.length)return y.stepMinor();return y.stepMajor(t).stepMinor(t)};y.stepMajor=function(t){if(!arguments.length)return[f,c];f=+t[0],c=+t[1];return y};y.stepMinor=function(t){if(!arguments.length)return[s,l];s=+t[0],l=+t[1];return y};y.precision=function(s){if(!arguments.length)return m;m=+s;h=fN(a,r,90);d=cN(e,t,m);p=fN(u,o,90);g=cN(i,n,m);return y};return y.extentMajor([[-180,-90+PB],[180,90-PB]]).extentMinor([[-180,-80-PB],[180,80+PB]])}function dN(){return hN()()}function pN(){}const gN=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function mN(){var t=1,e=1,n=u;function i(t,e){return e.map((e=>r(t,e)))}function r(t,e){var i=[],r=[];a(t,e,(a=>{n(a,t,e);if(yN(a)>0)i.push([a]);else r.push(a)}));r.forEach((t=>{for(var e=0,n=i.length,r;e<n;++e){if(vN((r=i[e])[0],t)!==-1){r.push(t);return}}}));return{type:"MultiPolygon",value:e,coordinates:i}}function a(n,i,r){var a=new Array,u=new Array,s,l,f,c,h,d;s=l=-1;c=n[0]>=i;gN[c<<1].forEach(p);while(++s<t-1){f=c,c=n[s+1]>=i;gN[f|c<<1].forEach(p)}gN[c<<0].forEach(p);while(++l<e-1){s=-1;c=n[l*t+t]>=i;h=n[l*t]>=i;gN[c<<1|h<<2].forEach(p);while(++s<t-1){f=c,c=n[l*t+t+s+1]>=i;d=h,h=n[l*t+s+1]>=i;gN[f|c<<1|h<<2|d<<3].forEach(p)}gN[c|h<<3].forEach(p)}s=-1;h=n[l*t]>=i;gN[h<<2].forEach(p);while(++s<t-1){d=h,h=n[l*t+s+1]>=i;gN[h<<2|d<<3].forEach(p)}gN[h<<3].forEach(p);function p(t){var e=[t[0][0]+s,t[0][1]+l],n=[t[1][0]+s,t[1][1]+l],i=o(e),f=o(n),c,h;if(c=u[i]){if(h=a[f]){delete u[c.end];delete a[h.start];if(c===h){c.ring.push(n);r(c.ring)}else{a[c.start]=u[h.end]={start:c.start,end:h.end,ring:c.ring.concat(h.ring)}}}else{delete u[c.end];c.ring.push(n);u[c.end=f]=c}}else if(c=a[f]){if(h=u[i]){delete a[c.start];delete u[h.end];if(c===h){c.ring.push(n);r(c.ring)}else{a[h.start]=u[c.end]={start:h.start,end:c.end,ring:h.ring.concat(c.ring)}}}else{delete a[c.start];c.ring.unshift(e);a[c.start=i]=c}}else{a[i]=u[f]={start:i,end:f,ring:[e,n]}}}}function o(e){return e[0]*2+e[1]*(t+1)*4}function u(n,i,r){n.forEach((n=>{var a=n[0],o=n[1],u=a|0,s=o|0,l,f=i[s*t+u];if(a>0&&a<t&&u===a){l=i[s*t+u-1];n[0]=a+(r-l)/(f-l)-.5}if(o>0&&o<e&&s===o){l=i[(s-1)*t+u];n[1]=o+(r-l)/(f-l)-.5}}))}i.contour=r;i.size=function(n){if(!arguments.length)return[t,e];var r=Math.floor(n[0]),a=Math.floor(n[1]);if(!(r>=0&&a>=0))(0,g.vU)("invalid size");return t=r,e=a,i};i.smooth=function(t){return arguments.length?(n=t?u:pN,i):n===u};return i}function yN(t){var e=0,n=t.length,i=t[n-1][1]*t[0][0]-t[n-1][0]*t[0][1];while(++e<n)i+=t[e-1][1]*t[e][0]-t[e-1][0]*t[e][1];return i}function vN(t,e){var n=-1,i=e.length,r;while(++n<i)if(r=xN(t,e[n]))return r;return 0}function xN(t,e){var n=e[0],i=e[1],r=-1;for(var a=0,o=t.length,u=o-1;a<o;u=a++){var s=t[a],l=s[0],f=s[1],c=t[u],h=c[0],d=c[1];if(_N(s,c,e))return 0;if(f>i!==d>i&&n<(h-l)*(i-f)/(d-f)+l)r=-r}return r}function _N(t,e,n){var i;return bN(t,e,n)&&wN(t[i=+(t[0]===e[0])],n[i],e[i])}function bN(t,e,n){return(e[0]-t[0])*(n[1]-t[1])===(n[0]-t[0])*(e[1]-t[1])}function wN(t,e,n){return t<=e&&e<=n||n<=e&&e<=t}function kN(t,e,n){return function(i){var r=(0,g.We)(i),a=n?Math.min(r[0],0):r[0],o=r[1],u=o-a,s=e?j(a,o,t):u/(t+1);return us(a+s,o,s)}}function MN(t){Wo.call(this,null,t)}MN.Definition={type:"Isocontour",metadata:{generates:true},params:[{name:"field",type:"field"},{name:"thresholds",type:"number",array:true},{name:"levels",type:"number"},{name:"nice",type:"boolean",default:false},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"zero",type:"boolean",default:true},{name:"smooth",type:"boolean",default:true},{name:"scale",type:"number",expr:true},{name:"translate",type:"number",array:true,expr:true},{name:"as",type:"string",null:true,default:"contour"}]};(0,g.XW)(MN,Wo,{transform(t,e){if(this.value&&!e.changed()&&!t.modified()){return e.StopPropagation}var n=e.fork(e.NO_SOURCE|e.NO_FIELDS),i=e.materialize(e.SOURCE).source,r=t.field||g.yR,a=mN().smooth(t.smooth!==false),o=t.thresholds||AN(i,r,t),u=t.as===null?null:t.as||"contour",s=[];i.forEach((e=>{const n=r(e);const i=a.size([n.width,n.height])(n.values,(0,g.kJ)(o)?o:o(n.values));EN(i,n,e,t);i.forEach((t=>{s.push(Ba(e,Sa(u!=null?{[u]:t}:t)))}))}));if(this.value)n.rem=this.value;this.value=n.source=n.add=s;return n}});function AN(t,e,n){const i=kN(n.levels||10,n.nice,n.zero!==false);return n.resolve!=="shared"?i:i(t.map((t=>Jo(e(t).values))))}function EN(t,e,n,i){let r=i.scale||e.scale,a=i.translate||e.translate;if((0,g.mf)(r))r=r(n,i);if((0,g.mf)(a))a=a(n,i);if((r===1||r==null)&&!a)return;const o=((0,g.hj)(r)?r:r[0])||1,u=((0,g.hj)(r)?r:r[1])||1,s=a&&a[0]||0,l=a&&a[1]||0;t.forEach(DN(e,o,u,s,l))}function DN(t,e,n,i,r){const a=t.x1||0,o=t.y1||0,u=e*n<0;function s(t){t.forEach(l)}function l(t){if(u)t.reverse();t.forEach(f)}function f(t){t[0]=(t[0]-a)*e+i;t[1]=(t[1]-o)*n+r}return function(t){t.coordinates.forEach(s);return t}}function CN(t,e,n){const i=t>=0?t:su(e,n);return Math.round((Math.sqrt(4*i*i+1)-1)/2)}function FN(t){return(0,g.mf)(t)?t:(0,g.a9)(+t)}function SN(){var t=t=>t[0],e=t=>t[1],n=g.kX,i=[-1,-1],r=960,a=500,o=2;function u(u,s){const l=CN(i[0],u,t)>>o,f=CN(i[1],u,e)>>o,c=l?l+2:0,h=f?f+2:0,d=2*c+(r>>o),p=2*h+(a>>o),g=new Float32Array(d*p),m=new Float32Array(d*p);let y=g;u.forEach((i=>{const r=c+(+t(i)>>o),a=h+(+e(i)>>o);if(r>=0&&r<d&&a>=0&&a<p){g[r+a*d]+=+n(i)}}));if(l>0&&f>0){TN(d,p,g,m,l);BN(d,p,m,g,f);TN(d,p,g,m,l);BN(d,p,m,g,f);TN(d,p,g,m,l);BN(d,p,m,g,f)}else if(l>0){TN(d,p,g,m,l);TN(d,p,m,g,l);TN(d,p,g,m,l);y=m}else if(f>0){BN(d,p,g,m,f);BN(d,p,m,g,f);BN(d,p,g,m,f);y=m}const v=s?Math.pow(2,-2*o):1/lA(y);for(let t=0,e=d*p;t<e;++t)y[t]*=v;return{values:y,scale:1<<o,width:d,height:p,x1:c,y1:h,x2:c+(r>>o),y2:h+(a>>o)}}u.x=function(e){return arguments.length?(t=FN(e),u):t};u.y=function(t){return arguments.length?(e=FN(t),u):e};u.weight=function(t){return arguments.length?(n=FN(t),u):n};u.size=function(t){if(!arguments.length)return[r,a];var e=+t[0],n=+t[1];if(!(e>=0&&n>=0))(0,g.vU)("invalid size");return r=e,a=n,u};u.cellSize=function(t){if(!arguments.length)return 1<<o;if(!((t=+t)>=1))(0,g.vU)("invalid cell size");o=Math.floor(Math.log(t)/Math.LN2);return u};u.bandwidth=function(t){if(!arguments.length)return i;t=(0,g.IX)(t);if(t.length===1)t=[+t[0],+t[0]];if(t.length!==2)(0,g.vU)("invalid bandwidth");return i=t,u};return u}function TN(t,e,n,i,r){const a=(r<<1)+1;for(let o=0;o<e;++o){for(let e=0,u=0;e<t+r;++e){if(e<t){u+=n[e+o*t]}if(e>=r){if(e>=a){u-=n[e-a+o*t]}i[e-r+o*t]=u/Math.min(e+1,t-1+a-e,a)}}}}function BN(t,e,n,i,r){const a=(r<<1)+1;for(let o=0;o<t;++o){for(let u=0,s=0;u<e+r;++u){if(u<e){s+=n[o+u*t]}if(u>=r){if(u>=a){s-=n[o+(u-a)*t]}i[o+(u-r)*t]=s/Math.min(u+1,e-1+a-u,a)}}}}function NN(t){Wo.call(this,null,t)}NN.Definition={type:"KDE2D",metadata:{generates:true},params:[{name:"size",type:"number",array:true,length:2,required:true},{name:"x",type:"field",required:true},{name:"y",type:"field",required:true},{name:"weight",type:"field"},{name:"groupby",type:"field",array:true},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number",array:true,length:2},{name:"counts",type:"boolean",default:false},{name:"as",type:"string",default:"grid"}]};const zN=["x","y","weight","size","cellSize","bandwidth"];function ON(t,e){zN.forEach((n=>e[n]!=null?t[n](e[n]):0));return t}(0,g.XW)(NN,Wo,{transform(t,e){if(this.value&&!e.changed()&&!t.modified())return e.StopPropagation;var n=e.fork(e.NO_SOURCE|e.NO_FIELDS),i=e.materialize(e.SOURCE).source,r=RN(i,t.groupby),a=(t.groupby||[]).map(g.el),o=ON(SN(),t),u=t.as||"grid",s=[];function l(t,e){for(let n=0;n<a.length;++n)t[a[n]]=e[n];return t}s=r.map((e=>Sa(l({[u]:o(e,t.counts)},e.dims))));if(this.value)n.rem=this.value;this.value=n.source=n.add=s;return n}});function RN(t,e){var n=[],i=t=>t(u),r,a,o,u,s,l;if(e==null){n.push(t)}else{for(r={},a=0,o=t.length;a<o;++a){u=t[a];s=e.map(i);l=r[s];if(!l){r[s]=l=[];l.dims=s;n.push(l)}l.push(u)}}return n}function UN(t){Wo.call(this,null,t)}UN.Definition={type:"Contour",metadata:{generates:true},params:[{name:"size",type:"number",array:true,length:2,required:true},{name:"values",type:"number",array:true},{name:"x",type:"field"},{name:"y",type:"field"},{name:"weight",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"nice",type:"boolean",default:false},{name:"thresholds",type:"number",array:true},{name:"smooth",type:"boolean",default:true}]};(0,g.XW)(UN,Wo,{transform(t,e){if(this.value&&!e.changed()&&!t.modified()){return e.StopPropagation}var n=e.fork(e.NO_SOURCE|e.NO_FIELDS),i=mN().smooth(t.smooth!==false),r=t.values,a=t.thresholds||kN(t.count||10,t.nice,!!r),o=t.size,u,s;if(!r){r=e.materialize(e.SOURCE).source;u=ON(SN(),t)(r,true);s=DN(u,u.scale||1,u.scale||1,0,0);o=[u.width,u.height];r=u.values}a=(0,g.kJ)(a)?a:a(r);r=i.size(o)(r,a);if(s)r.forEach(s);if(this.value)n.rem=this.value;this.value=n.source=n.add=(r||[]).map(Sa);return n}});const $N="Feature";const PN="FeatureCollection";const qN="MultiPoint";function IN(t){Wo.call(this,null,t)}IN.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:true,length:2},{name:"geojson",type:"field"}]};(0,g.XW)(IN,Wo,{transform(t,e){var n=this._features,i=this._points,r=t.fields,a=r&&r[0],o=r&&r[1],u=t.geojson||!r&&g.yR,s=e.ADD,l;l=t.modified()||e.changed(e.REM)||e.modified((0,g.Oj)(u))||a&&e.modified((0,g.Oj)(a))||o&&e.modified((0,g.Oj)(o));if(!this.value||l){s=e.SOURCE;this._features=n=[];this._points=i=[]}if(u){e.visit(s,(t=>n.push(u(t))))}if(a&&o){e.visit(s,(t=>{var e=a(t),n=o(t);if(e!=null&&n!=null&&(e=+e)===e&&(n=+n)===n){i.push([e,n])}}));n=n.concat({type:$N,geometry:{type:qN,coordinates:i}})}this.value={type:PN,features:n}}});function LN(t){Wo.call(this,null,t)}LN.Definition={type:"GeoPath",metadata:{modifies:true},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:true},{name:"as",type:"string",default:"path"}]};(0,g.XW)(LN,Wo,{transform(t,e){var n=e.fork(e.ALL),i=this.value,r=t.field||g.yR,a=t.as||"path",o=n.SOURCE;if(!i||t.modified()){this.value=i=UB(t.projection);n.materialize().reflow()}else{o=r===g.yR||e.modified(r.fields)?n.ADD_MOD:n.ADD}const u=jN(i,t.pointRadius);n.visit(o,(t=>t[a]=i(r(t))));i.pointRadius(u);return n.modifies(a)}});function jN(t,e){const n=t.pointRadius();t.context(null);if(e!=null){t.pointRadius(e)}return n}function WN(t){Wo.call(this,null,t)}WN.Definition={type:"GeoPoint",metadata:{modifies:true},params:[{name:"projection",type:"projection",required:true},{name:"fields",type:"field",array:true,required:true,length:2},{name:"as",type:"string",array:true,length:2,default:["x","y"]}]};(0,g.XW)(WN,Wo,{transform(t,e){var n=t.projection,i=t.fields[0],r=t.fields[1],a=t.as||["x","y"],o=a[0],u=a[1],s;function l(t){const e=n([i(t),r(t)]);if(e){t[o]=e[0];t[u]=e[1]}else{t[o]=undefined;t[u]=undefined}}if(t.modified()){e=e.materialize().reflow(true).visit(e.SOURCE,l)}else{s=e.modified(i.fields)||e.modified(r.fields);e.visit(s?e.ADD_MOD:e.ADD,l)}return e.modifies(a)}});function XN(t){Wo.call(this,null,t)}XN.Definition={type:"GeoShape",metadata:{modifies:true,nomod:true},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:true},{name:"as",type:"string",default:"shape"}]};(0,g.XW)(XN,Wo,{transform(t,e){var n=e.fork(e.ALL),i=this.value,r=t.as||"shape",a=n.ADD;if(!i||t.modified()){this.value=i=HN(UB(t.projection),t.field||(0,g.EP)("datum"),t.pointRadius);n.materialize().reflow();a=n.SOURCE}n.visit(a,(t=>t[r]=i));return n.modifies(r)}});function HN(t,e,n){const i=n==null?n=>t(e(n)):i=>{var r=t.pointRadius(),a=t.pointRadius(n)(e(i));t.pointRadius(r);return a};i.context=e=>{t.context(e);return i};return i}function YN(t){Wo.call(this,[],t);this.generator=hN()}YN.Definition={type:"Graticule",metadata:{changes:true,generates:true},params:[{name:"extent",type:"array",array:true,length:2,content:{type:"number",array:true,length:2}},{name:"extentMajor",type:"array",array:true,length:2,content:{type:"number",array:true,length:2}},{name:"extentMinor",type:"array",array:true,length:2,content:{type:"number",array:true,length:2}},{name:"step",type:"number",array:true,length:2},{name:"stepMajor",type:"number",array:true,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:true,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]};(0,g.XW)(YN,Wo,{transform(t,e){var n=this.value,i=this.generator,r;if(!n.length||t.modified()){for(const e in t){if((0,g.mf)(i[e])){i[e](t[e])}}}r=i();if(n.length){e.mod.push(Na(n[0],r))}else{e.add.push(Sa(r))}n[0]=r;return e}});function JN(t){Wo.call(this,null,t)}JN.Definition={type:"heatmap",metadata:{modifies:true},params:[{name:"field",type:"field"},{name:"color",type:"string",expr:true},{name:"opacity",type:"number",expr:true},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"as",type:"string",default:"image"}]};(0,g.XW)(JN,Wo,{transform(t,e){if(!e.changed()&&!t.modified()){return e.StopPropagation}var n=e.materialize(e.SOURCE).source,i=t.resolve==="shared",r=t.field||g.yR,a=GN(t.opacity,t),o=VN(t.color,t),u=t.as||"image",s={$x:0,$y:0,$value:0,$max:i?Jo(n.map((t=>Jo(r(t).values)))):0};n.forEach((t=>{const e=r(t);const n=(0,g.l7)({},t,s);if(!i)n.$max=Jo(e.values||[]);t[u]=ZN(e,n,o.dep?o:(0,g.a9)(o(n)),a.dep?a:(0,g.a9)(a(n)))}));return e.reflow(true).modifies(u)}});function VN(t,e){let n;if((0,g.mf)(t)){n=n=>Rh(t(n,e));n.dep=KN(t)}else{n=(0,g.a9)(Rh(t||"#888"))}return n}function GN(t,e){let n;if((0,g.mf)(t)){n=n=>t(n,e);n.dep=KN(t)}else if(t){n=(0,g.a9)(t)}else{n=t=>t.$value/t.$max||0;n.dep=true}return n}function KN(t){if(!(0,g.mf)(t))return false;const e=(0,g.Rg)((0,g.Oj)(t));return e.$x||e.$y||e.$value||e.$max}function ZN(t,e,n,i){const r=t.width,a=t.height,o=t.x1||0,u=t.y1||0,s=t.x2||r,l=t.y2||a,f=t.values,c=f?t=>f[t]:g.bM,h=Vc(s-o,l-u),d=h.getContext("2d"),p=d.getImageData(0,0,s-o,l-u),m=p.data;for(let g=u,y=0;g<l;++g){e.$y=g-u;for(let t=o,a=g*r;t<s;++t,y+=4){e.$x=t-o;e.$value=c(t+a);const r=n(e);m[y+0]=r.r;m[y+1]=r.g;m[y+2]=r.b;m[y+3]=~~(255*i(e))}}d.putImageData(p,0,0);return h}function QN(t){Wo.call(this,null,t);this.modified(true)}(0,g.XW)(QN,Wo,{transform(t,e){let n=this.value;if(!n||t.modified("type")){this.value=n=ez(t.type);zB.forEach((e=>{if(t[e]!=null)nz(n,e,t[e])}))}else{zB.forEach((e=>{if(t.modified(e))nz(n,e,t[e])}))}if(t.pointRadius!=null)n.path.pointRadius(t.pointRadius);if(t.fit)tz(n,t);return e.fork(e.NO_SOURCE|e.NO_FIELDS)}});function tz(t,e){const n=iz(e.fit);e.extent?t.fitExtent(e.extent,n):e.size?t.fitSize(e.size,n):0}function ez(t){const e=RB((t||"mercator").toLowerCase());if(!e)(0,g.vU)("Unrecognized projection type: "+t);return e()}function nz(t,e,n){if((0,g.mf)(t[e]))t[e](n)}function iz(t){t=(0,g.IX)(t);return t.length===1?t[0]:{type:PN,features:t.reduce(((t,e)=>t.concat(rz(e))),[])}}function rz(t){return t.type===PN?t.features:(0,g.IX)(t).filter((t=>t!=null)).map((t=>t.type===$N?t:{type:$N,geometry:t}))}function az(t,e){var n,i=1;if(t==null)t=0;if(e==null)e=0;function r(){var r,a=n.length,o,u=0,s=0;for(r=0;r<a;++r){o=n[r],u+=o.x,s+=o.y}for(u=(u/a-t)*i,s=(s/a-e)*i,r=0;r<a;++r){o=n[r],o.x-=u,o.y-=s}}r.initialize=function(t){n=t};r.x=function(e){return arguments.length?(t=+e,r):t};r.y=function(t){return arguments.length?(e=+t,r):e};r.strength=function(t){return arguments.length?(i=+t,r):i};return r}function oz(t){var e=+this._x.call(null,t),n=+this._y.call(null,t);return uz(this.cover(e,n),e,n,t)}function uz(t,e,n,i){if(isNaN(e)||isNaN(n))return t;var r,a=t._root,o={data:i},u=t._x0,s=t._y0,l=t._x1,f=t._y1,c,h,d,p,g,m,y,v;if(!a)return t._root=o,t;while(a.length){if(g=e>=(c=(u+l)/2))u=c;else l=c;if(m=n>=(h=(s+f)/2))s=h;else f=h;if(r=a,!(a=a[y=m<<1|g]))return r[y]=o,t}d=+t._x.call(null,a.data);p=+t._y.call(null,a.data);if(e===d&&n===p)return o.next=a,r?r[y]=o:t._root=o,t;do{r=r?r[y]=new Array(4):t._root=new Array(4);if(g=e>=(c=(u+l)/2))u=c;else l=c;if(m=n>=(h=(s+f)/2))s=h;else f=h}while((y=m<<1|g)===(v=(p>=h)<<1|d>=c));return r[v]=a,r[y]=o,t}function sz(t){var e,n,i=t.length,r,a,o=new Array(i),u=new Array(i),s=Infinity,l=Infinity,f=-Infinity,c=-Infinity;for(n=0;n<i;++n){if(isNaN(r=+this._x.call(null,e=t[n]))||isNaN(a=+this._y.call(null,e)))continue;o[n]=r;u[n]=a;if(r<s)s=r;if(r>f)f=r;if(a<l)l=a;if(a>c)c=a}if(s>f||l>c)return this;this.cover(s,l).cover(f,c);for(n=0;n<i;++n){uz(this,o[n],u[n],t[n])}return this}function lz(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,i=this._y0,r=this._x1,a=this._y1;if(isNaN(n)){r=(n=Math.floor(t))+1;a=(i=Math.floor(e))+1}else{var o=r-n,u=this._root,s,l;while(n>t||t>=r||i>e||e>=a){l=(e<i)<<1|t<n;s=new Array(4),s[l]=u,u=s,o*=2;switch(l){case 0:r=n+o,a=i+o;break;case 1:n=r-o,a=i+o;break;case 2:r=n+o,i=a-o;break;case 3:n=r-o,i=a-o;break}}if(this._root&&this._root.length)this._root=u}this._x0=n;this._y0=i;this._x1=r;this._y1=a;return this}function fz(){var t=[];this.visit((function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)}));return t}function cz(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?undefined:[[this._x0,this._y0],[this._x1,this._y1]]}function hz(t,e,n,i,r){this.node=t;this.x0=e;this.y0=n;this.x1=i;this.y1=r}function dz(t,e,n){var i,r=this._x0,a=this._y0,o,u,s,l,f=this._x1,c=this._y1,h=[],d=this._root,p,g;if(d)h.push(new hz(d,r,a,f,c));if(n==null)n=Infinity;else{r=t-n,a=e-n;f=t+n,c=e+n;n*=n}while(p=h.pop()){if(!(d=p.node)||(o=p.x0)>f||(u=p.y0)>c||(s=p.x1)<r||(l=p.y1)<a)continue;if(d.length){var m=(o+s)/2,y=(u+l)/2;h.push(new hz(d[3],m,y,s,l),new hz(d[2],o,y,m,l),new hz(d[1],m,u,s,y),new hz(d[0],o,u,m,y));if(g=(e>=y)<<1|t>=m){p=h[h.length-1];h[h.length-1]=h[h.length-1-g];h[h.length-1-g]=p}}else{var v=t-+this._x.call(null,d.data),x=e-+this._y.call(null,d.data),_=v*v+x*x;if(_<n){var b=Math.sqrt(n=_);r=t-b,a=e-b;f=t+b,c=e+b;i=d.data}}}return i}function pz(t){if(isNaN(f=+this._x.call(null,t))||isNaN(c=+this._y.call(null,t)))return this;var e,n=this._root,i,r,a,o=this._x0,u=this._y0,s=this._x1,l=this._y1,f,c,h,d,p,g,m,y;if(!n)return this;if(n.length)while(true){if(p=f>=(h=(o+s)/2))o=h;else s=h;if(g=c>=(d=(u+l)/2))u=d;else l=d;if(!(e=n,n=n[m=g<<1|p]))return this;if(!n.length)break;if(e[m+1&3]||e[m+2&3]||e[m+3&3])i=e,y=m}while(n.data!==t)if(!(r=n,n=n.next))return this;if(a=n.next)delete n.next;if(r)return a?r.next=a:delete r.next,this;if(!e)return this._root=a,this;a?e[m]=a:delete e[m];if((n=e[0]||e[1]||e[2]||e[3])&&n===(e[3]||e[2]||e[1]||e[0])&&!n.length){if(i)i[y]=n;else this._root=n}return this}function gz(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this}function mz(){return this._root}function yz(){var t=0;this.visit((function(e){if(!e.length)do{++t}while(e=e.next)}));return t}function vz(t){var e=[],n,i=this._root,r,a,o,u,s;if(i)e.push(new hz(i,this._x0,this._y0,this._x1,this._y1));while(n=e.pop()){if(!t(i=n.node,a=n.x0,o=n.y0,u=n.x1,s=n.y1)&&i.length){var l=(a+u)/2,f=(o+s)/2;if(r=i[3])e.push(new hz(r,l,f,u,s));if(r=i[2])e.push(new hz(r,a,f,l,s));if(r=i[1])e.push(new hz(r,l,o,u,f));if(r=i[0])e.push(new hz(r,a,o,l,f))}}return this}function xz(t){var e=[],n=[],i;if(this._root)e.push(new hz(this._root,this._x0,this._y0,this._x1,this._y1));while(i=e.pop()){var r=i.node;if(r.length){var a,o=i.x0,u=i.y0,s=i.x1,l=i.y1,f=(o+s)/2,c=(u+l)/2;if(a=r[0])e.push(new hz(a,o,u,f,c));if(a=r[1])e.push(new hz(a,f,u,s,c));if(a=r[2])e.push(new hz(a,o,c,f,l));if(a=r[3])e.push(new hz(a,f,c,s,l))}n.push(i)}while(i=n.pop()){t(i.node,i.x0,i.y0,i.x1,i.y1)}return this}function _z(t){return t[0]}function bz(t){return arguments.length?(this._x=t,this):this._x}function wz(t){return t[1]}function kz(t){return arguments.length?(this._y=t,this):this._y}function Mz(t,e,n){var i=new Az(e==null?_z:e,n==null?wz:n,NaN,NaN,NaN,NaN);return t==null?i:i.addAll(t)}function Az(t,e,n,i,r,a){this._x=t;this._y=e;this._x0=n;this._y0=i;this._x1=r;this._y1=a;this._root=undefined}function Ez(t){var e={data:t.data},n=e;while(t=t.next)n=n.next={data:t.data};return e}var Dz=Mz.prototype=Az.prototype;Dz.copy=function(){var t=new Az(this._x,this._y,this._x0,this._y0,this._x1,this._y1),e=this._root,n,i;if(!e)return t;if(!e.length)return t._root=Ez(e),t;n=[{source:e,target:t._root=new Array(4)}];while(e=n.pop()){for(var r=0;r<4;++r){if(i=e.source[r]){if(i.length)n.push({source:i,target:e.target[r]=new Array(4)});else e.target[r]=Ez(i)}}}return t};Dz.add=oz;Dz.addAll=sz;Dz.cover=lz;Dz.data=fz;Dz.extent=cz;Dz.find=dz;Dz.remove=pz;Dz.removeAll=gz;Dz.root=mz;Dz.size=yz;Dz.visit=vz;Dz.visitAfter=xz;Dz.x=bz;Dz.y=kz;function Cz(t){return function(){return t}}function Fz(t){return(t()-.5)*1e-6}function Sz(t){return t.x+t.vx}function Tz(t){return t.y+t.vy}function Bz(t){var e,n,i,r=1,a=1;if(typeof t!=="function")t=Cz(t==null?1:+t);function o(){var t,o=e.length,s,l,f,c,h,d;for(var p=0;p<a;++p){s=Mz(e,Sz,Tz).visitAfter(u);for(t=0;t<o;++t){l=e[t];h=n[l.index],d=h*h;f=l.x+l.vx;c=l.y+l.vy;s.visit(g)}}function g(t,e,n,a,o){var u=t.data,s=t.r,p=h+s;if(u){if(u.index>l.index){var g=f-u.x-u.vx,m=c-u.y-u.vy,y=g*g+m*m;if(y<p*p){if(g===0)g=Fz(i),y+=g*g;if(m===0)m=Fz(i),y+=m*m;y=(p-(y=Math.sqrt(y)))/y*r;l.vx+=(g*=y)*(p=(s*=s)/(d+s));l.vy+=(m*=y)*p;u.vx-=g*(p=1-p);u.vy-=m*p}}return}return e>f+p||a<f-p||n>c+p||o<c-p}}function u(t){if(t.data)return t.r=n[t.data.index];for(var e=t.r=0;e<4;++e){if(t[e]&&t[e].r>t.r){t.r=t[e].r}}}function s(){if(!e)return;var i,r=e.length,a;n=new Array(r);for(i=0;i<r;++i)a=e[i],n[a.index]=+t(a,i,e)}o.initialize=function(t,n){e=t;i=n;s()};o.iterations=function(t){return arguments.length?(a=+t,o):a};o.strength=function(t){return arguments.length?(r=+t,o):r};o.radius=function(e){return arguments.length?(t=typeof e==="function"?e:Cz(+e),s(),o):t};return o}var Nz={value:function(){}};function zz(){for(var t=0,e=arguments.length,n={},i;t<e;++t){if(!(i=arguments[t]+"")||i in n||/[\s.]/.test(i))throw new Error("illegal type: "+i);n[i]=[]}return new Oz(n)}function Oz(t){this._=t}function Rz(t,e){return t.trim().split(/^|\s+/).map((function(t){var n="",i=t.indexOf(".");if(i>=0)n=t.slice(i+1),t=t.slice(0,i);if(t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}}))}Oz.prototype=zz.prototype={constructor:Oz,on:function(t,e){var n=this._,i=Rz(t+"",n),r,a=-1,o=i.length;if(arguments.length<2){while(++a<o)if((r=(t=i[a]).type)&&(r=Uz(n[r],t.name)))return r;return}if(e!=null&&typeof e!=="function")throw new Error("invalid callback: "+e);while(++a<o){if(r=(t=i[a]).type)n[r]=$z(n[r],t.name,e);else if(e==null)for(r in n)n[r]=$z(n[r],t.name,null)}return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Oz(t)},call:function(t,e){if((r=arguments.length-2)>0)for(var n=new Array(r),i=0,r,a;i<r;++i)n[i]=arguments[i+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(a=this._[t],i=0,r=a.length;i<r;++i)a[i].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var i=this._[t],r=0,a=i.length;r<a;++r)i[r].value.apply(e,n)}};function Uz(t,e){for(var n=0,i=t.length,r;n<i;++n){if((r=t[n]).name===e){return r.value}}}function $z(t,e,n){for(var i=0,r=t.length;i<r;++i){if(t[i].name===e){t[i]=Nz,t=t.slice(0,i).concat(t.slice(i+1));break}}if(n!=null)t.push({name:e,value:n});return t}const Pz=zz;var qz=0,Iz=0,Lz=0,jz=1e3,Wz,Xz,Hz=0,Yz=0,Jz=0,Vz=typeof performance==="object"&&performance.now?performance:Date,Gz=typeof window==="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Kz(){return Yz||(Gz(Zz),Yz=Vz.now()+Jz)}function Zz(){Yz=0}function Qz(){this._call=this._time=this._next=null}Qz.prototype=tO.prototype={constructor:Qz,restart:function(t,e,n){if(typeof t!=="function")throw new TypeError("callback is not a function");n=(n==null?Kz():+n)+(e==null?0:+e);if(!this._next&&Xz!==this){if(Xz)Xz._next=this;else Wz=this;Xz=this}this._call=t;this._time=n;aO()},stop:function(){if(this._call){this._call=null;this._time=Infinity;aO()}}};function tO(t,e,n){var i=new Qz;i.restart(t,e,n);return i}function eO(){Kz();++qz;var t=Wz,e;while(t){if((e=Yz-t._time)>=0)t._call.call(null,e);t=t._next}--qz}function nO(){Yz=(Hz=Vz.now())+Jz;qz=Iz=0;try{eO()}finally{qz=0;rO();Yz=0}}function iO(){var t=Vz.now(),e=t-Hz;if(e>jz)Jz-=e,Hz=t}function rO(){var t,e=Wz,n,i=Infinity;while(e){if(e._call){if(i>e._time)i=e._time;t=e,e=e._next}else{n=e._next,e._next=null;e=t?t._next=n:Wz=n}}Xz=t;aO(i)}function aO(t){if(qz)return;if(Iz)Iz=clearTimeout(Iz);var e=t-Yz;if(e>24){if(t<Infinity)Iz=setTimeout(nO,t-Vz.now()-Jz);if(Lz)Lz=clearInterval(Lz)}else{if(!Lz)Hz=Vz.now(),Lz=setInterval(iO,jz);qz=1,Gz(nO)}}const oO=1664525;const uO=1013904223;const sO=4294967296;function lO(){let t=1;return()=>(t=(oO*t+uO)%sO)/sO}function fO(t){return t.x}function cO(t){return t.y}var hO=10,dO=Math.PI*(3-Math.sqrt(5));function pO(t){var e,n=1,i=.001,r=1-Math.pow(i,1/300),a=0,o=.6,u=new Map,s=tO(c),l=Pz("tick","end"),f=lO();if(t==null)t=[];function c(){h();l.call("tick",e);if(n<i){s.stop();l.call("end",e)}}function h(i){var s,l=t.length,f;if(i===undefined)i=1;for(var c=0;c<i;++c){n+=(a-n)*r;u.forEach((function(t){t(n)}));for(s=0;s<l;++s){f=t[s];if(f.fx==null)f.x+=f.vx*=o;else f.x=f.fx,f.vx=0;if(f.fy==null)f.y+=f.vy*=o;else f.y=f.fy,f.vy=0}}return e}function d(){for(var e=0,n=t.length,i;e<n;++e){i=t[e],i.index=e;if(i.fx!=null)i.x=i.fx;if(i.fy!=null)i.y=i.fy;if(isNaN(i.x)||isNaN(i.y)){var r=hO*Math.sqrt(.5+e),a=e*dO;i.x=r*Math.cos(a);i.y=r*Math.sin(a)}if(isNaN(i.vx)||isNaN(i.vy)){i.vx=i.vy=0}}}function p(e){if(e.initialize)e.initialize(t,f);return e}d();return e={tick:h,restart:function(){return s.restart(c),e},stop:function(){return s.stop(),e},nodes:function(n){return arguments.length?(t=n,d(),u.forEach(p),e):t},alpha:function(t){return arguments.length?(n=+t,e):n},alphaMin:function(t){return arguments.length?(i=+t,e):i},alphaDecay:function(t){return arguments.length?(r=+t,e):+r},alphaTarget:function(t){return arguments.length?(a=+t,e):a},velocityDecay:function(t){return arguments.length?(o=1-t,e):1-o},randomSource:function(t){return arguments.length?(f=t,u.forEach(p),e):f},force:function(t,n){return arguments.length>1?(n==null?u.delete(t):u.set(t,p(n)),e):u.get(t)},find:function(e,n,i){var r=0,a=t.length,o,u,s,l,f;if(i==null)i=Infinity;else i*=i;for(r=0;r<a;++r){l=t[r];o=e-l.x;u=n-l.y;s=o*o+u*u;if(s<i)f=l,i=s}return f},on:function(t,n){return arguments.length>1?(l.on(t,n),e):l.on(t)}}}function gO(){var t,e,n,i,r=Cz(-30),a,o=1,u=Infinity,s=.81;function l(n){var r,a=t.length,o=Mz(t,fO,cO).visitAfter(c);for(i=n,r=0;r<a;++r)e=t[r],o.visit(h)}function f(){if(!t)return;var e,n=t.length,i;a=new Array(n);for(e=0;e<n;++e)i=t[e],a[i.index]=+r(i,e,t)}function c(t){var e=0,n,i,r=0,o,u,s;if(t.length){for(o=u=s=0;s<4;++s){if((n=t[s])&&(i=Math.abs(n.value))){e+=n.value,r+=i,o+=i*n.x,u+=i*n.y}}t.x=o/r;t.y=u/r}else{n=t;n.x=n.data.x;n.y=n.data.y;do{e+=a[n.data.index]}while(n=n.next)}t.value=e}function h(t,r,l,f){if(!t.value)return true;var c=t.x-e.x,h=t.y-e.y,d=f-r,p=c*c+h*h;if(d*d/s<p){if(p<u){if(c===0)c=Fz(n),p+=c*c;if(h===0)h=Fz(n),p+=h*h;if(p<o)p=Math.sqrt(o*p);e.vx+=c*t.value*i/p;e.vy+=h*t.value*i/p}return true}else if(t.length||p>=u)return;if(t.data!==e||t.next){if(c===0)c=Fz(n),p+=c*c;if(h===0)h=Fz(n),p+=h*h;if(p<o)p=Math.sqrt(o*p)}do{if(t.data!==e){d=a[t.data.index]*i/p;e.vx+=c*d;e.vy+=h*d}}while(t=t.next)}l.initialize=function(e,i){t=e;n=i;f()};l.strength=function(t){return arguments.length?(r=typeof t==="function"?t:Cz(+t),f(),l):r};l.distanceMin=function(t){return arguments.length?(o=t*t,l):Math.sqrt(o)};l.distanceMax=function(t){return arguments.length?(u=t*t,l):Math.sqrt(u)};l.theta=function(t){return arguments.length?(s=t*t,l):Math.sqrt(s)};return l}function mO(t){return t.index}function yO(t,e){var n=t.get(e);if(!n)throw new Error("node not found: "+e);return n}function vO(t){var e=mO,n=c,i,r=Cz(30),a,o,u,s,l,f=1;if(t==null)t=[];function c(t){return 1/Math.min(u[t.source.index],u[t.target.index])}function h(e){for(var n=0,r=t.length;n<f;++n){for(var o=0,u,c,h,d,p,g,m;o<r;++o){u=t[o],c=u.source,h=u.target;d=h.x+h.vx-c.x-c.vx||Fz(l);p=h.y+h.vy-c.y-c.vy||Fz(l);g=Math.sqrt(d*d+p*p);g=(g-a[o])/g*e*i[o];d*=g,p*=g;h.vx-=d*(m=s[o]);h.vy-=p*m;c.vx+=d*(m=1-m);c.vy+=p*m}}}function d(){if(!o)return;var n,r=o.length,l=t.length,f=new Map(o.map(((t,n)=>[e(t,n,o),t]))),c;for(n=0,u=new Array(r);n<l;++n){c=t[n],c.index=n;if(typeof c.source!=="object")c.source=yO(f,c.source);if(typeof c.target!=="object")c.target=yO(f,c.target);u[c.source.index]=(u[c.source.index]||0)+1;u[c.target.index]=(u[c.target.index]||0)+1}for(n=0,s=new Array(l);n<l;++n){c=t[n],s[n]=u[c.source.index]/(u[c.source.index]+u[c.target.index])}i=new Array(l),p();a=new Array(l),g()}function p(){if(!o)return;for(var e=0,r=t.length;e<r;++e){i[e]=+n(t[e],e,t)}}function g(){if(!o)return;for(var e=0,n=t.length;e<n;++e){a[e]=+r(t[e],e,t)}}h.initialize=function(t,e){o=t;l=e;d()};h.links=function(e){return arguments.length?(t=e,d(),h):t};h.id=function(t){return arguments.length?(e=t,h):e};h.iterations=function(t){return arguments.length?(f=+t,h):f};h.strength=function(t){return arguments.length?(n=typeof t==="function"?t:Cz(+t),p(),h):n};h.distance=function(t){return arguments.length?(r=typeof t==="function"?t:Cz(+t),g(),h):r};return h}function xO(t){var e=Cz(.1),n,i,r;if(typeof t!=="function")t=Cz(t==null?0:+t);function a(t){for(var e=0,a=n.length,o;e<a;++e){o=n[e],o.vx+=(r[e]-o.x)*i[e]*t}}function o(){if(!n)return;var a,o=n.length;i=new Array(o);r=new Array(o);for(a=0;a<o;++a){i[a]=isNaN(r[a]=+t(n[a],a,n))?0:+e(n[a],a,n)}}a.initialize=function(t){n=t;o()};a.strength=function(t){return arguments.length?(e=typeof t==="function"?t:Cz(+t),o(),a):e};a.x=function(e){return arguments.length?(t=typeof e==="function"?e:Cz(+e),o(),a):t};return a}function _O(t){var e=Cz(.1),n,i,r;if(typeof t!=="function")t=Cz(t==null?0:+t);function a(t){for(var e=0,a=n.length,o;e<a;++e){o=n[e],o.vy+=(r[e]-o.y)*i[e]*t}}function o(){if(!n)return;var a,o=n.length;i=new Array(o);r=new Array(o);for(a=0;a<o;++a){i[a]=isNaN(r[a]=+t(n[a],a,n))?0:+e(n[a],a,n)}}a.initialize=function(t){n=t;o()};a.strength=function(t){return arguments.length?(e=typeof t==="function"?t:Cz(+t),o(),a):e};a.y=function(e){return arguments.length?(t=typeof e==="function"?e:Cz(+e),o(),a):t};return a}const bO={center:az,collide:Bz,nbody:gO,link:vO,x:xO,y:_O};const wO="forces",kO=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],MO=["static","iterations"],AO=["x","y","vx","vy"];function EO(t){Wo.call(this,null,t)}EO.Definition={type:"Force",metadata:{modifies:true},params:[{name:"static",type:"boolean",default:false},{name:"restart",type:"boolean",default:false},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:true,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:true},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:true},{name:"strength",type:"number",expr:true},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:true,modify:false,default:AO}]};(0,g.XW)(EO,Wo,{transform(t,e){var n=this.value,i=e.changed(e.ADD_REM),r=t.modified(kO),a=t.iterations||300;if(!n){this.value=n=CO(e.source,t);n.on("tick",DO(e.dataflow,this));if(!t.static){i=true;n.tick()}e.modifies("index")}else{if(i){e.modifies("index");n.nodes(e.source)}if(r||e.changed(e.MOD)){FO(n,t,0,e)}}if(r||i||t.modified(MO)||e.changed()&&t.restart){n.alpha(Math.max(n.alpha(),t.alpha||1)).alphaDecay(1-Math.pow(n.alphaMin(),1/a));if(t.static){for(n.stop();--a>=0;)n.tick()}else{if(n.stopped())n.restart();if(!i)return e.StopPropagation}}return this.finish(t,e)},finish(t,e){const n=e.dataflow;for(let u=this._argops,s=0,l=u.length,f;s<l;++s){f=u[s];if(f.name!==wO||f.op._argval.force!=="link"){continue}for(var i=f.op._argops,r=0,a=i.length,o;r<a;++r){if(i[r].name==="links"&&(o=i[r].op.source)){n.pulse(o,n.changeset().reflow());break}}}return e.reflow(t.modified()).modifies(AO)}});function DO(t,e){return()=>t.touch(e).run()}function CO(t,e){const n=pO(t),i=n.stop,r=n.restart;let a=false;n.stopped=()=>a;n.restart=()=>(a=false,r());n.stop=()=>(a=true,i());return FO(n,e,true).on("end",(()=>a=true))}function FO(t,e,n,i){var r=(0,g.IX)(e.forces),a,o,u,s;for(a=0,o=kO.length;a<o;++a){u=kO[a];if(u!==wO&&e.modified(u))t[u](e[u])}for(a=0,o=r.length;a<o;++a){s=wO+a;u=n||e.modified(wO,a)?TO(r[a]):i&&SO(r[a],i)?t.force(s):null;if(u)t.force(s,u)}for(o=t.numForces||0;a<o;++a){t.force(wO+a,null)}t.numForces=r.length;return t}function SO(t,e){var n,i;for(n in t){if((0,g.mf)(i=t[n])&&e.modified((0,g.Oj)(i)))return 1}return 0}function TO(t){var e,n;if(!(0,g.nr)(bO,t.force)){(0,g.vU)("Unrecognized force: "+t.force)}e=bO[t.force]();for(n in t){if((0,g.mf)(e[n]))BO(e[n],t[n],t)}return e}function BO(t,e,n){t((0,g.mf)(e)?t=>e(t,n):e)}function NO(t){var e=0,n=t.children,i=n&&n.length;if(!i)e=1;else while(--i>=0)e+=n[i].value;t.value=e}function zO(){return this.eachAfter(NO)}function OO(t,e){let n=-1;for(const i of this){t.call(e,i,++n,this)}return this}function RO(t,e){var n=this,i=[n],r,a,o=-1;while(n=i.pop()){t.call(e,n,++o,this);if(r=n.children){for(a=r.length-1;a>=0;--a){i.push(r[a])}}}return this}function UO(t,e){var n=this,i=[n],r=[],a,o,u,s=-1;while(n=i.pop()){r.push(n);if(a=n.children){for(o=0,u=a.length;o<u;++o){i.push(a[o])}}}while(n=r.pop()){t.call(e,n,++s,this)}return this}function $O(t,e){let n=-1;for(const i of this){if(t.call(e,i,++n,this)){return i}}}function PO(t){return this.eachAfter((function(e){var n=+t(e.data)||0,i=e.children,r=i&&i.length;while(--r>=0)n+=i[r].value;e.value=n}))}function qO(t){return this.eachBefore((function(e){if(e.children){e.children.sort(t)}}))}function IO(t){var e=this,n=LO(e,t),i=[e];while(e!==n){e=e.parent;i.push(e)}var r=i.length;while(t!==n){i.splice(r,0,t);t=t.parent}return i}function LO(t,e){if(t===e)return t;var n=t.ancestors(),i=e.ancestors(),r=null;t=n.pop();e=i.pop();while(t===e){r=t;t=n.pop();e=i.pop()}return r}function jO(){var t=this,e=[t];while(t=t.parent){e.push(t)}return e}function WO(){return Array.from(this)}function XO(){var t=[];this.eachBefore((function(e){if(!e.children){t.push(e)}}));return t}function HO(){var t=this,e=[];t.each((function(n){if(n!==t){e.push({source:n.parent,target:n})}}));return e}function*YO(){var t=this,e,n=[t],i,r,a;do{e=n.reverse(),n=[];while(t=e.pop()){yield t;if(i=t.children){for(r=0,a=i.length;r<a;++r){n.push(i[r])}}}}while(n.length)}function JO(t,e){if(t instanceof Map){t=[undefined,t];if(e===undefined)e=KO}else if(e===undefined){e=GO}var n=new tR(t),i,r=[n],a,o,u,s;while(i=r.pop()){if((o=e(i.data))&&(s=(o=Array.from(o)).length)){i.children=o;for(u=s-1;u>=0;--u){r.push(a=o[u]=new tR(o[u]));a.parent=i;a.depth=i.depth+1}}}return n.eachBefore(QO)}function VO(){return JO(this).eachBefore(ZO)}function GO(t){return t.children}function KO(t){return Array.isArray(t)?t[1]:null}function ZO(t){if(t.data.value!==undefined)t.value=t.data.value;t.data=t.data.data}function QO(t){var e=0;do{t.height=e}while((t=t.parent)&&t.height<++e)}function tR(t){this.data=t;this.depth=this.height=0;this.parent=null}tR.prototype=JO.prototype={constructor:tR,count:zO,each:OO,eachAfter:UO,eachBefore:RO,find:$O,sum:PO,sort:qO,path:IO,ancestors:jO,descendants:WO,leaves:XO,links:HO,copy:VO,[Symbol.iterator]:YO};function eR(t){return typeof t==="object"&&"length"in t?t:Array.from(t)}function nR(t){var e=t.length,n,i;while(e){i=Math.random()*e--|0;n=t[e];t[e]=t[i];t[i]=n}return t}function iR(t){var e=0,n=(t=nR(Array.from(t))).length,i=[],r,a;while(e<n){r=t[e];if(a&&oR(a,r))++e;else a=sR(i=rR(i,r)),e=0}return a}function rR(t,e){var n,i;if(uR(e,t))return[e];for(n=0;n<t.length;++n){if(aR(e,t[n])&&uR(fR(t[n],e),t)){return[t[n],e]}}for(n=0;n<t.length-1;++n){for(i=n+1;i<t.length;++i){if(aR(fR(t[n],t[i]),e)&&aR(fR(t[n],e),t[i])&&aR(fR(t[i],e),t[n])&&uR(cR(t[n],t[i],e),t)){return[t[n],t[i],e]}}}throw new Error}function aR(t,e){var n=t.r-e.r,i=e.x-t.x,r=e.y-t.y;return n<0||n*n<i*i+r*r}function oR(t,e){var n=t.r-e.r+Math.max(t.r,e.r,1)*1e-9,i=e.x-t.x,r=e.y-t.y;return n>0&&n*n>i*i+r*r}function uR(t,e){for(var n=0;n<e.length;++n){if(!oR(t,e[n])){return false}}return true}function sR(t){switch(t.length){case 1:return lR(t[0]);case 2:return fR(t[0],t[1]);case 3:return cR(t[0],t[1],t[2])}}function lR(t){return{x:t.x,y:t.y,r:t.r}}function fR(t,e){var n=t.x,i=t.y,r=t.r,a=e.x,o=e.y,u=e.r,s=a-n,l=o-i,f=u-r,c=Math.sqrt(s*s+l*l);return{x:(n+a+s/c*f)/2,y:(i+o+l/c*f)/2,r:(c+r+u)/2}}function cR(t,e,n){var i=t.x,r=t.y,a=t.r,o=e.x,u=e.y,s=e.r,l=n.x,f=n.y,c=n.r,h=i-o,d=i-l,p=r-u,g=r-f,m=s-a,y=c-a,v=i*i+r*r-a*a,x=v-o*o-u*u+s*s,_=v-l*l-f*f+c*c,b=d*p-h*g,w=(p*_-g*x)/(b*2)-i,k=(g*m-p*y)/b,M=(d*x-h*_)/(b*2)-r,A=(h*y-d*m)/b,E=k*k+A*A-1,D=2*(a+w*k+M*A),C=w*w+M*M-a*a,F=-(E?(D+Math.sqrt(D*D-4*E*C))/(2*E):C/D);return{x:i+w+k*F,y:r+M+A*F,r:F}}function hR(t,e,n){var i=t.x-e.x,r,a,o=t.y-e.y,u,s,l=i*i+o*o;if(l){a=e.r+n.r,a*=a;s=t.r+n.r,s*=s;if(a>s){r=(l+s-a)/(2*l);u=Math.sqrt(Math.max(0,s/l-r*r));n.x=t.x-r*i-u*o;n.y=t.y-r*o+u*i}else{r=(l+a-s)/(2*l);u=Math.sqrt(Math.max(0,a/l-r*r));n.x=e.x+r*i-u*o;n.y=e.y+r*o+u*i}}else{n.x=e.x+n.r;n.y=e.y}}function dR(t,e){var n=t.r+e.r-1e-6,i=e.x-t.x,r=e.y-t.y;return n>0&&n*n>i*i+r*r}function pR(t){var e=t._,n=t.next._,i=e.r+n.r,r=(e.x*n.r+n.x*e.r)/i,a=(e.y*n.r+n.y*e.r)/i;return r*r+a*a}function gR(t){this._=t;this.next=null;this.previous=null}function mR(t){if(!(r=(t=eR(t)).length))return 0;var e,n,i,r,a,o,u,s,l,f,c;e=t[0],e.x=0,e.y=0;if(!(r>1))return e.r;n=t[1],e.x=-n.r,n.x=e.r,n.y=0;if(!(r>2))return e.r+n.r;hR(n,e,i=t[2]);e=new gR(e),n=new gR(n),i=new gR(i);e.next=i.previous=n;n.next=e.previous=i;i.next=n.previous=e;t:for(u=3;u<r;++u){hR(e._,n._,i=t[u]),i=new gR(i);s=n.next,l=e.previous,f=n._.r,c=e._.r;do{if(f<=c){if(dR(s._,i._)){n=s,e.next=n,n.previous=e,--u;continue t}f+=s._.r,s=s.next}else{if(dR(l._,i._)){e=l,e.next=n,n.previous=e,--u;continue t}c+=l._.r,l=l.previous}}while(s!==l.next);i.previous=e,i.next=n,e.next=n.previous=n=i;a=pR(e);while((i=i.next)!==n){if((o=pR(i))<a){e=i,a=o}}n=e.next}e=[n._],i=n;while((i=i.next)!==n)e.push(i._);i=iR(e);for(u=0;u<r;++u)e=t[u],e.x-=i.x,e.y-=i.y;return i.r}function yR(t){mR(t);return t}function vR(t){return t==null?null:xR(t)}function xR(t){if(typeof t!=="function")throw new Error;return t}function _R(){return 0}function bR(t){return function(){return t}}function wR(t){return Math.sqrt(t.value)}function kR(){var t=null,e=1,n=1,i=_R;function r(r){r.x=e/2,r.y=n/2;if(t){r.eachBefore(MR(t)).eachAfter(AR(i,.5)).eachBefore(ER(1))}else{r.eachBefore(MR(wR)).eachAfter(AR(_R,1)).eachAfter(AR(i,r.r/Math.min(e,n))).eachBefore(ER(Math.min(e,n)/(2*r.r)))}return r}r.radius=function(e){return arguments.length?(t=vR(e),r):t};r.size=function(t){return arguments.length?(e=+t[0],n=+t[1],r):[e,n]};r.padding=function(t){return arguments.length?(i=typeof t==="function"?t:bR(+t),r):i};return r}function MR(t){return function(e){if(!e.children){e.r=Math.max(0,+t(e)||0)}}}function AR(t,e){return function(n){if(i=n.children){var i,r,a=i.length,o=t(n)*e||0,u;if(o)for(r=0;r<a;++r)i[r].r+=o;u=mR(i);if(o)for(r=0;r<a;++r)i[r].r-=o;n.r=u+o}}}function ER(t){return function(e){var n=e.parent;e.r*=t;if(n){e.x=n.x+t*e.x;e.y=n.y+t*e.y}}}function DR(t){t.x0=Math.round(t.x0);t.y0=Math.round(t.y0);t.x1=Math.round(t.x1);t.y1=Math.round(t.y1)}function CR(t,e,n,i,r){var a=t.children,o,u=-1,s=a.length,l=t.value&&(i-e)/t.value;while(++u<s){o=a[u],o.y0=n,o.y1=r;o.x0=e,o.x1=e+=o.value*l}}function FR(){var t=1,e=1,n=0,i=false;function r(r){var o=r.height+1;r.x0=r.y0=n;r.x1=t;r.y1=e/o;r.eachBefore(a(e,o));if(i)r.eachBefore(DR);return r}function a(t,e){return function(i){if(i.children){CR(i,i.x0,t*(i.depth+1)/e,i.x1,t*(i.depth+2)/e)}var r=i.x0,a=i.y0,o=i.x1-n,u=i.y1-n;if(o<r)r=o=(r+o)/2;if(u<a)a=u=(a+u)/2;i.x0=r;i.y0=a;i.x1=o;i.y1=u}}r.round=function(t){return arguments.length?(i=!!t,r):i};r.size=function(n){return arguments.length?(t=+n[0],e=+n[1],r):[t,e]};r.padding=function(t){return arguments.length?(n=+t,r):n};return r}var SR={depth:-1},TR={};function BR(t){return t.id}function NR(t){return t.parentId}function zR(){var t=BR,e=NR;function n(n){var i=Array.from(n),r=i.length,a,o,u,s,l,f,c,h=new Map;for(o=0;o<r;++o){a=i[o],l=i[o]=new tR(a);if((f=t(a,o,n))!=null&&(f+="")){c=l.id=f;h.set(c,h.has(c)?TR:l)}if((f=e(a,o,n))!=null&&(f+="")){l.parent=f}}for(o=0;o<r;++o){l=i[o];if(f=l.parent){s=h.get(f);if(!s)throw new Error("missing: "+f);if(s===TR)throw new Error("ambiguous: "+f);if(s.children)s.children.push(l);else s.children=[l];l.parent=s}else{if(u)throw new Error("multiple roots");u=l}}if(!u)throw new Error("no root");u.parent=SR;u.eachBefore((function(t){t.depth=t.parent.depth+1;--r})).eachBefore(QO);u.parent=null;if(r>0)throw new Error("cycle");return u}n.id=function(e){return arguments.length?(t=xR(e),n):t};n.parentId=function(t){return arguments.length?(e=xR(t),n):e};return n}function OR(t,e){return t.parent===e.parent?1:2}function RR(t){var e=t.children;return e?e[0]:t.t}function UR(t){var e=t.children;return e?e[e.length-1]:t.t}function $R(t,e,n){var i=n/(e.i-t.i);e.c-=i;e.s+=n;t.c+=i;e.z+=n;e.m+=n}function PR(t){var e=0,n=0,i=t.children,r=i.length,a;while(--r>=0){a=i[r];a.z+=e;a.m+=e;e+=a.s+(n+=a.c)}}function qR(t,e,n){return t.a.parent===e.parent?t.a:n}function IR(t,e){this._=t;this.parent=null;this.children=null;this.A=null;this.a=this;this.z=0;this.m=0;this.c=0;this.s=0;this.t=null;this.i=e}IR.prototype=Object.create(tR.prototype);function LR(t){var e=new IR(t,0),n,i=[e],r,a,o,u;while(n=i.pop()){if(a=n._.children){n.children=new Array(u=a.length);for(o=u-1;o>=0;--o){i.push(r=n.children[o]=new IR(a[o],o));r.parent=n}}}(e.parent=new IR(null,0)).children=[e];return e}function jR(){var t=OR,e=1,n=1,i=null;function r(r){var u=LR(r);u.eachAfter(a),u.parent.m=-u.z;u.eachBefore(o);if(i)r.eachBefore(s);else{var l=r,f=r,c=r;r.eachBefore((function(t){if(t.x<l.x)l=t;if(t.x>f.x)f=t;if(t.depth>c.depth)c=t}));var h=l===f?1:t(l,f)/2,d=h-l.x,p=e/(f.x+h+d),g=n/(c.depth||1);r.eachBefore((function(t){t.x=(t.x+d)*p;t.y=t.depth*g}))}return r}function a(e){var n=e.children,i=e.parent.children,r=e.i?i[e.i-1]:null;if(n){PR(e);var a=(n[0].z+n[n.length-1].z)/2;if(r){e.z=r.z+t(e._,r._);e.m=e.z-a}else{e.z=a}}else if(r){e.z=r.z+t(e._,r._)}e.parent.A=u(e,r,e.parent.A||i[0])}function o(t){t._.x=t.z+t.parent.m;t.m+=t.parent.m}function u(e,n,i){if(n){var r=e,a=e,o=n,u=r.parent.children[0],s=r.m,l=a.m,f=o.m,c=u.m,h;while(o=UR(o),r=RR(r),o&&r){u=RR(u);a=UR(a);a.a=e;h=o.z+f-r.z-s+t(o._,r._);if(h>0){$R(qR(o,e,i),e,h);s+=h;l+=h}f+=o.m;s+=r.m;c+=u.m;l+=a.m}if(o&&!UR(a)){a.t=o;a.m+=f-l}if(r&&!RR(u)){u.t=r;u.m+=s-c;i=e}}return i}function s(t){t.x*=e;t.y=t.depth*n}r.separation=function(e){return arguments.length?(t=e,r):t};r.size=function(t){return arguments.length?(i=false,e=+t[0],n=+t[1],r):i?null:[e,n]};r.nodeSize=function(t){return arguments.length?(i=true,e=+t[0],n=+t[1],r):i?[e,n]:null};return r}function WR(t,e){return t.parent===e.parent?1:2}function XR(t){return t.reduce(HR,0)/t.length}function HR(t,e){return t+e.x}function YR(t){return 1+t.reduce(JR,0)}function JR(t,e){return Math.max(t,e.y)}function VR(t){var e;while(e=t.children)t=e[0];return t}function GR(t){var e;while(e=t.children)t=e[e.length-1];return t}function KR(){var t=WR,e=1,n=1,i=false;function r(r){var a,o=0;r.eachAfter((function(e){var n=e.children;if(n){e.x=XR(n);e.y=YR(n)}else{e.x=a?o+=t(e,a):0;e.y=0;a=e}}));var u=VR(r),s=GR(r),l=u.x-t(u,s)/2,f=s.x+t(s,u)/2;return r.eachAfter(i?function(t){t.x=(t.x-r.x)*e;t.y=(r.y-t.y)*n}:function(t){t.x=(t.x-l)/(f-l)*e;t.y=(1-(r.y?t.y/r.y:1))*n})}r.separation=function(e){return arguments.length?(t=e,r):t};r.size=function(t){return arguments.length?(i=false,e=+t[0],n=+t[1],r):i?null:[e,n]};r.nodeSize=function(t){return arguments.length?(i=true,e=+t[0],n=+t[1],r):i?[e,n]:null};return r}function ZR(t,e,n,i,r){var a=t.children,o,u=a.length,s,l=new Array(u+1);for(l[0]=s=o=0;o<u;++o){l[o+1]=s+=a[o].value}f(0,u,t.value,e,n,i,r);function f(t,e,n,i,r,o,u){if(t>=e-1){var s=a[t];s.x0=i,s.y0=r;s.x1=o,s.y1=u;return}var c=l[t],h=n/2+c,d=t+1,p=e-1;while(d<p){var g=d+p>>>1;if(l[g]<h)d=g+1;else p=g}if(h-l[d-1]<l[d]-h&&t+1<d)--d;var m=l[d]-c,y=n-m;if(o-i>u-r){var v=n?(i*y+o*m)/n:o;f(t,d,m,i,r,v,u);f(d,e,y,v,r,o,u)}else{var x=n?(r*y+u*m)/n:u;f(t,d,m,i,r,o,x);f(d,e,y,i,x,o,u)}}}function QR(t,e,n,i,r){var a=t.children,o,u=-1,s=a.length,l=t.value&&(r-n)/t.value;while(++u<s){o=a[u],o.x0=e,o.x1=i;o.y0=n,o.y1=n+=o.value*l}}function tU(t,e,n,i,r){(t.depth&1?QR:CR)(t,e,n,i,r)}var eU=(1+Math.sqrt(5))/2;function nU(t,e,n,i,r,a){var o=[],u=e.children,s,l,f=0,c=0,h=u.length,d,p,g=e.value,m,y,v,x,_,b,w;while(f<h){d=r-n,p=a-i;do{m=u[c++].value}while(!m&&c<h);y=v=m;b=Math.max(p/d,d/p)/(g*t);w=m*m*b;_=Math.max(v/w,w/y);for(;c<h;++c){m+=l=u[c].value;if(l<y)y=l;if(l>v)v=l;w=m*m*b;x=Math.max(v/w,w/y);if(x>_){m-=l;break}_=x}o.push(s={value:m,dice:d<p,children:u.slice(f,c)});if(s.dice)CR(s,n,i,r,g?i+=p*m/g:a);else QR(s,n,i,g?n+=d*m/g:r,a);g-=m,f=c}return o}const iU=function t(e){function n(t,n,i,r,a){nU(e,t,n,i,r,a)}n.ratio=function(e){return t((e=+e)>1?e:1)};return n}(eU);const rU=function t(e){function n(t,n,i,r,a){if((o=t._squarify)&&o.ratio===e){var o,u,s,l,f=-1,c,h=o.length,d=t.value;while(++f<h){u=o[f],s=u.children;for(l=u.value=0,c=s.length;l<c;++l)u.value+=s[l].value;if(u.dice)CR(u,n,i,r,d?i+=(a-i)*u.value/d:a);else QR(u,n,i,d?n+=(r-n)*u.value/d:r,a);d-=u.value}}else{t._squarify=o=nU(e,t,n,i,r,a);o.ratio=e}}n.ratio=function(e){return t((e=+e)>1?e:1)};return n}(eU);function aU(){var t=iU,e=false,n=1,i=1,r=[0],a=_R,o=_R,u=_R,s=_R,l=_R;function f(t){t.x0=t.y0=0;t.x1=n;t.y1=i;t.eachBefore(c);r=[0];if(e)t.eachBefore(DR);return t}function c(e){var n=r[e.depth],i=e.x0+n,f=e.y0+n,c=e.x1-n,h=e.y1-n;if(c<i)i=c=(i+c)/2;if(h<f)f=h=(f+h)/2;e.x0=i;e.y0=f;e.x1=c;e.y1=h;if(e.children){n=r[e.depth+1]=a(e)/2;i+=l(e)-n;f+=o(e)-n;c-=u(e)-n;h-=s(e)-n;if(c<i)i=c=(i+c)/2;if(h<f)f=h=(f+h)/2;t(e,i,f,c,h)}}f.round=function(t){return arguments.length?(e=!!t,f):e};f.size=function(t){return arguments.length?(n=+t[0],i=+t[1],f):[n,i]};f.tile=function(e){return arguments.length?(t=xR(e),f):t};f.padding=function(t){return arguments.length?f.paddingInner(t).paddingOuter(t):f.paddingInner()};f.paddingInner=function(t){return arguments.length?(a=typeof t==="function"?t:bR(+t),f):a};f.paddingOuter=function(t){return arguments.length?f.paddingTop(t).paddingRight(t).paddingBottom(t).paddingLeft(t):f.paddingTop()};f.paddingTop=function(t){return arguments.length?(o=typeof t==="function"?t:bR(+t),f):o};f.paddingRight=function(t){return arguments.length?(u=typeof t==="function"?t:bR(+t),f):u};f.paddingBottom=function(t){return arguments.length?(s=typeof t==="function"?t:bR(+t),f):s};f.paddingLeft=function(t){return arguments.length?(l=typeof t==="function"?t:bR(+t),f):l};return f}function oU(t,e,n){const i={};t.each((t=>{const r=t.data;if(n(r))i[e(r)]=t}));t.lookup=i;return t}function uU(t){Wo.call(this,null,t)}uU.Definition={type:"Nest",metadata:{treesource:true,changes:true},params:[{name:"keys",type:"field",array:true},{name:"generate",type:"boolean"}]};const sU=t=>t.values;(0,g.XW)(uU,Wo,{transform(t,e){if(!e.source){(0,g.vU)("Nest transform requires an upstream data source.")}var n=t.generate,i=t.modified(),r=e.clone(),a=this.value;if(!a||i||e.changed()){if(a){a.each((t=>{if(t.children&&Da(t.data)){r.rem.push(t.data)}}))}this.value=a=JO({values:(0,g.IX)(t.keys).reduce(((t,e)=>{t.key(e);return t}),lU()).entries(r.source)},sU);if(n){a.each((t=>{if(t.children){t=Sa(t.data);r.add.push(t);r.source.push(t)}}))}oU(a,Ca,Ca)}r.source.root=a;return r}});function lU(){const t=[],e={entries:t=>i(n(t,0),0),key:n=>(t.push(n),e)};function n(e,i){if(i>=t.length){return e}const r=e.length,a=t[i++],o={},u={};let s=-1,l,f,c;while(++s<r){l=a(f=e[s])+"";if(c=o[l]){c.push(f)}else{o[l]=[f]}}for(l in o){u[l]=n(o[l],i)}return u}function i(e,n){if(++n>t.length)return e;const r=[];for(const t in e){r.push({key:t,values:i(e[t],n)})}return r}return e}function fU(t){Wo.call(this,null,t)}const cU=(t,e)=>t.parent===e.parent?1:2;(0,g.XW)(fU,Wo,{transform(t,e){if(!e.source||!e.source.root){(0,g.vU)(this.constructor.name+" transform requires a backing tree data source.")}const n=this.layout(t.method),i=this.fields,r=e.source.root,a=t.as||i;if(t.field)r.sum(t.field);else r.count();if(t.sort)r.sort(za(t.sort,(t=>t.data)));hU(n,this.params,t);if(n.separation){n.separation(t.separation!==false?cU:g.kX)}try{this.value=n(r)}catch(o){(0,g.vU)(o)}r.each((t=>dU(t,i,a)));return e.reflow(t.modified()).modifies(a).modifies("leaf")}});function hU(t,e,n){for(let i,r=0,a=e.length;r<a;++r){i=e[r];if(i in n)t[i](n[i])}}function dU(t,e,n){const i=t.data,r=e.length-1;for(let a=0;a<r;++a){i[n[a]]=t[e[a]]}i[n[r]]=t.children?t.children.length:0}const pU=["x","y","r","depth","children"];function gU(t){fU.call(this,t)}gU.Definition={type:"Pack",metadata:{tree:true,modifies:true},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:true,length:2},{name:"as",type:"string",array:true,length:pU.length,default:pU}]};(0,g.XW)(gU,fU,{layout:kR,params:["radius","size","padding"],fields:pU});const mU=["x0","y0","x1","y1","depth","children"];function yU(t){fU.call(this,t)}yU.Definition={type:"Partition",metadata:{tree:true,modifies:true},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:false},{name:"size",type:"number",array:true,length:2},{name:"as",type:"string",array:true,length:mU.length,default:mU}]};(0,g.XW)(yU,fU,{layout:FR,params:["size","round","padding"],fields:mU});function vU(t){Wo.call(this,null,t)}vU.Definition={type:"Stratify",metadata:{treesource:true},params:[{name:"key",type:"field",required:true},{name:"parentKey",type:"field",required:true}]};(0,g.XW)(vU,Wo,{transform(t,e){if(!e.source){(0,g.vU)("Stratify transform requires an upstream data source.")}let n=this.value;const i=t.modified(),r=e.fork(e.ALL).materialize(e.SOURCE),a=!n||i||e.changed(e.ADD_REM)||e.modified(t.key.fields)||e.modified(t.parentKey.fields);r.source=r.source.slice();if(a){n=r.source.length?oU(zR().id(t.key).parentId(t.parentKey)(r.source),t.key,g.yb):oU(zR()([{}]),t.key,t.key)}r.source.root=this.value=n;return r}});const xU={tidy:jR,cluster:KR};const _U=["x","y","depth","children"];function bU(t){fU.call(this,t)}bU.Definition={type:"Tree",metadata:{tree:true,modifies:true},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:true,length:2},{name:"nodeSize",type:"number",array:true,length:2},{name:"separation",type:"boolean",default:true},{name:"as",type:"string",array:true,length:_U.length,default:_U}]};(0,g.XW)(bU,fU,{layout(t){const e=t||"tidy";if((0,g.nr)(xU,e))return xU[e]();else(0,g.vU)("Unrecognized Tree layout method: "+e)},params:["size","nodeSize"],fields:_U});function wU(t){Wo.call(this,[],t)}wU.Definition={type:"TreeLinks",metadata:{tree:true,generates:true,changes:true},params:[]};(0,g.XW)(wU,Wo,{transform(t,e){const n=this.value,i=e.source&&e.source.root,r=e.fork(e.NO_SOURCE),a={};if(!i)(0,g.vU)("TreeLinks transform requires a tree data source.");if(e.changed(e.ADD_REM)){r.rem=n;e.visit(e.SOURCE,(t=>a[Ca(t)]=1));i.each((t=>{const e=t.data,n=t.parent&&t.parent.data;if(n&&a[Ca(e)]&&a[Ca(n)]){r.add.push(Sa({source:n,target:e}))}}));this.value=r.add}else if(e.changed(e.MOD)){e.visit(e.MOD,(t=>a[Ca(t)]=1));n.forEach((t=>{if(a[Ca(t.source)]||a[Ca(t.target)]){r.mod.push(t)}}))}return r}});const kU={binary:ZR,dice:CR,slice:QR,slicedice:tU,squarify:iU,resquarify:rU};const MU=["x0","y0","x1","y1","depth","children"];function AU(t){fU.call(this,t)}AU.Definition={type:"Treemap",metadata:{tree:true,modifies:true},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:false},{name:"size",type:"number",array:true,length:2},{name:"as",type:"string",array:true,length:MU.length,default:MU}]};(0,g.XW)(AU,fU,{layout(){const t=aU();t.ratio=e=>{const n=t.tile();if(n.ratio)t.tile(n.ratio(e))};t.method=e=>{if((0,g.nr)(kU,e))t.tile(kU[e]);else(0,g.vU)("Unrecognized Treemap layout method: "+e)};return t},params:["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"],fields:MU});const EU=4278190080;const DU=268435456;const CU=.0625;function FU(t,e){const n=t.bitmap();(e||[]).forEach((e=>n.set(t(e.boundary[0]),t(e.boundary[3]))));return[n,undefined]}function SU(t,e,n,i){const r=t.width,a=t.height,o=n||i,u=Vc(r,a).getContext("2d");e.forEach((t=>TU(u,t,o)));const s=new Uint32Array(u.getImageData(0,0,r,a).data.buffer),l=t.bitmap(),f=o&&t.bitmap();let c,h,d,p,g;for(h=0;h<a;++h){for(c=0;c<r;++c){g=s[h*r+c]&EU;if(g){d=t(c);p=t(h);if(!i)l.set(d,p);if(o&&g^DU)f.set(d,p)}}}return[l,f]}function TU(t,e,n){if(!e.length)return;const i=e[0].mark.marktype;if(i==="group"){e.forEach((e=>{e.items.forEach((e=>TU(t,e.items,n)))}))}else{pb[i].draw(t,{items:n?e.map(BU):e})}}function BU(t){const e=Ba(t,{});if(e.stroke){e.strokeOpacity=1}if(e.fill){e.fillOpacity=CU;e.stroke="#000";e.strokeOpacity=1;e.strokeWidth=2}return e}const NU=5,zU=31,OU=32,RU=new Uint32Array(OU+1),UU=new Uint32Array(OU+1);UU[0]=0;RU[0]=~UU[0];for(let VQ=1;VQ<=OU;++VQ){UU[VQ]=UU[VQ-1]<<1|1;RU[VQ]=~UU[VQ]}function $U(t,e){const n=new Uint32Array(~~((t*e+OU)/OU));function i(t,e){n[t]|=e}function r(t,e){n[t]&=e}return{array:n,get:(e,i)=>{const r=i*t+e;return n[r>>>NU]&1<<(r&zU)},set:(e,n)=>{const r=n*t+e;i(r>>>NU,1<<(r&zU))},clear:(e,n)=>{const i=n*t+e;r(i>>>NU,~(1<<(i&zU)))},getRange:(e,i,r,a)=>{let o=a,u,s,l,f;for(;o>=i;--o){u=o*t+e;s=o*t+r;l=u>>>NU;f=s>>>NU;if(l===f){if(n[l]&RU[u&zU]&UU[(s&zU)+1]){return true}}else{if(n[l]&RU[u&zU])return true;if(n[f]&UU[(s&zU)+1])return true;for(let t=l+1;t<f;++t){if(n[t])return true}}}return false},setRange:(e,n,r,a)=>{let o,u,s,l,f;for(;n<=a;++n){o=n*t+e;u=n*t+r;s=o>>>NU;l=u>>>NU;if(s===l){i(s,RU[o&zU]&UU[(u&zU)+1])}else{i(s,RU[o&zU]);i(l,UU[(u&zU)+1]);for(f=s+1;f<l;++f)i(f,4294967295)}}},clearRange:(e,n,i,a)=>{let o,u,s,l,f;for(;n<=a;++n){o=n*t+e;u=n*t+i;s=o>>>NU;l=u>>>NU;if(s===l){r(s,UU[o&zU]|RU[(u&zU)+1])}else{r(s,UU[o&zU]);r(l,RU[(u&zU)+1]);for(f=s+1;f<l;++f)r(f,0)}}},outOfBounds:(n,i,r,a)=>n<0||i<0||a>=e||r>=t}}function PU(t,e,n){const i=Math.max(1,Math.sqrt(t*e/1e6)),r=~~((t+2*n+i)/i),a=~~((e+2*n+i)/i),o=t=>~~((t+n)/i);o.invert=t=>t*i-n;o.bitmap=()=>$U(r,a);o.ratio=i;o.padding=n;o.width=t;o.height=e;return o}function qU(t,e,n,i){const r=t.width,a=t.height;return function(t){const e=t.datum.datum.items[i].items,n=e.length,o=t.datum.fontSize,u=I_.width(t.datum,t.datum.text);let s=0,l,f,c,h,d,p,g;for(let i=0;i<n;++i){l=e[i].x;c=e[i].y;f=e[i].x2===undefined?l:e[i].x2;h=e[i].y2===undefined?c:e[i].y2;d=(l+f)/2;p=(c+h)/2;g=Math.abs(f-l+h-c);if(g>=s){s=g;t.x=d;t.y=p}}d=u/2;p=o/2;l=t.x-d;f=t.x+d;c=t.y-p;h=t.y+p;t.align="center";if(l<0&&f<=r){t.align="left"}else if(0<=l&&r<f){t.align="right"}t.baseline="middle";if(c<0&&h<=a){t.baseline="top"}else if(0<=c&&a<h){t.baseline="bottom"}return true}}function IU(t,e,n,i,r,a){let o=n/2;return t-o<0||t+o>r||e-(o=i/2)<0||e+o>a}function LU(){return false}function jU(t,e,n,i,r,a,o,u){const s=r*a/(i*2),l=t(e-s),f=t(e+s),c=t(n-(a=a/2)),h=t(n+a);return o.outOfBounds(l,c,f,h)||o.getRange(l,c,f,h)||u&&u.getRange(l,c,f,h)}function WU(t,e,n,i,r,a,o,u){const s=r*a/(i*2);let l=t(e-s),f=t(e+s),c=t(n-(a=a/2)),h=t(n+a);l=l>0?l:0;c=c>0?c:0;f=f<t.width?f:t.width-1;h=h<t.height?h:t.height-1;return o.getRange(l,c,f,h)||u&&u.getRange(l,c,f,h)}function XU(t){return t?[WU,LU]:[jU,IU]}function HU(t,e,n,i,r){const a=t.width,o=t.height,[u,s]=XU(r),l=e[0],f=e[1];function c(e,n,i,r,c){const h=t.invert(e),d=t.invert(n);let p=i,g=o,m;if(!s(h,d,r,c,a,o)&&!u(t,h,d,c,r,p,l,f)&&!u(t,h,d,c,r,c,l,null)){while(g-p>=1){m=(p+g)/2;if(u(t,h,d,c,r,m,l,f)){g=m}else{p=m}}if(p>i){return[h,d,p,true]}}}return function(e){const r=e.datum.datum.items[i].items,f=r.length,h=e.datum.fontSize,d=I_.width(e.datum,e.datum.text);let p=n?h:0,g=false,m=false,y=0,v,x,_,b,w,k,M,A,E,D,C,F,S,T,B,N,z;for(let i=0;i<f;++i){v=r[i].x;_=r[i].y;x=r[i].x2===undefined?v:r[i].x2;b=r[i].y2===undefined?_:r[i].y2;if(v>x){z=v;v=x;x=z}if(_>b){z=_;_=b;b=z}E=t(v);C=t(x);D=~~((E+C)/2);F=t(_);T=t(b);S=~~((F+T)/2);for(M=D;M>=E;--M){for(A=S;A>=F;--A){N=c(M,A,p,d,h);if(N){[e.x,e.y,p,g]=N}}}for(M=D;M<=C;++M){for(A=S;A<=T;++A){N=c(M,A,p,d,h);if(N){[e.x,e.y,p,g]=N}}}if(!g&&!n){B=Math.abs(x-v+b-_);w=(v+x)/2;k=(_+b)/2;if(B>=y&&!s(w,k,d,h,a,o)&&!u(t,w,k,h,d,h,l,null)){y=B;e.x=w;e.y=k;m=true}}}if(g||m){w=d/2;k=h/2;l.setRange(t(e.x-w),t(e.y-k),t(e.x+w),t(e.y+k));e.align="center";e.baseline="middle";return true}else{return false}}}const YU=[-1,-1,1,1];const JU=[-1,1,-1,1];function VU(t,e,n,i,r){const a=t.width,o=t.height,[u,s]=XU(r),l=e[0],f=e[1],c=t.bitmap();return function(e){const r=e.datum.datum.items[i].items,h=r.length,d=e.datum.fontSize,p=I_.width(e.datum,e.datum.text),g=[];let m=n?d:0,y=false,v=false,x=0,_,b,w,k,M,A,E,D,C,F,S,T;for(let i=0;i<h;++i){_=r[i].x;w=r[i].y;b=r[i].x2===undefined?_:r[i].x2;k=r[i].y2===undefined?w:r[i].y2;g.push([t((_+b)/2),t((w+k)/2)]);while(g.length){[E,D]=g.pop();if(l.get(E,D)||f.get(E,D)||c.get(E,D))continue;c.set(E,D);for(let t=0;t<4;++t){M=E+YU[t];A=D+JU[t];if(!c.outOfBounds(M,A,M,A))g.push([M,A])}M=t.invert(E);A=t.invert(D);C=m;F=o;if(!s(M,A,p,d,a,o)&&!u(t,M,A,d,p,C,l,f)&&!u(t,M,A,d,p,d,l,null)){while(F-C>=1){S=(C+F)/2;if(u(t,M,A,d,p,S,l,f)){F=S}else{C=S}}if(C>m){e.x=M;e.y=A;m=C;y=true}}}if(!y&&!n){T=Math.abs(b-_+k-w);M=(_+b)/2;A=(w+k)/2;if(T>=x&&!s(M,A,p,d,a,o)&&!u(t,M,A,d,p,d,l,null)){x=T;e.x=M;e.y=A;v=true}}}if(y||v){M=p/2;A=d/2;l.setRange(t(e.x-M),t(e.y-A),t(e.x+M),t(e.y+A));e.align="center";e.baseline="middle";return true}else{return false}}}const GU=["right","center","left"],KU=["bottom","middle","top"];function ZU(t,e,n,i,r){const a=t.width,o=t.height,u=e[0],s=e[1],l=i.length;return function(e){const f=e.boundary,c=e.datum.fontSize;if(!r&&(f[2]<0||f[5]<0||f[0]>a||f[3]>o)){return false}let h=0,d,p,g,m,y,v,x,_,b,w,k,M,A,E,D;for(let a=0;a<l;++a){d=(n[a]&3)-1;p=(n[a]>>>2&3)-1;g=d===0&&p===0||i[a]<0;m=d&&p?Math.SQRT1_2:1;y=i[a]<0?-1:1;v=f[1+d]+i[a]*d*m;k=f[4+p]+y*c*p/2+i[a]*p*m;_=k-c/2;b=k+c/2;M=t(v);E=t(_);D=t(b);if(r){M=M<0?0:M;E=E<0?0:E;D=D>=t.height?t.height-1:D}if(!h){if(!QU(M,M,E,D,u,s,v,v,_,b,f,g)){continue}else{h=I_.width(e.datum,e.datum.text)}}w=v+y*h*d/2;v=w-h/2;x=w+h/2;M=t(v);A=t(x);if(r){M=M<0?0:M;A=A>=t.width?t.width-1:A}if(QU(M,A,E,D,u,s,v,x,_,b,f,g)){e.x=!d?w:d*y<0?x:v;e.y=!p?k:p*y<0?b:_;e.align=GU[d*y+1];e.baseline=KU[p*y+1];u.setRange(M,E,A,D);return true}}return false}}function QU(t,e,n,i,r,a,o,u,s,l,f,c){return!(r.outOfBounds(t,n,e,i)||(c&&a?a.getRange(t,n,e,i)||!t$(o,s,u,l,f):r.getRange(t,n,e,i)))}function t$(t,e,n,i,r){return r[0]<=t&&n<=r[2]&&r[3]<=e&&i<=r[5]}const e$=0,n$=4,i$=8,r$=0,a$=1,o$=2;const u$={"top-left":e$+r$,top:e$+a$,"top-right":e$+o$,left:n$+r$,middle:n$+a$,right:n$+o$,"bottom-left":i$+r$,bottom:i$+a$,"bottom-right":i$+o$};const s$={naive:qU,"reduced-search":HU,floodfill:VU};function l$(t,e,n,i,r,a,o,u,s,l,f){if(!t.length)return t;const c=Math.max(i.length,r.length),h=f$(i,c),d=c$(r,c),p=h$(t[0].datum),g=p==="group"&&t[0].datum.items[s].marktype,m=g==="area",y=d$(p,g,u,s),v=l===null||l===Infinity,x=PU(e[0],e[1],v?0:l),_=m&&f==="naive";const b=t.map((t=>({datum:t,opacity:0,x:undefined,y:undefined,align:undefined,baseline:undefined,boundary:y(t)})));let w;if(!_){if(n){b.sort(((t,e)=>n(t.datum,e.datum)))}let e=false;for(let t=0;t<d.length&&!e;++t){e=d[t]===5||h[t]<0}if(p&&(o||m)){a=[t.map((t=>t.datum))].concat(a)}w=a.length?SU(x,a,e,m):FU(x,o&&b)}const k=m?s$[f](x,w,o,s,v):ZU(x,w,d,h,v);b.forEach((t=>t.opacity=+k(t)));return b}function f$(t,e){const n=new Float64Array(e),i=t.length;for(let r=0;r<i;++r)n[r]=t[r]||0;for(let r=i;r<e;++r)n[r]=n[i-1];return n}function c$(t,e){const n=new Int8Array(e),i=t.length;for(let r=0;r<i;++r)n[r]|=u$[t[r]];for(let r=i;r<e;++r)n[r]=n[i-1];return n}function h$(t){return t&&t.mark&&t.mark.marktype}function d$(t,e,n,i){const r=t=>[t.x,t.x,t.x,t.y,t.y,t.y];if(!t){return r}else if(t==="line"||t==="area"){return t=>r(t.datum)}else if(e==="line"){return t=>{const e=t.datum.items[i].items;return r(e.length?e[n==="start"?0:e.length-1]:{x:NaN,y:NaN})}}else{return t=>{const e=t.datum.bounds;return[e.x1,(e.x1+e.x2)/2,e.x2,e.y1,(e.y1+e.y2)/2,e.y2]}}}const p$=["x","y","opacity","align","baseline"];const g$=["top-left","left","bottom-left","top","bottom","top-right","right","bottom-right"];function m$(t){Wo.call(this,null,t)}m$.Definition={type:"Label",metadata:{modifies:true},params:[{name:"size",type:"number",array:true,length:2,required:true},{name:"sort",type:"compare"},{name:"anchor",type:"string",array:true,default:g$},{name:"offset",type:"number",array:true,default:[1]},{name:"padding",type:"number",default:0,null:true},{name:"lineAnchor",type:"string",values:["start","end"],default:"end"},{name:"markIndex",type:"number",default:0},{name:"avoidBaseMark",type:"boolean",default:true},{name:"avoidMarks",type:"data",array:true},{name:"method",type:"string",default:"naive"},{name:"as",type:"string",array:true,length:p$.length,default:p$}]};(0,g.XW)(m$,Wo,{transform(t,e){function n(n){const i=t[n];return(0,g.mf)(i)&&e.modified(i.fields)}const i=t.modified();if(!(i||e.changed(e.ADD_REM)||n("sort")))return;if(!t.size||t.size.length!==2){(0,g.vU)("Size parameter should be specified as a [width, height] array.")}const r=t.as||p$;l$(e.materialize(e.SOURCE).source||[],t.size,t.sort,(0,g.IX)(t.offset==null?1:t.offset),(0,g.IX)(t.anchor||g$),t.avoidMarks||[],t.avoidBaseMark!==false,t.lineAnchor||"end",t.markIndex||0,t.padding===undefined?0:t.padding,t.method||"naive").forEach((t=>{const e=t.datum;e[r[0]]=t.x;e[r[1]]=t.y;e[r[2]]=t.opacity;e[r[3]]=t.align;e[r[4]]=t.baseline}));return e.reflow(i).modifies(r)}});function y$(t,e){var n=[],i=function(t){return t(u)},r,a,o,u,s,l;if(e==null){n.push(t)}else{for(r={},a=0,o=t.length;a<o;++a){u=t[a];s=e.map(i);l=r[s];if(!l){r[s]=l=[];l.dims=s;n.push(l)}l.push(u)}}return n}function v$(t){Wo.call(this,null,t)}v$.Definition={type:"Loess",metadata:{generates:true},params:[{name:"x",type:"field",required:true},{name:"y",type:"field",required:true},{name:"groupby",type:"field",array:true},{name:"bandwidth",type:"number",default:.3},{name:"as",type:"string",array:true}]};(0,g.XW)(v$,Wo,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS);if(!this.value||e.changed()||t.modified()){const i=e.materialize(e.SOURCE).source,r=y$(i,t.groupby),a=(t.groupby||[]).map(g.el),o=a.length,u=t.as||[(0,g.el)(t.x),(0,g.el)(t.y)],s=[];r.forEach((e=>{Zu(e,t.x,t.y,t.bandwidth||.3).forEach((t=>{const n={};for(let i=0;i<o;++i){n[a[i]]=e.dims[i]}n[u[0]]=t[0];n[u[1]]=t[1];s.push(Sa(n))}))}));if(this.value)n.rem=this.value;this.value=n.add=n.source=s}return n}});const x$={linear:Lu,log:ju,exp:Wu,pow:Xu,quad:Hu,poly:Yu};const _$=(t,e)=>t==="poly"?e:t==="quad"?2:1;function b$(t){Wo.call(this,null,t)}b$.Definition={type:"Regression",metadata:{generates:true},params:[{name:"x",type:"field",required:true},{name:"y",type:"field",required:true},{name:"groupby",type:"field",array:true},{name:"method",type:"string",default:"linear",values:Object.keys(x$)},{name:"order",type:"number",default:3},{name:"extent",type:"number",array:true,length:2},{name:"params",type:"boolean",default:false},{name:"as",type:"string",array:true}]};(0,g.XW)(b$,Wo,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS);if(!this.value||e.changed()||t.modified()){const i=e.materialize(e.SOURCE).source,r=y$(i,t.groupby),a=(t.groupby||[]).map(g.el),o=t.method||"linear",u=t.order||3,s=_$(o,u),l=t.as||[(0,g.el)(t.x),(0,g.el)(t.y)],f=x$[o],c=[];let h=t.extent;if(!(0,g.nr)(x$,o)){(0,g.vU)("Invalid regression method: "+o)}if(h!=null){if(o==="log"&&h[0]<=0){e.dataflow.warn("Ignoring extent with values <= 0 for log regression.");h=null}}r.forEach((n=>{const i=n.length;if(i<=s){e.dataflow.warn("Skipping regression with more parameters than data points.");return}const r=f(n,t.x,t.y,u);if(t.params){c.push(Sa({keys:n.dims,coef:r.coef,rSquared:r.rSquared}));return}const d=h||(0,g.We)(n,t.x),p=t=>{const e={};for(let i=0;i<a.length;++i){e[a[i]]=n.dims[i]}e[l[0]]=t[0];e[l[1]]=t[1];c.push(Sa(e))};if(o==="linear"){d.forEach((t=>p([t,r.predict(t)])))}else{is(r.predict,d,25,200).forEach(p)}}));if(this.value)n.rem=this.value;this.value=n.add=n.source=c}return n}});const w$=Math.pow(2,-52);const k$=new Uint32Array(512);class M${static from(t,e=z$,n=O$){const i=t.length;const r=new Float64Array(i*2);for(let a=0;a<i;a++){const i=t[a];r[2*a]=e(i);r[2*a+1]=n(i)}return new M$(r)}constructor(t){const e=t.length>>1;if(e>0&&typeof t[0]!=="number")throw new Error("Expected coords to contain numbers.");this.coords=t;const n=Math.max(2*e-5,0);this._triangles=new Uint32Array(n*3);this._halfedges=new Int32Array(n*3);this._hashSize=Math.ceil(Math.sqrt(e));this._hullPrev=new Uint32Array(e);this._hullNext=new Uint32Array(e);this._hullTri=new Uint32Array(e);this._hullHash=new Int32Array(this._hashSize).fill(-1);this._ids=new Uint32Array(e);this._dists=new Float64Array(e);this.update()}update(){const{coords:t,_hullPrev:e,_hullNext:n,_hullTri:i,_hullHash:r}=this;const a=t.length>>1;let o=Infinity;let u=Infinity;let s=-Infinity;let l=-Infinity;for(let A=0;A<a;A++){const e=t[2*A];const n=t[2*A+1];if(e<o)o=e;if(n<u)u=n;if(e>s)s=e;if(n>l)l=n;this._ids[A]=A}const f=(o+s)/2;const c=(u+l)/2;let h=Infinity;let d,p,g;for(let A=0;A<a;A++){const e=E$(f,c,t[2*A],t[2*A+1]);if(e<h){d=A;h=e}}const m=t[2*d];const y=t[2*d+1];h=Infinity;for(let A=0;A<a;A++){if(A===d)continue;const e=E$(m,y,t[2*A],t[2*A+1]);if(e<h&&e>0){p=A;h=e}}let v=t[2*p];let x=t[2*p+1];let _=Infinity;for(let A=0;A<a;A++){if(A===d||A===p)continue;const e=S$(m,y,v,x,t[2*A],t[2*A+1]);if(e<_){g=A;_=e}}let b=t[2*g];let w=t[2*g+1];if(_===Infinity){for(let i=0;i<a;i++){this._dists[i]=t[2*i]-t[0]||t[2*i+1]-t[1]}B$(this._ids,this._dists,0,a-1);const e=new Uint32Array(a);let n=0;for(let t=0,i=-Infinity;t<a;t++){const r=this._ids[t];if(this._dists[r]>i){e[n++]=r;i=this._dists[r]}}this.hull=e.subarray(0,n);this.triangles=new Uint32Array(0);this.halfedges=new Uint32Array(0);return}if(C$(m,y,v,x,b,w)){const t=p;const e=v;const n=x;p=g;v=b;x=w;g=t;b=e;w=n}const k=T$(m,y,v,x,b,w);this._cx=k.x;this._cy=k.y;for(let A=0;A<a;A++){this._dists[A]=E$(t[2*A],t[2*A+1],k.x,k.y)}B$(this._ids,this._dists,0,a-1);this._hullStart=d;let M=3;n[d]=e[g]=p;n[p]=e[d]=g;n[g]=e[p]=d;i[d]=0;i[p]=1;i[g]=2;r.fill(-1);r[this._hashKey(m,y)]=d;r[this._hashKey(v,x)]=p;r[this._hashKey(b,w)]=g;this.trianglesLen=0;this._addTriangle(d,p,g,-1,-1,-1);for(let A=0,E,D;A<this._ids.length;A++){const a=this._ids[A];const o=t[2*a];const u=t[2*a+1];if(A>0&&Math.abs(o-E)<=w$&&Math.abs(u-D)<=w$)continue;E=o;D=u;if(a===d||a===p||a===g)continue;let s=0;for(let t=0,e=this._hashKey(o,u);t<this._hashSize;t++){s=r[(e+t)%this._hashSize];if(s!==-1&&s!==n[s])break}s=e[s];let l=s,f;while(f=n[l],!C$(o,u,t[2*l],t[2*l+1],t[2*f],t[2*f+1])){l=f;if(l===s){l=-1;break}}if(l===-1)continue;let c=this._addTriangle(l,a,n[l],-1,-1,i[l]);i[a]=this._legalize(c+2);i[l]=c;M++;let h=n[l];while(f=n[h],C$(o,u,t[2*h],t[2*h+1],t[2*f],t[2*f+1])){c=this._addTriangle(h,a,f,i[a],-1,i[h]);i[a]=this._legalize(c+2);n[h]=h;M--;h=f}if(l===s){while(f=e[l],C$(o,u,t[2*f],t[2*f+1],t[2*l],t[2*l+1])){c=this._addTriangle(f,a,l,-1,i[l],i[f]);this._legalize(c+2);i[f]=c;n[l]=l;M--;l=f}}this._hullStart=e[a]=l;n[l]=e[h]=a;n[a]=h;r[this._hashKey(o,u)]=a;r[this._hashKey(t[2*l],t[2*l+1])]=l}this.hull=new Uint32Array(M);for(let A=0,E=this._hullStart;A<M;A++){this.hull[A]=E;E=n[E]}this.triangles=this._triangles.subarray(0,this.trianglesLen);this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(t,e){return Math.floor(A$(t-this._cx,e-this._cy)*this._hashSize)%this._hashSize}_legalize(t){const{_triangles:e,_halfedges:n,coords:i}=this;let r=0;let a=0;while(true){const o=n[t];const u=t-t%3;a=u+(t+2)%3;if(o===-1){if(r===0)break;t=k$[--r];continue}const s=o-o%3;const l=u+(t+1)%3;const f=s+(o+2)%3;const c=e[a];const h=e[t];const d=e[l];const p=e[f];const g=F$(i[2*c],i[2*c+1],i[2*h],i[2*h+1],i[2*d],i[2*d+1],i[2*p],i[2*p+1]);if(g){e[t]=p;e[o]=c;const i=n[f];if(i===-1){let e=this._hullStart;do{if(this._hullTri[e]===f){this._hullTri[e]=t;break}e=this._hullPrev[e]}while(e!==this._hullStart)}this._link(t,i);this._link(o,n[a]);this._link(a,f);const u=s+(o+1)%3;if(r<k$.length){k$[r++]=u}}else{if(r===0)break;t=k$[--r]}}return a}_link(t,e){this._halfedges[t]=e;if(e!==-1)this._halfedges[e]=t}_addTriangle(t,e,n,i,r,a){const o=this.trianglesLen;this._triangles[o]=t;this._triangles[o+1]=e;this._triangles[o+2]=n;this._link(o,i);this._link(o+1,r);this._link(o+2,a);this.trianglesLen+=3;return o}}function A$(t,e){const n=t/(Math.abs(t)+Math.abs(e));return(e>0?3-n:1+n)/4}function E$(t,e,n,i){const r=t-n;const a=e-i;return r*r+a*a}function D$(t,e,n,i,r,a){const o=(i-e)*(r-t);const u=(n-t)*(a-e);return Math.abs(o-u)>=33306690738754716e-32*Math.abs(o+u)?o-u:0}function C$(t,e,n,i,r,a){const o=D$(r,a,t,e,n,i)||D$(t,e,n,i,r,a)||D$(n,i,r,a,t,e);return o<0}function F$(t,e,n,i,r,a,o,u){const s=t-o;const l=e-u;const f=n-o;const c=i-u;const h=r-o;const d=a-u;const p=s*s+l*l;const g=f*f+c*c;const m=h*h+d*d;return s*(c*m-g*d)-l*(f*m-g*h)+p*(f*d-c*h)<0}function S$(t,e,n,i,r,a){const o=n-t;const u=i-e;const s=r-t;const l=a-e;const f=o*o+u*u;const c=s*s+l*l;const h=.5/(o*l-u*s);const d=(l*f-u*c)*h;const p=(o*c-s*f)*h;return d*d+p*p}function T$(t,e,n,i,r,a){const o=n-t;const u=i-e;const s=r-t;const l=a-e;const f=o*o+u*u;const c=s*s+l*l;const h=.5/(o*l-u*s);const d=t+(l*f-u*c)*h;const p=e+(o*c-s*f)*h;return{x:d,y:p}}function B$(t,e,n,i){if(i-n<=20){for(let r=n+1;r<=i;r++){const i=t[r];const a=e[i];let o=r-1;while(o>=n&&e[t[o]]>a)t[o+1]=t[o--];t[o+1]=i}}else{const r=n+i>>1;let a=n+1;let o=i;N$(t,r,a);if(e[t[n]]>e[t[i]])N$(t,n,i);if(e[t[a]]>e[t[i]])N$(t,a,i);if(e[t[n]]>e[t[a]])N$(t,n,a);const u=t[a];const s=e[u];while(true){do{a++}while(e[t[a]]<s);do{o--}while(e[t[o]]>s);if(o<a)break;N$(t,a,o)}t[n+1]=t[o];t[o]=u;if(i-a+1>=o-n){B$(t,e,a,i);B$(t,e,n,o-1)}else{B$(t,e,n,o-1);B$(t,e,a,i)}}}function N$(t,e,n){const i=t[e];t[e]=t[n];t[n]=i}function z$(t){return t[0]}function O$(t){return t[1]}const R$=1e-6;class U${constructor(){this._x0=this._y0=this._x1=this._y1=null;this._=""}moveTo(t,e){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+e}`}closePath(){if(this._x1!==null){this._x1=this._x0,this._y1=this._y0;this._+="Z"}}lineTo(t,e){this._+=`L${this._x1=+t},${this._y1=+e}`}arc(t,e,n){t=+t,e=+e,n=+n;const i=t+n;const r=e;if(n<0)throw new Error("negative radius");if(this._x1===null)this._+=`M${i},${r}`;else if(Math.abs(this._x1-i)>R$||Math.abs(this._y1-r)>R$)this._+="L"+i+","+r;if(!n)return;this._+=`A${n},${n},0,1,1,${t-n},${e}A${n},${n},0,1,1,${this._x1=i},${this._y1=r}`}rect(t,e,n,i){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+e}h${+n}v${+i}h${-n}Z`}value(){return this._||null}}class $${constructor(){this._=[]}moveTo(t,e){this._.push([t,e])}closePath(){this._.push(this._[0].slice())}lineTo(t,e){this._.push([t,e])}value(){return this._.length?this._:null}}class P${constructor(t,[e,n,i,r]=[0,0,960,500]){if(!((i=+i)>=(e=+e))||!((r=+r)>=(n=+n)))throw new Error("invalid bounds");this.delaunay=t;this._circumcenters=new Float64Array(t.points.length*2);this.vectors=new Float64Array(t.points.length*2);this.xmax=i,this.xmin=e;this.ymax=r,this.ymin=n;this._init()}update(){this.delaunay.update();this._init();return this}_init(){const{delaunay:{points:t,hull:e,triangles:n},vectors:i}=this;const r=this.circumcenters=this._circumcenters.subarray(0,n.length/3*2);for(let h=0,d=0,p=n.length,g,m;h<p;h+=3,d+=2){const e=n[h]*2;const i=n[h+1]*2;const a=n[h+2]*2;const o=t[e];const u=t[e+1];const s=t[i];const l=t[i+1];const f=t[a];const c=t[a+1];const p=s-o;const y=l-u;const v=f-o;const x=c-u;const _=p*p+y*y;const b=v*v+x*x;const w=(p*x-y*v)*2;if(!w){g=(o+f)/2-1e8*x;m=(u+c)/2+1e8*v}else if(Math.abs(w)<1e-8){g=(o+f)/2;m=(u+c)/2}else{const t=1/w;g=o+(x*_-y*b)*t;m=u+(p*b-v*_)*t}r[d]=g;r[d+1]=m}let a=e[e.length-1];let o,u=a*4;let s,l=t[2*a];let f,c=t[2*a+1];i.fill(0);for(let h=0;h<e.length;++h){a=e[h];o=u,s=l,f=c;u=a*4,l=t[2*a],c=t[2*a+1];i[o+2]=i[u]=f-c;i[o+3]=i[u+1]=l-s}}render(t){const e=t==null?t=new U$:undefined;const{delaunay:{halfedges:n,inedges:i,hull:r},circumcenters:a,vectors:o}=this;if(r.length<=1)return null;for(let l=0,f=n.length;l<f;++l){const e=n[l];if(e<l)continue;const i=Math.floor(l/3)*2;const r=Math.floor(e/3)*2;const o=a[i];const u=a[i+1];const s=a[r];const f=a[r+1];this._renderSegment(o,u,s,f,t)}let u,s=r[r.length-1];for(let l=0;l<r.length;++l){u=s,s=r[l];const e=Math.floor(i[s]/3)*2;const n=a[e];const f=a[e+1];const c=u*4;const h=this._project(n,f,o[c+2],o[c+3]);if(h)this._renderSegment(n,f,h[0],h[1],t)}return e&&e.value()}renderBounds(t){const e=t==null?t=new U$:undefined;t.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin);return e&&e.value()}renderCell(t,e){const n=e==null?e=new U$:undefined;const i=this._clip(t);if(i===null||!i.length)return;e.moveTo(i[0],i[1]);let r=i.length;while(i[0]===i[r-2]&&i[1]===i[r-1]&&r>1)r-=2;for(let a=2;a<r;a+=2){if(i[a]!==i[a-2]||i[a+1]!==i[a-1])e.lineTo(i[a],i[a+1])}e.closePath();return n&&n.value()}*cellPolygons(){const{delaunay:{points:t}}=this;for(let e=0,n=t.length/2;e<n;++e){const t=this.cellPolygon(e);if(t)t.index=e,yield t}}cellPolygon(t){const e=new $$;this.renderCell(t,e);return e.value()}_renderSegment(t,e,n,i,r){let a;const o=this._regioncode(t,e);const u=this._regioncode(n,i);if(o===0&&u===0){r.moveTo(t,e);r.lineTo(n,i)}else if(a=this._clipSegment(t,e,n,i,o,u)){r.moveTo(a[0],a[1]);r.lineTo(a[2],a[3])}}contains(t,e,n){if((e=+e,e!==e)||(n=+n,n!==n))return false;return this.delaunay._step(t,e,n)===t}*neighbors(t){const e=this._clip(t);if(e)for(const n of this.delaunay.neighbors(t)){const t=this._clip(n);if(t)t:for(let i=0,r=e.length;i<r;i+=2){for(let a=0,o=t.length;a<o;a+=2){if(e[i]==t[a]&&e[i+1]==t[a+1]&&e[(i+2)%r]==t[(a+o-2)%o]&&e[(i+3)%r]==t[(a+o-1)%o]){yield n;break t}}}}}_cell(t){const{circumcenters:e,delaunay:{inedges:n,halfedges:i,triangles:r}}=this;const a=n[t];if(a===-1)return null;const o=[];let u=a;do{const n=Math.floor(u/3);o.push(e[n*2],e[n*2+1]);u=u%3===2?u-2:u+1;if(r[u]!==t)break;u=i[u]}while(u!==a&&u!==-1);return o}_clip(t){if(t===0&&this.delaunay.hull.length===1){return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin]}const e=this._cell(t);if(e===null)return null;const{vectors:n}=this;const i=t*4;return n[i]||n[i+1]?this._clipInfinite(t,e,n[i],n[i+1],n[i+2],n[i+3]):this._clipFinite(t,e)}_clipFinite(t,e){const n=e.length;let i=null;let r,a,o=e[n-2],u=e[n-1];let s,l=this._regioncode(o,u);let f,c;for(let h=0;h<n;h+=2){r=o,a=u,o=e[h],u=e[h+1];s=l,l=this._regioncode(o,u);if(s===0&&l===0){f=c,c=0;if(i)i.push(o,u);else i=[o,u]}else{let e,n,h,d,p;if(s===0){if((e=this._clipSegment(r,a,o,u,s,l))===null)continue;[n,h,d,p]=e}else{if((e=this._clipSegment(o,u,r,a,l,s))===null)continue;[d,p,n,h]=e;f=c,c=this._edgecode(n,h);if(f&&c)this._edge(t,f,c,i,i.length);if(i)i.push(n,h);else i=[n,h]}f=c,c=this._edgecode(d,p);if(f&&c)this._edge(t,f,c,i,i.length);if(i)i.push(d,p);else i=[d,p]}}if(i){f=c,c=this._edgecode(i[0],i[1]);if(f&&c)this._edge(t,f,c,i,i.length)}else if(this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)){return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin]}return i}_clipSegment(t,e,n,i,r,a){while(true){if(r===0&&a===0)return[t,e,n,i];if(r&a)return null;let o,u,s=r||a;if(s&8)o=t+(n-t)*(this.ymax-e)/(i-e),u=this.ymax;else if(s&4)o=t+(n-t)*(this.ymin-e)/(i-e),u=this.ymin;else if(s&2)u=e+(i-e)*(this.xmax-t)/(n-t),o=this.xmax;else u=e+(i-e)*(this.xmin-t)/(n-t),o=this.xmin;if(r)t=o,e=u,r=this._regioncode(t,e);else n=o,i=u,a=this._regioncode(n,i)}}_clipInfinite(t,e,n,i,r,a){let o=Array.from(e),u;if(u=this._project(o[0],o[1],n,i))o.unshift(u[0],u[1]);if(u=this._project(o[o.length-2],o[o.length-1],r,a))o.push(u[0],u[1]);if(o=this._clipFinite(t,o)){for(let e=0,n=o.length,i,r=this._edgecode(o[n-2],o[n-1]);e<n;e+=2){i=r,r=this._edgecode(o[e],o[e+1]);if(i&&r)e=this._edge(t,i,r,o,e),n=o.length}}else if(this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)){o=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]}return o}_edge(t,e,n,i,r){while(e!==n){let n,a;switch(e){case 5:e=4;continue;case 4:e=6,n=this.xmax,a=this.ymin;break;case 6:e=2;continue;case 2:e=10,n=this.xmax,a=this.ymax;break;case 10:e=8;continue;case 8:e=9,n=this.xmin,a=this.ymax;break;case 9:e=1;continue;case 1:e=5,n=this.xmin,a=this.ymin;break}if((i[r]!==n||i[r+1]!==a)&&this.contains(t,n,a)){i.splice(r,0,n,a),r+=2}}if(i.length>4){for(let t=0;t<i.length;t+=2){const e=(t+2)%i.length,n=(t+4)%i.length;if(i[t]===i[e]&&i[e]===i[n]||i[t+1]===i[e+1]&&i[e+1]===i[n+1])i.splice(e,2),t-=2}}return r}_project(t,e,n,i){let r=Infinity,a,o,u;if(i<0){if(e<=this.ymin)return null;if((a=(this.ymin-e)/i)<r)u=this.ymin,o=t+(r=a)*n}else if(i>0){if(e>=this.ymax)return null;if((a=(this.ymax-e)/i)<r)u=this.ymax,o=t+(r=a)*n}if(n>0){if(t>=this.xmax)return null;if((a=(this.xmax-t)/n)<r)o=this.xmax,u=e+(r=a)*i}else if(n<0){if(t<=this.xmin)return null;if((a=(this.xmin-t)/n)<r)o=this.xmin,u=e+(r=a)*i}return[o,u]}_edgecode(t,e){return(t===this.xmin?1:t===this.xmax?2:0)|(e===this.ymin?4:e===this.ymax?8:0)}_regioncode(t,e){return(t<this.xmin?1:t>this.xmax?2:0)|(e<this.ymin?4:e>this.ymax?8:0)}}const q$=2*Math.PI,I$=Math.pow;function L$(t){return t[0]}function j$(t){return t[1]}function W$(t){const{triangles:e,coords:n}=t;for(let i=0;i<e.length;i+=3){const t=2*e[i],r=2*e[i+1],a=2*e[i+2],o=(n[a]-n[t])*(n[r+1]-n[t+1])-(n[r]-n[t])*(n[a+1]-n[t+1]);if(o>1e-10)return false}return true}function X$(t,e,n){return[t+Math.sin(t+e)*n,e+Math.cos(t-e)*n]}class H${static from(t,e=L$,n=j$,i){return new H$("length"in t?Y$(t,e,n,i):Float64Array.from(J$(t,e,n,i)))}constructor(t){this._delaunator=new M$(t);this.inedges=new Int32Array(t.length/2);this._hullIndex=new Int32Array(t.length/2);this.points=this._delaunator.coords;this._init()}update(){this._delaunator.update();this._init();return this}_init(){const t=this._delaunator,e=this.points;if(t.hull&&t.hull.length>2&&W$(t)){this.collinear=Int32Array.from({length:e.length/2},((t,e)=>e)).sort(((t,n)=>e[2*t]-e[2*n]||e[2*t+1]-e[2*n+1]));const t=this.collinear[0],n=this.collinear[this.collinear.length-1],i=[e[2*t],e[2*t+1],e[2*n],e[2*n+1]],r=1e-8*Math.hypot(i[3]-i[1],i[2]-i[0]);for(let a=0,o=e.length/2;a<o;++a){const t=X$(e[2*a],e[2*a+1],r);e[2*a]=t[0];e[2*a+1]=t[1]}this._delaunator=new M$(e)}else{delete this.collinear}const n=this.halfedges=this._delaunator.halfedges;const i=this.hull=this._delaunator.hull;const r=this.triangles=this._delaunator.triangles;const a=this.inedges.fill(-1);const o=this._hullIndex.fill(-1);for(let u=0,s=n.length;u<s;++u){const t=r[u%3===2?u-2:u+1];if(n[u]===-1||a[t]===-1)a[t]=u}for(let u=0,s=i.length;u<s;++u){o[i[u]]=u}if(i.length<=2&&i.length>0){this.triangles=new Int32Array(3).fill(-1);this.halfedges=new Int32Array(3).fill(-1);this.triangles[0]=i[0];this.triangles[1]=i[1];this.triangles[2]=i[1];a[i[0]]=1;if(i.length===2)a[i[1]]=0}}voronoi(t){return new P$(this,t)}*neighbors(t){const{inedges:e,hull:n,_hullIndex:i,halfedges:r,triangles:a,collinear:o}=this;if(o){const e=o.indexOf(t);if(e>0)yield o[e-1];if(e<o.length-1)yield o[e+1];return}const u=e[t];if(u===-1)return;let s=u,l=-1;do{yield l=a[s];s=s%3===2?s-2:s+1;if(a[s]!==t)return;s=r[s];if(s===-1){const e=n[(i[t]+1)%n.length];if(e!==l)yield e;return}}while(s!==u)}find(t,e,n=0){if((t=+t,t!==t)||(e=+e,e!==e))return-1;const i=n;let r;while((r=this._step(n,t,e))>=0&&r!==n&&r!==i)n=r;return r}_step(t,e,n){const{inedges:i,hull:r,_hullIndex:a,halfedges:o,triangles:u,points:s}=this;if(i[t]===-1||!s.length)return(t+1)%(s.length>>1);let l=t;let f=I$(e-s[t*2],2)+I$(n-s[t*2+1],2);const c=i[t];let h=c;do{let i=u[h];const c=I$(e-s[i*2],2)+I$(n-s[i*2+1],2);if(c<f)f=c,l=i;h=h%3===2?h-2:h+1;if(u[h]!==t)break;h=o[h];if(h===-1){h=r[(a[t]+1)%r.length];if(h!==i){if(I$(e-s[h*2],2)+I$(n-s[h*2+1],2)<f)return h}break}}while(h!==c);return l}render(t){const e=t==null?t=new U$:undefined;const{points:n,halfedges:i,triangles:r}=this;for(let a=0,o=i.length;a<o;++a){const e=i[a];if(e<a)continue;const o=r[a]*2;const u=r[e]*2;t.moveTo(n[o],n[o+1]);t.lineTo(n[u],n[u+1])}this.renderHull(t);return e&&e.value()}renderPoints(t,e=2){const n=t==null?t=new U$:undefined;const{points:i}=this;for(let r=0,a=i.length;r<a;r+=2){const n=i[r],a=i[r+1];t.moveTo(n+e,a);t.arc(n,a,e,0,q$)}return n&&n.value()}renderHull(t){const e=t==null?t=new U$:undefined;const{hull:n,points:i}=this;const r=n[0]*2,a=n.length;t.moveTo(i[r],i[r+1]);for(let o=1;o<a;++o){const e=2*n[o];t.lineTo(i[e],i[e+1])}t.closePath();return e&&e.value()}hullPolygon(){const t=new $$;this.renderHull(t);return t.value()}renderTriangle(t,e){const n=e==null?e=new U$:undefined;const{points:i,triangles:r}=this;const a=r[t*=3]*2;const o=r[t+1]*2;const u=r[t+2]*2;e.moveTo(i[a],i[a+1]);e.lineTo(i[o],i[o+1]);e.lineTo(i[u],i[u+1]);e.closePath();return n&&n.value()}*trianglePolygons(){const{triangles:t}=this;for(let e=0,n=t.length/3;e<n;++e){yield this.trianglePolygon(e)}}trianglePolygon(t){const e=new $$;this.renderTriangle(t,e);return e.value()}}function Y$(t,e,n,i){const r=t.length;const a=new Float64Array(r*2);for(let o=0;o<r;++o){const r=t[o];a[o*2]=e.call(i,r,o,t);a[o*2+1]=n.call(i,r,o,t)}return a}function*J$(t,e,n,i){let r=0;for(const a of t){yield e.call(i,a,r,t);yield n.call(i,a,r,t);++r}}function V$(t){Wo.call(this,null,t)}V$.Definition={type:"Voronoi",metadata:{modifies:true},params:[{name:"x",type:"field",required:true},{name:"y",type:"field",required:true},{name:"size",type:"number",array:true,length:2},{name:"extent",type:"array",array:true,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:true,length:2}},{name:"as",type:"string",default:"path"}]};const G$=[-1e5,-1e5,1e5,1e5];(0,g.XW)(V$,Wo,{transform(t,e){const n=t.as||"path",i=e.source;if(!i||!i.length)return e;let r=t.size;r=r?[0,0,r[0],r[1]]:(r=t.extent)?[r[0][0],r[0][1],r[1][0],r[1][1]]:G$;const a=this.value=H$.from(i,t.x,t.y).voronoi(r);for(let o=0,u=i.length;o<u;++o){const t=a.cellPolygon(o);i[o][n]=t?K$(t):null}return e.reflow(t.modified()).modifies(n)}});function K$(t){const e=t[0][0],n=t[0][1];let i=t.length-1;for(;t[i][0]===e&&t[i][1]===n;--i);return"M"+t.slice(0,i+1).join("L")+"Z"}var Z$=Math.PI/180,Q$=1<<11>>5,tP=1<<11;function eP(){var t=[256,256],e,n,i,r,a,o,u,s=oP,l=[],f=Math.random,c={};c.layout=function(){var s=h(Vc()),c=sP((t[0]>>5)*t[1]),p=null,g=l.length,m=-1,y=[],v=l.map((t=>({text:e(t),font:n(t),style:r(t),weight:a(t),rotate:o(t),size:~~(i(t)+1e-14),padding:u(t),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:false,sprite:null,datum:t}))).sort(((t,e)=>e.size-t.size));while(++m<g){var x=v[m];x.x=t[0]*(f()+.5)>>1;x.y=t[1]*(f()+.5)>>1;nP(s,x,v,m);if(x.hasText&&d(c,x,p)){y.push(x);if(p)rP(p,x);else p=[{x:x.x+x.x0,y:x.y+x.y0},{x:x.x+x.x1,y:x.y+x.y1}];x.x-=t[0]>>1;x.y-=t[1]>>1}}return y};function h(t){t.width=t.height=1;var e=Math.sqrt(t.getContext("2d").getImageData(0,0,1,1).data.length>>2);t.width=(Q$<<5)/e;t.height=tP/e;var n=t.getContext("2d");n.fillStyle=n.strokeStyle="red";n.textAlign="center";return{context:n,ratio:e}}function d(e,n,i){var r=n.x,a=n.y,o=Math.sqrt(t[0]*t[0]+t[1]*t[1]),u=s(t),l=f()<.5?1:-1,c=-l,h,d,p;while(h=u(c+=l)){d=~~h[0];p=~~h[1];if(Math.min(Math.abs(d),Math.abs(p))>=o)break;n.x=r+d;n.y=a+p;if(n.x+n.x0<0||n.y+n.y0<0||n.x+n.x1>t[0]||n.y+n.y1>t[1])continue;if(!i||!iP(n,e,t[0])){if(!i||aP(n,i)){var g=n.sprite,m=n.width>>5,y=t[0]>>5,v=n.x-(m<<4),x=v&127,_=32-x,b=n.y1-n.y0,w=(n.y+n.y0)*y+(v>>5),k;for(var M=0;M<b;M++){k=0;for(var A=0;A<=m;A++){e[w+A]|=k<<_|(A<m?(k=g[M*m+A])>>>x:0)}w+=y}n.sprite=null;return true}}}return false}c.words=function(t){if(arguments.length){l=t;return c}else{return l}};c.size=function(e){if(arguments.length){t=[+e[0],+e[1]];return c}else{return t}};c.font=function(t){if(arguments.length){n=lP(t);return c}else{return n}};c.fontStyle=function(t){if(arguments.length){r=lP(t);return c}else{return r}};c.fontWeight=function(t){if(arguments.length){a=lP(t);return c}else{return a}};c.rotate=function(t){if(arguments.length){o=lP(t);return c}else{return o}};c.text=function(t){if(arguments.length){e=lP(t);return c}else{return e}};c.spiral=function(t){if(arguments.length){s=fP[t]||t;return c}else{return s}};c.fontSize=function(t){if(arguments.length){i=lP(t);return c}else{return i}};c.padding=function(t){if(arguments.length){u=lP(t);return c}else{return u}};c.random=function(t){if(arguments.length){f=t;return c}else{return f}};return c}function nP(t,e,n,i){if(e.sprite)return;var r=t.context,a=t.ratio;r.clearRect(0,0,(Q$<<5)/a,tP/a);var o=0,u=0,s=0,l=n.length,f,c,h,d,p;--i;while(++i<l){e=n[i];r.save();r.font=e.style+" "+e.weight+" "+~~((e.size+1)/a)+"px "+e.font;f=r.measureText(e.text+"m").width*a;h=e.size<<1;if(e.rotate){var g=Math.sin(e.rotate*Z$),m=Math.cos(e.rotate*Z$),y=f*m,v=f*g,x=h*m,_=h*g;f=Math.max(Math.abs(y+_),Math.abs(y-_))+31>>5<<5;h=~~Math.max(Math.abs(v+x),Math.abs(v-x))}else{f=f+31>>5<<5}if(h>s)s=h;if(o+f>=Q$<<5){o=0;u+=s;s=0}if(u+h>=tP)break;r.translate((o+(f>>1))/a,(u+(h>>1))/a);if(e.rotate)r.rotate(e.rotate*Z$);r.fillText(e.text,0,0);if(e.padding){r.lineWidth=2*e.padding;r.strokeText(e.text,0,0)}r.restore();e.width=f;e.height=h;e.xoff=o;e.yoff=u;e.x1=f>>1;e.y1=h>>1;e.x0=-e.x1;e.y0=-e.y1;e.hasText=true;o+=f}var b=r.getImageData(0,0,(Q$<<5)/a,tP/a).data,w=[];while(--i>=0){e=n[i];if(!e.hasText)continue;f=e.width;c=f>>5;h=e.y1-e.y0;for(d=0;d<h*c;d++)w[d]=0;o=e.xoff;if(o==null)return;u=e.yoff;var k=0,M=-1;for(p=0;p<h;p++){for(d=0;d<f;d++){var A=c*p+(d>>5),E=b[(u+p)*(Q$<<5)+(o+d)<<2]?1<<31-d%32:0;w[A]|=E;k|=E}if(k)M=p;else{e.y0++;h--;p--;u++}}e.y1=e.y0+M;e.sprite=w.slice(0,(e.y1-e.y0)*c)}}function iP(t,e,n){n>>=5;var i=t.sprite,r=t.width>>5,a=t.x-(r<<4),o=a&127,u=32-o,s=t.y1-t.y0,l=(t.y+t.y0)*n+(a>>5),f;for(var c=0;c<s;c++){f=0;for(var h=0;h<=r;h++){if((f<<u|(h<r?(f=i[c*r+h])>>>o:0))&e[l+h])return true}l+=n}return false}function rP(t,e){var n=t[0],i=t[1];if(e.x+e.x0<n.x)n.x=e.x+e.x0;if(e.y+e.y0<n.y)n.y=e.y+e.y0;if(e.x+e.x1>i.x)i.x=e.x+e.x1;if(e.y+e.y1>i.y)i.y=e.y+e.y1}function aP(t,e){return t.x+t.x1>e[0].x&&t.x+t.x0<e[1].x&&t.y+t.y1>e[0].y&&t.y+t.y0<e[1].y}function oP(t){var e=t[0]/t[1];return function(t){return[e*(t*=.1)*Math.cos(t),t*Math.sin(t)]}}function uP(t){var e=4,n=e*t[0]/t[1],i=0,r=0;return function(t){var a=t<0?-1:1;switch(Math.sqrt(1+4*a*t)-a&3){case 0:i+=n;break;case 1:r+=e;break;case 2:i-=n;break;default:r-=e;break}return[i,r]}}function sP(t){var e=[],n=-1;while(++n<t)e[n]=0;return e}function lP(t){return typeof t==="function"?t:function(){return t}}var fP={archimedean:oP,rectangular:uP};const cP=["x","y","font","fontSize","fontStyle","fontWeight","angle"];const hP=["text","font","rotate","fontSize","fontStyle","fontWeight"];function dP(t){Wo.call(this,eP(),t)}dP.Definition={type:"Wordcloud",metadata:{modifies:true},params:[{name:"size",type:"number",array:true,length:2},{name:"font",type:"string",expr:true,default:"sans-serif"},{name:"fontStyle",type:"string",expr:true,default:"normal"},{name:"fontWeight",type:"string",expr:true,default:"normal"},{name:"fontSize",type:"number",expr:true,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:true,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:true},{name:"as",type:"string",array:true,length:7,default:cP}]};(0,g.XW)(dP,Wo,{transform(t,e){if(t.size&&!(t.size[0]&&t.size[1])){(0,g.vU)("Wordcloud size dimensions must be non-zero.")}function n(n){const i=t[n];return(0,g.mf)(i)&&e.modified(i.fields)}const i=t.modified();if(!(i||e.changed(e.ADD_REM)||hP.some(n)))return;const r=e.materialize(e.SOURCE).source,a=this.value,o=t.as||cP;let u=t.fontSize||14,s;(0,g.mf)(u)?s=t.fontSizeRange:u=(0,g.a9)(u);if(s){const t=u,e=pm("sqrt")().domain((0,g.We)(r,t)).range(s);u=n=>e(t(n))}r.forEach((t=>{t[o[0]]=NaN;t[o[1]]=NaN;t[o[3]]=0}));const l=a.words(r).text(t.text).size(t.size||[500,500]).padding(t.padding||1).spiral(t.spiral||"archimedean").rotate(t.rotate||0).font(t.font||"sans-serif").fontStyle(t.fontStyle||"normal").fontWeight(t.fontWeight||"normal").fontSize(u).random(fu).layout();const f=a.size(),c=f[0]>>1,h=f[1]>>1,d=l.length;for(let p=0,g,m;p<d;++p){g=l[p];m=g.datum;m[o[0]]=g.x+c;m[o[1]]=g.y+h;m[o[2]]=g.font;m[o[3]]=g.size;m[o[4]]=g.style;m[o[5]]=g.weight;m[o[6]]=g.rotate}return e.reflow(i).modifies(o)}});function pP(t,e){return Array.from(e,(e=>t[e]))}const gP=t=>new Uint8Array(t);const mP=t=>new Uint16Array(t);const yP=t=>new Uint32Array(t);function vP(){let t=8,e=[],n=yP(0),i=_P(0,t),r=_P(0,t);return{data:()=>e,seen:()=>n=xP(n,e.length),add(t){for(let n=0,i=e.length,r=t.length,a;n<r;++n){a=t[n];a._index=i++;e.push(a)}},remove(t,n){const a=e.length,o=Array(a-t),u=e;let s,l,f;for(l=0;!n[l]&&l<a;++l){o[l]=e[l];u[l]=l}for(f=l;l<a;++l){s=e[l];if(!n[l]){u[l]=f;i[f]=i[l];r[f]=r[l];o[f]=s;s._index=f++}else{u[l]=-1}i[l]=0}e=o;return u},size:()=>e.length,curr:()=>i,prev:()=>r,reset:t=>r[t]=i[t],all:()=>t<257?255:t<65537?65535:4294967295,set(t,e){i[t]|=e},clear(t,e){i[t]&=~e},resize(e,n){const a=i.length;if(e>a||n>t){t=Math.max(n,t);i=_P(e,t,i);r=_P(e,t)}}}}function xP(t,e,n){if(t.length>=e)return t;n=n||new t.constructor(e);n.set(t);return n}function _P(t,e,n){const i=(e<257?gP:e<65537?mP:yP)(t);if(n)i.set(n);return i}function bP(t,e,n){const i=1<<e;return{one:i,zero:~i,range:n.slice(),bisect:t.bisect,index:t.index,size:t.size,onAdd(t,e){const n=this,r=n.bisect(n.range,t.value),a=t.index,o=r[0],u=r[1],s=a.length;let l;for(l=0;l<o;++l)e[a[l]]|=i;for(l=u;l<s;++l)e[a[l]]|=i;return n}}}function wP(){let t=yP(0),e=[],n=0;function i(i,r,a){if(!r.length)return[];const o=n,u=r.length,s=yP(u);let l=Array(u),f,c,h;for(h=0;h<u;++h){l[h]=i(r[h]);s[h]=h}l=kP(l,s);if(o){f=e;c=t;e=Array(o+u);t=yP(o+u);MP(a,f,c,o,l,s,u,e,t)}else{if(a>0)for(h=0;h<u;++h){s[h]+=a}e=l;t=s}n=o+u;return{index:s,value:l}}function r(i,r){const a=n;let o,u,s;for(u=0;!r[t[u]]&&u<a;++u);for(s=u;u<a;++u){if(!r[o=t[u]]){t[s]=o;e[s]=e[u];++s}}n=a-i}function a(e){for(let i=0,r=n;i<r;++i){t[i]=e[t[i]]}}function o(t,i){let r;if(i){r=i.length}else{i=e;r=n}return[Qc(i,t[0],0,r),Zc(i,t[1],0,r)]}return{insert:i,remove:r,bisect:o,reindex:a,index:()=>t,size:()=>n}}function kP(t,e){t.sort.call(e,((e,n)=>{const i=t[e],r=t[n];return i<r?-1:i>r?1:0}));return pP(t,e)}function MP(t,e,n,i,r,a,o,u,s){let l=0,f=0,c;for(c=0;l<i&&f<o;++c){if(e[l]<r[f]){u[c]=e[l];s[c]=n[l++]}else{u[c]=r[f];s[c]=a[f++]+t}}for(;l<i;++l,++c){u[c]=e[l];s[c]=n[l]}for(;f<o;++f,++c){u[c]=r[f];s[c]=a[f]+t}}function AP(t){Wo.call(this,vP(),t);this._indices=null;this._dims=null}AP.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:true,required:true},{name:"query",type:"array",array:true,required:true,content:{type:"number",array:true,length:2}}]};(0,g.XW)(AP,Wo,{transform(t,e){if(!this._dims){return this.init(t,e)}else{var n=t.modified("fields")||t.fields.some((t=>e.modified(t.fields)));return n?this.reinit(t,e):this.eval(t,e)}},init(t,e){const n=t.fields,i=t.query,r=this._indices={},a=this._dims=[],o=i.length;let u=0,s,l;for(;u<o;++u){s=n[u].fname;l=r[s]||(r[s]=wP());a.push(bP(l,u,i[u]))}return this.eval(t,e)},reinit(t,e){const n=e.materialize().fork(),i=t.fields,r=t.query,a=this._indices,o=this._dims,u=this.value,s=u.curr(),l=u.prev(),f=u.all(),c=n.rem=n.add,h=n.mod,d=r.length,p={};let g,m,y,v,x,_,b,w,k;l.set(s);if(e.rem.length){x=this.remove(t,e,n)}if(e.add.length){u.add(e.add)}if(e.mod.length){_={};for(v=e.mod,b=0,w=v.length;b<w;++b){_[v[b]._index]=1}}for(b=0;b<d;++b){k=i[b];if(!o[b]||t.modified("fields",b)||e.modified(k.fields)){y=k.fname;if(!(g=p[y])){a[y]=m=wP();p[y]=g=m.insert(k,e.source,0)}o[b]=bP(m,b,r[b]).onAdd(g,s)}}for(b=0,w=u.data().length;b<w;++b){if(x[b]){continue}else if(l[b]!==s[b]){c.push(b)}else if(_[b]&&s[b]!==f){h.push(b)}}u.mask=(1<<d)-1;return n},eval(t,e){const n=e.materialize().fork(),i=this._dims.length;let r=0;if(e.rem.length){this.remove(t,e,n);r|=(1<<i)-1}if(t.modified("query")&&!t.modified("fields")){r|=this.update(t,e,n)}if(e.add.length){this.insert(t,e,n);r|=(1<<i)-1}if(e.mod.length){this.modify(e,n);r|=(1<<i)-1}this.value.mask=r;return n},insert(t,e,n){const i=e.add,r=this.value,a=this._dims,o=this._indices,u=t.fields,s={},l=n.add,f=r.size()+i.length,c=a.length;let h=r.size(),d,p,g;r.resize(f,c);r.add(i);const m=r.curr(),y=r.prev(),v=r.all();for(d=0;d<c;++d){p=u[d].fname;g=s[p]||(s[p]=o[p].insert(u[d],i,h));a[d].onAdd(g,m)}for(;h<f;++h){y[h]=v;if(m[h]!==v)l.push(h)}},modify(t,e){const n=e.mod,i=this.value,r=i.curr(),a=i.all(),o=t.mod;let u,s,l;for(u=0,s=o.length;u<s;++u){l=o[u]._index;if(r[l]!==a)n.push(l)}},remove(t,e,n){const i=this._indices,r=this.value,a=r.curr(),o=r.prev(),u=r.all(),s={},l=n.rem,f=e.rem;let c,h,d,p;for(c=0,h=f.length;c<h;++c){d=f[c]._index;s[d]=1;o[d]=p=a[d];a[d]=u;if(p!==u)l.push(d)}for(d in i){i[d].remove(h,s)}this.reindex(e,h,s);return s},reindex(t,e,n){const i=this._indices,r=this.value;t.runAfter((()=>{const t=r.remove(e,n);for(const e in i)i[e].reindex(t)}))},update(t,e,n){const i=this._dims,r=t.query,a=e.stamp,o=i.length;let u=0,s,l;n.filters=0;for(l=0;l<o;++l){if(t.modified("query",l)){s=l;++u}}if(u===1){u=i[s].one;this.incrementOne(i[s],r[s],n.add,n.rem)}else{for(l=0,u=0;l<o;++l){if(!t.modified("query",l))continue;u|=i[l].one;this.incrementAll(i[l],r[l],a,n.add);n.rem=n.add}}return u},incrementAll(t,e,n,i){const r=this.value,a=r.seen(),o=r.curr(),u=r.prev(),s=t.index(),l=t.bisect(t.range),f=t.bisect(e),c=f[0],h=f[1],d=l[0],p=l[1],g=t.one;let m,y,v;if(c<d){for(m=c,y=Math.min(d,h);m<y;++m){v=s[m];if(a[v]!==n){u[v]=o[v];a[v]=n;i.push(v)}o[v]^=g}}else if(c>d){for(m=d,y=Math.min(c,p);m<y;++m){v=s[m];if(a[v]!==n){u[v]=o[v];a[v]=n;i.push(v)}o[v]^=g}}if(h>p){for(m=Math.max(c,p),y=h;m<y;++m){v=s[m];if(a[v]!==n){u[v]=o[v];a[v]=n;i.push(v)}o[v]^=g}}else if(h<p){for(m=Math.max(d,h),y=p;m<y;++m){v=s[m];if(a[v]!==n){u[v]=o[v];a[v]=n;i.push(v)}o[v]^=g}}t.range=e.slice()},incrementOne(t,e,n,i){const r=this.value,a=r.curr(),o=t.index(),u=t.bisect(t.range),s=t.bisect(e),l=s[0],f=s[1],c=u[0],h=u[1],d=t.one;let p,g,m;if(l<c){for(p=l,g=Math.min(c,f);p<g;++p){m=o[p];a[m]^=d;n.push(m)}}else if(l>c){for(p=c,g=Math.min(l,h);p<g;++p){m=o[p];a[m]^=d;i.push(m)}}if(f>h){for(p=Math.max(l,h),g=f;p<g;++p){m=o[p];a[m]^=d;n.push(m)}}else if(f<h){for(p=Math.max(c,f),g=h;p<g;++p){m=o[p];a[m]^=d;i.push(m)}}t.range=e.slice()}});function EP(t){Wo.call(this,null,t)}EP.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:true,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:true,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]};(0,g.XW)(EP,Wo,{transform(t,e){const n=~(t.ignore||0),i=t.filter,r=i.mask;if((r&n)===0)return e.StopPropagation;const a=e.fork(e.ALL),o=i.data(),u=i.curr(),s=i.prev(),l=t=>!(u[t]&n)?o[t]:null;a.filter(a.MOD,l);if(!(r&r-1)){a.filter(a.ADD,l);a.filter(a.REM,(t=>(u[t]&n)===r?o[t]:null))}else{a.filter(a.ADD,(t=>{const e=u[t]&n,i=!e&&e^s[t]&n;return i?o[t]:null}));a.filter(a.REM,(t=>{const e=u[t]&n,i=e&&!(e^(e^s[t]&n));return i?o[t]:null}))}return a.filter(a.SOURCE,(t=>l(t._index)))}});const DP="RawCode";const CP="Literal";const FP="Property";const SP="Identifier";const TP="ArrayExpression";const BP="BinaryExpression";const NP="CallExpression";const zP="ConditionalExpression";const OP="LogicalExpression";const RP="MemberExpression";const UP="ObjectExpression";const $P="UnaryExpression";function PP(t){this.type=t}PP.prototype.visit=function(t){let e,n,i;if(t(this))return 1;for(e=qP(this),n=0,i=e.length;n<i;++n){if(e[n].visit(t))return 1}};function qP(t){switch(t.type){case TP:return t.elements;case BP:case OP:return[t.left,t.right];case NP:return[t.callee].concat(t.arguments);case zP:return[t.test,t.consequent,t.alternate];case RP:return[t.object,t.property];case UP:return t.properties;case FP:return[t.key,t.value];case $P:return[t.argument];case SP:case CP:case DP:default:return[]}}var IP,LP,jP,WP,XP;var HP=1,YP=2,JP=3,VP=4,GP=5,KP=6,ZP=7,QP=8,tq=9;IP={};IP[HP]="Boolean";IP[YP]="<end>";IP[JP]="Identifier";IP[VP]="Keyword";IP[GP]="Null";IP[KP]="Numeric";IP[ZP]="Punctuator";IP[QP]="String";IP[tq]="RegularExpression";var eq="ArrayExpression",nq="BinaryExpression",iq="CallExpression",rq="ConditionalExpression",aq="Identifier",oq="Literal",uq="LogicalExpression",sq="MemberExpression",lq="ObjectExpression",fq="Property",cq="UnaryExpression";var hq="Unexpected token %0",dq="Unexpected number",pq="Unexpected string",gq="Unexpected identifier",mq="Unexpected reserved word",yq="Unexpected end of input",vq="Invalid regular expression",xq="Invalid regular expression: missing /",_q="Octal literals are not allowed in strict mode.",bq="Duplicate data property in object literal not allowed in strict mode";var wq="ILLEGAL",kq="Disabled.";var Mq=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),Aq=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function Eq(t,e){if(!t){throw new Error("ASSERT: "+e)}}function Dq(t){return t>=48&&t<=57}function Cq(t){return"0123456789abcdefABCDEF".indexOf(t)>=0}function Fq(t){return"01234567".indexOf(t)>=0}function Sq(t){return t===32||t===9||t===11||t===12||t===160||t>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(t)>=0}function Tq(t){return t===10||t===13||t===8232||t===8233}function Bq(t){return t===36||t===95||t>=65&&t<=90||t>=97&&t<=122||t===92||t>=128&&Mq.test(String.fromCharCode(t))}function Nq(t){return t===36||t===95||t>=65&&t<=90||t>=97&&t<=122||t>=48&&t<=57||t===92||t>=128&&Aq.test(String.fromCharCode(t))}const zq={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function Oq(){while(jP<WP){const t=LP.charCodeAt(jP);if(Sq(t)||Tq(t)){++jP}else{break}}}function Rq(t){var e,n,i,r=0;n=t==="u"?4:2;for(e=0;e<n;++e){if(jP<WP&&Cq(LP[jP])){i=LP[jP++];r=r*16+"0123456789abcdef".indexOf(i.toLowerCase())}else{fI({},hq,wq)}}return String.fromCharCode(r)}function Uq(){var t,e,n,i;t=LP[jP];e=0;if(t==="}"){fI({},hq,wq)}while(jP<WP){t=LP[jP++];if(!Cq(t)){break}e=e*16+"0123456789abcdef".indexOf(t.toLowerCase())}if(e>1114111||t!=="}"){fI({},hq,wq)}if(e<=65535){return String.fromCharCode(e)}n=(e-65536>>10)+55296;i=(e-65536&1023)+56320;return String.fromCharCode(n,i)}function $q(){var t,e;t=LP.charCodeAt(jP++);e=String.fromCharCode(t);if(t===92){if(LP.charCodeAt(jP)!==117){fI({},hq,wq)}++jP;t=Rq("u");if(!t||t==="\\"||!Bq(t.charCodeAt(0))){fI({},hq,wq)}e=t}while(jP<WP){t=LP.charCodeAt(jP);if(!Nq(t)){break}++jP;e+=String.fromCharCode(t);if(t===92){e=e.substr(0,e.length-1);if(LP.charCodeAt(jP)!==117){fI({},hq,wq)}++jP;t=Rq("u");if(!t||t==="\\"||!Nq(t.charCodeAt(0))){fI({},hq,wq)}e+=t}}return e}function Pq(){var t,e;t=jP++;while(jP<WP){e=LP.charCodeAt(jP);if(e===92){jP=t;return $q()}if(Nq(e)){++jP}else{break}}return LP.slice(t,jP)}function qq(){var t,e,n;t=jP;e=LP.charCodeAt(jP)===92?$q():Pq();if(e.length===1){n=JP}else if(zq.hasOwnProperty(e)){n=VP}else if(e==="null"){n=GP}else if(e==="true"||e==="false"){n=HP}else{n=JP}return{type:n,value:e,start:t,end:jP}}function Iq(){var t=jP,e=LP.charCodeAt(jP),n,i=LP[jP],r,a,o;switch(e){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:++jP;return{type:ZP,value:String.fromCharCode(e),start:t,end:jP};default:n=LP.charCodeAt(jP+1);if(n===61){switch(e){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:jP+=2;return{type:ZP,value:String.fromCharCode(e)+String.fromCharCode(n),start:t,end:jP};case 33:case 61:jP+=2;if(LP.charCodeAt(jP)===61){++jP}return{type:ZP,value:LP.slice(t,jP),start:t,end:jP}}}}o=LP.substr(jP,4);if(o===">>>="){jP+=4;return{type:ZP,value:o,start:t,end:jP}}a=o.substr(0,3);if(a===">>>"||a==="<<="||a===">>="){jP+=3;return{type:ZP,value:a,start:t,end:jP}}r=a.substr(0,2);if(i===r[1]&&"+-<>&|".indexOf(i)>=0||r==="=>"){jP+=2;return{type:ZP,value:r,start:t,end:jP}}if(r==="//"){fI({},hq,wq)}if("<>=!+-*%&|^/".indexOf(i)>=0){++jP;return{type:ZP,value:i,start:t,end:jP}}fI({},hq,wq)}function Lq(t){let e="";while(jP<WP){if(!Cq(LP[jP])){break}e+=LP[jP++]}if(e.length===0){fI({},hq,wq)}if(Bq(LP.charCodeAt(jP))){fI({},hq,wq)}return{type:KP,value:parseInt("0x"+e,16),start:t,end:jP}}function jq(t){let e="0"+LP[jP++];while(jP<WP){if(!Fq(LP[jP])){break}e+=LP[jP++]}if(Bq(LP.charCodeAt(jP))||Dq(LP.charCodeAt(jP))){fI({},hq,wq)}return{type:KP,value:parseInt(e,8),octal:true,start:t,end:jP}}function Wq(){var t,e,n;n=LP[jP];Eq(Dq(n.charCodeAt(0))||n===".","Numeric literal must start with a decimal digit or a decimal point");e=jP;t="";if(n!=="."){t=LP[jP++];n=LP[jP];if(t==="0"){if(n==="x"||n==="X"){++jP;return Lq(e)}if(Fq(n)){return jq(e)}if(n&&Dq(n.charCodeAt(0))){fI({},hq,wq)}}while(Dq(LP.charCodeAt(jP))){t+=LP[jP++]}n=LP[jP]}if(n==="."){t+=LP[jP++];while(Dq(LP.charCodeAt(jP))){t+=LP[jP++]}n=LP[jP]}if(n==="e"||n==="E"){t+=LP[jP++];n=LP[jP];if(n==="+"||n==="-"){t+=LP[jP++]}if(Dq(LP.charCodeAt(jP))){while(Dq(LP.charCodeAt(jP))){t+=LP[jP++]}}else{fI({},hq,wq)}}if(Bq(LP.charCodeAt(jP))){fI({},hq,wq)}return{type:KP,value:parseFloat(t),start:e,end:jP}}function Xq(){var t="",e,n,i,r,a=false;e=LP[jP];Eq(e==="'"||e==='"',"String literal must starts with a quote");n=jP;++jP;while(jP<WP){i=LP[jP++];if(i===e){e="";break}else if(i==="\\"){i=LP[jP++];if(!i||!Tq(i.charCodeAt(0))){switch(i){case"u":case"x":if(LP[jP]==="{"){++jP;t+=Uq()}else{t+=Rq(i)}break;case"n":t+="\n";break;case"r":t+="\r";break;case"t":t+="\t";break;case"b":t+="\b";break;case"f":t+="\f";break;case"v":t+="\v";break;default:if(Fq(i)){r="01234567".indexOf(i);if(r!==0){a=true}if(jP<WP&&Fq(LP[jP])){a=true;r=r*8+"01234567".indexOf(LP[jP++]);if("0123".indexOf(i)>=0&&jP<WP&&Fq(LP[jP])){r=r*8+"01234567".indexOf(LP[jP++])}}t+=String.fromCharCode(r)}else{t+=i}break}}else{if(i==="\r"&&LP[jP]==="\n"){++jP}}}else if(Tq(i.charCodeAt(0))){break}else{t+=i}}if(e!==""){fI({},hq,wq)}return{type:QP,value:t,octal:a,start:n,end:jP}}function Hq(t,e){let n=t;if(e.indexOf("u")>=0){n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,((t,e)=>{if(parseInt(e,16)<=1114111){return"x"}fI({},vq)})).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x")}try{new RegExp(n)}catch(i){fI({},vq)}try{return new RegExp(t,e)}catch(r){return null}}function Yq(){var t,e,n,i,r;t=LP[jP];Eq(t==="/","Regular expression literal must start with a slash");e=LP[jP++];n=false;i=false;while(jP<WP){t=LP[jP++];e+=t;if(t==="\\"){t=LP[jP++];if(Tq(t.charCodeAt(0))){fI({},xq)}e+=t}else if(Tq(t.charCodeAt(0))){fI({},xq)}else if(n){if(t==="]"){n=false}}else{if(t==="/"){i=true;break}else if(t==="["){n=true}}}if(!i){fI({},xq)}r=e.substr(1,e.length-2);return{value:r,literal:e}}function Jq(){var t,e,n;e="";n="";while(jP<WP){t=LP[jP];if(!Nq(t.charCodeAt(0))){break}++jP;if(t==="\\"&&jP<WP){fI({},hq,wq)}else{n+=t;e+=t}}if(n.search(/[^gimuy]/g)>=0){fI({},vq,n)}return{value:n,literal:e}}function Vq(){var t,e,n,i;XP=null;Oq();t=jP;e=Yq();n=Jq();i=Hq(e.value,n.value);return{literal:e.literal+n.literal,value:i,regex:{pattern:e.value,flags:n.value},start:t,end:jP}}function Gq(t){return t.type===JP||t.type===VP||t.type===HP||t.type===GP}function Kq(){Oq();if(jP>=WP){return{type:YP,start:jP,end:jP}}const t=LP.charCodeAt(jP);if(Bq(t)){return qq()}if(t===40||t===41||t===59){return Iq()}if(t===39||t===34){return Xq()}if(t===46){if(Dq(LP.charCodeAt(jP+1))){return Wq()}return Iq()}if(Dq(t)){return Wq()}return Iq()}function Zq(){const t=XP;jP=t.end;XP=Kq();jP=t.end;return t}function Qq(){const t=jP;XP=Kq();jP=t}function tI(t){const e=new PP(eq);e.elements=t;return e}function eI(t,e,n){const i=new PP(t==="||"||t==="&&"?uq:nq);i.operator=t;i.left=e;i.right=n;return i}function nI(t,e){const n=new PP(iq);n.callee=t;n.arguments=e;return n}function iI(t,e,n){const i=new PP(rq);i.test=t;i.consequent=e;i.alternate=n;return i}function rI(t){const e=new PP(aq);e.name=t;return e}function aI(t){const e=new PP(oq);e.value=t.value;e.raw=LP.slice(t.start,t.end);if(t.regex){if(e.raw==="//"){e.raw="/(?:)/"}e.regex=t.regex}return e}function oI(t,e,n){const i=new PP(sq);i.computed=t==="[";i.object=e;i.property=n;if(!i.computed)n.member=true;return i}function uI(t){const e=new PP(lq);e.properties=t;return e}function sI(t,e,n){const i=new PP(fq);i.key=e;i.value=n;i.kind=t;return i}function lI(t,e){const n=new PP(cq);n.operator=t;n.argument=e;n.prefix=true;return n}function fI(t,e){var n,i=Array.prototype.slice.call(arguments,2),r=e.replace(/%(\d)/g,((t,e)=>{Eq(e<i.length,"Message reference must be in range");return i[e]}));n=new Error(r);n.index=jP;n.description=r;throw n}function cI(t){if(t.type===YP){fI(t,yq)}if(t.type===KP){fI(t,dq)}if(t.type===QP){fI(t,pq)}if(t.type===JP){fI(t,gq)}if(t.type===VP){fI(t,mq)}fI(t,hq,t.value)}function hI(t){const e=Zq();if(e.type!==ZP||e.value!==t){cI(e)}}function dI(t){return XP.type===ZP&&XP.value===t}function pI(t){return XP.type===VP&&XP.value===t}function gI(){const t=[];jP=XP.start;hI("[");while(!dI("]")){if(dI(",")){Zq();t.push(null)}else{t.push(TI());if(!dI("]")){hI(",")}}}Zq();return tI(t)}function mI(){jP=XP.start;const t=Zq();if(t.type===QP||t.type===KP){if(t.octal){fI(t,_q)}return aI(t)}return rI(t.value)}function yI(){var t,e,n,i;jP=XP.start;t=XP;if(t.type===JP){n=mI();hI(":");i=TI();return sI("init",n,i)}if(t.type===YP||t.type===ZP){cI(t)}else{e=mI();hI(":");i=TI();return sI("init",e,i)}}function vI(){var t=[],e,n,i,r={},a=String;jP=XP.start;hI("{");while(!dI("}")){e=yI();if(e.key.type===aq){n=e.key.name}else{n=a(e.key.value)}i="$"+n;if(Object.prototype.hasOwnProperty.call(r,i)){fI({},bq)}else{r[i]=true}t.push(e);if(!dI("}")){hI(",")}}hI("}");return uI(t)}function xI(){hI("(");const t=BI();hI(")");return t}const _I={if:1};function bI(){var t,e,n;if(dI("(")){return xI()}if(dI("[")){return gI()}if(dI("{")){return vI()}t=XP.type;jP=XP.start;if(t===JP||_I[XP.value]){n=rI(Zq().value)}else if(t===QP||t===KP){if(XP.octal){fI(XP,_q)}n=aI(Zq())}else if(t===VP){throw new Error(kq)}else if(t===HP){e=Zq();e.value=e.value==="true";n=aI(e)}else if(t===GP){e=Zq();e.value=null;n=aI(e)}else if(dI("/")||dI("/=")){n=aI(Vq());Qq()}else{cI(Zq())}return n}function wI(){const t=[];hI("(");if(!dI(")")){while(jP<WP){t.push(TI());if(dI(")")){break}hI(",")}}hI(")");return t}function kI(){jP=XP.start;const t=Zq();if(!Gq(t)){cI(t)}return rI(t.value)}function MI(){hI(".");return kI()}function AI(){hI("[");const t=BI();hI("]");return t}function EI(){var t,e,n;t=bI();for(;;){if(dI(".")){n=MI();t=oI(".",t,n)}else if(dI("(")){e=wI();t=nI(t,e)}else if(dI("[")){n=AI();t=oI("[",t,n)}else{break}}return t}function DI(){const t=EI();if(XP.type===ZP){if(dI("++")||dI("--")){throw new Error(kq)}}return t}function CI(){var t,e;if(XP.type!==ZP&&XP.type!==VP){e=DI()}else if(dI("++")||dI("--")){throw new Error(kq)}else if(dI("+")||dI("-")||dI("~")||dI("!")){t=Zq();e=CI();e=lI(t.value,e)}else if(pI("delete")||pI("void")||pI("typeof")){throw new Error(kq)}else{e=DI()}return e}function FI(t){let e=0;if(t.type!==ZP&&t.type!==VP){return 0}switch(t.value){case"||":e=1;break;case"&&":e=2;break;case"|":e=3;break;case"^":e=4;break;case"&":e=5;break;case"==":case"!=":case"===":case"!==":e=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":e=7;break;case"<<":case">>":case">>>":e=8;break;case"+":case"-":e=9;break;case"*":case"/":case"%":e=11;break}return e}function SI(){var t,e,n,i,r,a,o,u,s,l;t=XP;s=CI();i=XP;r=FI(i);if(r===0){return s}i.prec=r;Zq();e=[t,XP];o=CI();a=[s,i,o];while((r=FI(XP))>0){while(a.length>2&&r<=a[a.length-2].prec){o=a.pop();u=a.pop().value;s=a.pop();e.pop();n=eI(u,s,o);a.push(n)}i=Zq();i.prec=r;a.push(i);e.push(XP);n=CI();a.push(n)}l=a.length-1;n=a[l];e.pop();while(l>1){e.pop();n=eI(a[l-1].value,a[l-2],n);l-=2}return n}function TI(){var t,e,n;t=SI();if(dI("?")){Zq();e=TI();hI(":");n=TI();t=iI(t,e,n)}return t}function BI(){const t=TI();if(dI(",")){throw new Error(kq)}return t}function NI(t){LP=t;jP=0;WP=LP.length;XP=null;Qq();const e=BI();if(XP.type!==YP){throw new Error("Unexpect token after expression.")}return e}var zI={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function OI(t){function e(e,n,i,r){let a=t(n[0]);if(i){a=i+"("+a+")";if(i.lastIndexOf("new ",0)===0)a="("+a+")"}return a+"."+e+(r<0?"":r===0?"()":"("+n.slice(1).map(t).join(",")+")")}function n(t,n,i){return r=>e(t,r,n,i)}const i="new Date",r="String",a="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(e){if(e.length<3)(0,g.vU)("Missing arguments to clamp function.");if(e.length>3)(0,g.vU)("Too many arguments to clamp function.");const n=e.map(t);return"Math.max("+n[1]+", Math.min("+n[2]+","+n[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:i,date:n("getDate",i,0),day:n("getDay",i,0),year:n("getFullYear",i,0),month:n("getMonth",i,0),hours:n("getHours",i,0),minutes:n("getMinutes",i,0),seconds:n("getSeconds",i,0),milliseconds:n("getMilliseconds",i,0),time:n("getTime",i,0),timezoneoffset:n("getTimezoneOffset",i,0),utcdate:n("getUTCDate",i,0),utcday:n("getUTCDay",i,0),utcyear:n("getUTCFullYear",i,0),utcmonth:n("getUTCMonth",i,0),utchours:n("getUTCHours",i,0),utcminutes:n("getUTCMinutes",i,0),utcseconds:n("getUTCSeconds",i,0),utcmilliseconds:n("getUTCMilliseconds",i,0),length:n("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:n("toUpperCase",r,0),lower:n("toLowerCase",r,0),substring:n("substring",r),split:n("split",r),trim:n("trim",r,0),regexp:a,test:n("test",a),if:function(e){if(e.length<3)(0,g.vU)("Missing arguments to if function.");if(e.length>3)(0,g.vU)("Too many arguments to if function.");const n=e.map(t);return"("+n[0]+"?"+n[1]+":"+n[2]+")"}}}function RI(t){const e=t&&t.length-1;return e&&(t[0]==='"'&&t[e]==='"'||t[0]==="'"&&t[e]==="'")?t.slice(1,-1):t}function UI(t){t=t||{};const e=t.allowed?(0,g.Rg)(t.allowed):{},n=t.forbidden?(0,g.Rg)(t.forbidden):{},i=t.constants||zI,r=(t.functions||OI)(c),a=t.globalvar,o=t.fieldvar,u=(0,g.mf)(a)?a:t=>`${a}["${t}"]`;let s={},l={},f=0;function c(t){if((0,g.HD)(t))return t;const e=h[t.type];if(e==null)(0,g.vU)("Unsupported type: "+t.type);return e(t)}const h={Literal:t=>t.raw,Identifier:t=>{const r=t.name;if(f>0){return r}else if((0,g.nr)(n,r)){return(0,g.vU)("Illegal identifier: "+r)}else if((0,g.nr)(i,r)){return i[r]}else if((0,g.nr)(e,r)){return r}else{s[r]=1;return u(r)}},MemberExpression:t=>{const e=!t.computed,n=c(t.object);if(e)f+=1;const i=c(t.property);if(n===o){l[RI(i)]=1}if(e)f-=1;return n+(e?"."+i:"["+i+"]")},CallExpression:t=>{if(t.callee.type!=="Identifier"){(0,g.vU)("Illegal callee type: "+t.callee.type)}const e=t.callee.name,n=t.arguments,i=(0,g.nr)(r,e)&&r[e];if(!i)(0,g.vU)("Unrecognized function: "+e);return(0,g.mf)(i)?i(n):i+"("+n.map(c).join(",")+")"},ArrayExpression:t=>"["+t.elements.map(c).join(",")+"]",BinaryExpression:t=>"("+c(t.left)+" "+t.operator+" "+c(t.right)+")",UnaryExpression:t=>"("+t.operator+c(t.argument)+")",ConditionalExpression:t=>"("+c(t.test)+"?"+c(t.consequent)+":"+c(t.alternate)+")",LogicalExpression:t=>"("+c(t.left)+t.operator+c(t.right)+")",ObjectExpression:t=>"{"+t.properties.map(c).join(",")+"}",Property:t=>{f+=1;const e=c(t.key);f-=1;return e+":"+c(t.value)}};function d(t){const e={code:c(t),globals:Object.keys(s),fields:Object.keys(l)};s={};l={};return e}d.functions=r;d.constants=i;return d}var $I=1e-6;var PI=1e-12;var qI=Math.PI;var II=qI/2;var LI=qI/4;var jI=qI*2;var WI=180/qI;var XI=qI/180;var HI=Math.abs;var YI=Math.atan;var JI=Math.atan2;var VI=Math.cos;var GI=Math.ceil;var KI=Math.exp;var ZI=Math.floor;var QI=Math.hypot;var tL=Math.log;var eL=Math.pow;var nL=Math.sin;var iL=Math.sign||function(t){return t>0?1:t<0?-1:0};var rL=Math.sqrt;var aL=Math.tan;function oL(t){return t>1?0:t<-1?qI:Math.acos(t)}function uL(t){return t>1?II:t<-1?-II:Math.asin(t)}function sL(t){return(t=nL(t/2))*t}function lL(){}function fL(t,e){if(t&&hL.hasOwnProperty(t.type)){hL[t.type](t,e)}}var cL={Feature:function(t,e){fL(t.geometry,e)},FeatureCollection:function(t,e){var n=t.features,i=-1,r=n.length;while(++i<r)fL(n[i].geometry,e)}};var hL={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates;e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){var n=t.coordinates,i=-1,r=n.length;while(++i<r)t=n[i],e.point(t[0],t[1],t[2])},LineString:function(t,e){dL(t.coordinates,e,0)},MultiLineString:function(t,e){var n=t.coordinates,i=-1,r=n.length;while(++i<r)dL(n[i],e,0)},Polygon:function(t,e){pL(t.coordinates,e)},MultiPolygon:function(t,e){var n=t.coordinates,i=-1,r=n.length;while(++i<r)pL(n[i],e)},GeometryCollection:function(t,e){var n=t.geometries,i=-1,r=n.length;while(++i<r)fL(n[i],e)}};function dL(t,e,n){var i=-1,r=t.length-n,a;e.lineStart();while(++i<r)a=t[i],e.point(a[0],a[1],a[2]);e.lineEnd()}function pL(t,e){var n=-1,i=t.length;e.polygonStart();while(++n<i)dL(t[n],e,1);e.polygonEnd()}function gL(t,e){if(t&&cL.hasOwnProperty(t.type)){cL[t.type](t,e)}else{fL(t,e)}}var mL=new gE;var yL=new gE,vL,xL,_L,bL,wL;var kL={point:lL,lineStart:lL,lineEnd:lL,polygonStart:function(){mL=new gE;kL.lineStart=ML;kL.lineEnd=AL},polygonEnd:function(){var t=+mL;yL.add(t<0?jI+t:t);this.lineStart=this.lineEnd=this.point=lL},sphere:function(){yL.add(jI)}};function ML(){kL.point=EL}function AL(){DL(vL,xL)}function EL(t,e){kL.point=DL;vL=t,xL=e;t*=XI,e*=XI;_L=t,bL=VI(e=e/2+LI),wL=nL(e)}function DL(t,e){t*=XI,e*=XI;e=e/2+LI;var n=t-_L,i=n>=0?1:-1,r=i*n,a=VI(e),o=nL(e),u=wL*o,s=bL*a+u*VI(r),l=u*i*nL(r);mL.add(JI(l,s));_L=t,bL=a,wL=o}function CL(t){yL=new gE;gL(t,kL);return yL*2}function FL(t){return[JI(t[1],t[0]),uL(t[2])]}function SL(t){var e=t[0],n=t[1],i=VI(n);return[i*VI(e),i*nL(e),nL(n)]}function TL(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function BL(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function NL(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function zL(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function OL(t){var e=rL(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}var RL,UL,$L,PL,qL,IL,LL,jL,WL,XL,HL;var YL={point:JL,lineStart:GL,lineEnd:KL,polygonStart:function(){YL.point=ZL;YL.lineStart=QL;YL.lineEnd=tj;WL=new gE;kL.polygonStart()},polygonEnd:function(){kL.polygonEnd();YL.point=JL;YL.lineStart=GL;YL.lineEnd=KL;if(mL<0)RL=-($L=180),UL=-(PL=90);else if(WL>$I)PL=90;else if(WL<-$I)UL=-90;HL[0]=RL,HL[1]=$L},sphere:function(){RL=-($L=180),UL=-(PL=90)}};function JL(t,e){XL.push(HL=[RL=t,$L=t]);if(e<UL)UL=e;if(e>PL)PL=e}function VL(t,e){var n=SL([t*XI,e*XI]);if(jL){var i=BL(jL,n),r=[i[1],-i[0],0],a=BL(r,i);OL(a);a=FL(a);var o=t-qL,u=o>0?1:-1,s=a[0]*WI*u,l,f=HI(o)>180;if(f^(u*qL<s&&s<u*t)){l=a[1]*WI;if(l>PL)PL=l}else if(s=(s+360)%360-180,f^(u*qL<s&&s<u*t)){l=-a[1]*WI;if(l<UL)UL=l}else{if(e<UL)UL=e;if(e>PL)PL=e}if(f){if(t<qL){if(ej(RL,t)>ej(RL,$L))$L=t}else{if(ej(t,$L)>ej(RL,$L))RL=t}}else{if($L>=RL){if(t<RL)RL=t;if(t>$L)$L=t}else{if(t>qL){if(ej(RL,t)>ej(RL,$L))$L=t}else{if(ej(t,$L)>ej(RL,$L))RL=t}}}}else{XL.push(HL=[RL=t,$L=t])}if(e<UL)UL=e;if(e>PL)PL=e;jL=n,qL=t}function GL(){YL.point=VL}function KL(){HL[0]=RL,HL[1]=$L;YL.point=JL;jL=null}function ZL(t,e){if(jL){var n=t-qL;WL.add(HI(n)>180?n+(n>0?360:-360):n)}else{IL=t,LL=e}kL.point(t,e);VL(t,e)}function QL(){kL.lineStart()}function tj(){ZL(IL,LL);kL.lineEnd();if(HI(WL)>$I)RL=-($L=180);HL[0]=RL,HL[1]=$L;jL=null}function ej(t,e){return(e-=t)<0?e+360:e}function nj(t,e){return t[0]-e[0]}function ij(t,e){return t[0]<=t[1]?t[0]<=e&&e<=t[1]:e<t[0]||t[1]<e}function rj(t){var e,n,i,r,a,o,u;PL=$L=-(RL=UL=Infinity);XL=[];gL(t,YL);if(n=XL.length){XL.sort(nj);for(e=1,i=XL[0],a=[i];e<n;++e){r=XL[e];if(ij(i,r[0])||ij(i,r[1])){if(ej(i[0],r[1])>ej(i[0],i[1]))i[1]=r[1];if(ej(r[0],i[1])>ej(i[0],i[1]))i[0]=r[0]}else{a.push(i=r)}}for(o=-Infinity,n=a.length-1,e=0,i=a[n];e<=n;i=r,++e){r=a[e];if((u=ej(i[1],r[0]))>o)o=u,RL=r[0],$L=i[1]}}XL=HL=null;return RL===Infinity||UL===Infinity?[[NaN,NaN],[NaN,NaN]]:[[RL,UL],[$L,PL]]}var aj,oj,uj,sj,lj,fj,cj,hj,dj,pj,gj,mj,yj,vj,xj,_j;var bj={sphere:lL,point:wj,lineStart:Mj,lineEnd:Dj,polygonStart:function(){bj.lineStart=Cj;bj.lineEnd=Fj},polygonEnd:function(){bj.lineStart=Mj;bj.lineEnd=Dj}};function wj(t,e){t*=XI,e*=XI;var n=VI(e);kj(n*VI(t),n*nL(t),nL(e))}function kj(t,e,n){++aj;uj+=(t-uj)/aj;sj+=(e-sj)/aj;lj+=(n-lj)/aj}function Mj(){bj.point=Aj}function Aj(t,e){t*=XI,e*=XI;var n=VI(e);vj=n*VI(t);xj=n*nL(t);_j=nL(e);bj.point=Ej;kj(vj,xj,_j)}function Ej(t,e){t*=XI,e*=XI;var n=VI(e),i=n*VI(t),r=n*nL(t),a=nL(e),o=JI(rL((o=xj*a-_j*r)*o+(o=_j*i-vj*a)*o+(o=vj*r-xj*i)*o),vj*i+xj*r+_j*a);oj+=o;fj+=o*(vj+(vj=i));cj+=o*(xj+(xj=r));hj+=o*(_j+(_j=a));kj(vj,xj,_j)}function Dj(){bj.point=wj}function Cj(){bj.point=Sj}function Fj(){Tj(mj,yj);bj.point=wj}function Sj(t,e){mj=t,yj=e;t*=XI,e*=XI;bj.point=Tj;var n=VI(e);vj=n*VI(t);xj=n*nL(t);_j=nL(e);kj(vj,xj,_j)}function Tj(t,e){t*=XI,e*=XI;var n=VI(e),i=n*VI(t),r=n*nL(t),a=nL(e),o=xj*a-_j*r,u=_j*i-vj*a,s=vj*r-xj*i,l=QI(o,u,s),f=uL(l),c=l&&-f/l;dj.add(c*o);pj.add(c*u);gj.add(c*s);oj+=f;fj+=f*(vj+(vj=i));cj+=f*(xj+(xj=r));hj+=f*(_j+(_j=a));kj(vj,xj,_j)}function Bj(t){aj=oj=uj=sj=lj=fj=cj=hj=0;dj=new gE;pj=new gE;gj=new gE;gL(t,bj);var e=+dj,n=+pj,i=+gj,r=QI(e,n,i);if(r<PI){e=fj,n=cj,i=hj;if(oj<$I)e=uj,n=sj,i=lj;r=QI(e,n,i);if(r<PI)return[NaN,NaN]}return[JI(n,e)*WI,uL(i/r)*WI]}function Nj(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function zj(t){let e=t;let n=t;if(t.length===1){e=(e,n)=>t(e)-n;n=Oj(t)}function i(t,e,i,r){if(i==null)i=0;if(r==null)r=t.length;while(i<r){const a=i+r>>>1;if(n(t[a],e)<0)i=a+1;else r=a}return i}function r(t,e,i,r){if(i==null)i=0;if(r==null)r=t.length;while(i<r){const a=i+r>>>1;if(n(t[a],e)>0)r=a;else i=a+1}return i}function a(t,n,r,a){if(r==null)r=0;if(a==null)a=t.length;const o=i(t,n,r,a-1);return o>r&&e(t[o-1],n)>-e(t[o],n)?o-1:o}return{left:i,center:a,right:r}}function Oj(t){return(e,n)=>Nj(t(e),n)}const Rj="intersect";const Uj="union";const $j="vlMulti";const Pj="vlPoint";const qj="or";const Ij="and";const Lj="_vgsid_",jj="E",Wj="R",Xj="R-E",Hj="R-LE",Yj="R-RE",Jj="index:unit";function Vj(t,e){var n=e.fields,i=e.values,r=n.length,a=0,o,u;for(;a<r;++a){u=n[a];u.getter=g.EP.getter||(0,g.EP)(u.field);o=u.getter(t);if((0,g.J_)(o))o=(0,g.He)(o);if((0,g.J_)(i[a]))i[a]=(0,g.He)(i[a]);if((0,g.J_)(i[a][0]))i[a]=i[a].map(g.He);if(u.type===jj){if((0,g.kJ)(i[a])?i[a].indexOf(o)<0:o!==i[a]){return false}}else{if(u.type===Wj){if(!(0,g.u5)(o,i[a]))return false}else if(u.type===Yj){if(!(0,g.u5)(o,i[a],true,false))return false}else if(u.type===Xj){if(!(0,g.u5)(o,i[a],false,false))return false}else if(u.type===Hj){if(!(0,g.u5)(o,i[a],false,true))return false}}}return true}function Gj(t,e,n){var i=this.context.data[t],r=i?i.values.value:[],a=i?i[Jj]&&i[Jj].value:undefined,o=n===Rj,u=r.length,s=0,l,f,c,h,d;for(;s<u;++s){l=r[s];if(a&&o){f=f||{};c=f[h=l.unit]||0;if(c===-1)continue;d=Vj(e,l);f[h]=d?-1:++c;if(d&&a.size===1)return true;if(!d&&c===a.get(h).count)return false}else{d=Vj(e,l);if(o^d)return d}}return u&&o}const Kj=(0,g.EP)(Lj),Zj=zj(Kj),Qj=Zj.left,tW=Zj.right;function eW(t,e,n){const i=this.context.data[t],r=i?i.values.value:[],a=i?i[Jj]&&i[Jj].value:undefined,o=n===Rj,u=Kj(e),s=Qj(r,u);if(s===r.length)return false;if(Kj(r[s])!==u)return false;if(a&&o){if(a.size===1)return true;if(tW(r,u)-s<a.size)return false}return true}function nW(t,e){return t.map((t=>(0,g.l7)({values:e.fields.map((e=>(e.getter||(e.getter=(0,g.EP)(e.field)))(t.datum)))},e)))}function iW(t,e,n,i){var r=this.context.data[t],a=r?r.values.value:[],o={},u={},s={},l,f,c,h,d,p,m,y,v,x=a.length,_=0,b,w;for(;_<x;++_){l=a[_];h=l.unit;f=l.fields;c=l.values;for(b=0,w=f.length;b<w;++b){d=f[b];p=o[d.field]||(o[d.field]={});m=p[h]||(p[h]=[]);s[d.field]=y=d.type.charAt(0);v=rW[y+"_union"];p[h]=v(m,(0,g.IX)(c[b]))}if(n){m=u[h]||(u[h]=[]);m.push((0,g.IX)(c).reduce(((t,e,n)=>(t[f[n].field]=e,t)),{}))}}e=e||Uj;Object.keys(o).forEach((t=>{o[t]=Object.keys(o[t]).map((e=>o[t][e])).reduce(((n,i)=>n===undefined?i:rW[s[t]+"_"+e](n,i)))}));a=Object.keys(u);if(n&&a.length){const t=i?Pj:$j;o[t]=e===Uj?{[qj]:a.reduce(((t,e)=>(t.push(...u[e]),t)),[])}:{[Ij]:a.map((t=>({[qj]:u[t]})))}}return o}var rW={E_union:function(t,e){if(!t.length)return e;var n=0,i=e.length;for(;n<i;++n)if(t.indexOf(e[n])<0)t.push(e[n]);return t},E_intersect:function(t,e){return!t.length?e:t.filter((t=>e.indexOf(t)>=0))},R_union:function(t,e){var n=(0,g.He)(e[0]),i=(0,g.He)(e[1]);if(n>i){n=e[1];i=e[0]}if(!t.length)return[n,i];if(t[0]>n)t[0]=n;if(t[1]<i)t[1]=i;return t},R_intersect:function(t,e){var n=(0,g.He)(e[0]),i=(0,g.He)(e[1]);if(n>i){n=e[1];i=e[0]}if(!t.length)return[n,i];if(i<t[0]||t[1]<n){return[]}else{if(t[0]<n)t[0]=n;if(t[1]>i)t[1]=i}return t}};const aW=":",oW="@";function uW(t,e,n,i){if(e[0].type!==CP)(0,g.vU)("First argument to selection functions must be a string literal.");const r=e[0].value,a=e.length>=2&&(0,g.fj)(e).value,o="unit",u=oW+o,s=aW+r;if(a===Rj&&!(0,g.nr)(i,u)){i[u]=n.getData(r).indataRef(n,o)}if(!(0,g.nr)(i,s)){i[s]=n.getData(r).tuplesRef()}}function sW(t){const e=this.context.data[t];return e?e.values.value:[]}function lW(t,e,n){const i=this.context.data[t]["index:"+e],r=i?i.value.get(n):undefined;return r?r.count:r}function fW(t,e){const n=this.context.dataflow,i=this.context.data[t],r=i.input;n.pulse(r,n.changeset().remove(g.yb).insert(e));return 1}function cW(t,e,n){if(t){const n=this.context.dataflow,i=t.mark.source;n.pulse(i,n.changeset().encode(t,e))}return n!==undefined?n:t}const hW=t=>function(e,n){const i=this.context.dataflow.locale();return i[t](n)(e)};const dW=hW("format");const pW=hW("timeFormat");const gW=hW("utcFormat");const mW=hW("timeParse");const yW=hW("utcParse");const vW=new Date(2e3,0,1);function xW(t,e,n){if(!Number.isInteger(t)||!Number.isInteger(e))return"";vW.setYear(2e3);vW.setMonth(t);vW.setDate(e);return pW.call(this,vW,n)}function _W(t){return xW.call(this,t,1,"%B")}function bW(t){return xW.call(this,t,1,"%b")}function wW(t){return xW.call(this,0,2+t,"%A")}function kW(t){return xW.call(this,0,2+t,"%a")}const MW=":";const AW="@";const EW="%";const DW="$";function CW(t,e,n,i){if(e[0].type!==CP){(0,g.vU)("First argument to data functions must be a string literal.")}const r=e[0].value,a=MW+r;if(!(0,g.nr)(a,i)){try{i[a]=n.getData(r).tuplesRef()}catch(o){}}}function FW(t,e,n,i){if(e[0].type!==CP)(0,g.vU)("First argument to indata must be a string literal.");if(e[1].type!==CP)(0,g.vU)("Second argument to indata must be a string literal.");const r=e[0].value,a=e[1].value,o=AW+a;if(!(0,g.nr)(o,i)){i[o]=n.getData(r).indataRef(n,a)}}function SW(t,e,n,i){if(e[0].type===CP){TW(n,i,e[0].value)}else{for(t in n.scales){TW(n,i,t)}}}function TW(t,e,n){const i=EW+n;if(!(0,g.nr)(e,i)){try{e[i]=t.scaleRef(n)}catch(r){}}}function BW(t,e){let n;return(0,g.mf)(t)?t:(0,g.HD)(t)?(n=e.scales[t])&&n.value:undefined}function NW(t,e,n){e.__bandwidth=t=>t&&t.bandwidth?t.bandwidth():0;n._bandwidth=SW;n._range=SW;n._scale=SW;const i=e=>"_["+(e.type===CP?(0,g.m8)(EW+e.value):(0,g.m8)(EW)+"+"+t(e))+"]";return{_bandwidth:t=>`this.__bandwidth(${i(t[0])})`,_range:t=>`${i(t[0])}.range()`,_scale:e=>`${i(e[0])}(${t(e[1])})`}}function zW(t,e){return function(n,i,r){if(n){const e=BW(n,(r||this).context);return e&&e.path[t](i)}else{return e(i)}}}const OW=zW("area",CL);const RW=zW("bounds",rj);const UW=zW("centroid",Bj);function $W(t){const e=this.context.group;let n=false;if(e)while(t){if(t===e){n=true;break}t=t.mark.group}return n}function PW(t,e,n){try{t[e].apply(t,["EXPRESSION"].concat([].slice.call(n)))}catch(i){t.warn(i)}return n[n.length-1]}function qW(){return PW(this.context.dataflow,"warn",arguments)}function IW(){return PW(this.context.dataflow,"info",arguments)}function LW(){return PW(this.context.dataflow,"debug",arguments)}function jW(t){const e=t/255;if(e<=.03928){return e/12.92}return Math.pow((e+.055)/1.055,2.4)}function WW(t){const e=Rh(t),n=jW(e.r),i=jW(e.g),r=jW(e.b);return.2126*n+.7152*i+.0722*r}function XW(t,e){const n=WW(t),i=WW(e),r=Math.max(n,i),a=Math.min(n,i);return(r+.05)/(a+.05)}function HW(){const t=[].slice.call(arguments);t.unshift({});return(0,g.l7)(...t)}function YW(t,e){return t===e||t!==t&&e!==e?true:(0,g.kJ)(t)?(0,g.kJ)(e)&&t.length===e.length?JW(t,e):false:(0,g.Kn)(t)&&(0,g.Kn)(e)?VW(t,e):false}function JW(t,e){for(let n=0,i=t.length;n<i;++n){if(!YW(t[n],e[n]))return false}return true}function VW(t,e){for(const n in t){if(!YW(t[n],e[n]))return false}return true}function GW(t){return e=>VW(t,e)}function KW(t,e,n,i,r,a){const o=this.context.dataflow,u=this.context.data[t],s=u.input,l=o.stamp();let f=u.changes,c,h;if(o._trigger===false||!(s.value.length||e||i)){return 0}if(!f||f.stamp<l){u.changes=f=o.changeset();f.stamp=l;o.runAfter((()=>{u.modified=true;o.pulse(s,f).run()}),true,1)}if(n){c=n===true?g.yb:(0,g.kJ)(n)||Da(n)?n:GW(n);f.remove(c)}if(e){f.insert(e)}if(i){c=GW(i);if(s.value.some(c)){f.remove(c)}else{f.insert(i)}}if(r){for(h in a){f.modify(r,h,a[h])}}return 1}function ZW(t){const e=t.touches,n=e[0].clientX-e[1].clientX,i=e[0].clientY-e[1].clientY;return Math.sqrt(n*n+i*i)}function QW(t){const e=t.touches;return Math.atan2(e[0].clientY-e[1].clientY,e[0].clientX-e[1].clientX)}const tX={};function eX(t,e){const n=tX[e]||(tX[e]=(0,g.EP)(e));return(0,g.kJ)(t)?t.map(n):n(t)}function nX(t){return(0,g.kJ)(t)||ArrayBuffer.isView(t)?t:null}function iX(t){return nX(t)||((0,g.HD)(t)?t:null)}function rX(t,...e){return nX(t).join(...e)}function aX(t,...e){return iX(t).indexOf(...e)}function oX(t,...e){return iX(t).lastIndexOf(...e)}function uX(t,...e){return iX(t).slice(...e)}function sX(t,e,n){if((0,g.mf)(n))(0,g.vU)("Function argument passed to replace.");return String(t).replace(e,n)}function lX(t){return nX(t).slice().reverse()}function fX(t,e,n){return zg(t||0,e||0,n||0)}function cX(t,e){const n=BW(t,(e||this).context);return n&&n.bandwidth?n.bandwidth():0}function hX(t,e){const n=BW(t,(e||this).context);return n?n.copy():undefined}function dX(t,e){const n=BW(t,(e||this).context);return n?n.domain():[]}function pX(t,e,n){const i=BW(t,(n||this).context);return!i?undefined:(0,g.kJ)(e)?(i.invertRange||i.invert)(e):(i.invert||i.invertExtent)(e)}function gX(t,e){const n=BW(t,(e||this).context);return n&&n.range?n.range():[]}function mX(t,e,n){const i=BW(t,(n||this).context);return i?i(e):undefined}function yX(t,e,n,i,r){t=BW(t,(r||this).context);const a=yy(e,n);let o=t.domain(),u=o[0],s=(0,g.fj)(o),l=g.yR;if(!(s-u)){t=(t.interpolator?pm("sequential")().interpolator(t.interpolator()):pm("linear")().interpolate(t.interpolate()).range(t.range())).domain([u=0,s=1])}else{l=Fm(t,u,s)}if(t.ticks){o=t.ticks(+i||15);if(u!==o[0])o.unshift(u);if(s!==(0,g.fj)(o))o.push(s)}o.forEach((e=>a.stop(l(e),t(e))));return a}function vX(t,e,n){const i=BW(t,(n||this).context);return function(t){return i?i.path.context(t)(e):""}}function xX(t){let e=null;return function(n){return n?Oy(n,e=e||wy(t)):t}}const _X=t=>t.data;function bX(t,e){const n=sW.call(e,t);return n.root&&n.root.lookup||{}}function wX(t,e,n){const i=bX(t,this),r=i[e],a=i[n];return r&&a?r.path(a).map(_X):undefined}function kX(t,e){const n=bX(t,this)[e];return n?n.ancestors().map(_X):undefined}const MX=()=>typeof window!=="undefined"&&window||null;function AX(){const t=MX();return t?t.screen:{}}function EX(){const t=MX();return t?[t.innerWidth,t.innerHeight]:[undefined,undefined]}function DX(){const t=this.context.dataflow,e=t.container&&t.container();return e?[e.clientWidth,e.clientHeight]:[undefined,undefined]}function CX(t,e,n){if(!t)return[];const[i,r]=t,a=(new Rv).set(i[0],i[1],r[0],r[1]),o=n||this.context.dataflow.scenegraph().root;return xk(o,a,FX(e))}function FX(t){let e=null;if(t){const n=(0,g.IX)(t.marktype),i=(0,g.IX)(t.markname);e=t=>(!n.length||n.some((e=>t.marktype===e)))&&(!i.length||i.some((e=>t.name===e)))}return e}const SX={random(){return fu()},cumulativeNormal:wu,cumulativeLogNormal:Fu,cumulativeUniform:Ou,densityNormal:bu,densityLogNormal:Cu,densityUniform:zu,quantileNormal:ku,quantileLogNormal:Su,quantileUniform:Ru,sampleNormal:_u,sampleLogNormal:Du,sampleUniform:Nu,isArray:g.kJ,isBoolean:g.jn,isDate:g.J_,isDefined(t){return t!==undefined},isNumber:g.hj,isObject:g.Kn,isRegExp:g.Kj,isString:g.HD,isTuple:Da,isValid(t){return t!=null&&t===t},toBoolean:g.sw,toDate:g.ZU,toNumber:g.He,toString:g.BB,indexof:aX,join:rX,lastindexof:oX,replace:sX,reverse:lX,slice:uX,flush:g.yl,lerp:g.t7,merge:HW,pad:g.vk,peek:g.fj,pluck:eX,span:g.yP,inrange:g.u5,truncate:g.$G,rgb:Rh,lab:rg,hcl:hg,hsl:jh,luminance:WW,contrast:XW,sequence:us,format:dW,utcFormat:gW,utcParse:yW,utcOffset:Tn,utcSequence:zn,timeFormat:pW,timeParse:mW,timeOffset:Sn,timeSequence:Nn,timeUnitSpecifier:tn,monthFormat:_W,monthAbbrevFormat:bW,dayFormat:wW,dayAbbrevFormat:kW,quarter:g.mS,utcquarter:g.N3,week:an,utcweek:cn,dayofyear:rn,utcdayofyear:fn,warn:qW,info:IW,debug:LW,extent:g.We,inScope:$W,intersect:CX,clampRange:g.l$,pinchDistance:ZW,pinchAngle:QW,screen:AX,containerSize:DX,windowSize:EX,bandspace:fX,setdata:fW,pathShape:xX,panLinear:g.Dw,panLog:g.mJ,panPow:g.QA,panSymlog:g.Zw,zoomLinear:g.ay,zoomLog:g.dH,zoomPow:g.mK,zoomSymlog:g.bV,encode:cW,modify:KW};const TX=["view","item","group","xy","x","y"],BX="event.vega.",NX="this.",zX={};const OX={forbidden:["_"],allowed:["datum","event","item"],fieldvar:"datum",globalvar:t=>`_[${(0,g.m8)(DW+t)}]`,functions:UX,constants:zI,visitors:zX};const RX=UI(OX);function UX(t){const e=OI(t);TX.forEach((t=>e[t]=BX+t));for(const n in SX){e[n]=NX+n}(0,g.l7)(e,NW(t,SX,zX));return e}function $X(t,e,n){if(arguments.length===1){return SX[t]}SX[t]=e;if(n)zX[t]=n;if(RX)RX.functions[t]=NX+t;return this}$X("bandwidth",cX,SW);$X("copy",hX,SW);$X("domain",dX,SW);$X("range",gX,SW);$X("invert",pX,SW);$X("scale",mX,SW);$X("gradient",yX,SW);$X("geoArea",OW,SW);$X("geoBounds",RW,SW);$X("geoCentroid",UW,SW);$X("geoShape",vX,SW);$X("indata",lW,FW);$X("data",sW,CW);$X("treePath",wX,CW);$X("treeAncestors",kX,CW);$X("vlSelectionTest",Gj,uW);$X("vlSelectionIdTest",eW,uW);$X("vlSelectionResolve",iW,uW);$X("vlSelectionTuples",nW);function PX(t,e){const n={};let i;try{t=(0,g.HD)(t)?t:(0,g.m8)(t)+"";i=NI(t)}catch(a){(0,g.vU)("Expression parse error: "+t)}i.visit((t=>{if(t.type!==NP)return;const i=t.callee.name,r=OX.visitors[i];if(r)r(i,t.arguments,e,n)}));const r=RX(i);r.globals.forEach((t=>{const i=DW+t;if(!(0,g.nr)(n,i)&&e.getSignal(t)){n[i]=e.signalRef(t)}}));return{$expr:(0,g.l7)({code:r.code},e.options.ast?{ast:i}:null),$fields:r.fields,$params:n}}function qX(t){const e=this,n=t.operators||[];if(t.background){e.background=t.background}if(t.eventConfig){e.eventConfig=t.eventConfig}if(t.locale){e.locale=t.locale}n.forEach((t=>e.parseOperator(t)));n.forEach((t=>e.parseOperatorParameters(t)));(t.streams||[]).forEach((t=>e.parseStream(t)));(t.updates||[]).forEach((t=>e.parseUpdate(t)));return e.resolve()}const IX=(0,g.Rg)(["rule"]),LX=(0,g.Rg)(["group","image","rect"]);function jX(t,e){let n="";if(IX[e])return n;if(t.x2){if(t.x){if(LX[e]){n+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"}n+="o.width=o.x2-o.x;"}else{n+="o.x=o.x2-(o.width||0);"}}if(t.xc){n+="o.x=o.xc-(o.width||0)/2;"}if(t.y2){if(t.y){if(LX[e]){n+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"}n+="o.height=o.y2-o.y;"}else{n+="o.y=o.y2-(o.height||0);"}}if(t.yc){n+="o.y=o.yc-(o.height||0)/2;"}return n}function WX(t){return(t+"").toLowerCase()}function XX(t){return WX(t)==="operator"}function HX(t){return WX(t)==="collect"}function YX(t,e,n){if(n[n.length-1]!==";"){n="return("+n+");"}const i=Function(...e.concat(n));return t&&t.functions?i.bind(t.functions):i}function JX(t,e,n,i){return"((u = ".concat(t,") < (v = ").concat(e,") || u == null) && v != null ? ").concat(n,"\n  : (u > v || v == null) && u != null ? ").concat(i,"\n  : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? ").concat(n,"\n  : v !== v && u === u ? ").concat(i," : ")}var VX={operator:(t,e)=>YX(t,["_"],e.code),parameter:(t,e)=>YX(t,["datum","_"],e.code),event:(t,e)=>YX(t,["event"],e.code),handler:(t,e)=>{const n="var datum=event.item&&event.item.datum;return ".concat(e.code,";");return YX(t,["_","event"],n)},encode:(t,e)=>{const{marktype:n,channels:i}=e;let r="var o=item,datum=o.datum,m=0,$;";for(const a in i){const t="o["+(0,g.m8)(a)+"]";r+="$=".concat(i[a].code,";if(").concat(t,"!==$)").concat(t,"=$,m=1;")}r+=jX(i,n);r+="return m;";return YX(t,["item","_"],r)},codegen:{get(t){const e="[".concat(t.map(g.m8).join("]["),"]");const n=Function("_","return _".concat(e,";"));n.path=e;return n},comparator(t,e){let n;const i=(t,i)=>{const r=e[i];let a,o;if(t.path){a="a".concat(t.path);o="b".concat(t.path)}else{(n=n||{})["f"+i]=t;a="this.f".concat(i,"(a)");o="this.f".concat(i,"(b)")}return JX(a,o,-r,r)};const r=Function("a","b","var u, v; return "+t.map(i).join("")+"0;");return n?r.bind(n):r}}};function GX(t){const e=this;if(XX(t.type)||!t.type){e.operator(t,t.update?e.operatorExpression(t.update):null)}else{e.transform(t,t.type)}}function KX(t){const e=this;if(t.params){const n=e.get(t.id);if(!n)(0,g.vU)("Invalid operator id: "+t.id);e.dataflow.connect(n,n.parameters(e.parseParameters(t.params),t.react,t.initonly))}}function ZX(t,e){e=e||{};const n=this;for(const i in t){const r=t[i];e[i]=(0,g.kJ)(r)?r.map((t=>QX(t,n,e))):QX(r,n,e)}return e}function QX(t,e,n){if(!t||!(0,g.Kn)(t))return t;for(let i=0,r=tH.length,a;i<r;++i){a=tH[i];if((0,g.nr)(t,a.key)){return a.parse(t,e,n)}}return t}var tH=[{key:"$ref",parse:eH},{key:"$key",parse:iH},{key:"$expr",parse:nH},{key:"$field",parse:rH},{key:"$encode",parse:oH},{key:"$compare",parse:aH},{key:"$context",parse:uH},{key:"$subflow",parse:sH},{key:"$tupleid",parse:lH}];function eH(t,e){return e.get(t.$ref)||(0,g.vU)("Operator not defined: "+t.$ref)}function nH(t,e,n){if(t.$params){e.parseParameters(t.$params,n)}const i="e:"+t.$expr.code+"_"+t.$name;return e.fn[i]||(e.fn[i]=(0,g.ZE)(e.parameterExpression(t.$expr),t.$fields,t.$name))}function iH(t,e){const n="k:"+t.$key+"_"+!!t.$flat;return e.fn[n]||(e.fn[n]=(0,g.Jy)(t.$key,t.$flat,e.expr.codegen))}function rH(t,e){if(!t.$field)return null;const n="f:"+t.$field+"_"+t.$name;return e.fn[n]||(e.fn[n]=(0,g.EP)(t.$field,t.$name,e.expr.codegen))}function aH(t,e){const n="c:"+t.$compare+"_"+t.$order,i=(0,g.IX)(t.$compare).map((t=>t&&t.$tupleid?Ca:t));return e.fn[n]||(e.fn[n]=(0,g.qu)(i,t.$order,e.expr.codegen))}function oH(t,e){const n=t.$encode,i={};for(const r in n){const t=n[r];i[r]=(0,g.ZE)(e.encodeExpression(t.$expr),t.$fields);i[r].output=t.$output}return i}function uH(t,e){return e}function sH(t,e){const n=t.$subflow;return function(t,i,r){const a=e.fork().parse(n),o=a.get(n.operators[0].id),u=a.signals.parent;if(u)u.set(r);o.detachSubflow=()=>e.detach(a);return o}}function lH(){return Ca}function fH(t){var e=this,n=t.filter!=null?e.eventExpression(t.filter):undefined,i=t.stream!=null?e.get(t.stream):undefined,r;if(t.source){i=e.events(t.source,t.type,n)}else if(t.merge){r=t.merge.map((t=>e.get(t)));i=r[0].merge.apply(r[0],r.slice(1))}if(t.between){r=t.between.map((t=>e.get(t)));i=i.between(r[0],r[1])}if(t.filter){i=i.filter(n)}if(t.throttle!=null){i=i.throttle(+t.throttle)}if(t.debounce!=null){i=i.debounce(+t.debounce)}if(i==null){(0,g.vU)("Invalid stream definition: "+JSON.stringify(t))}if(t.consume)i.consume(true);e.stream(t,i)}function cH(t){var e=this,n=(0,g.Kn)(n=t.source)?n.$ref:n,i=e.get(n),r=null,a=t.update,o=undefined;if(!i)(0,g.vU)("Source not defined: "+t.source);r=t.target&&t.target.$expr?e.eventExpression(t.target.$expr):e.get(t.target);if(a&&a.$expr){if(a.$params){o=e.parseParameters(a.$params)}a=e.handlerExpression(a.$expr)}e.update(t,i,r,a,o)}const hH={skip:true};function dH(t){var e=this,n={};if(t.signals){var i=n.signals={};Object.keys(e.signals).forEach((n=>{const r=e.signals[n];if(t.signals(n,r)){i[n]=r.value}}))}if(t.data){var r=n.data={};Object.keys(e.data).forEach((n=>{const i=e.data[n];if(t.data(n,i)){r[n]=i.input.value}}))}if(e.subcontext&&t.recurse!==false){n.subcontext=e.subcontext.map((e=>e.getState(t)))}return n}function pH(t){var e=this,n=e.dataflow,i=t.data,r=t.signals;Object.keys(r||{}).forEach((t=>{n.update(e.signals[t],r[t],hH)}));Object.keys(i||{}).forEach((t=>{n.pulse(e.data[t].input,n.changeset().remove(g.yb).insert(i[t]))}));(t.subcontext||[]).forEach(((t,n)=>{const i=e.subcontext[n];if(i)i.setState(t)}))}function gH(t,e,n,i){return new mH(t,e,n,i)}function mH(t,e,n,i){this.dataflow=t;this.transforms=e;this.events=t.events.bind(t);this.expr=i||VX,this.signals={};this.scales={};this.nodes={};this.data={};this.fn={};if(n){this.functions=Object.create(n);this.functions.context=this}}function yH(t){this.dataflow=t.dataflow;this.transforms=t.transforms;this.events=t.events;this.expr=t.expr;this.signals=Object.create(t.signals);this.scales=Object.create(t.scales);this.nodes=Object.create(t.nodes);this.data=Object.create(t.data);this.fn=Object.create(t.fn);if(t.functions){this.functions=Object.create(t.functions);this.functions.context=this}}mH.prototype=yH.prototype={fork(){const t=new yH(this);(this.subcontext||(this.subcontext=[])).push(t);return t},detach(t){this.subcontext=this.subcontext.filter((e=>e!==t));const e=Object.keys(t.nodes);for(const n of e)t.nodes[n]._targets=null;for(const n of e)t.nodes[n].detach();t.nodes=null},get(t){return this.nodes[t]},set(t,e){return this.nodes[t]=e},add(t,e){const n=this,i=n.dataflow,r=t.value;n.set(t.id,e);if(HX(t.type)&&r){if(r.$ingest){i.ingest(e,r.$ingest,r.$format)}else if(r.$request){i.preload(e,r.$request,r.$format)}else{i.pulse(e,i.changeset().insert(r))}}if(t.root){n.root=e}if(t.parent){let r=n.get(t.parent.$ref);if(r){i.connect(r,[e]);e.targets().add(r)}else{(n.unresolved=n.unresolved||[]).push((()=>{r=n.get(t.parent.$ref);i.connect(r,[e]);e.targets().add(r)}))}}if(t.signal){n.signals[t.signal]=e}if(t.scale){n.scales[t.scale]=e}if(t.data){for(const i in t.data){const r=n.data[i]||(n.data[i]={});t.data[i].forEach((t=>r[t]=e))}}},resolve(){(this.unresolved||[]).forEach((t=>t()));delete this.unresolved;return this},operator(t,e){this.add(t,this.dataflow.add(t.value,e))},transform(t,e){this.add(t,this.dataflow.add(this.transforms[WX(e)]))},stream(t,e){this.set(t.id,e)},update(t,e,n,i,r){this.dataflow.on(e,n,i,r,t.options)},operatorExpression(t){return this.expr.operator(this,t)},parameterExpression(t){return this.expr.parameter(this,t)},eventExpression(t){return this.expr.event(this,t)},handlerExpression(t){return this.expr.handler(this,t)},encodeExpression(t){return this.expr.encode(this,t)},parse:qX,parseOperator:GX,parseOperatorParameters:KX,parseParameters:ZX,parseStream:fH,parseUpdate:cH,getState:dH,setState:pH};function vH(t,e,n){var i=new Qz,r=e;if(e==null)return i.restart(t,e,n),i;i._restart=i.restart;i.restart=function(t,e,n){e=+e,n=n==null?Kz():+n;i._restart((function a(o){o+=r;i._restart(a,r+=e,n);t(o)}),e,n)};i.restart(t,e,n);return i}function xH(t){const e=t.container();if(e){e.setAttribute("role","graphics-document");e.setAttribute("aria-roleDescription","visualization");_H(e,t.description())}}function _H(t,e){if(t)e==null?t.removeAttribute("aria-label"):t.setAttribute("aria-label",e)}function bH(t){t.add(null,(e=>{t._background=e.bg;t._resize=1;return e.bg}),{bg:t._signals.background})}const wH="default";function kH(t){const e=t._signals.cursor||(t._signals.cursor=t.add({user:wH,item:null}));t.on(t.events("view","mousemove"),e,((t,n)=>{const i=e.value,r=i?(0,g.HD)(i)?i:i.user:wH,a=n.item&&n.item.cursor||null;return i&&r===i.user&&a==i.item?i:{user:r,item:a}}));t.add(null,(function(e){let n=e.cursor,i=this.value;if(!(0,g.HD)(n)){i=n.item;n=n.user}MH(t,n&&n!==wH?n:i||n);return i}),{cursor:e})}function MH(t,e){const n=t.globalCursor()?typeof document!=="undefined"&&document.body:t.container();if(n){return e==null?n.style.removeProperty("cursor"):n.style.cursor=e}}function AH(t,e){var n=t._runtime.data;if(!(0,g.nr)(n,e)){(0,g.vU)("Unrecognized data set: "+e)}return n[e]}function EH(t,e){return arguments.length<2?AH(this,t).values.value:DH.call(this,t,Ra().remove(g.yb).insert(e))}function DH(t,e){if(!Oa(e)){(0,g.vU)("Second argument to changes must be a changeset.")}const n=AH(this,t);n.modified=true;return this.pulse(n.input,e)}function CH(t,e){return DH.call(this,t,Ra().insert(e))}function FH(t,e){return DH.call(this,t,Ra().remove(e))}function SH(t){var e=t.padding();return Math.max(0,t._viewWidth+e.left+e.right)}function TH(t){var e=t.padding();return Math.max(0,t._viewHeight+e.top+e.bottom)}function BH(t){var e=t.padding(),n=t._origin;return[e.left+n[0],e.top+n[1]]}function NH(t){var e=BH(t),n=SH(t),i=TH(t);t._renderer.background(t.background());t._renderer.resize(n,i,e);t._handler.origin(e);t._resizeListeners.forEach((e=>{try{e(n,i)}catch(r){t.error(r)}}))}function zH(t,e,n){var i=t._renderer,r=i&&i.canvas(),a,o,u;if(r){u=BH(t);o=e.changedTouches?e.changedTouches[0]:e;a=Fb(o,r);a[0]-=u[0];a[1]-=u[1]}e.dataflow=t;e.item=n;e.vega=OH(t,n,a);return e}function OH(t,e,n){const i=e?e.mark.marktype==="group"?e:e.mark.group:null;function r(t){var n=i,r;if(t)for(r=e;r;r=r.mark.group){if(r.mark.name===t){n=r;break}}return n&&n.mark&&n.mark.interactive?n:{}}function a(t){if(!t)return n;if((0,g.HD)(t))t=r(t);const e=n.slice();while(t){e[0]-=t.x||0;e[1]-=t.y||0;t=t.mark&&t.mark.group}return e}return{view:(0,g.a9)(t),item:(0,g.a9)(e||{}),group:r,xy:a,x:t=>a(t)[0],y:t=>a(t)[1]}}const RH="view",UH="timer",$H="window",PH={trap:false};function qH(t){const e=(0,g.l7)({defaults:{}},t);const n=(t,e)=>{e.forEach((e=>{if((0,g.kJ)(t[e]))t[e]=(0,g.Rg)(t[e])}))};n(e.defaults,["prevent","allow"]);n(e,["view","window","selector"]);return e}function IH(t,e,n,i){t._eventListeners.push({type:n,sources:(0,g.IX)(e),handler:i})}function LH(t,e){var n=t._eventConfig.defaults,i=n.prevent,r=n.allow;return i===false||r===true?false:i===true||r===false?true:i?i[e]:r?!r[e]:t.preventDefault()}function jH(t,e,n){const i=t._eventConfig&&t._eventConfig[e];if(i===false||(0,g.Kn)(i)&&!i[n]){t.warn(`Blocked ${e} ${n} event listener.`);return false}return true}function WH(t,e,n){var i=this,r=new Va(n),a=function(n,a){i.runAsync(null,(()=>{if(t===RH&&LH(i,e)){n.preventDefault()}r.receive(zH(i,n,a))}))},o;if(t===UH){if(jH(i,"timer",e)){i.timer(a,e)}}else if(t===RH){if(jH(i,"view",e)){i.addEventListener(e,a,PH)}}else{if(t===$H){if(jH(i,"window",e)&&typeof window!=="undefined"){o=[window]}}else if(typeof document!=="undefined"){if(jH(i,"selector",e)){o=document.querySelectorAll(t)}}if(!o){i.warn("Can not resolve event source: "+t)}else{for(var u=0,s=o.length;u<s;++u){o[u].addEventListener(e,a)}IH(i,o,e,a)}}return r}function XH(t){return t.item}function HH(t){return t.item.mark.source}function YH(t){return function(e,n){return n.vega.view().changeset().encode(n.item,t)}}function JH(t,e){t=[t||"hover"];e=[e||"update",t[0]];this.on(this.events("view","mouseover",XH),HH,YH(t));this.on(this.events("view","mouseout",XH),HH,YH(e));return this}function VH(){var t=this._tooltip,e=this._timers,n=this._eventListeners,i,r,a;i=e.length;while(--i>=0){e[i].stop()}i=n.length;while(--i>=0){a=n[i];r=a.sources.length;while(--r>=0){a.sources[r].removeEventListener(a.type,a.handler)}}if(t){t.call(this,this._handler,null,null,null)}return this}function GH(t,e,n){const i=document.createElement(t);for(const r in e)i.setAttribute(r,e[r]);if(n!=null)i.textContent=n;return i}const KH="vega-bind",ZH="vega-bind-name",QH="vega-bind-radio";function tY(t,e,n){if(!e)return;const i=n.param;let r=n.state;if(!r){r=n.state={elements:null,active:false,set:null,update:e=>{if(e!=t.signal(i.signal)){t.runAsync(null,(()=>{r.source=true;t.signal(i.signal,e)}))}}};if(i.debounce){r.update=(0,g.Ds)(i.debounce,r.update)}}const a=i.input==null&&i.element?eY:iY;a(r,e,i,t);if(!r.active){t.on(t._signals[i.signal],null,(()=>{r.source?r.source=false:r.set(t.signal(i.signal))}));r.active=true}return r}function eY(t,e,n,i){const r=n.event||"input";const a=()=>t.update(e.value);i.signal(n.signal,e.value);e.addEventListener(r,a);IH(i,e,r,a);t.set=t=>{e.value=t;e.dispatchEvent(nY(r))}}function nY(t){return typeof Event!=="undefined"?new Event(t):{type:t}}function iY(t,e,n,i){const r=i.signal(n.signal);const a=GH("div",{class:KH});const o=n.input==="radio"?a:a.appendChild(GH("label"));o.appendChild(GH("span",{class:ZH},n.name||n.signal));e.appendChild(a);let u=rY;switch(n.input){case"checkbox":u=aY;break;case"select":u=oY;break;case"radio":u=uY;break;case"range":u=sY;break}u(t,o,n,r)}function rY(t,e,n,i){const r=GH("input");for(const a in n){if(a!=="signal"&&a!=="element"){r.setAttribute(a==="input"?"type":a,n[a])}}r.setAttribute("name",n.signal);r.value=i;e.appendChild(r);r.addEventListener("input",(()=>t.update(r.value)));t.elements=[r];t.set=t=>r.value=t}function aY(t,e,n,i){const r={type:"checkbox",name:n.signal};if(i)r.checked=true;const a=GH("input",r);e.appendChild(a);a.addEventListener("change",(()=>t.update(a.checked)));t.elements=[a];t.set=t=>a.checked=!!t||null}function oY(t,e,n,i){const r=GH("select",{name:n.signal}),a=n.labels||[];n.options.forEach(((t,e)=>{const n={value:t};if(lY(t,i))n.selected=true;r.appendChild(GH("option",n,(a[e]||t)+""))}));e.appendChild(r);r.addEventListener("change",(()=>{t.update(n.options[r.selectedIndex])}));t.elements=[r];t.set=t=>{for(let e=0,i=n.options.length;e<i;++e){if(lY(n.options[e],t)){r.selectedIndex=e;return}}}}function uY(t,e,n,i){const r=GH("span",{class:QH}),a=n.labels||[];e.appendChild(r);t.elements=n.options.map(((e,o)=>{const u={type:"radio",name:n.signal,value:e};if(lY(e,i))u.checked=true;const s=GH("input",u);s.addEventListener("change",(()=>t.update(e)));const l=GH("label",{},(a[o]||e)+"");l.prepend(s);r.appendChild(l);return s}));t.set=e=>{const n=t.elements,i=n.length;for(let t=0;t<i;++t){if(lY(n[t].value,e))n[t].checked=true}}}function sY(t,e,n,i){i=i!==undefined?i:(+n.max+ +n.min)/2;const r=n.max!=null?n.max:Math.max(100,+i)||100,a=n.min||Math.min(0,r,+i)||0,o=n.step||j(a,r,100);const u=GH("input",{type:"range",name:n.signal,min:a,max:r,step:o});u.value=i;const s=GH("span",{},+i);e.appendChild(u);e.appendChild(s);const l=()=>{s.textContent=u.value;t.update(+u.value)};u.addEventListener("input",l);u.addEventListener("change",l);t.elements=[u];t.set=t=>{u.value=t;s.textContent=t}}function lY(t,e){return t===e||t+""===e+""}function fY(t,e,n,i,r,a){e=e||new i(t.loader());return e.initialize(n,SH(t),TH(t),BH(t),r,a).background(t.background())}function cY(t,e){return!e?null:function(){try{e.apply(this,arguments)}catch(n){t.error(n)}}}function hY(t,e,n,i){const r=new i(t.loader(),cY(t,t.tooltip())).scene(t.scenegraph().root).initialize(n,BH(t),t);if(e){e.handlers().forEach((t=>{r.on(t.type,t.handler)}))}return r}function dY(t,e){const n=this,i=n._renderType,r=n._eventConfig.bind,a=vk(i);t=n._el=t?pY(n,t,true):null;xH(n);if(!a)n.error("Unrecognized renderer type: "+i);const o=a.handler||nw,u=t?a.renderer:a.headless;n._renderer=!u?null:fY(n,n._renderer,t,u);n._handler=hY(n,n._handler,t,o);n._redraw=true;if(t&&r!=="none"){e=e?n._elBind=pY(n,e,true):t.appendChild(GH("form",{class:"vega-bindings"}));n._bind.forEach((t=>{if(t.param.element&&r!=="container"){t.element=pY(n,t.param.element,!!t.param.input)}}));n._bind.forEach((t=>{tY(n,t.element||e,t)}))}return n}function pY(t,e,n){if(typeof e==="string"){if(typeof document!=="undefined"){e=document.querySelector(e);if(!e){t.error("Signal bind element not found: "+e);return null}}else{t.error("DOM document instance not found.");return null}}if(e&&n){try{e.innerHTML=""}catch(i){e=null;t.error(i)}}return e}const gY=t=>+t||0;const mY=t=>({top:t,bottom:t,left:t,right:t});function yY(t){return(0,g.Kn)(t)?{top:gY(t.top),bottom:gY(t.bottom),left:gY(t.left),right:gY(t.right)}:mY(gY(t))}async function vY(t,e,n,i){const r=vk(e),a=r&&r.headless;if(!a)(0,g.vU)("Unrecognized renderer type: "+e);await t.runAsync();return fY(t,null,null,a,n,i).renderAsync(t._scenegraph.root)}async function xY(t,e){if(t!==mk.Canvas&&t!==mk.SVG&&t!==mk.PNG){(0,g.vU)("Unrecognized image type: "+t)}const n=await vY(this,t,e);return t===mk.SVG?_Y(n.svg(),"image/svg+xml"):n.canvas().toDataURL("image/png")}function _Y(t,e){const n=new Blob([t],{type:e});return window.URL.createObjectURL(n)}async function bY(t,e){const n=await vY(this,mk.Canvas,t,e);return n.canvas()}async function wY(t){const e=await vY(this,mk.SVG,t);return e.svg()}function kY(t,e,n){return gH(t,Xo,SX,n).parse(e)}function MY(t){var e=this._runtime.scales;if(!(0,g.nr)(e,t)){(0,g.vU)("Unrecognized scale or projection: "+t)}return e[t].value}var AY="width",EY="height",DY="padding",CY={skip:true};function FY(t,e){var n=t.autosize(),i=t.padding();return e-(n&&n.contains===DY?i.left+i.right:0)}function SY(t,e){var n=t.autosize(),i=t.padding();return e-(n&&n.contains===DY?i.top+i.bottom:0)}function TY(t){var e=t._signals,n=e[AY],i=e[EY],r=e[DY];function a(){t._autosize=t._resize=1}t._resizeWidth=t.add(null,(e=>{t._width=e.size;t._viewWidth=FY(t,e.size);a()}),{size:n});t._resizeHeight=t.add(null,(e=>{t._height=e.size;t._viewHeight=SY(t,e.size);a()}),{size:i});const o=t.add(null,a,{pad:r});t._resizeWidth.rank=n.rank+1;t._resizeHeight.rank=i.rank+1;o.rank=r.rank+1}function BY(t,e,n,i,r,a){this.runAfter((o=>{let u=0;o._autosize=0;if(o.width()!==n){u=1;o.signal(AY,n,CY);o._resizeWidth.skip(true)}if(o.height()!==i){u=1;o.signal(EY,i,CY);o._resizeHeight.skip(true)}if(o._viewWidth!==t){o._resize=1;o._viewWidth=t}if(o._viewHeight!==e){o._resize=1;o._viewHeight=e}if(o._origin[0]!==r[0]||o._origin[1]!==r[1]){o._resize=1;o._origin=r}if(u)o.run("enter");if(a)o.runAfter((t=>t.resize()))}),false,1)}function NY(t){return this._runtime.getState(t||{data:zY,signals:OY,recurse:true})}function zY(t,e){return e.modified&&(0,g.kJ)(e.input.value)&&t.indexOf("_:vega:_")}function OY(t,e){return!(t==="parent"||e instanceof Xo.proxy)}function RY(t){this.runAsync(null,(e=>{e._trigger=false;e._runtime.setState(t)}),(t=>{t._trigger=true}));return this}function UY(t,e){function n(e){t({timestamp:Date.now(),elapsed:e})}this._timers.push(vH(n,e))}function $Y(t,e,n,i){const r=t.element();if(r)r.setAttribute("title",PY(i))}function PY(t){return t==null?"":(0,g.kJ)(t)?IY(t):(0,g.Kn)(t)&&!(0,g.J_)(t)?qY(t):t+""}function qY(t){return Object.keys(t).map((e=>{const n=t[e];return e+": "+((0,g.kJ)(n)?IY(n):LY(n))})).join("\n")}function IY(t){return"["+t.map(LY).join(", ")+"]"}function LY(t){return(0,g.kJ)(t)?"[…]":(0,g.Kn)(t)&&!(0,g.J_)(t)?"{…}":t}function jY(t,e){const n=this;e=e||{};Lo.call(n);if(e.loader)n.loader(e.loader);if(e.logger)n.logger(e.logger);if(e.logLevel!=null)n.logLevel(e.logLevel);if(e.locale||t.locale){const i=(0,g.l7)({},t.locale,e.locale);n.locale(qr(i.number,i.time))}n._el=null;n._elBind=null;n._renderType=e.renderer||mk.Canvas;n._scenegraph=new wb;const i=n._scenegraph.root;n._renderer=null;n._tooltip=e.tooltip||$Y,n._redraw=true;n._handler=(new nw).scene(i);n._globalCursor=false;n._preventDefault=false;n._timers=[];n._eventListeners=[];n._resizeListeners=[];n._eventConfig=qH(t.eventConfig);n.globalCursor(n._eventConfig.globalCursor);const r=kY(n,t,e.expr);n._runtime=r;n._signals=r.signals;n._bind=(t.bindings||[]).map((t=>({state:null,param:(0,g.l7)({},t)})));if(r.root)r.root.set(i);i.source=r.data.root.input;n.pulse(r.data.root.input,n.changeset().insert(i.items));n._width=n.width();n._height=n.height();n._viewWidth=FY(n,n._width);n._viewHeight=SY(n,n._height);n._origin=[0,0];n._resize=0;n._autosize=1;TY(n);bH(n);kH(n);n.description(t.description);if(e.hover)n.hover();if(e.container)n.initialize(e.container,e.bind)}function WY(t,e){return(0,g.nr)(t._signals,e)?t._signals[e]:(0,g.vU)("Unrecognized signal name: "+(0,g.m8)(e))}function XY(t,e){const n=(t._targets||[]).filter((t=>t._update&&t._update.handler===e));return n.length?n[0]:null}function HY(t,e,n,i){let r=XY(n,i);if(!r){r=cY(t,(()=>i(e,n.value)));r.handler=i;t.on(n,null,r)}return t}function YY(t,e,n){const i=XY(e,n);if(i)e._targets.remove(i);return t}(0,g.XW)(jY,Lo,{async evaluate(t,e,n){await Lo.prototype.evaluate.call(this,t,e);if(this._redraw||this._resize){try{if(this._renderer){if(this._resize){this._resize=0;NH(this)}await this._renderer.renderAsync(this._scenegraph.root)}this._redraw=false}catch(i){this.error(i)}}if(n)Ma(this,n);return this},dirty(t){this._redraw=true;this._renderer&&this._renderer.dirty(t)},description(t){if(arguments.length){const e=t!=null?t+"":null;if(e!==this._desc)_H(this._el,this._desc=e);return this}return this._desc},container(){return this._el},scenegraph(){return this._scenegraph},origin(){return this._origin.slice()},signal(t,e,n){const i=WY(this,t);return arguments.length===1?i.value:this.update(i,e,n)},width(t){return arguments.length?this.signal("width",t):this.signal("width")},height(t){return arguments.length?this.signal("height",t):this.signal("height")},padding(t){return arguments.length?this.signal("padding",yY(t)):yY(this.signal("padding"))},autosize(t){return arguments.length?this.signal("autosize",t):this.signal("autosize")},background(t){return arguments.length?this.signal("background",t):this.signal("background")},renderer(t){if(!arguments.length)return this._renderType;if(!vk(t))(0,g.vU)("Unrecognized renderer type: "+t);if(t!==this._renderType){this._renderType=t;this._resetRenderer()}return this},tooltip(t){if(!arguments.length)return this._tooltip;if(t!==this._tooltip){this._tooltip=t;this._resetRenderer()}return this},loader(t){if(!arguments.length)return this._loader;if(t!==this._loader){Lo.prototype.loader.call(this,t);this._resetRenderer()}return this},resize(){this._autosize=1;return this.touch(WY(this,"autosize"))},_resetRenderer(){if(this._renderer){this._renderer=null;this.initialize(this._el,this._elBind)}},_resizeView:BY,addEventListener(t,e,n){let i=e;if(!(n&&n.trap===false)){i=cY(this,e);i.raw=e}this._handler.on(t,i);return this},removeEventListener(t,e){var n=this._handler.handlers(t),i=n.length,r,a;while(--i>=0){a=n[i].type;r=n[i].handler;if(t===a&&(e===r||e===r.raw)){this._handler.off(a,r);break}}return this},addResizeListener(t){const e=this._resizeListeners;if(e.indexOf(t)<0){e.push(t)}return this},removeResizeListener(t){var e=this._resizeListeners,n=e.indexOf(t);if(n>=0){e.splice(n,1)}return this},addSignalListener(t,e){return HY(this,t,WY(this,t),e)},removeSignalListener(t,e){return YY(this,WY(this,t),e)},addDataListener(t,e){return HY(this,t,AH(this,t).values,e)},removeDataListener(t,e){return YY(this,AH(this,t).values,e)},globalCursor(t){if(arguments.length){if(this._globalCursor!==!!t){const e=MH(this,null);this._globalCursor=!!t;if(e)MH(this,e)}return this}else{return this._globalCursor}},preventDefault(t){if(arguments.length){this._preventDefault=t;return this}else{return this._preventDefault}},timer:UY,events:WH,finalize:VH,hover:JH,data:EH,change:DH,insert:CH,remove:FH,scale:MY,initialize:dY,toImageURL:xY,toCanvas:bY,toSVG:wY,getState:NY,setState:RY});const JY="view",VY="[",GY="]",KY="{",ZY="}",QY=":",tJ=",",eJ="@",nJ=">",iJ=/[[\]{}]/,rJ={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let aJ,oJ;function uJ(t,e,n){aJ=e||JY;oJ=n||rJ;return fJ(t.trim()).map(cJ)}function sJ(t){return oJ[t]}function lJ(t,e,n,i,r){const a=t.length;let o=0,u;for(;e<a;++e){u=t[e];if(!o&&u===n)return e;else if(r&&r.indexOf(u)>=0)--o;else if(i&&i.indexOf(u)>=0)++o}return e}function fJ(t){const e=[],n=t.length;let i=0,r=0;while(r<n){r=lJ(t,r,tJ,VY+KY,GY+ZY);e.push(t.substring(i,r).trim());i=++r}if(e.length===0){throw"Empty event selector: "+t}return e}function cJ(t){return t[0]==="["?hJ(t):dJ(t)}function hJ(t){const e=t.length;let n=1,i;n=lJ(t,n,GY,VY,GY);if(n===e){throw"Empty between selector: "+t}i=fJ(t.substring(1,n));if(i.length!==2){throw"Between selector must have two elements: "+t}t=t.slice(n+1).trim();if(t[0]!==nJ){throw"Expected '>' after between selector: "+t}i=i.map(cJ);const r=cJ(t.slice(1).trim());if(r.between){return{between:i,stream:r}}else{r.between=i}return r}function dJ(t){const e={source:aJ},n=[];let i=[0,0],r=0,a=0,o=t.length,u=0,s,l;if(t[o-1]===ZY){u=t.lastIndexOf(KY);if(u>=0){try{i=pJ(t.substring(u+1,o-1))}catch(f){throw"Invalid throttle specification: "+t}t=t.slice(0,u).trim();o=t.length}else throw"Unmatched right brace: "+t;u=0}if(!o)throw t;if(t[0]===eJ)r=++u;s=lJ(t,u,QY);if(s<o){n.push(t.substring(a,s).trim());a=u=++s}u=lJ(t,u,VY);if(u===o){n.push(t.substring(a,o).trim())}else{n.push(t.substring(a,u).trim());l=[];a=++u;if(a===o)throw"Unmatched left bracket: "+t}while(u<o){u=lJ(t,u,GY);if(u===o)throw"Unmatched left bracket: "+t;l.push(t.substring(a,u).trim());if(u<o-1&&t[++u]!==VY)throw"Expected left bracket: "+t;a=++u}if(!(o=n.length)||iJ.test(n[o-1])){throw"Invalid event selector: "+t}if(o>1){e.type=n[1];if(r){e.markname=n[0].slice(1)}else if(sJ(n[0])){e.marktype=n[0]}else{e.source=n[0]}}else{e.type=n[0]}if(e.type.slice(-1)==="!"){e.consume=true;e.type=e.type.slice(0,-1)}if(l!=null)e.filter=l;if(i[0])e.throttle=i[0];if(i[1])e.debounce=i[1];return e}function pJ(t){const e=t.split(tJ);if(!t.length||e.length>2)throw t;return e.map((e=>{const n=+e;if(n!==n)throw t;return n}))}function gJ(t){return(0,g.Kn)(t)?t:{type:t||"pad"}}const mJ=t=>+t||0;const yJ=t=>({top:t,bottom:t,left:t,right:t});function vJ(t){return!(0,g.Kn)(t)?yJ(mJ(t)):t.signal?t:{top:mJ(t.top),bottom:mJ(t.bottom),left:mJ(t.left),right:mJ(t.right)}}const xJ=t=>(0,g.Kn)(t)&&!(0,g.kJ)(t)?(0,g.l7)({},t):{value:t};function _J(t,e,n,i){if(n!=null){const r=(0,g.Kn)(n)&&!(0,g.kJ)(n)||(0,g.kJ)(n)&&n.length&&(0,g.Kn)(n[0]);if(r){t.update[e]=n}else{t[i||"enter"][e]={value:n}}return 1}else{return 0}}function bJ(t,e,n){for(const i in e){_J(t,i,e[i])}for(const i in n){_J(t,i,n[i],"update")}}function wJ(t,e,n){for(const i in e){if(n&&(0,g.nr)(n,i))continue;t[i]=(0,g.l7)(t[i]||{},e[i])}return t}function kJ(t,e){return e&&(e.enter&&e.enter[t]||e.update&&e.update[t])}const MJ="mark";const AJ="frame";const EJ="scope";const DJ="axis";const CJ="axis-domain";const FJ="axis-grid";const SJ="axis-label";const TJ="axis-tick";const BJ="axis-title";const NJ="legend";const zJ="legend-band";const OJ="legend-entry";const RJ="legend-gradient";const UJ="legend-label";const $J="legend-symbol";const PJ="legend-title";const qJ="title";const IJ="title-text";const LJ="title-subtitle";function jJ(t,e,n,i,r){const a={},o={};let u,s,l,f;s="lineBreak";if(e==="text"&&r[s]!=null&&!kJ(s,t)){WJ(a,s,r[s])}if(n=="legend"||String(n).startsWith("axis")){n=null}f=n===AJ?r.group:n===MJ?(0,g.l7)({},r.mark,r[e]):null;for(s in f){l=kJ(s,t)||(s==="fill"||s==="stroke")&&(kJ("fill",t)||kJ("stroke",t));if(!l)WJ(a,s,f[s])}(0,g.IX)(i).forEach((e=>{const n=r.style&&r.style[e];for(const i in n){if(!kJ(i,t)){WJ(a,i,n[i])}}}));t=(0,g.l7)({},t);for(s in a){f=a[s];if(f.signal){(u=u||{})[s]=f}else{o[s]=f}}t.enter=(0,g.l7)(o,t.enter);if(u)t.update=(0,g.l7)(u,t.update);return t}function WJ(t,e,n){t[e]=n&&n.signal?{signal:n.signal}:{value:n}}const XJ=t=>(0,g.HD)(t)?(0,g.m8)(t):t.signal?`(${t.signal})`:KJ(t);function HJ(t){if(t.gradient!=null){return VJ(t)}let e=t.signal?`(${t.signal})`:t.color?JJ(t.color):t.field!=null?KJ(t.field):t.value!==undefined?(0,g.m8)(t.value):undefined;if(t.scale!=null){e=QJ(t,e)}if(e===undefined){e=null}if(t.exponent!=null){e=`pow(${e},${GJ(t.exponent)})`}if(t.mult!=null){e+=`*${GJ(t.mult)}`}if(t.offset!=null){e+=`+${GJ(t.offset)}`}if(t.round){e=`round(${e})`}return e}const YJ=(t,e,n,i)=>`(${t}(${[e,n,i].map(HJ).join(",")})+'')`;function JJ(t){return t.c?YJ("hcl",t.h,t.c,t.l):t.h||t.s?YJ("hsl",t.h,t.s,t.l):t.l||t.a?YJ("lab",t.l,t.a,t.b):t.r||t.g||t.b?YJ("rgb",t.r,t.g,t.b):null}function VJ(t){const e=[t.start,t.stop,t.count].map((t=>t==null?null:(0,g.m8)(t)));while(e.length&&(0,g.fj)(e)==null)e.pop();e.unshift(XJ(t.gradient));return`gradient(${e.join(",")})`}function GJ(t){return(0,g.Kn)(t)?"("+HJ(t)+")":t}function KJ(t){return ZJ((0,g.Kn)(t)?t:{datum:t})}function ZJ(t){let e,n,i;if(t.signal){e="datum";i=t.signal}else if(t.group||t.parent){n=Math.max(1,t.level||1);e="item";while(n-- >0){e+=".mark.group"}if(t.parent){i=t.parent;e+=".datum"}else{i=t.group}}else if(t.datum){e="datum";i=t.datum}else{(0,g.vU)("Invalid field reference: "+(0,g.m8)(t))}if(!t.signal){i=(0,g.HD)(i)?(0,g._k)(i).map(g.m8).join("]["):ZJ(i)}return e+"["+i+"]"}function QJ(t,e){const n=XJ(t.scale);if(t.range!=null){e=`lerp(_range(${n}), ${+t.range})`}else{if(e!==undefined)e=`_scale(${n}, ${e})`;if(t.band){e=(e?e+"+":"")+`_bandwidth(${n})`+(+t.band===1?"":"*"+GJ(t.band));if(t.extra){e=`(datum.extra ? _scale(${n}, datum.extra.value) : ${e})`}}if(e==null)e="0"}return e}function tV(t){let e="";t.forEach((t=>{const n=HJ(t);e+=t.test?`(${t.test})?${n}:`:n}));if((0,g.fj)(e)===":"){e+="null"}return e}function eV(t,e,n,i,r,a){const o={};a=a||{};a.encoders={$encode:o};t=jJ(t,e,n,i,r.config);for(const u in t){o[u]=nV(t[u],e,a,r)}return a}function nV(t,e,n,i){const r={},a={};for(const o in t){if(t[o]!=null){r[o]=rV(iV(t[o]),i,n,a)}}return{$expr:{marktype:e,channels:r},$fields:Object.keys(a),$output:Object.keys(t)}}function iV(t){return(0,g.kJ)(t)?tV(t):HJ(t)}function rV(t,e,n,i){const r=PX(t,e);r.$fields.forEach((t=>i[t]=1));(0,g.l7)(n,r.$params);return r.$expr}const aV="outer",oV=["value","update","init","react","bind"];function uV(t,e){(0,g.vU)(t+' for "outer" push: '+(0,g.m8)(e))}function sV(t,e){const n=t.name;if(t.push===aV){if(!e.signals[n])uV("No prior signal definition",n);oV.forEach((e=>{if(t[e]!==undefined)uV("Invalid property ",e)}))}else{const i=e.addSignal(n,t.value);if(t.react===false)i.react=false;if(t.bind)e.addBinding(n,t.bind)}}function lV(t,e,n,i){this.id=-1;this.type=t;this.value=e;this.params=n;if(i)this.parent=i}function fV(t,e,n,i){return new lV(t,e,n,i)}function cV(t,e){return fV("operator",t,e)}function hV(t){const e={$ref:t.id};if(t.id<0)(t.refs=t.refs||[]).push(e);return e}function dV(t,e){return e?{$field:t,$name:e}:{$field:t}}const pV=dV("key");function gV(t,e){return{$compare:t,$order:e}}function mV(t,e){const n={$key:t};if(e)n.$flat=true;return n}const yV="ascending";const vV="descending";function xV(t){return!(0,g.Kn)(t)?"":(t.order===vV?"-":"+")+_V(t.op,t.field)}function _V(t,e){return(t&&t.signal?"$"+t.signal:t||"")+(t&&e?"_":"")+(e&&e.signal?"$"+e.signal:e||"")}const bV="scope";const wV="view";function kV(t){return t&&t.signal}function MV(t){return t&&t.expr}function AV(t){if(kV(t))return true;if((0,g.Kn)(t))for(const e in t){if(AV(t[e]))return true}return false}function EV(t,e){return t!=null?t:e}function DV(t){return t&&t.signal||t}const CV="timer";function FV(t,e){const n=t.merge?TV:t.stream?BV:t.type?NV:(0,g.vU)("Invalid stream specification: "+(0,g.m8)(t));return n(t,e)}function SV(t){return t===bV?wV:t||wV}function TV(t,e){const n=t.merge.map((t=>FV(t,e))),i=zV({merge:n},t,e);return e.addStream(i).id}function BV(t,e){const n=FV(t.stream,e),i=zV({stream:n},t,e);return e.addStream(i).id}function NV(t,e){let n;if(t.type===CV){n=e.event(CV,t.throttle);t={between:t.between,filter:t.filter}}else{n=e.event(SV(t.source),t.type)}const i=zV({stream:n},t,e);return Object.keys(i).length===1?n:e.addStream(i).id}function zV(t,e,n){let i=e.between;if(i){if(i.length!==2){(0,g.vU)('Stream "between" parameter must have 2 entries: '+(0,g.m8)(e))}t.between=[FV(i[0],n),FV(i[1],n)]}i=e.filter?[].concat(e.filter):[];if(e.marktype||e.markname||e.markrole){i.push(OV(e.marktype,e.markname,e.markrole))}if(e.source===bV){i.push("inScope(event.item)")}if(i.length){t.filter=PX("("+i.join(")&&(")+")",n).$expr}if((i=e.throttle)!=null){t.throttle=+i}if((i=e.debounce)!=null){t.debounce=+i}if(e.consume){t.consume=true}return t}function OV(t,e,n){const i="event.item";return i+(t&&t!=="*"?"&&"+i+".mark.marktype==='"+t+"'":"")+(n?"&&"+i+".mark.role==='"+n+"'":"")+(e?"&&"+i+".mark.name==='"+e+"'":"")}const RV={code:"_.$value",ast:{type:"Identifier",value:"value"}};function UV(t,e,n){const i=t.encode,r={target:n};let a=t.events,o=t.update,u=[];if(!a){(0,g.vU)("Signal update missing events specification.")}if((0,g.HD)(a)){a=uJ(a,e.isSubscope()?bV:wV)}a=(0,g.IX)(a).filter((t=>t.signal||t.scale?(u.push(t),0):1));if(u.length>1){u=[PV(u)]}if(a.length){u.push(a.length>1?{merge:a}:a[0])}if(i!=null){if(o)(0,g.vU)("Signal encode and update are mutually exclusive.");o="encode(item(),"+(0,g.m8)(i)+")"}r.update=(0,g.HD)(o)?PX(o,e):o.expr!=null?PX(o.expr,e):o.value!=null?o.value:o.signal!=null?{$expr:RV,$params:{$value:e.signalRef(o.signal)}}:(0,g.vU)("Invalid signal update specification.");if(t.force){r.options={force:true}}u.forEach((t=>e.addUpdate((0,g.l7)($V(t,e),r))))}function $V(t,e){return{source:t.signal?e.signalRef(t.signal):t.scale?e.scaleRef(t.scale):FV(t,e)}}function PV(t){return{signal:"["+t.map((t=>t.scale?'scale("'+t.scale+'")':t.signal))+"]"}}function qV(t,e){const n=e.getSignal(t.name);let i=t.update;if(t.init){if(i){(0,g.vU)("Signals can not include both init and update expressions.")}else{i=t.init;n.initonly=true}}if(i){i=PX(i,e);n.update=i.$expr;n.params=i.$params}if(t.on){t.on.forEach((t=>UV(t,e,n.id)))}}const IV=t=>(e,n,i)=>fV(t,n,e||undefined,i);const LV=IV("aggregate");const jV=IV("axisticks");const WV=IV("bound");const XV=IV("collect");const HV=IV("compare");const YV=IV("datajoin");const JV=IV("encode");const VV=IV("expression");const GV=IV("facet");const KV=IV("field");const ZV=IV("key");const QV=IV("legendentries");const tG=IV("load");const eG=IV("mark");const nG=IV("multiextent");const iG=IV("multivalues");const rG=IV("overlap");const aG=IV("params");const oG=IV("prefacet");const uG=IV("projection");const sG=IV("proxy");const lG=IV("relay");const fG=IV("render");const cG=IV("scale");const hG=IV("sieve");const dG=IV("sortitems");const pG=IV("viewlayout");const gG=IV("values");let mG=0;const yG={min:"min",max:"max",count:"sum"};function vG(t,e){const n=t.type||"linear";if(!gm(n)){(0,g.vU)("Unrecognized scale type: "+(0,g.m8)(n))}e.addScale(t.name,{type:n,domain:undefined})}function xG(t,e){const n=e.getScale(t.name).params;let i;n.domain=kG(t.domain,t,e);if(t.range!=null){n.range=OG(t,e,n)}if(t.interpolate!=null){zG(t.interpolate,n)}if(t.nice!=null){n.nice=NG(t.nice)}if(t.bins!=null){n.bins=BG(t.bins,e)}for(i in t){if((0,g.nr)(n,i)||i==="name")continue;n[i]=_G(t[i],e)}}function _G(t,e){return!(0,g.Kn)(t)?t:t.signal?e.signalRef(t.signal):(0,g.vU)("Unsupported object: "+(0,g.m8)(t))}function bG(t,e){return t.signal?e.signalRef(t.signal):t.map((t=>_G(t,e)))}function wG(t){(0,g.vU)("Can not find data set: "+(0,g.m8)(t))}function kG(t,e,n){if(!t){if(e.domainMin!=null||e.domainMax!=null){(0,g.vU)("No scale domain defined for domainMin/domainMax to override.")}return}return t.signal?n.signalRef(t.signal):((0,g.kJ)(t)?MG:t.fields?EG:AG)(t,e,n)}function MG(t,e,n){return t.map((t=>_G(t,n)))}function AG(t,e,n){const i=n.getData(t.data);if(!i)wG(t.data);return vm(e.type)?i.valuesRef(n,t.field,FG(t.sort,false)):km(e.type)?i.domainRef(n,t.field):i.extentRef(n,t.field)}function EG(t,e,n){const i=t.data,r=t.fields.reduce(((t,e)=>{e=(0,g.HD)(e)?{data:i,field:e}:(0,g.kJ)(e)||e.signal?DG(e,n):e;t.push(e);return t}),[]);return(vm(e.type)?CG:km(e.type)?SG:TG)(t,n,r)}function DG(t,e){const n="_:vega:_"+mG++,i=XV({});if((0,g.kJ)(t)){i.value={$ingest:t}}else if(t.signal){const r="setdata("+(0,g.m8)(n)+","+t.signal+")";i.params.input=e.signalRef(r)}e.addDataPipeline(n,[i,hG({})]);return{data:n,field:"data"}}function CG(t,e,n){const i=FG(t.sort,true);let r,a;const o=n.map((t=>{const n=e.getData(t.data);if(!n)wG(t.data);return n.countsRef(e,t.field,i)}));const u={groupby:pV,pulse:o};if(i){r=i.op||"count";a=i.field?_V(r,i.field):"count";u.ops=[yG[r]];u.fields=[e.fieldRef(a)];u.as=[a]}r=e.add(LV(u));const s=e.add(XV({pulse:hV(r)}));a=e.add(gG({field:pV,sort:e.sortRef(i),pulse:hV(s)}));return hV(a)}function FG(t,e){if(t){if(!t.field&&!t.op){if((0,g.Kn)(t))t.field="key";else t={field:"key"}}else if(!t.field&&t.op!=="count"){(0,g.vU)("No field provided for sort aggregate op: "+t.op)}else if(e&&t.field){if(t.op&&!yG[t.op]){(0,g.vU)("Multiple domain scales can not be sorted using "+t.op)}}}return t}function SG(t,e,n){const i=n.map((t=>{const n=e.getData(t.data);if(!n)wG(t.data);return n.domainRef(e,t.field)}));return hV(e.add(iG({values:i})))}function TG(t,e,n){const i=n.map((t=>{const n=e.getData(t.data);if(!n)wG(t.data);return n.extentRef(e,t.field)}));return hV(e.add(nG({extents:i})))}function BG(t,e){return t.signal||(0,g.kJ)(t)?bG(t,e):e.objectProperty(t)}function NG(t){return(0,g.Kn)(t)?{interval:_G(t.interval),step:_G(t.step)}:_G(t)}function zG(t,e){e.interpolate=_G(t.type||t);if(t.gamma!=null){e.interpolateGamma=_G(t.gamma)}}function OG(t,e,n){const i=e.config.range;let r=t.range;if(r.signal){return e.signalRef(r.signal)}else if((0,g.HD)(r)){if(i&&(0,g.nr)(i,r)){t=(0,g.l7)({},t,{range:i[r]});return OG(t,e,n)}else if(r==="width"){r=[0,{signal:"width"}]}else if(r==="height"){r=vm(t.type)?[0,{signal:"height"}]:[{signal:"height"},0]}else{(0,g.vU)("Unrecognized scale range value: "+(0,g.m8)(r))}}else if(r.scheme){n.scheme=(0,g.kJ)(r.scheme)?bG(r.scheme,e):_G(r.scheme,e);if(r.extent)n.schemeExtent=bG(r.extent,e);if(r.count)n.schemeCount=_G(r.count,e);return}else if(r.step){n.rangeStep=_G(r.step,e);return}else if(vm(t.type)&&!(0,g.kJ)(r)){return kG(r,t,e)}else if(!(0,g.kJ)(r)){(0,g.vU)("Unsupported range type: "+(0,g.m8)(r))}return r.map((t=>((0,g.kJ)(t)?bG:_G)(t,e)))}function RG(t,e){const n=e.config.projection||{},i={};for(const r in t){if(r==="name")continue;i[r]=UG(t[r],r,e)}for(const r in n){if(i[r]==null){i[r]=UG(n[r],r,e)}}e.addProjection(t.name,i)}function UG(t,e,n){return(0,g.kJ)(t)?t.map((t=>UG(t,e,n))):!(0,g.Kn)(t)?t:t.signal?n.signalRef(t.signal):e==="fit"?t:(0,g.vU)("Unsupported parameter object: "+(0,g.m8)(t))}const $G="top";const PG="left";const qG="right";const IG="bottom";const LG="center";const jG="vertical";const WG="start";const XG="middle";const HG="end";const YG="index";const JG="label";const VG="offset";const GG="perc";const KG="perc2";const ZG="value";const QG="guide-label";const tK="guide-title";const eK="group-title";const nK="group-subtitle";const iK="symbol";const rK="gradient";const aK="discrete";const oK="size";const uK="shape";const sK="fill";const lK="stroke";const fK="strokeWidth";const cK="strokeDash";const hK="opacity";const dK=[oK,uK,sK,lK,fK,cK,hK];const pK={name:1,style:1,interactive:1};const gK={value:0};const mK={value:1};const yK="group";const vK="rect";const xK="rule";const _K="symbol";const bK="text";function wK(t){t.type=yK;t.interactive=t.interactive||false;return t}function kK(t,e){const n=(n,i)=>EV(t[n],EV(e[n],i));n.isVertical=n=>jG===EV(t.direction,e.direction||(n?e.symbolDirection:e.gradientDirection));n.gradientLength=()=>EV(t.gradientLength,e.gradientLength||e.gradientWidth);n.gradientThickness=()=>EV(t.gradientThickness,e.gradientThickness||e.gradientHeight);n.entryColumns=()=>EV(t.columns,EV(e.columns,+n.isVertical(true)));return n}function MK(t,e){const n=e&&(e.update&&e.update[t]||e.enter&&e.enter[t]);return n&&n.signal?n:n?n.value:null}function AK(t,e,n){const i=e.config.style[n];return i&&i[t]}function EK(t,e,n){return`item.anchor === '${WG}' ? ${t} : item.anchor === '${HG}' ? ${e} : ${n}`}const DK=EK((0,g.m8)(PG),(0,g.m8)(qG),(0,g.m8)(LG));function CK(t){const e=t("tickBand");let n=t("tickOffset"),i,r;if(!e){i=t("bandPosition");r=t("tickExtra")}else if(e.signal){i={signal:`(${e.signal}) === 'extent' ? 1 : 0.5`};r={signal:`(${e.signal}) === 'extent'`};if(!(0,g.Kn)(n)){n={signal:`(${e.signal}) === 'extent' ? 0 : ${n}`}}}else if(e==="extent"){i=1;r=true;n=0}else{i=.5;r=false}return{extra:r,band:i,offset:n}}function FK(t,e){return!e?t:!t?e:!(0,g.Kn)(t)?{value:t,offset:e}:Object.assign({},t,{offset:FK(t.offset,e)})}function SK(t,e){if(e){t.name=e.name;t.style=e.style||t.style;t.interactive=!!e.interactive;t.encode=wJ(t.encode,e,pK)}else{t.interactive=false}return t}function TK(t,e,n,i){const r=kK(t,n),a=r.isVertical(),o=r.gradientThickness(),u=r.gradientLength();let s,l,f,c,h;if(a){l=[0,1];f=[0,0];c=o;h=u}else{l=[0,0];f=[1,0];c=u;h=o}const d={enter:s={opacity:gK,x:gK,y:gK,width:xJ(c),height:xJ(h)},update:(0,g.l7)({},s,{opacity:mK,fill:{gradient:e,start:l,stop:f}}),exit:{opacity:gK}};bJ(d,{stroke:r("gradientStrokeColor"),strokeWidth:r("gradientStrokeWidth")},{opacity:r("gradientOpacity")});return SK({type:vK,role:RJ,encode:d},i)}function BK(t,e,n,i,r){const a=kK(t,n),o=a.isVertical(),u=a.gradientThickness(),s=a.gradientLength();let l,f,c,h,d="";o?(l="y",c="y2",f="x",h="width",d="1-"):(l="x",c="x2",f="y",h="height");const p={opacity:gK,fill:{scale:e,field:ZG}};p[l]={signal:d+"datum."+GG,mult:s};p[f]=gK;p[c]={signal:d+"datum."+KG,mult:s};p[h]=xJ(u);const m={enter:p,update:(0,g.l7)({},p,{opacity:mK}),exit:{opacity:gK}};bJ(m,{stroke:a("gradientStrokeColor"),strokeWidth:a("gradientStrokeWidth")},{opacity:a("gradientOpacity")});return SK({type:vK,role:zJ,key:ZG,from:r,encode:m},i)}const NK=`datum.${GG}<=0?"${PG}":datum.${GG}>=1?"${qG}":"${LG}"`,zK=`datum.${GG}<=0?"${IG}":datum.${GG}>=1?"${$G}":"${XG}"`;function OK(t,e,n,i){const r=kK(t,e),a=r.isVertical(),o=xJ(r.gradientThickness()),u=r.gradientLength();let s=r("labelOverlap"),l,f,c,h,d="";const p={enter:l={opacity:gK},update:f={opacity:mK,text:{field:JG}},exit:{opacity:gK}};bJ(p,{fill:r("labelColor"),fillOpacity:r("labelOpacity"),font:r("labelFont"),fontSize:r("labelFontSize"),fontStyle:r("labelFontStyle"),fontWeight:r("labelFontWeight"),limit:EV(t.labelLimit,e.gradientLabelLimit)});if(a){l.align={value:"left"};l.baseline=f.baseline={signal:zK};c="y";h="x";d="1-"}else{l.align=f.align={signal:NK};l.baseline={value:"top"};c="x";h="y"}l[c]=f[c]={signal:d+"datum."+GG,mult:u};l[h]=f[h]=o;o.offset=EV(t.labelOffset,e.gradientLabelOffset)||0;s=s?{separation:r("labelSeparation"),method:s,order:"datum."+YG}:undefined;return SK({type:bK,role:UJ,style:QG,key:ZG,from:i,encode:p,overlap:s},n)}function RK(t,e,n,i,r){const a=kK(t,e),o=n.entries,u=!!(o&&o.interactive),s=o?o.name:undefined,l=a("clipHeight"),f=a("symbolOffset"),c={data:"value"},h=`(${r}) ? datum.${VG} : datum.${oK}`,d=l?xJ(l):{field:oK},p=`datum.${YG}`,g=`max(1, ${r})`;let m,y,v,x,_;d.mult=.5;m={enter:y={opacity:gK,x:{signal:h,mult:.5,offset:f},y:d},update:v={opacity:mK,x:y.x,y:y.y},exit:{opacity:gK}};let b=null,w=null;if(!t.fill){b=e.symbolBaseFillColor;w=e.symbolBaseStrokeColor}bJ(m,{fill:a("symbolFillColor",b),shape:a("symbolType"),size:a("symbolSize"),stroke:a("symbolStrokeColor",w),strokeDash:a("symbolDash"),strokeDashOffset:a("symbolDashOffset"),strokeWidth:a("symbolStrokeWidth")},{opacity:a("symbolOpacity")});dK.forEach((e=>{if(t[e]){v[e]=y[e]={scale:t[e],field:ZG}}}));const k=SK({type:_K,role:$J,key:ZG,from:c,clip:l?true:undefined,encode:m},n.symbols);const M=xJ(f);M.offset=a("labelOffset");m={enter:y={opacity:gK,x:{signal:h,offset:M},y:d},update:v={opacity:mK,text:{field:JG},x:y.x,y:y.y},exit:{opacity:gK}};bJ(m,{align:a("labelAlign"),baseline:a("labelBaseline"),fill:a("labelColor"),fillOpacity:a("labelOpacity"),font:a("labelFont"),fontSize:a("labelFontSize"),fontStyle:a("labelFontStyle"),fontWeight:a("labelFontWeight"),limit:a("labelLimit")});const A=SK({type:bK,role:UJ,style:QG,key:ZG,from:c,encode:m},n.labels);m={enter:{noBound:{value:!l},width:gK,height:l?xJ(l):gK,opacity:gK},exit:{opacity:gK},update:v={opacity:mK,row:{signal:null},column:{signal:null}}};if(a.isVertical(true)){x=`ceil(item.mark.items.length / ${g})`;v.row.signal=`${p}%${x}`;v.column.signal=`floor(${p} / ${x})`;_={field:["row",p]}}else{v.row.signal=`floor(${p} / ${g})`;v.column.signal=`${p} % ${g}`;_={field:p}}v.column.signal=`(${r})?${v.column.signal}:${p}`;i={facet:{data:i,name:"value",groupby:YG}};return wK({role:EJ,from:i,encode:wJ(m,o,pK),marks:[k,A],name:s,interactive:u,sort:_})}function UK(t,e){const n=kK(t,e);return{align:n("gridAlign"),columns:n.entryColumns(),center:{row:true,column:false},padding:{row:n("rowPadding"),column:n("columnPadding")}}}const $K='item.orient === "left"',PK='item.orient === "right"',qK=`(${$K} || ${PK})`,IK=`datum.vgrad && ${qK}`,LK=EK('"top"','"bottom"','"middle"'),jK=EK('"right"','"left"','"center"'),WK=`datum.vgrad && ${PK} ? (${jK}) : (${qK} && !(datum.vgrad && ${$K})) ? "left" : ${DK}`,XK=`item._anchor || (${qK} ? "middle" : "start")`,HK=`${IK} ? (${$K} ? -90 : 90) : 0`,YK=`${qK} ? (datum.vgrad ? (${PK} ? "bottom" : "top") : ${LK}) : "top"`;function JK(t,e,n,i){const r=kK(t,e);const a={enter:{opacity:gK},update:{opacity:mK,x:{field:{group:"padding"}},y:{field:{group:"padding"}}},exit:{opacity:gK}};bJ(a,{orient:r("titleOrient"),_anchor:r("titleAnchor"),anchor:{signal:XK},angle:{signal:HK},align:{signal:WK},baseline:{signal:YK},text:t.title,fill:r("titleColor"),fillOpacity:r("titleOpacity"),font:r("titleFont"),fontSize:r("titleFontSize"),fontStyle:r("titleFontStyle"),fontWeight:r("titleFontWeight"),limit:r("titleLimit"),lineHeight:r("titleLineHeight")},{align:r("titleAlign"),baseline:r("titleBaseline")});return SK({type:bK,role:PJ,style:tK,from:i,encode:a},n)}function VK(t,e){let n;if((0,g.Kn)(t)){if(t.signal){n=t.signal}else if(t.path){n="pathShape("+GK(t.path)+")"}else if(t.sphere){n="geoShape("+GK(t.sphere)+', {type: "Sphere"})'}}return n?e.signalRef(n):!!t}function GK(t){return(0,g.Kn)(t)&&t.signal?t.signal:(0,g.m8)(t)}function KK(t){const e=t.role||"";return!e.indexOf("axis")||!e.indexOf("legend")||!e.indexOf("title")?e:t.type===yK?EJ:e||MJ}function ZK(t){return{marktype:t.type,name:t.name||undefined,role:t.role||KK(t),zindex:+t.zindex||undefined,aria:t.aria,description:t.description}}function QK(t,e){return t&&t.signal?e.signalRef(t.signal):t===false?false:true}function tZ(t,e){const n=Ho(t.type);if(!n)(0,g.vU)("Unrecognized transform type: "+(0,g.m8)(t.type));const i=fV(n.type.toLowerCase(),null,eZ(n,t,e));if(t.signal)e.addSignal(t.signal,e.proxy(i));i.metadata=n.metadata||{};return i}function eZ(t,e,n){const i={},r=t.params.length;for(let a=0;a<r;++a){const r=t.params[a];i[r.name]=nZ(r,e,n)}return i}function nZ(t,e,n){const i=t.type,r=e[t.name];if(i==="index"){return rZ(t,e,n)}else if(r===undefined){if(t.required){(0,g.vU)("Missing required "+(0,g.m8)(e.type)+" parameter: "+(0,g.m8)(t.name))}return}else if(i==="param"){return aZ(t,e,n)}else if(i==="projection"){return n.projectionRef(e[t.name])}return t.array&&!kV(r)?r.map((e=>iZ(t,e,n))):iZ(t,r,n)}function iZ(t,e,n){const i=t.type;if(kV(e)){return fZ(i)?(0,g.vU)("Expression references can not be signals."):cZ(i)?n.fieldRef(e):hZ(i)?n.compareRef(e):n.signalRef(e.signal)}else{const r=t.expr||cZ(i);return r&&uZ(e)?n.exprRef(e.expr,e.as):r&&sZ(e)?dV(e.field,e.as):fZ(i)?PX(e,n):lZ(i)?hV(n.getData(e).values):cZ(i)?dV(e):hZ(i)?n.compareRef(e):e}}function rZ(t,e,n){if(!(0,g.HD)(e.from)){(0,g.vU)('Lookup "from" parameter must be a string literal.')}return n.getData(e.from).lookupRef(n,e.key)}function aZ(t,e,n){const i=e[t.name];if(t.array){if(!(0,g.kJ)(i)){(0,g.vU)("Expected an array of sub-parameters. Instead: "+(0,g.m8)(i))}return i.map((e=>oZ(t,e,n)))}else{return oZ(t,i,n)}}function oZ(t,e,n){const i=t.params.length;let r;for(let o=0;o<i;++o){r=t.params[o];for(const t in r.key){if(r.key[t]!==e[t]){r=null;break}}if(r)break}if(!r)(0,g.vU)("Unsupported parameter: "+(0,g.m8)(e));const a=(0,g.l7)(eZ(r,e,n),r.key);return hV(n.add(aG(a)))}const uZ=t=>t&&t.expr;const sZ=t=>t&&t.field;const lZ=t=>t==="data";const fZ=t=>t==="expr";const cZ=t=>t==="field";const hZ=t=>t==="compare";function dZ(t,e,n){let i,r,a,o,u;if(!t){o=hV(n.add(XV(null,[{}])))}else if(i=t.facet){if(!e)(0,g.vU)("Only group marks can be faceted.");if(i.field!=null){o=u=pZ(i,n)}else{if(!t.data){a=tZ((0,g.l7)({type:"aggregate",groupby:(0,g.IX)(i.groupby)},i.aggregate),n);a.params.key=n.keyRef(i.groupby);a.params.pulse=pZ(i,n);o=u=hV(n.add(a))}else{u=hV(n.getData(t.data).aggregate)}r=n.keyRef(i.groupby,true)}}if(!o){o=pZ(t,n)}return{key:r,pulse:o,parent:u}}function pZ(t,e){return t.$ref?t:t.data&&t.data.$ref?t.data:hV(e.getData(t.data).output)}function gZ(t,e,n,i,r){this.scope=t;this.input=e;this.output=n;this.values=i;this.aggregate=r;this.index={}}gZ.fromEntries=function(t,e){const n=e.length,i=e[n-1],r=e[n-2];let a=e[0],o=null,u=1;if(a&&a.type==="load"){a=e[1]}t.add(e[0]);for(;u<n;++u){e[u].params.pulse=hV(e[u-1]);t.add(e[u]);if(e[u].type==="aggregate")o=e[u]}return new gZ(t,a,r,i,o)};function mZ(t){return(0,g.HD)(t)?t:null}function yZ(t,e,n){const i=_V(n.op,n.field);let r;if(e.ops){for(let t=0,n=e.as.length;t<n;++t){if(e.as[t]===i)return}}else{e.ops=["count"];e.fields=[null];e.as=["count"]}if(n.op){e.ops.push((r=n.op.signal)?t.signalRef(r):n.op);e.fields.push(t.fieldRef(n.field));e.as.push(i)}}function vZ(t,e,n,i,r,a,o){const u=e[n]||(e[n]={}),s=xV(a);let l=mZ(r),f,c;if(l!=null){t=e.scope;l=l+(s?"|"+s:"");f=u[l]}if(!f){const n=a?{field:pV,pulse:e.countsRef(t,r,a)}:{field:t.fieldRef(r),pulse:hV(e.output)};if(s)n.sort=t.sortRef(a);c=t.add(fV(i,undefined,n));if(o)e.index[r]=c;f=hV(c);if(l!=null)u[l]=f}return f}gZ.prototype={countsRef(t,e,n){const i=this,r=i.counts||(i.counts={}),a=mZ(e);let o,u,s;if(a!=null){t=i.scope;o=r[a]}if(!o){s={groupby:t.fieldRef(e,"key"),pulse:hV(i.output)};if(n&&n.field)yZ(t,s,n);u=t.add(LV(s));o=t.add(XV({pulse:hV(u)}));o={agg:u,ref:hV(o)};if(a!=null)r[a]=o}else if(n&&n.field){yZ(t,o.agg.params,n)}return o.ref},tuplesRef(){return hV(this.values)},extentRef(t,e){return vZ(t,this,"extent","extent",e,false)},domainRef(t,e){return vZ(t,this,"domain","values",e,false)},valuesRef(t,e,n){return vZ(t,this,"vals","values",e,n||true)},lookupRef(t,e){return vZ(t,this,"lookup","tupleindex",e,false)},indataRef(t,e){return vZ(t,this,"indata","tupleindex",e,true,true)}};function xZ(t,e,n){const i=t.from.facet,r=i.name,a=pZ(i,e);let o;if(!i.name){(0,g.vU)("Facet must have a name: "+(0,g.m8)(i))}if(!i.data){(0,g.vU)("Facet must reference a data set: "+(0,g.m8)(i))}if(i.field){o=e.add(oG({field:e.fieldRef(i.field),pulse:a}))}else if(i.groupby){o=e.add(GV({key:e.keyRef(i.groupby),group:hV(e.proxy(n.parent)),pulse:a}))}else{(0,g.vU)("Facet must specify groupby or field: "+(0,g.m8)(i))}const u=e.fork(),s=u.add(XV()),l=u.add(hG({pulse:hV(s)}));u.addData(r,new gZ(u,s,s,l));u.addSignal("parent",null);o.params.subflow={$subflow:u.parse(t).toRuntime()}}function _Z(t,e,n){const i=e.add(oG({pulse:n.pulse})),r=e.fork();r.add(hG());r.addSignal("parent",null);i.params.subflow={$subflow:r.parse(t).toRuntime()}}function bZ(t,e,n){const i=t.remove,r=t.insert,a=t.toggle,o=t.modify,u=t.values,s=e.add(cV());const l="if("+t.trigger+',modify("'+n+'",'+[r,i,a,o,u].map((t=>t==null?"null":t)).join(",")+"),0)";const f=PX(l,e);s.update=f.$expr;s.params=f.$params}function wZ(t,e){const n=KK(t),i=t.type===yK,r=t.from&&t.from.facet,a=t.overlap;let o=t.layout||n===EJ||n===AJ,u,s,l,f,c,h,d;const p=n===MJ||o||r;const m=dZ(t.from,i,e);s=e.add(YV({key:m.key||(t.key?dV(t.key):undefined),pulse:m.pulse,clean:!i}));const y=hV(s);s=l=e.add(XV({pulse:y}));s=e.add(eG({markdef:ZK(t),interactive:QK(t.interactive,e),clip:VK(t.clip,e),context:{$context:true},groups:e.lookup(),parent:e.signals.parent?e.signalRef("parent"):null,index:e.markpath(),pulse:hV(s)}));const v=hV(s);s=f=e.add(JV(eV(t.encode,t.type,n,t.style,e,{mod:false,pulse:v})));s.params.parent=e.encode();if(t.transform){t.transform.forEach((t=>{const n=tZ(t,e),i=n.metadata;if(i.generates||i.changes){(0,g.vU)("Mark transforms should not generate new data.")}if(!i.nomod)f.params.mod=true;n.params.pulse=hV(s);e.add(s=n)}))}if(t.sort){s=e.add(dG({sort:e.compareRef(t.sort),pulse:hV(s)}))}const x=hV(s);if(r||o){o=e.add(pG({layout:e.objectProperty(t.layout),legends:e.legends,mark:v,pulse:x}));h=hV(o)}const _=e.add(WV({mark:v,pulse:h||x}));d=hV(_);if(i){if(p){u=e.operators;u.pop();if(o)u.pop()}e.pushState(x,h||d,y);r?xZ(t,e,m):p?_Z(t,e,m):e.parse(t);e.popState();if(p){if(o)u.push(o);u.push(_)}}if(a){d=kZ(a,d,e)}const b=e.add(fG({pulse:d})),w=e.add(hG({pulse:hV(b)},undefined,e.parent()));if(t.name!=null){c=t.name;e.addData(c,new gZ(e,l,b,w));if(t.on)t.on.forEach((t=>{if(t.insert||t.remove||t.toggle){(0,g.vU)("Marks only support modify triggers.")}bZ(t,e,c)}))}}function kZ(t,e,n){const i=t.method,r=t.bound,a=t.separation;const o={separation:kV(a)?n.signalRef(a.signal):a,method:kV(i)?n.signalRef(i.signal):i,pulse:e};if(t.order){o.sort=n.compareRef({field:t.order})}if(r){const t=r.tolerance;o.boundTolerance=kV(t)?n.signalRef(t.signal):+t;o.boundScale=n.scaleRef(r.scale);o.boundOrient=r.orient}return hV(n.add(rG(o)))}function MZ(t,e){const n=e.config.legend,i=t.encode||{},r=kK(t,n),a=i.legend||{},o=a.name||undefined,u=a.interactive,s=a.style,l={};let f=0,c,h,d;dK.forEach((e=>t[e]?(l[e]=t[e],f=f||t[e]):0));if(!f)(0,g.vU)("Missing valid scale for legend.");const p=AZ(t,e.scaleType(f));const m={title:t.title!=null,scales:l,type:p,vgrad:p!=="symbol"&&r.isVertical()};const y=hV(e.add(XV(null,[m])));const v={enter:{x:{value:0},y:{value:0}}};const x=hV(e.add(QV(h={type:p,scale:e.scaleRef(f),count:e.objectProperty(r("tickCount")),limit:e.property(r("symbolLimit")),values:e.objectProperty(t.values),minstep:e.property(t.tickMinStep),formatType:e.property(t.formatType),formatSpecifier:e.property(t.format)})));if(p===rK){d=[TK(t,f,n,i.gradient),OK(t,n,i.labels,x)];h.count=h.count||e.signalRef(`max(2,2*floor((${DV(r.gradientLength())})/100))`)}else if(p===aK){d=[BK(t,f,n,i.gradient,x),OK(t,n,i.labels,x)]}else{c=UK(t,n);d=[RK(t,n,i,x,DV(c.columns))];h.size=CZ(t,e,d[0].marks)}d=[wK({role:OJ,from:y,encode:v,marks:d,layout:c,interactive:u})];if(m.title){d.push(JK(t,n,i.title,y))}return wZ(wK({role:NJ,from:y,encode:wJ(DZ(r,t,n),a,pK),marks:d,aria:r("aria"),description:r("description"),zindex:r("zindex"),name:o,interactive:u,style:s}),e)}function AZ(t,e){let n=t.type||iK;if(!t.type&&EZ(t)===1&&(t.fill||t.stroke)){n=ym(e)?rK:xm(e)?aK:iK}return n!==rK?n:xm(e)?aK:rK}function EZ(t){return dK.reduce(((e,n)=>e+(t[n]?1:0)),0)}function DZ(t,e,n){const i={enter:{},update:{}};bJ(i,{orient:t("orient"),offset:t("offset"),padding:t("padding"),titlePadding:t("titlePadding"),cornerRadius:t("cornerRadius"),fill:t("fillColor"),stroke:t("strokeColor"),strokeWidth:n.strokeWidth,strokeDash:n.strokeDash,x:t("legendX"),y:t("legendY"),format:e.format,formatType:e.formatType});return i}function CZ(t,e,n){const i=DV(FZ("size",t,n)),r=DV(FZ("strokeWidth",t,n)),a=DV(SZ(n[1].encode,e,QG));return PX(`max(ceil(sqrt(${i})+${r}),${a})`,e)}function FZ(t,e,n){return e[t]?`scale("${e[t]}",datum)`:MK(t,n[0].encode)}function SZ(t,e,n){return MK("fontSize",t)||AK("fontSize",e,n)}const TZ=`item.orient==="${PG}"?-90:item.orient==="${qG}"?90:0`;function BZ(t,e){t=(0,g.HD)(t)?{text:t}:t;const n=kK(t,e.config.title),i=t.encode||{},r=i.group||{},a=r.name||undefined,o=r.interactive,u=r.style,s=[];const l={},f=hV(e.add(XV(null,[l])));s.push(OZ(t,n,NZ(t),f));if(t.subtitle){s.push(RZ(t,n,i.subtitle,f))}return wZ(wK({role:qJ,from:f,encode:zZ(n,r),marks:s,aria:n("aria"),description:n("description"),zindex:n("zindex"),name:a,interactive:o,style:u}),e)}function NZ(t){const e=t.encode;return e&&e.title||(0,g.l7)({name:t.name,interactive:t.interactive,style:t.style},e)}function zZ(t,e){const n={enter:{},update:{}};bJ(n,{orient:t("orient"),anchor:t("anchor"),align:{signal:DK},angle:{signal:TZ},limit:t("limit"),frame:t("frame"),offset:t("offset")||0,padding:t("subtitlePadding")});return wJ(n,e,pK)}function OZ(t,e,n,i){const r={value:0},a=t.text,o={enter:{opacity:r},update:{opacity:{value:1}},exit:{opacity:r}};bJ(o,{text:a,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:e("dx"),dy:e("dy"),fill:e("color"),font:e("font"),fontSize:e("fontSize"),fontStyle:e("fontStyle"),fontWeight:e("fontWeight"),lineHeight:e("lineHeight")},{align:e("align"),angle:e("angle"),baseline:e("baseline")});return SK({type:bK,role:IJ,style:eK,from:i,encode:o},n)}function RZ(t,e,n,i){const r={value:0},a=t.subtitle,o={enter:{opacity:r},update:{opacity:{value:1}},exit:{opacity:r}};bJ(o,{text:a,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:e("dx"),dy:e("dy"),fill:e("subtitleColor"),font:e("subtitleFont"),fontSize:e("subtitleFontSize"),fontStyle:e("subtitleFontStyle"),fontWeight:e("subtitleFontWeight"),lineHeight:e("subtitleLineHeight")},{align:e("align"),angle:e("angle"),baseline:e("baseline")});return SK({type:bK,role:LJ,style:nK,from:i,encode:o},n)}function UZ(t,e){const n=[];if(t.transform){t.transform.forEach((t=>{n.push(tZ(t,e))}))}if(t.on){t.on.forEach((n=>{bZ(n,e,t.name)}))}e.addDataPipeline(t.name,$Z(t,e,n))}function $Z(t,e,n){const i=[];let r=null,a=false,o=false,u,s,l,f,c;if(t.values){if(kV(t.values)||AV(t.format)){i.push(qZ(e,t));i.push(r=PZ())}else{i.push(r=PZ({$ingest:t.values,$format:t.format}))}}else if(t.url){if(AV(t.url)||AV(t.format)){i.push(qZ(e,t));i.push(r=PZ())}else{i.push(r=PZ({$request:t.url,$format:t.format}))}}else if(t.source){r=u=(0,g.IX)(t.source).map((t=>hV(e.getData(t).output)));i.push(null)}for(s=0,l=n.length;s<l;++s){f=n[s];c=f.metadata;if(!r&&!c.source){i.push(r=PZ())}i.push(f);if(c.generates)o=true;if(c.modifies&&!o)a=true;if(c.source)r=f;else if(c.changes)r=null}if(u){l=u.length-1;i[0]=lG({derive:a,pulse:l?u:u[0]});if(a||l){i.splice(1,0,PZ())}}if(!r)i.push(PZ());i.push(hG({}));return i}function PZ(t){const e=XV({},t);e.metadata={source:true};return e}function qZ(t,e){return tG({url:e.url?t.property(e.url):undefined,async:e.async?t.property(e.async):undefined,values:e.values?t.property(e.values):undefined,format:t.objectProperty(e.format)})}const IZ=t=>t===IG||t===$G;const LZ=(t,e,n)=>kV(t)?VZ(t.signal,e,n):t===PG||t===$G?e:n;const jZ=(t,e,n)=>kV(t)?YZ(t.signal,e,n):IZ(t)?e:n;const WZ=(t,e,n)=>kV(t)?JZ(t.signal,e,n):IZ(t)?n:e;const XZ=(t,e,n)=>kV(t)?GZ(t.signal,e,n):t===$G?{value:e}:{value:n};const HZ=(t,e,n)=>kV(t)?KZ(t.signal,e,n):t===qG?{value:e}:{value:n};const YZ=(t,e,n)=>ZZ(`${t} === '${$G}' || ${t} === '${IG}'`,e,n);const JZ=(t,e,n)=>ZZ(`${t} !== '${$G}' && ${t} !== '${IG}'`,e,n);const VZ=(t,e,n)=>tQ(`${t} === '${PG}' || ${t} === '${$G}'`,e,n);const GZ=(t,e,n)=>tQ(`${t} === '${$G}'`,e,n);const KZ=(t,e,n)=>tQ(`${t} === '${qG}'`,e,n);const ZZ=(t,e,n)=>{e=e!=null?xJ(e):e;n=n!=null?xJ(n):n;if(QZ(e)&&QZ(n)){e=e?e.signal||(0,g.m8)(e.value):null;n=n?n.signal||(0,g.m8)(n.value):null;return{signal:`${t} ? (${e}) : (${n})`}}else{return[(0,g.l7)({test:t},e)].concat(n||[])}};const QZ=t=>t==null||Object.keys(t).length===1;const tQ=(t,e,n)=>({signal:`${t} ? (${nQ(e)}) : (${nQ(n)})`});const eQ=(t,e,n,i,r)=>({signal:(i!=null?`${t} === '${PG}' ? (${nQ(i)}) : `:"")+(n!=null?`${t} === '${IG}' ? (${nQ(n)}) : `:"")+(r!=null?`${t} === '${qG}' ? (${nQ(r)}) : `:"")+(e!=null?`${t} === '${$G}' ? (${nQ(e)}) : `:"")+"(null)"});const nQ=t=>kV(t)?t.signal:t==null?null:(0,g.m8)(t);const iQ=(t,e)=>e===0?0:kV(t)?{signal:`(${t.signal}) * ${e}`}:{value:t*e};const rQ=(t,e)=>{const n=t.signal;return n&&n.endsWith("(null)")?{signal:n.slice(0,-6)+e.signal}:t};function aQ(t,e,n,i){let r;if(e&&(0,g.nr)(e,t)){return e[t]}else if((0,g.nr)(n,t)){return n[t]}else if(t.startsWith("title")){switch(t){case"titleColor":r="fill";break;case"titleFont":case"titleFontSize":case"titleFontWeight":r=t[5].toLowerCase()+t.slice(6)}return i[tK][r]}else if(t.startsWith("label")){switch(t){case"labelColor":r="fill";break;case"labelFont":case"labelFontSize":r=t[5].toLowerCase()+t.slice(6)}return i[QG][r]}return null}function oQ(t){const e={};for(const n of t){if(!n)continue;for(const t in n)e[t]=1}return Object.keys(e)}function uQ(t,e){var n=e.config,i=n.style,r=n.axis,a=e.scaleType(t.scale)==="band"&&n.axisBand,o=t.orient,u,s,l;if(kV(o)){const t=oQ([n.axisX,n.axisY]),e=oQ([n.axisTop,n.axisBottom,n.axisLeft,n.axisRight]);u={};for(l of t){u[l]=jZ(o,aQ(l,n.axisX,r,i),aQ(l,n.axisY,r,i))}s={};for(l of e){s[l]=eQ(o.signal,aQ(l,n.axisTop,r,i),aQ(l,n.axisBottom,r,i),aQ(l,n.axisLeft,r,i),aQ(l,n.axisRight,r,i))}}else{u=o===$G||o===IG?n.axisX:n.axisY;s=n["axis"+o[0].toUpperCase()+o.slice(1)]}const f=u||s||a?(0,g.l7)({},r,u,s,a):r;return f}function sQ(t,e,n,i){const r=kK(t,e),a=t.orient;let o,u;const s={enter:o={opacity:gK},update:u={opacity:mK},exit:{opacity:gK}};bJ(s,{stroke:r("domainColor"),strokeCap:r("domainCap"),strokeDash:r("domainDash"),strokeDashOffset:r("domainDashOffset"),strokeWidth:r("domainWidth"),strokeOpacity:r("domainOpacity")});const l=lQ(t,0);const f=lQ(t,1);o.x=u.x=jZ(a,l,gK);o.x2=u.x2=jZ(a,f);o.y=u.y=WZ(a,l,gK);o.y2=u.y2=WZ(a,f);return SK({type:xK,role:CJ,from:i,encode:s},n)}function lQ(t,e){return{scale:t.scale,range:e}}function fQ(t,e,n,i,r){const a=kK(t,e),o=t.orient,u=t.gridScale,s=LZ(o,1,-1),l=cQ(t.offset,s);let f,c,h;const d={enter:f={opacity:gK},update:h={opacity:mK},exit:c={opacity:gK}};bJ(d,{stroke:a("gridColor"),strokeCap:a("gridCap"),strokeDash:a("gridDash"),strokeDashOffset:a("gridDashOffset"),strokeOpacity:a("gridOpacity"),strokeWidth:a("gridWidth")});const p={scale:t.scale,field:ZG,band:r.band,extra:r.extra,offset:r.offset,round:a("tickRound")};const m=jZ(o,{signal:"height"},{signal:"width"});const y=u?{scale:u,range:0,mult:s,offset:l}:{value:0,offset:l};const v=u?{scale:u,range:1,mult:s,offset:l}:(0,g.l7)(m,{mult:s,offset:l});f.x=h.x=jZ(o,p,y);f.y=h.y=WZ(o,p,y);f.x2=h.x2=WZ(o,v);f.y2=h.y2=jZ(o,v);c.x=jZ(o,p);c.y=WZ(o,p);return SK({type:xK,role:FJ,key:ZG,from:i,encode:d},n)}function cQ(t,e){if(e===1);else if(!(0,g.Kn)(t)){t=kV(e)?{signal:`(${e.signal}) * (${t||0})`}:e*(t||0)}else{let n=t=(0,g.l7)({},t);while(n.mult!=null){if(!(0,g.Kn)(n.mult)){n.mult=kV(e)?{signal:`(${n.mult}) * (${e.signal})`}:n.mult*e;return t}else{n=n.mult=(0,g.l7)({},n.mult)}}n.mult=e}return t}function hQ(t,e,n,i,r,a){const o=kK(t,e),u=t.orient,s=LZ(u,-1,1);let l,f,c;const h={enter:l={opacity:gK},update:c={opacity:mK},exit:f={opacity:gK}};bJ(h,{stroke:o("tickColor"),strokeCap:o("tickCap"),strokeDash:o("tickDash"),strokeDashOffset:o("tickDashOffset"),strokeOpacity:o("tickOpacity"),strokeWidth:o("tickWidth")});const d=xJ(r);d.mult=s;const p={scale:t.scale,field:ZG,band:a.band,extra:a.extra,offset:a.offset,round:o("tickRound")};c.y=l.y=jZ(u,gK,p);c.y2=l.y2=jZ(u,d);f.x=jZ(u,p);c.x=l.x=WZ(u,gK,p);c.x2=l.x2=WZ(u,d);f.y=WZ(u,p);return SK({type:xK,role:TJ,key:ZG,from:i,encode:h},n)}function dQ(t,e,n,i,r){return{signal:'flush(range("'+t+'"), '+'scale("'+t+'", datum.value), '+e+","+n+","+i+","+r+")"}}function pQ(t,e,n,i,r,a){const o=kK(t,e),u=t.orient,s=t.scale,l=LZ(u,-1,1),f=DV(o("labelFlush")),c=DV(o("labelFlushOffset")),h=o("labelAlign"),d=o("labelBaseline");let p=f===0||!!f,g;const m=xJ(r);m.mult=l;m.offset=xJ(o("labelPadding")||0);m.offset.mult=l;const y={scale:s,field:ZG,band:.5,offset:FK(a.offset,o("labelOffset"))};const v=jZ(u,p?dQ(s,f,'"left"','"right"','"center"'):{value:"center"},HZ(u,"left","right"));const x=jZ(u,XZ(u,"bottom","top"),p?dQ(s,f,'"top"','"bottom"','"middle"'):{value:"middle"});const _=dQ(s,f,`-(${c})`,c,0);p=p&&c;const b={opacity:gK,x:jZ(u,y,m),y:WZ(u,y,m)};const w={enter:b,update:g={opacity:mK,text:{field:JG},x:b.x,y:b.y,align:v,baseline:x},exit:{opacity:gK,x:b.x,y:b.y}};bJ(w,{dx:!h&&p?jZ(u,_):null,dy:!d&&p?WZ(u,_):null});bJ(w,{angle:o("labelAngle"),fill:o("labelColor"),fillOpacity:o("labelOpacity"),font:o("labelFont"),fontSize:o("labelFontSize"),fontWeight:o("labelFontWeight"),fontStyle:o("labelFontStyle"),limit:o("labelLimit"),lineHeight:o("labelLineHeight")},{align:h,baseline:d});const k=o("labelBound");let M=o("labelOverlap");M=M||k?{separation:o("labelSeparation"),method:M,order:"datum.index",bound:k?{scale:s,orient:u,tolerance:k}:null}:undefined;if(g.align!==v){g.align=rQ(g.align,v)}if(g.baseline!==x){g.baseline=rQ(g.baseline,x)}return SK({type:bK,role:SJ,style:QG,key:ZG,from:i,encode:w,overlap:M},n)}function gQ(t,e,n,i){const r=kK(t,e),a=t.orient,o=LZ(a,-1,1);let u,s;const l={enter:u={opacity:gK,anchor:xJ(r("titleAnchor",null)),align:{signal:DK}},update:s=(0,g.l7)({},u,{opacity:mK,text:xJ(t.title)}),exit:{opacity:gK}};const f={signal:`lerp(range("${t.scale}"), ${EK(0,1,.5)})`};s.x=jZ(a,f);s.y=WZ(a,f);u.angle=jZ(a,gK,iQ(o,90));u.baseline=jZ(a,XZ(a,IG,$G),{value:IG});s.angle=u.angle;s.baseline=u.baseline;bJ(l,{fill:r("titleColor"),fillOpacity:r("titleOpacity"),font:r("titleFont"),fontSize:r("titleFontSize"),fontStyle:r("titleFontStyle"),fontWeight:r("titleFontWeight"),limit:r("titleLimit"),lineHeight:r("titleLineHeight")},{align:r("titleAlign"),angle:r("titleAngle"),baseline:r("titleBaseline")});mQ(r,a,l,n);l.update.align=rQ(l.update.align,u.align);l.update.angle=rQ(l.update.angle,u.angle);l.update.baseline=rQ(l.update.baseline,u.baseline);return SK({type:bK,role:BJ,style:tK,from:i,encode:l},n)}function mQ(t,e,n,i){const r=(t,e)=>t!=null?(n.update[e]=rQ(xJ(t),n.update[e]),false):!kJ(e,i)?true:false;const a=r(t("titleX"),"x"),o=r(t("titleY"),"y");n.enter.auto=o===a?xJ(o):jZ(e,xJ(o),xJ(a))}function yQ(t,e){const n=uQ(t,e),i=t.encode||{},r=i.axis||{},a=r.name||undefined,o=r.interactive,u=r.style,s=kK(t,n),l=CK(s);const f={scale:t.scale,ticks:!!s("ticks"),labels:!!s("labels"),grid:!!s("grid"),domain:!!s("domain"),title:t.title!=null};const c=hV(e.add(XV({},[f])));const h=hV(e.add(jV({scale:e.scaleRef(t.scale),extra:e.property(l.extra),count:e.objectProperty(t.tickCount),values:e.objectProperty(t.values),minstep:e.property(t.tickMinStep),formatType:e.property(t.formatType),formatSpecifier:e.property(t.format)})));const d=[];let p;if(f.grid){d.push(fQ(t,n,i.grid,h,l))}if(f.ticks){p=s("tickSize");d.push(hQ(t,n,i.ticks,h,p,l))}if(f.labels){p=f.ticks?p:0;d.push(pQ(t,n,i.labels,h,p,l))}if(f.domain){d.push(sQ(t,n,i.domain,c))}if(f.title){d.push(gQ(t,n,i.title,c))}return wZ(wK({role:DJ,from:c,encode:wJ(vQ(s,t),r,pK),marks:d,aria:s("aria"),description:s("description"),zindex:s("zindex"),name:a,interactive:o,style:u}),e)}function vQ(t,e){const n={enter:{},update:{}};bJ(n,{orient:t("orient"),offset:t("offset")||0,position:EV(e.position,0),titlePadding:t("titlePadding"),minExtent:t("minExtent"),maxExtent:t("maxExtent"),range:{signal:`abs(span(range("${e.scale}")))`},translate:t("translate"),format:e.format,formatType:e.formatType});return n}function xQ(t,e,n){const i=(0,g.IX)(t.signals),r=(0,g.IX)(t.scales);if(!n)i.forEach((t=>sV(t,e)));(0,g.IX)(t.projections).forEach((t=>RG(t,e)));r.forEach((t=>vG(t,e)));(0,g.IX)(t.data).forEach((t=>UZ(t,e)));r.forEach((t=>xG(t,e)));(n||i).forEach((t=>qV(t,e)));(0,g.IX)(t.axes).forEach((t=>yQ(t,e)));(0,g.IX)(t.marks).forEach((t=>wZ(t,e)));(0,g.IX)(t.legends).forEach((t=>MZ(t,e)));if(t.title)BZ(t.title,e);e.parseLambdas();return e}const _Q=t=>wJ({enter:{x:{value:0},y:{value:0}},update:{width:{signal:"width"},height:{signal:"height"}}},t);function bQ(t,e){const n=e.config;const i=hV(e.root=e.add(cV()));const r=kQ(t,n);r.forEach((t=>sV(t,e)));e.description=t.description||n.description;e.eventConfig=n.events;e.legends=e.objectProperty(n.legend&&n.legend.layout);e.locale=n.locale;const a=e.add(XV());const o=e.add(JV(eV(_Q(t.encode),yK,AJ,t.style,e,{pulse:hV(a)})));const u=e.add(pG({layout:e.objectProperty(t.layout),legends:e.legends,autosize:e.signalRef("autosize"),mark:i,pulse:hV(o)}));e.operators.pop();e.pushState(hV(o),hV(u),null);xQ(t,e,r);e.operators.push(u);let s=e.add(WV({mark:i,pulse:hV(u)}));s=e.add(fG({pulse:hV(s)}));s=e.add(hG({pulse:hV(s)}));e.addData("root",new gZ(e,a,a,s));return e}function wQ(t,e){return e&&e.signal?{name:t,update:e.signal}:{name:t,value:e}}function kQ(t,e){const n=n=>EV(t[n],e[n]),i=[wQ("background",n("background")),wQ("autosize",gJ(n("autosize"))),wQ("padding",vJ(n("padding"))),wQ("width",n("width")||0),wQ("height",n("height")||0)],r=i.reduce(((t,e)=>(t[e.name]=e,t)),{}),a={};(0,g.IX)(t.signals).forEach((t=>{if((0,g.nr)(r,t.name)){t=(0,g.l7)(r[t.name],t)}else{i.push(t)}a[t.name]=t}));(0,g.IX)(e.signals).forEach((t=>{if(!(0,g.nr)(a,t.name)&&!(0,g.nr)(r,t.name)){i.push(t)}}));return i}function MQ(t,e){this.config=t||{};this.options=e||{};this.bindings=[];this.field={};this.signals={};this.lambdas={};this.scales={};this.events={};this.data={};this.streams=[];this.updates=[];this.operators=[];this.eventConfig=null;this.locale=null;this._id=0;this._subid=0;this._nextsub=[0];this._parent=[];this._encode=[];this._lookup=[];this._markpath=[]}function AQ(t){this.config=t.config;this.options=t.options;this.legends=t.legends;this.field=Object.create(t.field);this.signals=Object.create(t.signals);this.lambdas=Object.create(t.lambdas);this.scales=Object.create(t.scales);this.events=Object.create(t.events);this.data=Object.create(t.data);this.streams=[];this.updates=[];this.operators=[];this._id=0;this._subid=++t._nextsub[0];this._nextsub=t._nextsub;this._parent=t._parent.slice();this._encode=t._encode.slice();this._lookup=t._lookup.slice();this._markpath=t._markpath}MQ.prototype=AQ.prototype={parse(t){return xQ(t,this)},fork(){return new AQ(this)},isSubscope(){return this._subid>0},toRuntime(){this.finish();return{description:this.description,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig,locale:this.locale}},id(){return(this._subid?this._subid+":":0)+this._id++},add(t){this.operators.push(t);t.id=this.id();if(t.refs){t.refs.forEach((e=>{e.$ref=t.id}));t.refs=null}return t},proxy(t){const e=t instanceof lV?hV(t):t;return this.add(sG({value:e}))},addStream(t){this.streams.push(t);t.id=this.id();return t},addUpdate(t){this.updates.push(t);return t},finish(){let t,e;if(this.root)this.root.root=true;for(t in this.signals){this.signals[t].signal=t}for(t in this.scales){this.scales[t].scale=t}function n(t,e,n){let i,r;if(t){i=t.data||(t.data={});r=i[e]||(i[e]=[]);r.push(n)}}for(t in this.data){e=this.data[t];n(e.input,t,"input");n(e.output,t,"output");n(e.values,t,"values");for(const i in e.index){n(e.index[i],t,"index:"+i)}}return this},pushState(t,e,n){this._encode.push(hV(this.add(hG({pulse:t}))));this._parent.push(e);this._lookup.push(n?hV(this.proxy(n)):null);this._markpath.push(-1)},popState(){this._encode.pop();this._parent.pop();this._lookup.pop();this._markpath.pop()},parent(){return(0,g.fj)(this._parent)},encode(){return(0,g.fj)(this._encode)},lookup(){return(0,g.fj)(this._lookup)},markpath(){const t=this._markpath;return++t[t.length-1]},fieldRef(t,e){if((0,g.HD)(t))return dV(t,e);if(!t.signal){(0,g.vU)("Unsupported field reference: "+(0,g.m8)(t))}const n=t.signal;let i=this.field[n];if(!i){const t={name:this.signalRef(n)};if(e)t.as=e;this.field[n]=i=hV(this.add(KV(t)))}return i},compareRef(t){let e=false;const n=t=>kV(t)?(e=true,this.signalRef(t.signal)):MV(t)?(e=true,this.exprRef(t.expr)):t;const i=(0,g.IX)(t.field).map(n),r=(0,g.IX)(t.order).map(n);return e?hV(this.add(HV({fields:i,orders:r}))):gV(i,r)},keyRef(t,e){let n=false;const i=t=>kV(t)?(n=true,hV(r[t.signal])):t;const r=this.signals;t=(0,g.IX)(t).map(i);return n?hV(this.add(ZV({fields:t,flat:e}))):mV(t,e)},sortRef(t){if(!t)return t;const e=_V(t.op,t.field),n=t.order||yV;return n.signal?hV(this.add(HV({fields:e,orders:this.signalRef(n.signal)}))):gV(e,n)},event(t,e){const n=t+":"+e;if(!this.events[n]){const i=this.id();this.streams.push({id:i,source:t,type:e});this.events[n]=i}return this.events[n]},hasOwnSignal(t){return(0,g.nr)(this.signals,t)},addSignal(t,e){if(this.hasOwnSignal(t)){(0,g.vU)("Duplicate signal name: "+(0,g.m8)(t))}const n=e instanceof lV?e:this.add(cV(e));return this.signals[t]=n},getSignal(t){if(!this.signals[t]){(0,g.vU)("Unrecognized signal name: "+(0,g.m8)(t))}return this.signals[t]},signalRef(t){if(this.signals[t]){return hV(this.signals[t])}else if(!(0,g.nr)(this.lambdas,t)){this.lambdas[t]=this.add(cV(null))}return hV(this.lambdas[t])},parseLambdas(){const t=Object.keys(this.lambdas);for(let e=0,n=t.length;e<n;++e){const n=t[e],i=PX(n,this),r=this.lambdas[n];r.params=i.$params;r.update=i.$expr}},property(t){return t&&t.signal?this.signalRef(t.signal):t},objectProperty(t){return!t||!(0,g.Kn)(t)?t:this.signalRef(t.signal||EQ(t))},exprRef(t,e){const n={expr:PX(t,this)};if(e)n.expr.$name=e;return hV(this.add(VV(n)))},addBinding(t,e){if(!this.bindings){(0,g.vU)("Nested signals do not support binding: "+(0,g.m8)(t))}this.bindings.push((0,g.l7)({signal:t},e))},addScaleProj(t,e){if((0,g.nr)(this.scales,t)){(0,g.vU)("Duplicate scale or projection name: "+(0,g.m8)(t))}this.scales[t]=this.add(e)},addScale(t,e){this.addScaleProj(t,cG(e))},addProjection(t,e){this.addScaleProj(t,uG(e))},getScale(t){if(!this.scales[t]){(0,g.vU)("Unrecognized scale name: "+(0,g.m8)(t))}return this.scales[t]},scaleRef(t){return hV(this.getScale(t))},scaleType(t){return this.getScale(t).params.type},projectionRef(t){return this.scaleRef(t)},projectionType(t){return this.scaleType(t)},addData(t,e){if((0,g.nr)(this.data,t)){(0,g.vU)("Duplicate data set name: "+(0,g.m8)(t))}return this.data[t]=e},getData(t){if(!this.data[t]){(0,g.vU)("Undefined data set name: "+(0,g.m8)(t))}return this.data[t]},addDataPipeline(t,e){if((0,g.nr)(this.data,t)){(0,g.vU)("Duplicate data set name: "+(0,g.m8)(t))}return this.addData(t,gZ.fromEntries(this,e))}};function EQ(t){return((0,g.kJ)(t)?DQ:CQ)(t)}function DQ(t){const e=t.length;let n="[";for(let i=0;i<e;++i){const e=t[i];n+=(i>0?",":"")+((0,g.Kn)(e)?e.signal||EQ(e):(0,g.m8)(e))}return n+"]"}function CQ(t){let e="{",n=0,i,r;for(i in t){r=t[i];e+=(++n>1?",":"")+(0,g.m8)(i)+":"+((0,g.Kn)(r)?r.signal||EQ(r):(0,g.m8)(r))}return e+"}"}function FQ(){const t="sans-serif",e=30,n=2,i="#4c78a8",r="#000",a="#888",o="#ddd";return{description:"Vega visualization",padding:0,autosize:"pad",background:null,events:{defaults:{allow:["wheel"]}},group:null,mark:null,arc:{fill:i},area:{fill:i},image:null,line:{stroke:i,strokeWidth:n},path:{stroke:i},rect:{fill:i},rule:{stroke:r},shape:{stroke:i},symbol:{fill:i,size:64},text:{fill:r,font:t,fontSize:11},trail:{fill:i,size:n},style:{"guide-label":{fill:r,font:t,fontSize:10},"guide-title":{fill:r,font:t,fontSize:11,fontWeight:"bold"},"group-title":{fill:r,font:t,fontSize:13,fontWeight:"bold"},"group-subtitle":{fill:r,font:t,fontSize:12},point:{size:e,strokeWidth:n,shape:"circle"},circle:{size:e,strokeWidth:n},square:{size:e,strokeWidth:n,shape:"square"},cell:{fill:"transparent",stroke:o}},title:{orient:"top",anchor:"middle",offset:4,subtitlePadding:3},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:true,domainWidth:1,domainColor:a,grid:false,gridWidth:1,gridColor:o,labels:true,labelAngle:0,labelLimit:180,labelOffset:0,labelPadding:2,ticks:true,tickColor:a,tickOffset:0,tickRound:true,tickSize:5,tickWidth:1,titlePadding:4},axisBand:{tickOffset:-.5},projection:{type:"mercator"},legend:{orient:"right",padding:0,gridAlign:"each",columnPadding:10,rowPadding:2,symbolDirection:"vertical",gradientDirection:"vertical",gradientLength:200,gradientThickness:16,gradientStrokeColor:o,gradientStrokeWidth:0,gradientLabelOffset:2,labelAlign:"left",labelBaseline:"middle",labelLimit:160,labelOffset:4,labelOverlap:true,symbolLimit:30,symbolType:"circle",symbolSize:100,symbolOffset:0,symbolStrokeWidth:1.5,symbolBaseFillColor:"transparent",symbolBaseStrokeColor:a,titleLimit:180,titleOrient:"top",titlePadding:5,layout:{offset:18,direction:"horizontal",left:{direction:"vertical"},right:{direction:"vertical"}}},range:{category:{scheme:"tableau10"},ordinal:{scheme:"blues"},heatmap:{scheme:"yellowgreenblue"},ramp:{scheme:"blues"},diverging:{scheme:"blueorange",extent:[1,0]},symbol:["circle","square","triangle-up","cross","diamond","triangle-right","triangle-down","triangle-left"]}}}function SQ(t,e,n){if(!(0,g.Kn)(t)){(0,g.vU)("Input Vega specification must be an object.")}e=(0,g.fE)(FQ(),e,t.config);return bQ(t,new MQ(e,n)).toRuntime()}var TQ="vega";var BQ="5.21.0";var NQ="The Vega visualization grammar.";var zQ=["vega","visualization","interaction","dataflow","library","data","d3"];var OQ="BSD-3-Clause";var RQ="UW Interactive Data Lab (http://idl.cs.washington.edu)";var UQ="build/vega-node.js";var $Q="build/vega.module.js";var PQ="build/vega.min.js";var qQ="build/vega.min.js";var IQ="index.d.ts";var LQ="vega/vega";var jQ={bundle:"rollup -c --config-bundle",prebuild:"rimraf build && rimraf build-es5",build:"rollup -c --config-core --config-bundle --config-ie",postbuild:"node schema-copy",pretest:"yarn build --config-test",test:"TZ=America/Los_Angeles tape 'test/**/*-test.js'",prepublishOnly:"yarn test && yarn build",postpublish:"./schema-deploy.sh"};var WQ={"vega-crossfilter":"~4.0.5","vega-dataflow":"~5.7.4","vega-encode":"~4.8.3","vega-event-selector":"~3.0.0","vega-expression":"~5.0.0","vega-force":"~4.0.7","vega-format":"~1.0.4","vega-functions":"~5.12.1","vega-geo":"~4.3.8","vega-hierarchy":"~4.0.9","vega-label":"~1.1.0","vega-loader":"~4.4.1","vega-parser":"~6.1.4","vega-projection":"~1.4.5","vega-regression":"~1.0.9","vega-runtime":"~6.1.3","vega-scale":"~7.1.1","vega-scenegraph":"~4.9.4","vega-statistics":"~1.7.10","vega-time":"~2.0.4","vega-transforms":"~4.9.4","vega-typings":"~0.22.0","vega-util":"~1.17.0","vega-view":"~5.10.1","vega-view-transforms":"~4.5.8","vega-voronoi":"~4.1.5","vega-wordcloud":"~4.1.3"};var XQ={"vega-schema":"*"};var HQ="774165e29850b66ec8b79ba52a7955f1ab936ea6";var YQ={name:TQ,version:BQ,description:NQ,keywords:zQ,license:OQ,author:RQ,main:UQ,module:$Q,unpkg:PQ,jsdelivr:qQ,types:IQ,repository:LQ,scripts:jQ,dependencies:WQ,devDependencies:XQ,gitHead:HQ};(0,g.l7)(Xo,i,a,o,u,s,f,l,c,h,d,p);const JQ=YQ.version}}]);
//# sourceMappingURL=863.0506b197c7fd586cdc12.js.map?v=0506b197c7fd586cdc12